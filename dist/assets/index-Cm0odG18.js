var aw=t=>{throw TypeError(t)};var Yf=(t,e,n)=>e.has(t)||aw("Cannot "+n);var M=(t,e,n)=>(Yf(t,e,"read from private field"),n?n.call(t):e.get(t)),ye=(t,e,n)=>e.has(t)?aw("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),se=(t,e,n,r)=>(Yf(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),je=(t,e,n)=>(Yf(t,e,"access private method"),n);var ed=(t,e,n,r)=>({set _(i){se(t,e,i,n)},get _(){return M(t,e,r)}});function gT(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var l1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _T={exports:{}},Hh={},vT={exports:{}},Le={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gu=Symbol.for("react.element"),c1=Symbol.for("react.portal"),u1=Symbol.for("react.fragment"),d1=Symbol.for("react.strict_mode"),h1=Symbol.for("react.profiler"),f1=Symbol.for("react.provider"),p1=Symbol.for("react.context"),m1=Symbol.for("react.forward_ref"),g1=Symbol.for("react.suspense"),y1=Symbol.for("react.memo"),_1=Symbol.for("react.lazy"),lw=Symbol.iterator;function v1(t){return t===null||typeof t!="object"?null:(t=lw&&t[lw]||t["@@iterator"],typeof t=="function"?t:null)}var wT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ET=Object.assign,ST={};function ml(t,e,n){this.props=t,this.context=e,this.refs=ST,this.updater=n||wT}ml.prototype.isReactComponent={};ml.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ml.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function TT(){}TT.prototype=ml.prototype;function Yg(t,e,n){this.props=t,this.context=e,this.refs=ST,this.updater=n||wT}var Zg=Yg.prototype=new TT;Zg.constructor=Yg;ET(Zg,ml.prototype);Zg.isPureReactComponent=!0;var cw=Array.isArray,xT=Object.prototype.hasOwnProperty,Xg={current:null},bT={key:!0,ref:!0,__self:!0,__source:!0};function IT(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)xT.call(e,r)&&!bT.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:gu,type:t,key:s,ref:o,props:i,_owner:Xg.current}}function w1(t,e){return{$$typeof:gu,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ey(t){return typeof t=="object"&&t!==null&&t.$$typeof===gu}function E1(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var uw=/\/+/g;function Zf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?E1(""+t.key):e.toString(36)}function bd(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case gu:case c1:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Zf(o,0):r,cw(i)?(n="",t!=null&&(n=t.replace(uw,"$&/")+"/"),bd(i,e,n,"",function(u){return u})):i!=null&&(ey(i)&&(i=w1(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(uw,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",cw(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Zf(s,a);o+=bd(s,e,n,l,i)}else if(l=v1(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Zf(s,a++),o+=bd(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function td(t,e,n){if(t==null)return t;var r=[],i=0;return bd(t,r,"","",function(s){return e.call(n,s,i++)}),r}function S1(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var On={current:null},Id={transition:null},T1={ReactCurrentDispatcher:On,ReactCurrentBatchConfig:Id,ReactCurrentOwner:Xg};function CT(){throw Error("act(...) is not supported in production builds of React.")}Le.Children={map:td,forEach:function(t,e,n){td(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return td(t,function(){e++}),e},toArray:function(t){return td(t,function(e){return e})||[]},only:function(t){if(!ey(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Le.Component=ml;Le.Fragment=u1;Le.Profiler=h1;Le.PureComponent=Yg;Le.StrictMode=d1;Le.Suspense=g1;Le.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=T1;Le.act=CT;Le.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=ET({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Xg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)xT.call(e,l)&&!bT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:gu,type:t.type,key:i,ref:s,props:r,_owner:o}};Le.createContext=function(t){return t={$$typeof:p1,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:f1,_context:t},t.Consumer=t};Le.createElement=IT;Le.createFactory=function(t){var e=IT.bind(null,t);return e.type=t,e};Le.createRef=function(){return{current:null}};Le.forwardRef=function(t){return{$$typeof:m1,render:t}};Le.isValidElement=ey;Le.lazy=function(t){return{$$typeof:_1,_payload:{_status:-1,_result:t},_init:S1}};Le.memo=function(t,e){return{$$typeof:y1,type:t,compare:e===void 0?null:e}};Le.startTransition=function(t){var e=Id.transition;Id.transition={};try{t()}finally{Id.transition=e}};Le.unstable_act=CT;Le.useCallback=function(t,e){return On.current.useCallback(t,e)};Le.useContext=function(t){return On.current.useContext(t)};Le.useDebugValue=function(){};Le.useDeferredValue=function(t){return On.current.useDeferredValue(t)};Le.useEffect=function(t,e){return On.current.useEffect(t,e)};Le.useId=function(){return On.current.useId()};Le.useImperativeHandle=function(t,e,n){return On.current.useImperativeHandle(t,e,n)};Le.useInsertionEffect=function(t,e){return On.current.useInsertionEffect(t,e)};Le.useLayoutEffect=function(t,e){return On.current.useLayoutEffect(t,e)};Le.useMemo=function(t,e){return On.current.useMemo(t,e)};Le.useReducer=function(t,e,n){return On.current.useReducer(t,e,n)};Le.useRef=function(t){return On.current.useRef(t)};Le.useState=function(t){return On.current.useState(t)};Le.useSyncExternalStore=function(t,e,n){return On.current.useSyncExternalStore(t,e,n)};Le.useTransition=function(){return On.current.useTransition()};Le.version="18.3.1";vT.exports=Le;var N=vT.exports;const Cn=yT(N),kT=gT({__proto__:null,default:Cn},[N]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x1=N,b1=Symbol.for("react.element"),I1=Symbol.for("react.fragment"),C1=Object.prototype.hasOwnProperty,k1=x1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,A1={key:!0,ref:!0,__self:!0,__source:!0};function AT(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)C1.call(e,r)&&!A1.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:b1,type:t,key:s,ref:o,props:i,_owner:k1.current}}Hh.Fragment=I1;Hh.jsx=AT;Hh.jsxs=AT;_T.exports=Hh;var m=_T.exports,Kp={},PT={exports:{}},cr={},RT={exports:{}},NT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(B,Q){var fe=B.length;B.push(Q);e:for(;0<fe;){var ke=fe-1>>>1,$e=B[ke];if(0<i($e,Q))B[ke]=Q,B[fe]=$e,fe=ke;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var Q=B[0],fe=B.pop();if(fe!==Q){B[0]=fe;e:for(var ke=0,$e=B.length,Ze=$e>>>1;ke<Ze;){var Gt=2*(ke+1)-1,Kt=B[Gt],En=Gt+1,Z=B[En];if(0>i(Kt,fe))En<$e&&0>i(Z,Kt)?(B[ke]=Z,B[En]=fe,ke=En):(B[ke]=Kt,B[Gt]=fe,ke=Gt);else if(En<$e&&0>i(Z,fe))B[ke]=Z,B[En]=fe,ke=En;else break e}}return Q}function i(B,Q){var fe=B.sortIndex-Q.sortIndex;return fe!==0?fe:B.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],u=[],d=1,h=null,p=3,y=!1,T=!1,E=!1,R=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(B){for(var Q=n(u);Q!==null;){if(Q.callback===null)r(u);else if(Q.startTime<=B)r(u),Q.sortIndex=Q.expirationTime,e(l,Q);else break;Q=n(u)}}function D(B){if(E=!1,b(B),!T)if(n(l)!==null)T=!0,Ne(L);else{var Q=n(u);Q!==null&&De(D,Q.startTime-B)}}function L(B,Q){T=!1,E&&(E=!1,w(_),_=-1),y=!0;var fe=p;try{for(b(Q),h=n(l);h!==null&&(!(h.expirationTime>Q)||B&&!k());){var ke=h.callback;if(typeof ke=="function"){h.callback=null,p=h.priorityLevel;var $e=ke(h.expirationTime<=Q);Q=t.unstable_now(),typeof $e=="function"?h.callback=$e:h===n(l)&&r(l),b(Q)}else r(l);h=n(l)}if(h!==null)var Ze=!0;else{var Gt=n(u);Gt!==null&&De(D,Gt.startTime-Q),Ze=!1}return Ze}finally{h=null,p=fe,y=!1}}var j=!1,I=null,_=-1,C=5,A=-1;function k(){return!(t.unstable_now()-A<C)}function x(){if(I!==null){var B=t.unstable_now();A=B;var Q=!0;try{Q=I(!0,B)}finally{Q?P():(j=!1,I=null)}}else j=!1}var P;if(typeof v=="function")P=function(){v(x)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,we=he.port2;he.port1.onmessage=x,P=function(){we.postMessage(null)}}else P=function(){R(x,0)};function Ne(B){I=B,j||(j=!0,P())}function De(B,Q){_=R(function(){B(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(B){B.callback=null},t.unstable_continueExecution=function(){T||y||(T=!0,Ne(L))},t.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<B?Math.floor(1e3/B):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(B){switch(p){case 1:case 2:case 3:var Q=3;break;default:Q=p}var fe=p;p=Q;try{return B()}finally{p=fe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(B,Q){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var fe=p;p=B;try{return Q()}finally{p=fe}},t.unstable_scheduleCallback=function(B,Q,fe){var ke=t.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?ke+fe:ke):fe=ke,B){case 1:var $e=-1;break;case 2:$e=250;break;case 5:$e=1073741823;break;case 4:$e=1e4;break;default:$e=5e3}return $e=fe+$e,B={id:d++,callback:Q,priorityLevel:B,startTime:fe,expirationTime:$e,sortIndex:-1},fe>ke?(B.sortIndex=fe,e(u,B),n(l)===null&&B===n(u)&&(E?(w(_),_=-1):E=!0,De(D,fe-ke))):(B.sortIndex=$e,e(l,B),T||y||(T=!0,Ne(L))),B},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(B){var Q=p;return function(){var fe=p;p=Q;try{return B.apply(this,arguments)}finally{p=fe}}}})(NT);RT.exports=NT;var P1=RT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R1=N,sr=P1;function q(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var DT=new Set,kc={};function Fo(t,e){Ka(t,e),Ka(t+"Capture",e)}function Ka(t,e){for(kc[t]=e,t=0;t<e.length;t++)DT.add(e[t])}var bi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qp=Object.prototype.hasOwnProperty,N1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,dw={},hw={};function D1(t){return Qp.call(hw,t)?!0:Qp.call(dw,t)?!1:N1.test(t)?hw[t]=!0:(dw[t]=!0,!1)}function O1(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function L1(t,e,n,r){if(e===null||typeof e>"u"||O1(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ln(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var on={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){on[t]=new Ln(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];on[e]=new Ln(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){on[t]=new Ln(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){on[t]=new Ln(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){on[t]=new Ln(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){on[t]=new Ln(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){on[t]=new Ln(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){on[t]=new Ln(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){on[t]=new Ln(t,5,!1,t.toLowerCase(),null,!1,!1)});var ty=/[\-:]([a-z])/g;function ny(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ty,ny);on[e]=new Ln(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ty,ny);on[e]=new Ln(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ty,ny);on[e]=new Ln(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){on[t]=new Ln(t,1,!1,t.toLowerCase(),null,!1,!1)});on.xlinkHref=new Ln("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){on[t]=new Ln(t,1,!1,t.toLowerCase(),null,!0,!0)});function ry(t,e,n,r){var i=on.hasOwnProperty(e)?on[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(L1(e,n,i,r)&&(n=null),r||i===null?D1(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Li=R1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nd=Symbol.for("react.element"),ca=Symbol.for("react.portal"),ua=Symbol.for("react.fragment"),iy=Symbol.for("react.strict_mode"),Jp=Symbol.for("react.profiler"),OT=Symbol.for("react.provider"),LT=Symbol.for("react.context"),sy=Symbol.for("react.forward_ref"),Yp=Symbol.for("react.suspense"),Zp=Symbol.for("react.suspense_list"),oy=Symbol.for("react.memo"),Ji=Symbol.for("react.lazy"),MT=Symbol.for("react.offscreen"),fw=Symbol.iterator;function $l(t){return t===null||typeof t!="object"?null:(t=fw&&t[fw]||t["@@iterator"],typeof t=="function"?t:null)}var St=Object.assign,Xf;function Xl(t){if(Xf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Xf=e&&e[1]||""}return`
`+Xf+t}var ep=!1;function tp(t,e){if(!t||ep)return"";ep=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{ep=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Xl(t):""}function M1(t){switch(t.tag){case 5:return Xl(t.type);case 16:return Xl("Lazy");case 13:return Xl("Suspense");case 19:return Xl("SuspenseList");case 0:case 2:case 15:return t=tp(t.type,!1),t;case 11:return t=tp(t.type.render,!1),t;case 1:return t=tp(t.type,!0),t;default:return""}}function Xp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ua:return"Fragment";case ca:return"Portal";case Jp:return"Profiler";case iy:return"StrictMode";case Yp:return"Suspense";case Zp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case LT:return(t.displayName||"Context")+".Consumer";case OT:return(t._context.displayName||"Context")+".Provider";case sy:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case oy:return e=t.displayName||null,e!==null?e:Xp(t.type)||"Memo";case Ji:e=t._payload,t=t._init;try{return Xp(t(e))}catch{}}return null}function V1(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Xp(e);case 8:return e===iy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ds(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function VT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function j1(t){var e=VT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function rd(t){t._valueTracker||(t._valueTracker=j1(t))}function jT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=VT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Kd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function em(t,e){var n=e.checked;return St({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function pw(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ds(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function FT(t,e){e=e.checked,e!=null&&ry(t,"checked",e,!1)}function tm(t,e){FT(t,e);var n=Ds(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?nm(t,e.type,n):e.hasOwnProperty("defaultValue")&&nm(t,e.type,Ds(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function mw(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function nm(t,e,n){(e!=="number"||Kd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ec=Array.isArray;function Ea(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ds(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function rm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(q(91));return St({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function gw(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(q(92));if(ec(n)){if(1<n.length)throw Error(q(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ds(n)}}function UT(t,e){var n=Ds(e.value),r=Ds(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function yw(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function $T(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function im(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?$T(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var id,BT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(id=id||document.createElement("div"),id.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=id.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ac(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var dc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},F1=["Webkit","ms","Moz","O"];Object.keys(dc).forEach(function(t){F1.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),dc[e]=dc[t]})});function zT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||dc.hasOwnProperty(t)&&dc[t]?(""+e).trim():e+"px"}function WT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=zT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var U1=St({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sm(t,e){if(e){if(U1[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(q(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(q(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(q(61))}if(e.style!=null&&typeof e.style!="object")throw Error(q(62))}}function om(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var am=null;function ay(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var lm=null,Sa=null,Ta=null;function _w(t){if(t=vu(t)){if(typeof lm!="function")throw Error(q(280));var e=t.stateNode;e&&(e=Yh(e),lm(t.stateNode,t.type,e))}}function qT(t){Sa?Ta?Ta.push(t):Ta=[t]:Sa=t}function HT(){if(Sa){var t=Sa,e=Ta;if(Ta=Sa=null,_w(t),e)for(t=0;t<e.length;t++)_w(e[t])}}function GT(t,e){return t(e)}function KT(){}var np=!1;function QT(t,e,n){if(np)return t(e,n);np=!0;try{return GT(t,e,n)}finally{np=!1,(Sa!==null||Ta!==null)&&(KT(),HT())}}function Pc(t,e){var n=t.stateNode;if(n===null)return null;var r=Yh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(q(231,e,typeof n));return n}var cm=!1;if(bi)try{var Bl={};Object.defineProperty(Bl,"passive",{get:function(){cm=!0}}),window.addEventListener("test",Bl,Bl),window.removeEventListener("test",Bl,Bl)}catch{cm=!1}function $1(t,e,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var hc=!1,Qd=null,Jd=!1,um=null,B1={onError:function(t){hc=!0,Qd=t}};function z1(t,e,n,r,i,s,o,a,l){hc=!1,Qd=null,$1.apply(B1,arguments)}function W1(t,e,n,r,i,s,o,a,l){if(z1.apply(this,arguments),hc){if(hc){var u=Qd;hc=!1,Qd=null}else throw Error(q(198));Jd||(Jd=!0,um=u)}}function Uo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function JT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function vw(t){if(Uo(t)!==t)throw Error(q(188))}function q1(t){var e=t.alternate;if(!e){if(e=Uo(t),e===null)throw Error(q(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return vw(i),t;if(s===r)return vw(i),e;s=s.sibling}throw Error(q(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(q(189))}}if(n.alternate!==r)throw Error(q(190))}if(n.tag!==3)throw Error(q(188));return n.stateNode.current===n?t:e}function YT(t){return t=q1(t),t!==null?ZT(t):null}function ZT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=ZT(t);if(e!==null)return e;t=t.sibling}return null}var XT=sr.unstable_scheduleCallback,ww=sr.unstable_cancelCallback,H1=sr.unstable_shouldYield,G1=sr.unstable_requestPaint,At=sr.unstable_now,K1=sr.unstable_getCurrentPriorityLevel,ly=sr.unstable_ImmediatePriority,ex=sr.unstable_UserBlockingPriority,Yd=sr.unstable_NormalPriority,Q1=sr.unstable_LowPriority,tx=sr.unstable_IdlePriority,Gh=null,Yr=null;function J1(t){if(Yr&&typeof Yr.onCommitFiberRoot=="function")try{Yr.onCommitFiberRoot(Gh,t,void 0,(t.current.flags&128)===128)}catch{}}var Lr=Math.clz32?Math.clz32:X1,Y1=Math.log,Z1=Math.LN2;function X1(t){return t>>>=0,t===0?32:31-(Y1(t)/Z1|0)|0}var sd=64,od=4194304;function tc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Zd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=tc(a):(s&=o,s!==0&&(r=tc(s)))}else o=n&~i,o!==0?r=tc(o):s!==0&&(r=tc(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Lr(e),i=1<<n,r|=t[n],e&=~i;return r}function eP(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tP(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Lr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=eP(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function dm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function nx(){var t=sd;return sd<<=1,!(sd&4194240)&&(sd=64),t}function rp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function yu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Lr(e),t[e]=n}function nP(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Lr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function cy(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Lr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var tt=0;function rx(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ix,uy,sx,ox,ax,hm=!1,ad=[],_s=null,vs=null,ws=null,Rc=new Map,Nc=new Map,Xi=[],rP="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ew(t,e){switch(t){case"focusin":case"focusout":_s=null;break;case"dragenter":case"dragleave":vs=null;break;case"mouseover":case"mouseout":ws=null;break;case"pointerover":case"pointerout":Rc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nc.delete(e.pointerId)}}function zl(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=vu(e),e!==null&&uy(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function iP(t,e,n,r,i){switch(e){case"focusin":return _s=zl(_s,t,e,n,r,i),!0;case"dragenter":return vs=zl(vs,t,e,n,r,i),!0;case"mouseover":return ws=zl(ws,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Rc.set(s,zl(Rc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Nc.set(s,zl(Nc.get(s)||null,t,e,n,r,i)),!0}return!1}function lx(t){var e=no(t.target);if(e!==null){var n=Uo(e);if(n!==null){if(e=n.tag,e===13){if(e=JT(n),e!==null){t.blockedOn=e,ax(t.priority,function(){sx(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Cd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=fm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);am=r,n.target.dispatchEvent(r),am=null}else return e=vu(n),e!==null&&uy(e),t.blockedOn=n,!1;e.shift()}return!0}function Sw(t,e,n){Cd(t)&&n.delete(e)}function sP(){hm=!1,_s!==null&&Cd(_s)&&(_s=null),vs!==null&&Cd(vs)&&(vs=null),ws!==null&&Cd(ws)&&(ws=null),Rc.forEach(Sw),Nc.forEach(Sw)}function Wl(t,e){t.blockedOn===e&&(t.blockedOn=null,hm||(hm=!0,sr.unstable_scheduleCallback(sr.unstable_NormalPriority,sP)))}function Dc(t){function e(i){return Wl(i,t)}if(0<ad.length){Wl(ad[0],t);for(var n=1;n<ad.length;n++){var r=ad[n];r.blockedOn===t&&(r.blockedOn=null)}}for(_s!==null&&Wl(_s,t),vs!==null&&Wl(vs,t),ws!==null&&Wl(ws,t),Rc.forEach(e),Nc.forEach(e),n=0;n<Xi.length;n++)r=Xi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Xi.length&&(n=Xi[0],n.blockedOn===null);)lx(n),n.blockedOn===null&&Xi.shift()}var xa=Li.ReactCurrentBatchConfig,Xd=!0;function oP(t,e,n,r){var i=tt,s=xa.transition;xa.transition=null;try{tt=1,dy(t,e,n,r)}finally{tt=i,xa.transition=s}}function aP(t,e,n,r){var i=tt,s=xa.transition;xa.transition=null;try{tt=4,dy(t,e,n,r)}finally{tt=i,xa.transition=s}}function dy(t,e,n,r){if(Xd){var i=fm(t,e,n,r);if(i===null)fp(t,e,r,eh,n),Ew(t,r);else if(iP(i,t,e,n,r))r.stopPropagation();else if(Ew(t,r),e&4&&-1<rP.indexOf(t)){for(;i!==null;){var s=vu(i);if(s!==null&&ix(s),s=fm(t,e,n,r),s===null&&fp(t,e,r,eh,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else fp(t,e,r,null,n)}}var eh=null;function fm(t,e,n,r){if(eh=null,t=ay(r),t=no(t),t!==null)if(e=Uo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=JT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return eh=t,null}function cx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(K1()){case ly:return 1;case ex:return 4;case Yd:case Q1:return 16;case tx:return 536870912;default:return 16}default:return 16}}var fs=null,hy=null,kd=null;function ux(){if(kd)return kd;var t,e=hy,n=e.length,r,i="value"in fs?fs.value:fs.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return kd=i.slice(t,1<r?1-r:void 0)}function Ad(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ld(){return!0}function Tw(){return!1}function ur(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?ld:Tw,this.isPropagationStopped=Tw,this}return St(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ld)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ld)},persist:function(){},isPersistent:ld}),e}var gl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fy=ur(gl),_u=St({},gl,{view:0,detail:0}),lP=ur(_u),ip,sp,ql,Kh=St({},_u,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:py,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ql&&(ql&&t.type==="mousemove"?(ip=t.screenX-ql.screenX,sp=t.screenY-ql.screenY):sp=ip=0,ql=t),ip)},movementY:function(t){return"movementY"in t?t.movementY:sp}}),xw=ur(Kh),cP=St({},Kh,{dataTransfer:0}),uP=ur(cP),dP=St({},_u,{relatedTarget:0}),op=ur(dP),hP=St({},gl,{animationName:0,elapsedTime:0,pseudoElement:0}),fP=ur(hP),pP=St({},gl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),mP=ur(pP),gP=St({},gl,{data:0}),bw=ur(gP),yP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_P={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=vP[t])?!!e[t]:!1}function py(){return wP}var EP=St({},_u,{key:function(t){if(t.key){var e=yP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ad(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?_P[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:py,charCode:function(t){return t.type==="keypress"?Ad(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ad(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),SP=ur(EP),TP=St({},Kh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Iw=ur(TP),xP=St({},_u,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:py}),bP=ur(xP),IP=St({},gl,{propertyName:0,elapsedTime:0,pseudoElement:0}),CP=ur(IP),kP=St({},Kh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),AP=ur(kP),PP=[9,13,27,32],my=bi&&"CompositionEvent"in window,fc=null;bi&&"documentMode"in document&&(fc=document.documentMode);var RP=bi&&"TextEvent"in window&&!fc,dx=bi&&(!my||fc&&8<fc&&11>=fc),Cw=" ",kw=!1;function hx(t,e){switch(t){case"keyup":return PP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var da=!1;function NP(t,e){switch(t){case"compositionend":return fx(e);case"keypress":return e.which!==32?null:(kw=!0,Cw);case"textInput":return t=e.data,t===Cw&&kw?null:t;default:return null}}function DP(t,e){if(da)return t==="compositionend"||!my&&hx(t,e)?(t=ux(),kd=hy=fs=null,da=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return dx&&e.locale!=="ko"?null:e.data;default:return null}}var OP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Aw(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!OP[t.type]:e==="textarea"}function px(t,e,n,r){qT(r),e=th(e,"onChange"),0<e.length&&(n=new fy("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var pc=null,Oc=null;function LP(t){bx(t,0)}function Qh(t){var e=pa(t);if(jT(e))return t}function MP(t,e){if(t==="change")return e}var mx=!1;if(bi){var ap;if(bi){var lp="oninput"in document;if(!lp){var Pw=document.createElement("div");Pw.setAttribute("oninput","return;"),lp=typeof Pw.oninput=="function"}ap=lp}else ap=!1;mx=ap&&(!document.documentMode||9<document.documentMode)}function Rw(){pc&&(pc.detachEvent("onpropertychange",gx),Oc=pc=null)}function gx(t){if(t.propertyName==="value"&&Qh(Oc)){var e=[];px(e,Oc,t,ay(t)),QT(LP,e)}}function VP(t,e,n){t==="focusin"?(Rw(),pc=e,Oc=n,pc.attachEvent("onpropertychange",gx)):t==="focusout"&&Rw()}function jP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Qh(Oc)}function FP(t,e){if(t==="click")return Qh(e)}function UP(t,e){if(t==="input"||t==="change")return Qh(e)}function $P(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ur=typeof Object.is=="function"?Object.is:$P;function Lc(t,e){if(Ur(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Qp.call(e,i)||!Ur(t[i],e[i]))return!1}return!0}function Nw(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Dw(t,e){var n=Nw(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Nw(n)}}function yx(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?yx(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function _x(){for(var t=window,e=Kd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Kd(t.document)}return e}function gy(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function BP(t){var e=_x(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&yx(n.ownerDocument.documentElement,n)){if(r!==null&&gy(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=Dw(n,s);var o=Dw(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var zP=bi&&"documentMode"in document&&11>=document.documentMode,ha=null,pm=null,mc=null,mm=!1;function Ow(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;mm||ha==null||ha!==Kd(r)||(r=ha,"selectionStart"in r&&gy(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),mc&&Lc(mc,r)||(mc=r,r=th(pm,"onSelect"),0<r.length&&(e=new fy("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ha)))}function cd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var fa={animationend:cd("Animation","AnimationEnd"),animationiteration:cd("Animation","AnimationIteration"),animationstart:cd("Animation","AnimationStart"),transitionend:cd("Transition","TransitionEnd")},cp={},vx={};bi&&(vx=document.createElement("div").style,"AnimationEvent"in window||(delete fa.animationend.animation,delete fa.animationiteration.animation,delete fa.animationstart.animation),"TransitionEvent"in window||delete fa.transitionend.transition);function Jh(t){if(cp[t])return cp[t];if(!fa[t])return t;var e=fa[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in vx)return cp[t]=e[n];return t}var wx=Jh("animationend"),Ex=Jh("animationiteration"),Sx=Jh("animationstart"),Tx=Jh("transitionend"),xx=new Map,Lw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function $s(t,e){xx.set(t,e),Fo(e,[t])}for(var up=0;up<Lw.length;up++){var dp=Lw[up],WP=dp.toLowerCase(),qP=dp[0].toUpperCase()+dp.slice(1);$s(WP,"on"+qP)}$s(wx,"onAnimationEnd");$s(Ex,"onAnimationIteration");$s(Sx,"onAnimationStart");$s("dblclick","onDoubleClick");$s("focusin","onFocus");$s("focusout","onBlur");$s(Tx,"onTransitionEnd");Ka("onMouseEnter",["mouseout","mouseover"]);Ka("onMouseLeave",["mouseout","mouseover"]);Ka("onPointerEnter",["pointerout","pointerover"]);Ka("onPointerLeave",["pointerout","pointerover"]);Fo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HP=new Set("cancel close invalid load scroll toggle".split(" ").concat(nc));function Mw(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,W1(r,e,void 0,t),t.currentTarget=null}function bx(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Mw(i,a,u),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Mw(i,a,u),s=l}}}if(Jd)throw t=um,Jd=!1,um=null,t}function ht(t,e){var n=e[wm];n===void 0&&(n=e[wm]=new Set);var r=t+"__bubble";n.has(r)||(Ix(e,t,2,!1),n.add(r))}function hp(t,e,n){var r=0;e&&(r|=4),Ix(n,t,r,e)}var ud="_reactListening"+Math.random().toString(36).slice(2);function Mc(t){if(!t[ud]){t[ud]=!0,DT.forEach(function(n){n!=="selectionchange"&&(HP.has(n)||hp(n,!1,t),hp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[ud]||(e[ud]=!0,hp("selectionchange",!1,e))}}function Ix(t,e,n,r){switch(cx(e)){case 1:var i=oP;break;case 4:i=aP;break;default:i=dy}n=i.bind(null,e,n,t),i=void 0,!cm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function fp(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=no(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}QT(function(){var u=s,d=ay(n),h=[];e:{var p=xx.get(t);if(p!==void 0){var y=fy,T=t;switch(t){case"keypress":if(Ad(n)===0)break e;case"keydown":case"keyup":y=SP;break;case"focusin":T="focus",y=op;break;case"focusout":T="blur",y=op;break;case"beforeblur":case"afterblur":y=op;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=xw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=uP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=bP;break;case wx:case Ex:case Sx:y=fP;break;case Tx:y=CP;break;case"scroll":y=lP;break;case"wheel":y=AP;break;case"copy":case"cut":case"paste":y=mP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=Iw}var E=(e&4)!==0,R=!E&&t==="scroll",w=E?p!==null?p+"Capture":null:p;E=[];for(var v=u,b;v!==null;){b=v;var D=b.stateNode;if(b.tag===5&&D!==null&&(b=D,w!==null&&(D=Pc(v,w),D!=null&&E.push(Vc(v,D,b)))),R)break;v=v.return}0<E.length&&(p=new y(p,T,null,n,d),h.push({event:p,listeners:E}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",p&&n!==am&&(T=n.relatedTarget||n.fromElement)&&(no(T)||T[Ii]))break e;if((y||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,y?(T=n.relatedTarget||n.toElement,y=u,T=T?no(T):null,T!==null&&(R=Uo(T),T!==R||T.tag!==5&&T.tag!==6)&&(T=null)):(y=null,T=u),y!==T)){if(E=xw,D="onMouseLeave",w="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(E=Iw,D="onPointerLeave",w="onPointerEnter",v="pointer"),R=y==null?p:pa(y),b=T==null?p:pa(T),p=new E(D,v+"leave",y,n,d),p.target=R,p.relatedTarget=b,D=null,no(d)===u&&(E=new E(w,v+"enter",T,n,d),E.target=b,E.relatedTarget=R,D=E),R=D,y&&T)t:{for(E=y,w=T,v=0,b=E;b;b=Yo(b))v++;for(b=0,D=w;D;D=Yo(D))b++;for(;0<v-b;)E=Yo(E),v--;for(;0<b-v;)w=Yo(w),b--;for(;v--;){if(E===w||w!==null&&E===w.alternate)break t;E=Yo(E),w=Yo(w)}E=null}else E=null;y!==null&&Vw(h,p,y,E,!1),T!==null&&R!==null&&Vw(h,R,T,E,!0)}}e:{if(p=u?pa(u):window,y=p.nodeName&&p.nodeName.toLowerCase(),y==="select"||y==="input"&&p.type==="file")var L=MP;else if(Aw(p))if(mx)L=UP;else{L=jP;var j=VP}else(y=p.nodeName)&&y.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(L=FP);if(L&&(L=L(t,u))){px(h,L,n,d);break e}j&&j(t,p,u),t==="focusout"&&(j=p._wrapperState)&&j.controlled&&p.type==="number"&&nm(p,"number",p.value)}switch(j=u?pa(u):window,t){case"focusin":(Aw(j)||j.contentEditable==="true")&&(ha=j,pm=u,mc=null);break;case"focusout":mc=pm=ha=null;break;case"mousedown":mm=!0;break;case"contextmenu":case"mouseup":case"dragend":mm=!1,Ow(h,n,d);break;case"selectionchange":if(zP)break;case"keydown":case"keyup":Ow(h,n,d)}var I;if(my)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else da?hx(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(dx&&n.locale!=="ko"&&(da||_!=="onCompositionStart"?_==="onCompositionEnd"&&da&&(I=ux()):(fs=d,hy="value"in fs?fs.value:fs.textContent,da=!0)),j=th(u,_),0<j.length&&(_=new bw(_,t,null,n,d),h.push({event:_,listeners:j}),I?_.data=I:(I=fx(n),I!==null&&(_.data=I)))),(I=RP?NP(t,n):DP(t,n))&&(u=th(u,"onBeforeInput"),0<u.length&&(d=new bw("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=I))}bx(h,e)})}function Vc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function th(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Pc(t,n),s!=null&&r.unshift(Vc(t,s,i)),s=Pc(t,e),s!=null&&r.push(Vc(t,s,i))),t=t.return}return r}function Yo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Vw(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,i?(l=Pc(n,s),l!=null&&o.unshift(Vc(n,l,a))):i||(l=Pc(n,s),l!=null&&o.push(Vc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var GP=/\r\n?/g,KP=/\u0000|\uFFFD/g;function jw(t){return(typeof t=="string"?t:""+t).replace(GP,`
`).replace(KP,"")}function dd(t,e,n){if(e=jw(e),jw(t)!==e&&n)throw Error(q(425))}function nh(){}var gm=null,ym=null;function _m(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var vm=typeof setTimeout=="function"?setTimeout:void 0,QP=typeof clearTimeout=="function"?clearTimeout:void 0,Fw=typeof Promise=="function"?Promise:void 0,JP=typeof queueMicrotask=="function"?queueMicrotask:typeof Fw<"u"?function(t){return Fw.resolve(null).then(t).catch(YP)}:vm;function YP(t){setTimeout(function(){throw t})}function pp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Dc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Dc(e)}function Es(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Uw(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var yl=Math.random().toString(36).slice(2),Qr="__reactFiber$"+yl,jc="__reactProps$"+yl,Ii="__reactContainer$"+yl,wm="__reactEvents$"+yl,ZP="__reactListeners$"+yl,XP="__reactHandles$"+yl;function no(t){var e=t[Qr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Ii]||n[Qr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Uw(t);t!==null;){if(n=t[Qr])return n;t=Uw(t)}return e}t=n,n=t.parentNode}return null}function vu(t){return t=t[Qr]||t[Ii],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function pa(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(q(33))}function Yh(t){return t[jc]||null}var Em=[],ma=-1;function Bs(t){return{current:t}}function pt(t){0>ma||(t.current=Em[ma],Em[ma]=null,ma--)}function at(t,e){ma++,Em[ma]=t.current,t.current=e}var Os={},vn=Bs(Os),zn=Bs(!1),bo=Os;function Qa(t,e){var n=t.type.contextTypes;if(!n)return Os;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Wn(t){return t=t.childContextTypes,t!=null}function rh(){pt(zn),pt(vn)}function $w(t,e,n){if(vn.current!==Os)throw Error(q(168));at(vn,e),at(zn,n)}function Cx(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(q(108,V1(t)||"Unknown",i));return St({},n,r)}function ih(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Os,bo=vn.current,at(vn,t),at(zn,zn.current),!0}function Bw(t,e,n){var r=t.stateNode;if(!r)throw Error(q(169));n?(t=Cx(t,e,bo),r.__reactInternalMemoizedMergedChildContext=t,pt(zn),pt(vn),at(vn,t)):pt(zn),at(zn,n)}var mi=null,Zh=!1,mp=!1;function kx(t){mi===null?mi=[t]:mi.push(t)}function eR(t){Zh=!0,kx(t)}function zs(){if(!mp&&mi!==null){mp=!0;var t=0,e=tt;try{var n=mi;for(tt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}mi=null,Zh=!1}catch(i){throw mi!==null&&(mi=mi.slice(t+1)),XT(ly,zs),i}finally{tt=e,mp=!1}}return null}var ga=[],ya=0,sh=null,oh=0,fr=[],pr=0,Io=null,_i=1,vi="";function Xs(t,e){ga[ya++]=oh,ga[ya++]=sh,sh=t,oh=e}function Ax(t,e,n){fr[pr++]=_i,fr[pr++]=vi,fr[pr++]=Io,Io=t;var r=_i;t=vi;var i=32-Lr(r)-1;r&=~(1<<i),n+=1;var s=32-Lr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,_i=1<<32-Lr(e)+i|n<<i|r,vi=s+t}else _i=1<<s|n<<i|r,vi=t}function yy(t){t.return!==null&&(Xs(t,1),Ax(t,1,0))}function _y(t){for(;t===sh;)sh=ga[--ya],ga[ya]=null,oh=ga[--ya],ga[ya]=null;for(;t===Io;)Io=fr[--pr],fr[pr]=null,vi=fr[--pr],fr[pr]=null,_i=fr[--pr],fr[pr]=null}var ir=null,nr=null,yt=!1,Nr=null;function Px(t,e){var n=mr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function zw(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ir=t,nr=Es(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ir=t,nr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Io!==null?{id:_i,overflow:vi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=mr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,ir=t,nr=null,!0):!1;default:return!1}}function Sm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Tm(t){if(yt){var e=nr;if(e){var n=e;if(!zw(t,e)){if(Sm(t))throw Error(q(418));e=Es(n.nextSibling);var r=ir;e&&zw(t,e)?Px(r,n):(t.flags=t.flags&-4097|2,yt=!1,ir=t)}}else{if(Sm(t))throw Error(q(418));t.flags=t.flags&-4097|2,yt=!1,ir=t}}}function Ww(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ir=t}function hd(t){if(t!==ir)return!1;if(!yt)return Ww(t),yt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!_m(t.type,t.memoizedProps)),e&&(e=nr)){if(Sm(t))throw Rx(),Error(q(418));for(;e;)Px(t,e),e=Es(e.nextSibling)}if(Ww(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(q(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){nr=Es(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}nr=null}}else nr=ir?Es(t.stateNode.nextSibling):null;return!0}function Rx(){for(var t=nr;t;)t=Es(t.nextSibling)}function Ja(){nr=ir=null,yt=!1}function vy(t){Nr===null?Nr=[t]:Nr.push(t)}var tR=Li.ReactCurrentBatchConfig;function Hl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(q(309));var r=n.stateNode}if(!r)throw Error(q(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(q(284));if(!n._owner)throw Error(q(290,t))}return t}function fd(t,e){throw t=Object.prototype.toString.call(e),Error(q(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function qw(t){var e=t._init;return e(t._payload)}function Nx(t){function e(w,v){if(t){var b=w.deletions;b===null?(w.deletions=[v],w.flags|=16):b.push(v)}}function n(w,v){if(!t)return null;for(;v!==null;)e(w,v),v=v.sibling;return null}function r(w,v){for(w=new Map;v!==null;)v.key!==null?w.set(v.key,v):w.set(v.index,v),v=v.sibling;return w}function i(w,v){return w=bs(w,v),w.index=0,w.sibling=null,w}function s(w,v,b){return w.index=b,t?(b=w.alternate,b!==null?(b=b.index,b<v?(w.flags|=2,v):b):(w.flags|=2,v)):(w.flags|=1048576,v)}function o(w){return t&&w.alternate===null&&(w.flags|=2),w}function a(w,v,b,D){return v===null||v.tag!==6?(v=Sp(b,w.mode,D),v.return=w,v):(v=i(v,b),v.return=w,v)}function l(w,v,b,D){var L=b.type;return L===ua?d(w,v,b.props.children,D,b.key):v!==null&&(v.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Ji&&qw(L)===v.type)?(D=i(v,b.props),D.ref=Hl(w,v,b),D.return=w,D):(D=Md(b.type,b.key,b.props,null,w.mode,D),D.ref=Hl(w,v,b),D.return=w,D)}function u(w,v,b,D){return v===null||v.tag!==4||v.stateNode.containerInfo!==b.containerInfo||v.stateNode.implementation!==b.implementation?(v=Tp(b,w.mode,D),v.return=w,v):(v=i(v,b.children||[]),v.return=w,v)}function d(w,v,b,D,L){return v===null||v.tag!==7?(v=Eo(b,w.mode,D,L),v.return=w,v):(v=i(v,b),v.return=w,v)}function h(w,v,b){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Sp(""+v,w.mode,b),v.return=w,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case nd:return b=Md(v.type,v.key,v.props,null,w.mode,b),b.ref=Hl(w,null,v),b.return=w,b;case ca:return v=Tp(v,w.mode,b),v.return=w,v;case Ji:var D=v._init;return h(w,D(v._payload),b)}if(ec(v)||$l(v))return v=Eo(v,w.mode,b,null),v.return=w,v;fd(w,v)}return null}function p(w,v,b,D){var L=v!==null?v.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return L!==null?null:a(w,v,""+b,D);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case nd:return b.key===L?l(w,v,b,D):null;case ca:return b.key===L?u(w,v,b,D):null;case Ji:return L=b._init,p(w,v,L(b._payload),D)}if(ec(b)||$l(b))return L!==null?null:d(w,v,b,D,null);fd(w,b)}return null}function y(w,v,b,D,L){if(typeof D=="string"&&D!==""||typeof D=="number")return w=w.get(b)||null,a(v,w,""+D,L);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case nd:return w=w.get(D.key===null?b:D.key)||null,l(v,w,D,L);case ca:return w=w.get(D.key===null?b:D.key)||null,u(v,w,D,L);case Ji:var j=D._init;return y(w,v,b,j(D._payload),L)}if(ec(D)||$l(D))return w=w.get(b)||null,d(v,w,D,L,null);fd(v,D)}return null}function T(w,v,b,D){for(var L=null,j=null,I=v,_=v=0,C=null;I!==null&&_<b.length;_++){I.index>_?(C=I,I=null):C=I.sibling;var A=p(w,I,b[_],D);if(A===null){I===null&&(I=C);break}t&&I&&A.alternate===null&&e(w,I),v=s(A,v,_),j===null?L=A:j.sibling=A,j=A,I=C}if(_===b.length)return n(w,I),yt&&Xs(w,_),L;if(I===null){for(;_<b.length;_++)I=h(w,b[_],D),I!==null&&(v=s(I,v,_),j===null?L=I:j.sibling=I,j=I);return yt&&Xs(w,_),L}for(I=r(w,I);_<b.length;_++)C=y(I,w,_,b[_],D),C!==null&&(t&&C.alternate!==null&&I.delete(C.key===null?_:C.key),v=s(C,v,_),j===null?L=C:j.sibling=C,j=C);return t&&I.forEach(function(k){return e(w,k)}),yt&&Xs(w,_),L}function E(w,v,b,D){var L=$l(b);if(typeof L!="function")throw Error(q(150));if(b=L.call(b),b==null)throw Error(q(151));for(var j=L=null,I=v,_=v=0,C=null,A=b.next();I!==null&&!A.done;_++,A=b.next()){I.index>_?(C=I,I=null):C=I.sibling;var k=p(w,I,A.value,D);if(k===null){I===null&&(I=C);break}t&&I&&k.alternate===null&&e(w,I),v=s(k,v,_),j===null?L=k:j.sibling=k,j=k,I=C}if(A.done)return n(w,I),yt&&Xs(w,_),L;if(I===null){for(;!A.done;_++,A=b.next())A=h(w,A.value,D),A!==null&&(v=s(A,v,_),j===null?L=A:j.sibling=A,j=A);return yt&&Xs(w,_),L}for(I=r(w,I);!A.done;_++,A=b.next())A=y(I,w,_,A.value,D),A!==null&&(t&&A.alternate!==null&&I.delete(A.key===null?_:A.key),v=s(A,v,_),j===null?L=A:j.sibling=A,j=A);return t&&I.forEach(function(x){return e(w,x)}),yt&&Xs(w,_),L}function R(w,v,b,D){if(typeof b=="object"&&b!==null&&b.type===ua&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case nd:e:{for(var L=b.key,j=v;j!==null;){if(j.key===L){if(L=b.type,L===ua){if(j.tag===7){n(w,j.sibling),v=i(j,b.props.children),v.return=w,w=v;break e}}else if(j.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===Ji&&qw(L)===j.type){n(w,j.sibling),v=i(j,b.props),v.ref=Hl(w,j,b),v.return=w,w=v;break e}n(w,j);break}else e(w,j);j=j.sibling}b.type===ua?(v=Eo(b.props.children,w.mode,D,b.key),v.return=w,w=v):(D=Md(b.type,b.key,b.props,null,w.mode,D),D.ref=Hl(w,v,b),D.return=w,w=D)}return o(w);case ca:e:{for(j=b.key;v!==null;){if(v.key===j)if(v.tag===4&&v.stateNode.containerInfo===b.containerInfo&&v.stateNode.implementation===b.implementation){n(w,v.sibling),v=i(v,b.children||[]),v.return=w,w=v;break e}else{n(w,v);break}else e(w,v);v=v.sibling}v=Tp(b,w.mode,D),v.return=w,w=v}return o(w);case Ji:return j=b._init,R(w,v,j(b._payload),D)}if(ec(b))return T(w,v,b,D);if($l(b))return E(w,v,b,D);fd(w,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,v!==null&&v.tag===6?(n(w,v.sibling),v=i(v,b),v.return=w,w=v):(n(w,v),v=Sp(b,w.mode,D),v.return=w,w=v),o(w)):n(w,v)}return R}var Ya=Nx(!0),Dx=Nx(!1),ah=Bs(null),lh=null,_a=null,wy=null;function Ey(){wy=_a=lh=null}function Sy(t){var e=ah.current;pt(ah),t._currentValue=e}function xm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ba(t,e){lh=t,wy=_a=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Bn=!0),t.firstContext=null)}function vr(t){var e=t._currentValue;if(wy!==t)if(t={context:t,memoizedValue:e,next:null},_a===null){if(lh===null)throw Error(q(308));_a=t,lh.dependencies={lanes:0,firstContext:t}}else _a=_a.next=t;return e}var ro=null;function Ty(t){ro===null?ro=[t]:ro.push(t)}function Ox(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Ty(e)):(n.next=i.next,i.next=n),e.interleaved=n,Ci(t,r)}function Ci(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Yi=!1;function xy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lx(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ti(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ss(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ze&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Ci(t,n)}return i=r.interleaved,i===null?(e.next=e,Ty(r)):(e.next=i.next,i.next=e),r.interleaved=e,Ci(t,n)}function Pd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,cy(t,n)}}function Hw(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ch(t,e,n,r){var i=t.updateQueue;Yi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?s=u:o.next=u,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,d=u=l=null,a=s;do{var p=a.lane,y=a.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:y,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var T=t,E=a;switch(p=e,y=n,E.tag){case 1:if(T=E.payload,typeof T=="function"){h=T.call(y,h,p);break e}h=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=E.payload,p=typeof T=="function"?T.call(y,h,p):T,p==null)break e;h=St({},h,p);break e;case 2:Yi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=i.effects,p===null?i.effects=[a]:p.push(a))}else y={eventTime:y,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=y,l=h):d=d.next=y,o|=p;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;p=a,a=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);ko|=o,t.lanes=o,t.memoizedState=h}}function Gw(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(q(191,i));i.call(r)}}}var wu={},Zr=Bs(wu),Fc=Bs(wu),Uc=Bs(wu);function io(t){if(t===wu)throw Error(q(174));return t}function by(t,e){switch(at(Uc,e),at(Fc,t),at(Zr,wu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:im(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=im(e,t)}pt(Zr),at(Zr,e)}function Za(){pt(Zr),pt(Fc),pt(Uc)}function Mx(t){io(Uc.current);var e=io(Zr.current),n=im(e,t.type);e!==n&&(at(Fc,t),at(Zr,n))}function Iy(t){Fc.current===t&&(pt(Zr),pt(Fc))}var vt=Bs(0);function uh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var gp=[];function Cy(){for(var t=0;t<gp.length;t++)gp[t]._workInProgressVersionPrimary=null;gp.length=0}var Rd=Li.ReactCurrentDispatcher,yp=Li.ReactCurrentBatchConfig,Co=0,wt=null,jt=null,qt=null,dh=!1,gc=!1,$c=0,nR=0;function un(){throw Error(q(321))}function ky(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ur(t[n],e[n]))return!1;return!0}function Ay(t,e,n,r,i,s){if(Co=s,wt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Rd.current=t===null||t.memoizedState===null?oR:aR,t=n(r,i),gc){s=0;do{if(gc=!1,$c=0,25<=s)throw Error(q(301));s+=1,qt=jt=null,e.updateQueue=null,Rd.current=lR,t=n(r,i)}while(gc)}if(Rd.current=hh,e=jt!==null&&jt.next!==null,Co=0,qt=jt=wt=null,dh=!1,e)throw Error(q(300));return t}function Py(){var t=$c!==0;return $c=0,t}function Wr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qt===null?wt.memoizedState=qt=t:qt=qt.next=t,qt}function wr(){if(jt===null){var t=wt.alternate;t=t!==null?t.memoizedState:null}else t=jt.next;var e=qt===null?wt.memoizedState:qt.next;if(e!==null)qt=e,jt=t;else{if(t===null)throw Error(q(310));jt=t,t={memoizedState:jt.memoizedState,baseState:jt.baseState,baseQueue:jt.baseQueue,queue:jt.queue,next:null},qt===null?wt.memoizedState=qt=t:qt=qt.next=t}return qt}function Bc(t,e){return typeof e=="function"?e(t):e}function _p(t){var e=wr(),n=e.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=t;var r=jt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,u=s;do{var d=u.lane;if((Co&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,wt.lanes|=d,ko|=d}u=u.next}while(u!==null&&u!==s);l===null?o=r:l.next=a,Ur(r,e.memoizedState)||(Bn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,wt.lanes|=s,ko|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function vp(t){var e=wr(),n=e.queue;if(n===null)throw Error(q(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Ur(s,e.memoizedState)||(Bn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function Vx(){}function jx(t,e){var n=wt,r=wr(),i=e(),s=!Ur(r.memoizedState,i);if(s&&(r.memoizedState=i,Bn=!0),r=r.queue,Ry($x.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||qt!==null&&qt.memoizedState.tag&1){if(n.flags|=2048,zc(9,Ux.bind(null,n,r,i,e),void 0,null),Ht===null)throw Error(q(349));Co&30||Fx(n,e,i)}return i}function Fx(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=wt.updateQueue,e===null?(e={lastEffect:null,stores:null},wt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Ux(t,e,n,r){e.value=n,e.getSnapshot=r,Bx(e)&&zx(t)}function $x(t,e,n){return n(function(){Bx(e)&&zx(t)})}function Bx(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ur(t,n)}catch{return!0}}function zx(t){var e=Ci(t,1);e!==null&&Mr(e,t,1,-1)}function Kw(t){var e=Wr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bc,lastRenderedState:t},e.queue=t,t=t.dispatch=sR.bind(null,wt,t),[e.memoizedState,t]}function zc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=wt.updateQueue,e===null?(e={lastEffect:null,stores:null},wt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Wx(){return wr().memoizedState}function Nd(t,e,n,r){var i=Wr();wt.flags|=t,i.memoizedState=zc(1|e,n,void 0,r===void 0?null:r)}function Xh(t,e,n,r){var i=wr();r=r===void 0?null:r;var s=void 0;if(jt!==null){var o=jt.memoizedState;if(s=o.destroy,r!==null&&ky(r,o.deps)){i.memoizedState=zc(e,n,s,r);return}}wt.flags|=t,i.memoizedState=zc(1|e,n,s,r)}function Qw(t,e){return Nd(8390656,8,t,e)}function Ry(t,e){return Xh(2048,8,t,e)}function qx(t,e){return Xh(4,2,t,e)}function Hx(t,e){return Xh(4,4,t,e)}function Gx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Kx(t,e,n){return n=n!=null?n.concat([t]):null,Xh(4,4,Gx.bind(null,e,t),n)}function Ny(){}function Qx(t,e){var n=wr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ky(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Jx(t,e){var n=wr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ky(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Yx(t,e,n){return Co&21?(Ur(n,e)||(n=nx(),wt.lanes|=n,ko|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Bn=!0),t.memoizedState=n)}function rR(t,e){var n=tt;tt=n!==0&&4>n?n:4,t(!0);var r=yp.transition;yp.transition={};try{t(!1),e()}finally{tt=n,yp.transition=r}}function Zx(){return wr().memoizedState}function iR(t,e,n){var r=xs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Xx(t))eb(e,n);else if(n=Ox(t,e,n,r),n!==null){var i=Pn();Mr(n,t,r,i),tb(n,e,r)}}function sR(t,e,n){var r=xs(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xx(t))eb(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Ur(a,o)){var l=e.interleaved;l===null?(i.next=i,Ty(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=Ox(t,e,i,r),n!==null&&(i=Pn(),Mr(n,t,r,i),tb(n,e,r))}}function Xx(t){var e=t.alternate;return t===wt||e!==null&&e===wt}function eb(t,e){gc=dh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function tb(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,cy(t,n)}}var hh={readContext:vr,useCallback:un,useContext:un,useEffect:un,useImperativeHandle:un,useInsertionEffect:un,useLayoutEffect:un,useMemo:un,useReducer:un,useRef:un,useState:un,useDebugValue:un,useDeferredValue:un,useTransition:un,useMutableSource:un,useSyncExternalStore:un,useId:un,unstable_isNewReconciler:!1},oR={readContext:vr,useCallback:function(t,e){return Wr().memoizedState=[t,e===void 0?null:e],t},useContext:vr,useEffect:Qw,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Nd(4194308,4,Gx.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Nd(4194308,4,t,e)},useInsertionEffect:function(t,e){return Nd(4,2,t,e)},useMemo:function(t,e){var n=Wr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Wr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=iR.bind(null,wt,t),[r.memoizedState,t]},useRef:function(t){var e=Wr();return t={current:t},e.memoizedState=t},useState:Kw,useDebugValue:Ny,useDeferredValue:function(t){return Wr().memoizedState=t},useTransition:function(){var t=Kw(!1),e=t[0];return t=rR.bind(null,t[1]),Wr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=wt,i=Wr();if(yt){if(n===void 0)throw Error(q(407));n=n()}else{if(n=e(),Ht===null)throw Error(q(349));Co&30||Fx(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Qw($x.bind(null,r,s,t),[t]),r.flags|=2048,zc(9,Ux.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Wr(),e=Ht.identifierPrefix;if(yt){var n=vi,r=_i;n=(r&~(1<<32-Lr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=$c++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=nR++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},aR={readContext:vr,useCallback:Qx,useContext:vr,useEffect:Ry,useImperativeHandle:Kx,useInsertionEffect:qx,useLayoutEffect:Hx,useMemo:Jx,useReducer:_p,useRef:Wx,useState:function(){return _p(Bc)},useDebugValue:Ny,useDeferredValue:function(t){var e=wr();return Yx(e,jt.memoizedState,t)},useTransition:function(){var t=_p(Bc)[0],e=wr().memoizedState;return[t,e]},useMutableSource:Vx,useSyncExternalStore:jx,useId:Zx,unstable_isNewReconciler:!1},lR={readContext:vr,useCallback:Qx,useContext:vr,useEffect:Ry,useImperativeHandle:Kx,useInsertionEffect:qx,useLayoutEffect:Hx,useMemo:Jx,useReducer:vp,useRef:Wx,useState:function(){return vp(Bc)},useDebugValue:Ny,useDeferredValue:function(t){var e=wr();return jt===null?e.memoizedState=t:Yx(e,jt.memoizedState,t)},useTransition:function(){var t=vp(Bc)[0],e=wr().memoizedState;return[t,e]},useMutableSource:Vx,useSyncExternalStore:jx,useId:Zx,unstable_isNewReconciler:!1};function Cr(t,e){if(t&&t.defaultProps){e=St({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function bm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:St({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ef={isMounted:function(t){return(t=t._reactInternals)?Uo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Pn(),i=xs(t),s=Ti(r,i);s.payload=e,n!=null&&(s.callback=n),e=Ss(t,s,i),e!==null&&(Mr(e,t,i,r),Pd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Pn(),i=xs(t),s=Ti(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Ss(t,s,i),e!==null&&(Mr(e,t,i,r),Pd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Pn(),r=xs(t),i=Ti(n,r);i.tag=2,e!=null&&(i.callback=e),e=Ss(t,i,r),e!==null&&(Mr(e,t,r,n),Pd(e,t,r))}};function Jw(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Lc(n,r)||!Lc(i,s):!0}function nb(t,e,n){var r=!1,i=Os,s=e.contextType;return typeof s=="object"&&s!==null?s=vr(s):(i=Wn(e)?bo:vn.current,r=e.contextTypes,s=(r=r!=null)?Qa(t,i):Os),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ef,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Yw(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ef.enqueueReplaceState(e,e.state,null)}function Im(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},xy(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=vr(s):(s=Wn(e)?bo:vn.current,i.context=Qa(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(bm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&ef.enqueueReplaceState(i,i.state,null),ch(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Xa(t,e){try{var n="",r=e;do n+=M1(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function wp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Cm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var cR=typeof WeakMap=="function"?WeakMap:Map;function rb(t,e,n){n=Ti(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ph||(ph=!0,Vm=r),Cm(t,e)},n}function ib(t,e,n){n=Ti(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Cm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Cm(t,e),typeof r!="function"&&(Ts===null?Ts=new Set([this]):Ts.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Zw(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new cR;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=TR.bind(null,t,e,n),e.then(t,t))}function Xw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function e0(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ti(-1,1),e.tag=2,Ss(n,e,1))),n.lanes|=1),t)}var uR=Li.ReactCurrentOwner,Bn=!1;function kn(t,e,n,r){e.child=t===null?Dx(e,null,n,r):Ya(e,t.child,n,r)}function t0(t,e,n,r,i){n=n.render;var s=e.ref;return ba(e,i),r=Ay(t,e,n,r,s,i),n=Py(),t!==null&&!Bn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ki(t,e,i)):(yt&&n&&yy(e),e.flags|=1,kn(t,e,r,i),e.child)}function n0(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!Uy(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,sb(t,e,s,r,i)):(t=Md(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Lc,n(o,r)&&t.ref===e.ref)return ki(t,e,i)}return e.flags|=1,t=bs(s,r),t.ref=e.ref,t.return=e,e.child=t}function sb(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Lc(s,r)&&t.ref===e.ref)if(Bn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Bn=!0);else return e.lanes=t.lanes,ki(t,e,i)}return km(t,e,n,r,i)}function ob(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(wa,Xn),Xn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,at(wa,Xn),Xn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,at(wa,Xn),Xn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,at(wa,Xn),Xn|=r;return kn(t,e,i,n),e.child}function ab(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function km(t,e,n,r,i){var s=Wn(n)?bo:vn.current;return s=Qa(e,s),ba(e,i),n=Ay(t,e,n,r,s,i),r=Py(),t!==null&&!Bn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ki(t,e,i)):(yt&&r&&yy(e),e.flags|=1,kn(t,e,n,i),e.child)}function r0(t,e,n,r,i){if(Wn(n)){var s=!0;ih(e)}else s=!1;if(ba(e,i),e.stateNode===null)Dd(t,e),nb(e,n,r),Im(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=vr(u):(u=Wn(n)?bo:vn.current,u=Qa(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==u)&&Yw(e,o,r,u),Yi=!1;var p=e.memoizedState;o.state=p,ch(e,r,o,i),l=e.memoizedState,a!==r||p!==l||zn.current||Yi?(typeof d=="function"&&(bm(e,n,d,r),l=e.memoizedState),(a=Yi||Jw(e,n,a,r,p,l,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Lx(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Cr(e.type,a),o.props=u,h=e.pendingProps,p=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=vr(l):(l=Wn(n)?bo:vn.current,l=Qa(e,l));var y=n.getDerivedStateFromProps;(d=typeof y=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||p!==l)&&Yw(e,o,r,l),Yi=!1,p=e.memoizedState,o.state=p,ch(e,r,o,i);var T=e.memoizedState;a!==h||p!==T||zn.current||Yi?(typeof y=="function"&&(bm(e,n,y,r),T=e.memoizedState),(u=Yi||Jw(e,n,u,r,p,T,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,T,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,T,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=T),o.props=r,o.state=T,o.context=l,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return Am(t,e,n,r,s,i)}function Am(t,e,n,r,i,s){ab(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Bw(e,n,!1),ki(t,e,s);r=e.stateNode,uR.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ya(e,t.child,null,s),e.child=Ya(e,null,a,s)):kn(t,e,a,s),e.memoizedState=r.state,i&&Bw(e,n,!0),e.child}function lb(t){var e=t.stateNode;e.pendingContext?$w(t,e.pendingContext,e.pendingContext!==e.context):e.context&&$w(t,e.context,!1),by(t,e.containerInfo)}function i0(t,e,n,r,i){return Ja(),vy(i),e.flags|=256,kn(t,e,n,r),e.child}var Pm={dehydrated:null,treeContext:null,retryLane:0};function Rm(t){return{baseLanes:t,cachePool:null,transitions:null}}function cb(t,e,n){var r=e.pendingProps,i=vt.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),at(vt,i&1),t===null)return Tm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=rf(o,r,0,null),t=Eo(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Rm(n),e.memoizedState=Pm,t):Dy(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return dR(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=bs(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=bs(a,s):(s=Eo(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Rm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Pm,r}return s=t.child,t=s.sibling,r=bs(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Dy(t,e){return e=rf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function pd(t,e,n,r){return r!==null&&vy(r),Ya(e,t.child,null,n),t=Dy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function dR(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=wp(Error(q(422))),pd(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=rf({mode:"visible",children:r.children},i,0,null),s=Eo(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Ya(e,t.child,null,o),e.child.memoizedState=Rm(o),e.memoizedState=Pm,s);if(!(e.mode&1))return pd(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(q(419)),r=wp(s,r,void 0),pd(t,e,o,r)}if(a=(o&t.childLanes)!==0,Bn||a){if(r=Ht,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ci(t,i),Mr(r,t,i,-1))}return Fy(),r=wp(Error(q(421))),pd(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=xR.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,nr=Es(i.nextSibling),ir=e,yt=!0,Nr=null,t!==null&&(fr[pr++]=_i,fr[pr++]=vi,fr[pr++]=Io,_i=t.id,vi=t.overflow,Io=e),e=Dy(e,r.children),e.flags|=4096,e)}function s0(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),xm(t.return,e,n)}function Ep(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function ub(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(kn(t,e,r.children,n),r=vt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&s0(t,n,e);else if(t.tag===19)s0(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(at(vt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&uh(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Ep(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&uh(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Ep(e,!0,n,null,s);break;case"together":Ep(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Dd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ki(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ko|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(q(153));if(e.child!==null){for(t=e.child,n=bs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=bs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function hR(t,e,n){switch(e.tag){case 3:lb(e),Ja();break;case 5:Mx(e);break;case 1:Wn(e.type)&&ih(e);break;case 4:by(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;at(ah,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(at(vt,vt.current&1),e.flags|=128,null):n&e.child.childLanes?cb(t,e,n):(at(vt,vt.current&1),t=ki(t,e,n),t!==null?t.sibling:null);at(vt,vt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return ub(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),at(vt,vt.current),r)break;return null;case 22:case 23:return e.lanes=0,ob(t,e,n)}return ki(t,e,n)}var db,Nm,hb,fb;db=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Nm=function(){};hb=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,io(Zr.current);var s=null;switch(n){case"input":i=em(t,i),r=em(t,r),s=[];break;case"select":i=St({},i,{value:void 0}),r=St({},r,{value:void 0}),s=[];break;case"textarea":i=rm(t,i),r=rm(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=nh)}sm(n,r);var o;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var a=i[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(kc.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(a=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(kc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&ht("scroll",t),s||a===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(e.updateQueue=u)&&(e.flags|=4)}};fb=function(t,e,n,r){n!==r&&(e.flags|=4)};function Gl(t,e){if(!yt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function dn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function fR(t,e,n){var r=e.pendingProps;switch(_y(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dn(e),null;case 1:return Wn(e.type)&&rh(),dn(e),null;case 3:return r=e.stateNode,Za(),pt(zn),pt(vn),Cy(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(hd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Nr!==null&&(Um(Nr),Nr=null))),Nm(t,e),dn(e),null;case 5:Iy(e);var i=io(Uc.current);if(n=e.type,t!==null&&e.stateNode!=null)hb(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(q(166));return dn(e),null}if(t=io(Zr.current),hd(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Qr]=e,r[jc]=s,t=(e.mode&1)!==0,n){case"dialog":ht("cancel",r),ht("close",r);break;case"iframe":case"object":case"embed":ht("load",r);break;case"video":case"audio":for(i=0;i<nc.length;i++)ht(nc[i],r);break;case"source":ht("error",r);break;case"img":case"image":case"link":ht("error",r),ht("load",r);break;case"details":ht("toggle",r);break;case"input":pw(r,s),ht("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},ht("invalid",r);break;case"textarea":gw(r,s),ht("invalid",r)}sm(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&dd(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&dd(r.textContent,a,t),i=["children",""+a]):kc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&ht("scroll",r)}switch(n){case"input":rd(r),mw(r,s,!0);break;case"textarea":rd(r),yw(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=nh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=$T(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Qr]=e,t[jc]=r,db(t,e,!1,!1),e.stateNode=t;e:{switch(o=om(n,r),n){case"dialog":ht("cancel",t),ht("close",t),i=r;break;case"iframe":case"object":case"embed":ht("load",t),i=r;break;case"video":case"audio":for(i=0;i<nc.length;i++)ht(nc[i],t);i=r;break;case"source":ht("error",t),i=r;break;case"img":case"image":case"link":ht("error",t),ht("load",t),i=r;break;case"details":ht("toggle",t),i=r;break;case"input":pw(t,r),i=em(t,r),ht("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=St({},r,{value:void 0}),ht("invalid",t);break;case"textarea":gw(t,r),i=rm(t,r),ht("invalid",t);break;default:i=r}sm(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?WT(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&BT(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ac(t,l):typeof l=="number"&&Ac(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(kc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ht("scroll",t):l!=null&&ry(t,s,l,o))}switch(n){case"input":rd(t),mw(t,r,!1);break;case"textarea":rd(t),yw(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ds(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Ea(t,!!r.multiple,s,!1):r.defaultValue!=null&&Ea(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=nh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return dn(e),null;case 6:if(t&&e.stateNode!=null)fb(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(q(166));if(n=io(Uc.current),io(Zr.current),hd(e)){if(r=e.stateNode,n=e.memoizedProps,r[Qr]=e,(s=r.nodeValue!==n)&&(t=ir,t!==null))switch(t.tag){case 3:dd(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&dd(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Qr]=e,e.stateNode=r}return dn(e),null;case 13:if(pt(vt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(yt&&nr!==null&&e.mode&1&&!(e.flags&128))Rx(),Ja(),e.flags|=98560,s=!1;else if(s=hd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(q(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(q(317));s[Qr]=e}else Ja(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;dn(e),s=!1}else Nr!==null&&(Um(Nr),Nr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||vt.current&1?Ut===0&&(Ut=3):Fy())),e.updateQueue!==null&&(e.flags|=4),dn(e),null);case 4:return Za(),Nm(t,e),t===null&&Mc(e.stateNode.containerInfo),dn(e),null;case 10:return Sy(e.type._context),dn(e),null;case 17:return Wn(e.type)&&rh(),dn(e),null;case 19:if(pt(vt),s=e.memoizedState,s===null)return dn(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Gl(s,!1);else{if(Ut!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=uh(t),o!==null){for(e.flags|=128,Gl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return at(vt,vt.current&1|2),e.child}t=t.sibling}s.tail!==null&&At()>el&&(e.flags|=128,r=!0,Gl(s,!1),e.lanes=4194304)}else{if(!r)if(t=uh(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Gl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!yt)return dn(e),null}else 2*At()-s.renderingStartTime>el&&n!==1073741824&&(e.flags|=128,r=!0,Gl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=At(),e.sibling=null,n=vt.current,at(vt,r?n&1|2:n&1),e):(dn(e),null);case 22:case 23:return jy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Xn&1073741824&&(dn(e),e.subtreeFlags&6&&(e.flags|=8192)):dn(e),null;case 24:return null;case 25:return null}throw Error(q(156,e.tag))}function pR(t,e){switch(_y(e),e.tag){case 1:return Wn(e.type)&&rh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Za(),pt(zn),pt(vn),Cy(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Iy(e),null;case 13:if(pt(vt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(q(340));Ja()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return pt(vt),null;case 4:return Za(),null;case 10:return Sy(e.type._context),null;case 22:case 23:return jy(),null;case 24:return null;default:return null}}var md=!1,mn=!1,mR=typeof WeakSet=="function"?WeakSet:Set,ae=null;function va(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){It(t,e,r)}else n.current=null}function Dm(t,e,n){try{n()}catch(r){It(t,e,r)}}var o0=!1;function gR(t,e){if(gm=Xd,t=_x(),gy(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,u=0,d=0,h=t,p=null;t:for(;;){for(var y;h!==n||i!==0&&h.nodeType!==3||(a=o+i),h!==s||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(y=h.firstChild)!==null;)p=h,h=y;for(;;){if(h===t)break t;if(p===n&&++u===i&&(a=o),p===s&&++d===r&&(l=o),(y=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=y}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ym={focusedElem:t,selectionRange:n},Xd=!1,ae=e;ae!==null;)if(e=ae,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ae=t;else for(;ae!==null;){e=ae;try{var T=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var E=T.memoizedProps,R=T.memoizedState,w=e.stateNode,v=w.getSnapshotBeforeUpdate(e.elementType===e.type?E:Cr(e.type,E),R);w.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(q(163))}}catch(D){It(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,ae=t;break}ae=e.return}return T=o0,o0=!1,T}function yc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Dm(e,n,s)}i=i.next}while(i!==r)}}function tf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Om(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function pb(t){var e=t.alternate;e!==null&&(t.alternate=null,pb(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Qr],delete e[jc],delete e[wm],delete e[ZP],delete e[XP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function mb(t){return t.tag===5||t.tag===3||t.tag===4}function a0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||mb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Lm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=nh));else if(r!==4&&(t=t.child,t!==null))for(Lm(t,e,n),t=t.sibling;t!==null;)Lm(t,e,n),t=t.sibling}function Mm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Mm(t,e,n),t=t.sibling;t!==null;)Mm(t,e,n),t=t.sibling}var Yt=null,Rr=!1;function Wi(t,e,n){for(n=n.child;n!==null;)gb(t,e,n),n=n.sibling}function gb(t,e,n){if(Yr&&typeof Yr.onCommitFiberUnmount=="function")try{Yr.onCommitFiberUnmount(Gh,n)}catch{}switch(n.tag){case 5:mn||va(n,e);case 6:var r=Yt,i=Rr;Yt=null,Wi(t,e,n),Yt=r,Rr=i,Yt!==null&&(Rr?(t=Yt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Yt.removeChild(n.stateNode));break;case 18:Yt!==null&&(Rr?(t=Yt,n=n.stateNode,t.nodeType===8?pp(t.parentNode,n):t.nodeType===1&&pp(t,n),Dc(t)):pp(Yt,n.stateNode));break;case 4:r=Yt,i=Rr,Yt=n.stateNode.containerInfo,Rr=!0,Wi(t,e,n),Yt=r,Rr=i;break;case 0:case 11:case 14:case 15:if(!mn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Dm(n,e,o),i=i.next}while(i!==r)}Wi(t,e,n);break;case 1:if(!mn&&(va(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){It(n,e,a)}Wi(t,e,n);break;case 21:Wi(t,e,n);break;case 22:n.mode&1?(mn=(r=mn)||n.memoizedState!==null,Wi(t,e,n),mn=r):Wi(t,e,n);break;default:Wi(t,e,n)}}function l0(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new mR),e.forEach(function(r){var i=bR.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Ir(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Yt=a.stateNode,Rr=!1;break e;case 3:Yt=a.stateNode.containerInfo,Rr=!0;break e;case 4:Yt=a.stateNode.containerInfo,Rr=!0;break e}a=a.return}if(Yt===null)throw Error(q(160));gb(s,o,i),Yt=null,Rr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){It(i,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)yb(e,t),e=e.sibling}function yb(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ir(e,t),zr(t),r&4){try{yc(3,t,t.return),tf(3,t)}catch(E){It(t,t.return,E)}try{yc(5,t,t.return)}catch(E){It(t,t.return,E)}}break;case 1:Ir(e,t),zr(t),r&512&&n!==null&&va(n,n.return);break;case 5:if(Ir(e,t),zr(t),r&512&&n!==null&&va(n,n.return),t.flags&32){var i=t.stateNode;try{Ac(i,"")}catch(E){It(t,t.return,E)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&FT(i,s),om(a,o);var u=om(a,s);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];d==="style"?WT(i,h):d==="dangerouslySetInnerHTML"?BT(i,h):d==="children"?Ac(i,h):ry(i,d,h,u)}switch(a){case"input":tm(i,s);break;case"textarea":UT(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var y=s.value;y!=null?Ea(i,!!s.multiple,y,!1):p!==!!s.multiple&&(s.defaultValue!=null?Ea(i,!!s.multiple,s.defaultValue,!0):Ea(i,!!s.multiple,s.multiple?[]:"",!1))}i[jc]=s}catch(E){It(t,t.return,E)}}break;case 6:if(Ir(e,t),zr(t),r&4){if(t.stateNode===null)throw Error(q(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(E){It(t,t.return,E)}}break;case 3:if(Ir(e,t),zr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Dc(e.containerInfo)}catch(E){It(t,t.return,E)}break;case 4:Ir(e,t),zr(t);break;case 13:Ir(e,t),zr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(My=At())),r&4&&l0(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(mn=(u=mn)||d,Ir(e,t),mn=u):Ir(e,t),zr(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(ae=t,d=t.child;d!==null;){for(h=ae=d;ae!==null;){switch(p=ae,y=p.child,p.tag){case 0:case 11:case 14:case 15:yc(4,p,p.return);break;case 1:va(p,p.return);var T=p.stateNode;if(typeof T.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,T.props=e.memoizedProps,T.state=e.memoizedState,T.componentWillUnmount()}catch(E){It(r,n,E)}}break;case 5:va(p,p.return);break;case 22:if(p.memoizedState!==null){u0(h);continue}}y!==null?(y.return=p,ae=y):u0(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=zT("display",o))}catch(E){It(t,t.return,E)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(E){It(t,t.return,E)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ir(e,t),zr(t),r&4&&l0(t);break;case 21:break;default:Ir(e,t),zr(t)}}function zr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(mb(n)){var r=n;break e}n=n.return}throw Error(q(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ac(i,""),r.flags&=-33);var s=a0(t);Mm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=a0(t);Lm(t,a,o);break;default:throw Error(q(161))}}catch(l){It(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function yR(t,e,n){ae=t,_b(t)}function _b(t,e,n){for(var r=(t.mode&1)!==0;ae!==null;){var i=ae,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||md;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||mn;a=md;var u=mn;if(md=o,(mn=l)&&!u)for(ae=i;ae!==null;)o=ae,l=o.child,o.tag===22&&o.memoizedState!==null?d0(i):l!==null?(l.return=o,ae=l):d0(i);for(;s!==null;)ae=s,_b(s),s=s.sibling;ae=i,md=a,mn=u}c0(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ae=s):c0(t)}}function c0(t){for(;ae!==null;){var e=ae;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:mn||tf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!mn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Cr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Gw(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Gw(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Dc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(q(163))}mn||e.flags&512&&Om(e)}catch(p){It(e,e.return,p)}}if(e===t){ae=null;break}if(n=e.sibling,n!==null){n.return=e.return,ae=n;break}ae=e.return}}function u0(t){for(;ae!==null;){var e=ae;if(e===t){ae=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ae=n;break}ae=e.return}}function d0(t){for(;ae!==null;){var e=ae;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{tf(4,e)}catch(l){It(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){It(e,i,l)}}var s=e.return;try{Om(e)}catch(l){It(e,s,l)}break;case 5:var o=e.return;try{Om(e)}catch(l){It(e,o,l)}}}catch(l){It(e,e.return,l)}if(e===t){ae=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ae=a;break}ae=e.return}}var _R=Math.ceil,fh=Li.ReactCurrentDispatcher,Oy=Li.ReactCurrentOwner,yr=Li.ReactCurrentBatchConfig,ze=0,Ht=null,Dt=null,rn=0,Xn=0,wa=Bs(0),Ut=0,Wc=null,ko=0,nf=0,Ly=0,_c=null,Un=null,My=0,el=1/0,fi=null,ph=!1,Vm=null,Ts=null,gd=!1,ps=null,mh=0,vc=0,jm=null,Od=-1,Ld=0;function Pn(){return ze&6?At():Od!==-1?Od:Od=At()}function xs(t){return t.mode&1?ze&2&&rn!==0?rn&-rn:tR.transition!==null?(Ld===0&&(Ld=nx()),Ld):(t=tt,t!==0||(t=window.event,t=t===void 0?16:cx(t.type)),t):1}function Mr(t,e,n,r){if(50<vc)throw vc=0,jm=null,Error(q(185));yu(t,n,r),(!(ze&2)||t!==Ht)&&(t===Ht&&(!(ze&2)&&(nf|=n),Ut===4&&es(t,rn)),qn(t,r),n===1&&ze===0&&!(e.mode&1)&&(el=At()+500,Zh&&zs()))}function qn(t,e){var n=t.callbackNode;tP(t,e);var r=Zd(t,t===Ht?rn:0);if(r===0)n!==null&&ww(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&ww(n),e===1)t.tag===0?eR(h0.bind(null,t)):kx(h0.bind(null,t)),JP(function(){!(ze&6)&&zs()}),n=null;else{switch(rx(r)){case 1:n=ly;break;case 4:n=ex;break;case 16:n=Yd;break;case 536870912:n=tx;break;default:n=Yd}n=Ib(n,vb.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function vb(t,e){if(Od=-1,Ld=0,ze&6)throw Error(q(327));var n=t.callbackNode;if(Ia()&&t.callbackNode!==n)return null;var r=Zd(t,t===Ht?rn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=gh(t,r);else{e=r;var i=ze;ze|=2;var s=Eb();(Ht!==t||rn!==e)&&(fi=null,el=At()+500,wo(t,e));do try{ER();break}catch(a){wb(t,a)}while(!0);Ey(),fh.current=s,ze=i,Dt!==null?e=0:(Ht=null,rn=0,e=Ut)}if(e!==0){if(e===2&&(i=dm(t),i!==0&&(r=i,e=Fm(t,i))),e===1)throw n=Wc,wo(t,0),es(t,r),qn(t,At()),n;if(e===6)es(t,r);else{if(i=t.current.alternate,!(r&30)&&!vR(i)&&(e=gh(t,r),e===2&&(s=dm(t),s!==0&&(r=s,e=Fm(t,s))),e===1))throw n=Wc,wo(t,0),es(t,r),qn(t,At()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(q(345));case 2:eo(t,Un,fi);break;case 3:if(es(t,r),(r&130023424)===r&&(e=My+500-At(),10<e)){if(Zd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Pn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=vm(eo.bind(null,t,Un,fi),e);break}eo(t,Un,fi);break;case 4:if(es(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Lr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=At()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_R(r/1960))-r,10<r){t.timeoutHandle=vm(eo.bind(null,t,Un,fi),r);break}eo(t,Un,fi);break;case 5:eo(t,Un,fi);break;default:throw Error(q(329))}}}return qn(t,At()),t.callbackNode===n?vb.bind(null,t):null}function Fm(t,e){var n=_c;return t.current.memoizedState.isDehydrated&&(wo(t,e).flags|=256),t=gh(t,e),t!==2&&(e=Un,Un=n,e!==null&&Um(e)),t}function Um(t){Un===null?Un=t:Un.push.apply(Un,t)}function vR(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ur(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function es(t,e){for(e&=~Ly,e&=~nf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Lr(e),r=1<<n;t[n]=-1,e&=~r}}function h0(t){if(ze&6)throw Error(q(327));Ia();var e=Zd(t,0);if(!(e&1))return qn(t,At()),null;var n=gh(t,e);if(t.tag!==0&&n===2){var r=dm(t);r!==0&&(e=r,n=Fm(t,r))}if(n===1)throw n=Wc,wo(t,0),es(t,e),qn(t,At()),n;if(n===6)throw Error(q(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,eo(t,Un,fi),qn(t,At()),null}function Vy(t,e){var n=ze;ze|=1;try{return t(e)}finally{ze=n,ze===0&&(el=At()+500,Zh&&zs())}}function Ao(t){ps!==null&&ps.tag===0&&!(ze&6)&&Ia();var e=ze;ze|=1;var n=yr.transition,r=tt;try{if(yr.transition=null,tt=1,t)return t()}finally{tt=r,yr.transition=n,ze=e,!(ze&6)&&zs()}}function jy(){Xn=wa.current,pt(wa)}function wo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,QP(n)),Dt!==null)for(n=Dt.return;n!==null;){var r=n;switch(_y(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&rh();break;case 3:Za(),pt(zn),pt(vn),Cy();break;case 5:Iy(r);break;case 4:Za();break;case 13:pt(vt);break;case 19:pt(vt);break;case 10:Sy(r.type._context);break;case 22:case 23:jy()}n=n.return}if(Ht=t,Dt=t=bs(t.current,null),rn=Xn=e,Ut=0,Wc=null,Ly=nf=ko=0,Un=_c=null,ro!==null){for(e=0;e<ro.length;e++)if(n=ro[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}ro=null}return t}function wb(t,e){do{var n=Dt;try{if(Ey(),Rd.current=hh,dh){for(var r=wt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}dh=!1}if(Co=0,qt=jt=wt=null,gc=!1,$c=0,Oy.current=null,n===null||n.return===null){Ut=1,Wc=e,Dt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=rn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var y=Xw(o);if(y!==null){y.flags&=-257,e0(y,o,a,s,e),y.mode&1&&Zw(s,u,e),e=y,l=u;var T=e.updateQueue;if(T===null){var E=new Set;E.add(l),e.updateQueue=E}else T.add(l);break e}else{if(!(e&1)){Zw(s,u,e),Fy();break e}l=Error(q(426))}}else if(yt&&a.mode&1){var R=Xw(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),e0(R,o,a,s,e),vy(Xa(l,a));break e}}s=l=Xa(l,a),Ut!==4&&(Ut=2),_c===null?_c=[s]:_c.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var w=rb(s,l,e);Hw(s,w);break e;case 1:a=l;var v=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ts===null||!Ts.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var D=ib(s,a,e);Hw(s,D);break e}}s=s.return}while(s!==null)}Tb(n)}catch(L){e=L,Dt===n&&n!==null&&(Dt=n=n.return);continue}break}while(!0)}function Eb(){var t=fh.current;return fh.current=hh,t===null?hh:t}function Fy(){(Ut===0||Ut===3||Ut===2)&&(Ut=4),Ht===null||!(ko&268435455)&&!(nf&268435455)||es(Ht,rn)}function gh(t,e){var n=ze;ze|=2;var r=Eb();(Ht!==t||rn!==e)&&(fi=null,wo(t,e));do try{wR();break}catch(i){wb(t,i)}while(!0);if(Ey(),ze=n,fh.current=r,Dt!==null)throw Error(q(261));return Ht=null,rn=0,Ut}function wR(){for(;Dt!==null;)Sb(Dt)}function ER(){for(;Dt!==null&&!H1();)Sb(Dt)}function Sb(t){var e=bb(t.alternate,t,Xn);t.memoizedProps=t.pendingProps,e===null?Tb(t):Dt=e,Oy.current=null}function Tb(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=pR(n,e),n!==null){n.flags&=32767,Dt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ut=6,Dt=null;return}}else if(n=fR(n,e,Xn),n!==null){Dt=n;return}if(e=e.sibling,e!==null){Dt=e;return}Dt=e=t}while(e!==null);Ut===0&&(Ut=5)}function eo(t,e,n){var r=tt,i=yr.transition;try{yr.transition=null,tt=1,SR(t,e,n,r)}finally{yr.transition=i,tt=r}return null}function SR(t,e,n,r){do Ia();while(ps!==null);if(ze&6)throw Error(q(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(q(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(nP(t,s),t===Ht&&(Dt=Ht=null,rn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||gd||(gd=!0,Ib(Yd,function(){return Ia(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=yr.transition,yr.transition=null;var o=tt;tt=1;var a=ze;ze|=4,Oy.current=null,gR(t,n),yb(n,t),BP(ym),Xd=!!gm,ym=gm=null,t.current=n,yR(n),G1(),ze=a,tt=o,yr.transition=s}else t.current=n;if(gd&&(gd=!1,ps=t,mh=i),s=t.pendingLanes,s===0&&(Ts=null),J1(n.stateNode),qn(t,At()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ph)throw ph=!1,t=Vm,Vm=null,t;return mh&1&&t.tag!==0&&Ia(),s=t.pendingLanes,s&1?t===jm?vc++:(vc=0,jm=t):vc=0,zs(),null}function Ia(){if(ps!==null){var t=rx(mh),e=yr.transition,n=tt;try{if(yr.transition=null,tt=16>t?16:t,ps===null)var r=!1;else{if(t=ps,ps=null,mh=0,ze&6)throw Error(q(331));var i=ze;for(ze|=4,ae=t.current;ae!==null;){var s=ae,o=s.child;if(ae.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(ae=u;ae!==null;){var d=ae;switch(d.tag){case 0:case 11:case 15:yc(8,d,s)}var h=d.child;if(h!==null)h.return=d,ae=h;else for(;ae!==null;){d=ae;var p=d.sibling,y=d.return;if(pb(d),d===u){ae=null;break}if(p!==null){p.return=y,ae=p;break}ae=y}}}var T=s.alternate;if(T!==null){var E=T.child;if(E!==null){T.child=null;do{var R=E.sibling;E.sibling=null,E=R}while(E!==null)}}ae=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ae=o;else e:for(;ae!==null;){if(s=ae,s.flags&2048)switch(s.tag){case 0:case 11:case 15:yc(9,s,s.return)}var w=s.sibling;if(w!==null){w.return=s.return,ae=w;break e}ae=s.return}}var v=t.current;for(ae=v;ae!==null;){o=ae;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,ae=b;else e:for(o=v;ae!==null;){if(a=ae,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:tf(9,a)}}catch(L){It(a,a.return,L)}if(a===o){ae=null;break e}var D=a.sibling;if(D!==null){D.return=a.return,ae=D;break e}ae=a.return}}if(ze=i,zs(),Yr&&typeof Yr.onPostCommitFiberRoot=="function")try{Yr.onPostCommitFiberRoot(Gh,t)}catch{}r=!0}return r}finally{tt=n,yr.transition=e}}return!1}function f0(t,e,n){e=Xa(n,e),e=rb(t,e,1),t=Ss(t,e,1),e=Pn(),t!==null&&(yu(t,1,e),qn(t,e))}function It(t,e,n){if(t.tag===3)f0(t,t,n);else for(;e!==null;){if(e.tag===3){f0(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ts===null||!Ts.has(r))){t=Xa(n,t),t=ib(e,t,1),e=Ss(e,t,1),t=Pn(),e!==null&&(yu(e,1,t),qn(e,t));break}}e=e.return}}function TR(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Pn(),t.pingedLanes|=t.suspendedLanes&n,Ht===t&&(rn&n)===n&&(Ut===4||Ut===3&&(rn&130023424)===rn&&500>At()-My?wo(t,0):Ly|=n),qn(t,e)}function xb(t,e){e===0&&(t.mode&1?(e=od,od<<=1,!(od&130023424)&&(od=4194304)):e=1);var n=Pn();t=Ci(t,e),t!==null&&(yu(t,e,n),qn(t,n))}function xR(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),xb(t,n)}function bR(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(q(314))}r!==null&&r.delete(e),xb(t,n)}var bb;bb=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||zn.current)Bn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Bn=!1,hR(t,e,n);Bn=!!(t.flags&131072)}else Bn=!1,yt&&e.flags&1048576&&Ax(e,oh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Dd(t,e),t=e.pendingProps;var i=Qa(e,vn.current);ba(e,n),i=Ay(null,e,r,t,i,n);var s=Py();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Wn(r)?(s=!0,ih(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,xy(e),i.updater=ef,e.stateNode=i,i._reactInternals=e,Im(e,r,t,n),e=Am(null,e,r,!0,s,n)):(e.tag=0,yt&&s&&yy(e),kn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Dd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=CR(r),t=Cr(r,t),i){case 0:e=km(null,e,r,t,n);break e;case 1:e=r0(null,e,r,t,n);break e;case 11:e=t0(null,e,r,t,n);break e;case 14:e=n0(null,e,r,Cr(r.type,t),n);break e}throw Error(q(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Cr(r,i),km(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Cr(r,i),r0(t,e,r,i,n);case 3:e:{if(lb(e),t===null)throw Error(q(387));r=e.pendingProps,s=e.memoizedState,i=s.element,Lx(t,e),ch(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Xa(Error(q(423)),e),e=i0(t,e,r,n,i);break e}else if(r!==i){i=Xa(Error(q(424)),e),e=i0(t,e,r,n,i);break e}else for(nr=Es(e.stateNode.containerInfo.firstChild),ir=e,yt=!0,Nr=null,n=Dx(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ja(),r===i){e=ki(t,e,n);break e}kn(t,e,r,n)}e=e.child}return e;case 5:return Mx(e),t===null&&Tm(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,_m(r,i)?o=null:s!==null&&_m(r,s)&&(e.flags|=32),ab(t,e),kn(t,e,o,n),e.child;case 6:return t===null&&Tm(e),null;case 13:return cb(t,e,n);case 4:return by(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ya(e,null,r,n):kn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Cr(r,i),t0(t,e,r,i,n);case 7:return kn(t,e,e.pendingProps,n),e.child;case 8:return kn(t,e,e.pendingProps.children,n),e.child;case 12:return kn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,at(ah,r._currentValue),r._currentValue=o,s!==null)if(Ur(s.value,o)){if(s.children===i.children&&!zn.current){e=ki(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Ti(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),xm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(q(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),xm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}kn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ba(e,n),i=vr(i),r=r(i),e.flags|=1,kn(t,e,r,n),e.child;case 14:return r=e.type,i=Cr(r,e.pendingProps),i=Cr(r.type,i),n0(t,e,r,i,n);case 15:return sb(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Cr(r,i),Dd(t,e),e.tag=1,Wn(r)?(t=!0,ih(e)):t=!1,ba(e,n),nb(e,r,i),Im(e,r,i,n),Am(null,e,r,!0,t,n);case 19:return ub(t,e,n);case 22:return ob(t,e,n)}throw Error(q(156,e.tag))};function Ib(t,e){return XT(t,e)}function IR(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function mr(t,e,n,r){return new IR(t,e,n,r)}function Uy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function CR(t){if(typeof t=="function")return Uy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===sy)return 11;if(t===oy)return 14}return 2}function bs(t,e){var n=t.alternate;return n===null?(n=mr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Md(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")Uy(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ua:return Eo(n.children,i,s,e);case iy:o=8,i|=8;break;case Jp:return t=mr(12,n,e,i|2),t.elementType=Jp,t.lanes=s,t;case Yp:return t=mr(13,n,e,i),t.elementType=Yp,t.lanes=s,t;case Zp:return t=mr(19,n,e,i),t.elementType=Zp,t.lanes=s,t;case MT:return rf(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case OT:o=10;break e;case LT:o=9;break e;case sy:o=11;break e;case oy:o=14;break e;case Ji:o=16,r=null;break e}throw Error(q(130,t==null?t:typeof t,""))}return e=mr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Eo(t,e,n,r){return t=mr(7,t,r,e),t.lanes=n,t}function rf(t,e,n,r){return t=mr(22,t,r,e),t.elementType=MT,t.lanes=n,t.stateNode={isHidden:!1},t}function Sp(t,e,n){return t=mr(6,t,null,e),t.lanes=n,t}function Tp(t,e,n){return e=mr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function kR(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rp(0),this.expirationTimes=rp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function $y(t,e,n,r,i,s,o,a,l){return t=new kR(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=mr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},xy(s),t}function AR(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ca,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Cb(t){if(!t)return Os;t=t._reactInternals;e:{if(Uo(t)!==t||t.tag!==1)throw Error(q(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Wn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(q(171))}if(t.tag===1){var n=t.type;if(Wn(n))return Cx(t,n,e)}return e}function kb(t,e,n,r,i,s,o,a,l){return t=$y(n,r,!0,t,i,s,o,a,l),t.context=Cb(null),n=t.current,r=Pn(),i=xs(n),s=Ti(r,i),s.callback=e??null,Ss(n,s,i),t.current.lanes=i,yu(t,i,r),qn(t,r),t}function sf(t,e,n,r){var i=e.current,s=Pn(),o=xs(i);return n=Cb(n),e.context===null?e.context=n:e.pendingContext=n,e=Ti(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ss(i,e,o),t!==null&&(Mr(t,i,o,s),Pd(t,i,o)),o}function yh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function p0(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function By(t,e){p0(t,e),(t=t.alternate)&&p0(t,e)}function PR(){return null}var Ab=typeof reportError=="function"?reportError:function(t){console.error(t)};function zy(t){this._internalRoot=t}of.prototype.render=zy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(q(409));sf(t,e,null,null)};of.prototype.unmount=zy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ao(function(){sf(null,t,null,null)}),e[Ii]=null}};function of(t){this._internalRoot=t}of.prototype.unstable_scheduleHydration=function(t){if(t){var e=ox();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Xi.length&&e!==0&&e<Xi[n].priority;n++);Xi.splice(n,0,t),n===0&&lx(t)}};function Wy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function af(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function m0(){}function RR(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=yh(o);s.call(u)}}var o=kb(e,r,t,0,null,!1,!1,"",m0);return t._reactRootContainer=o,t[Ii]=o.current,Mc(t.nodeType===8?t.parentNode:t),Ao(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var u=yh(l);a.call(u)}}var l=$y(t,0,!1,null,null,!1,!1,"",m0);return t._reactRootContainer=l,t[Ii]=l.current,Mc(t.nodeType===8?t.parentNode:t),Ao(function(){sf(e,l,n,r)}),l}function lf(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=yh(o);a.call(l)}}sf(e,o,t,i)}else o=RR(n,e,t,i,r);return yh(o)}ix=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=tc(e.pendingLanes);n!==0&&(cy(e,n|1),qn(e,At()),!(ze&6)&&(el=At()+500,zs()))}break;case 13:Ao(function(){var r=Ci(t,1);if(r!==null){var i=Pn();Mr(r,t,1,i)}}),By(t,1)}};uy=function(t){if(t.tag===13){var e=Ci(t,134217728);if(e!==null){var n=Pn();Mr(e,t,134217728,n)}By(t,134217728)}};sx=function(t){if(t.tag===13){var e=xs(t),n=Ci(t,e);if(n!==null){var r=Pn();Mr(n,t,e,r)}By(t,e)}};ox=function(){return tt};ax=function(t,e){var n=tt;try{return tt=t,e()}finally{tt=n}};lm=function(t,e,n){switch(e){case"input":if(tm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Yh(r);if(!i)throw Error(q(90));jT(r),tm(r,i)}}}break;case"textarea":UT(t,n);break;case"select":e=n.value,e!=null&&Ea(t,!!n.multiple,e,!1)}};GT=Vy;KT=Ao;var NR={usingClientEntryPoint:!1,Events:[vu,pa,Yh,qT,HT,Vy]},Kl={findFiberByHostInstance:no,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},DR={bundleType:Kl.bundleType,version:Kl.version,rendererPackageName:Kl.rendererPackageName,rendererConfig:Kl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Li.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=YT(t),t===null?null:t.stateNode},findFiberByHostInstance:Kl.findFiberByHostInstance||PR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yd.isDisabled&&yd.supportsFiber)try{Gh=yd.inject(DR),Yr=yd}catch{}}cr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NR;cr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wy(e))throw Error(q(200));return AR(t,e,null,n)};cr.createRoot=function(t,e){if(!Wy(t))throw Error(q(299));var n=!1,r="",i=Ab;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=$y(t,1,!1,null,null,n,!1,r,i),t[Ii]=e.current,Mc(t.nodeType===8?t.parentNode:t),new zy(e)};cr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(q(188)):(t=Object.keys(t).join(","),Error(q(268,t)));return t=YT(e),t=t===null?null:t.stateNode,t};cr.flushSync=function(t){return Ao(t)};cr.hydrate=function(t,e,n){if(!af(e))throw Error(q(200));return lf(null,t,e,!0,n)};cr.hydrateRoot=function(t,e,n){if(!Wy(t))throw Error(q(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=Ab;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=kb(e,null,t,1,n??null,i,!1,s,o),t[Ii]=e.current,Mc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new of(e)};cr.render=function(t,e,n){if(!af(e))throw Error(q(200));return lf(null,t,e,!1,n)};cr.unmountComponentAtNode=function(t){if(!af(t))throw Error(q(40));return t._reactRootContainer?(Ao(function(){lf(null,null,t,!1,function(){t._reactRootContainer=null,t[Ii]=null})}),!0):!1};cr.unstable_batchedUpdates=Vy;cr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!af(n))throw Error(q(200));if(t==null||t._reactInternals===void 0)throw Error(q(38));return lf(t,e,n,!1,r)};cr.version="18.3.1-next-f1338f8080-20240426";function Pb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Pb)}catch(t){console.error(t)}}Pb(),PT.exports=cr;var Rb=PT.exports,g0=Rb;Kp.createRoot=g0.createRoot,Kp.hydrateRoot=g0.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qc(){return qc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qc.apply(this,arguments)}var ms;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ms||(ms={}));const y0="popstate";function OR(t){t===void 0&&(t={});function e(r,i){let{pathname:s,search:o,hash:a}=r.location;return $m("",{pathname:s,search:o,hash:a},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:_h(i)}return MR(e,n,null,t)}function Et(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Nb(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function LR(){return Math.random().toString(36).substr(2,8)}function _0(t,e){return{usr:t.state,key:t.key,idx:e}}function $m(t,e,n,r){return n===void 0&&(n=null),qc({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?_l(e):e,{state:n,key:e&&e.key||r||LR()})}function _h(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function _l(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function MR(t,e,n,r){r===void 0&&(r={});let{window:i=document.defaultView,v5Compat:s=!1}=r,o=i.history,a=ms.Pop,l=null,u=d();u==null&&(u=0,o.replaceState(qc({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){a=ms.Pop;let R=d(),w=R==null?null:R-u;u=R,l&&l({action:a,location:E.location,delta:w})}function p(R,w){a=ms.Push;let v=$m(E.location,R,w);u=d()+1;let b=_0(v,u),D=E.createHref(v);try{o.pushState(b,"",D)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;i.location.assign(D)}s&&l&&l({action:a,location:E.location,delta:1})}function y(R,w){a=ms.Replace;let v=$m(E.location,R,w);u=d();let b=_0(v,u),D=E.createHref(v);o.replaceState(b,"",D),s&&l&&l({action:a,location:E.location,delta:0})}function T(R){let w=i.location.origin!=="null"?i.location.origin:i.location.href,v=typeof R=="string"?R:_h(R);return v=v.replace(/ $/,"%20"),Et(w,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,w)}let E={get action(){return a},get location(){return t(i,o)},listen(R){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(y0,h),l=R,()=>{i.removeEventListener(y0,h),l=null}},createHref(R){return e(i,R)},createURL:T,encodeLocation(R){let w=T(R);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:p,replace:y,go(R){return o.go(R)}};return E}var v0;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(v0||(v0={}));function VR(t,e,n){return n===void 0&&(n="/"),jR(t,e,n)}function jR(t,e,n,r){let i=typeof e=="string"?_l(e):e,s=tl(i.pathname||"/",n);if(s==null)return null;let o=Db(t);FR(o);let a=null;for(let l=0;a==null&&l<o.length;++l){let u=JR(s);a=KR(o[l],u)}return a}function Db(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let i=(s,o,a)=>{let l={relativePath:a===void 0?s.path||"":a,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};l.relativePath.startsWith("/")&&(Et(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=Is([r,l.relativePath]),d=n.concat(l);s.children&&s.children.length>0&&(Et(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Db(s.children,e,d,u)),!(s.path==null&&!s.index)&&e.push({path:u,score:HR(u,s.index),routesMeta:d})};return t.forEach((s,o)=>{var a;if(s.path===""||!((a=s.path)!=null&&a.includes("?")))i(s,o);else for(let l of Ob(s.path))i(s,o,l)}),e}function Ob(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let o=Ob(r.join("/")),a=[];return a.push(...o.map(l=>l===""?s:[s,l].join("/"))),i&&a.push(...o),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function FR(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:GR(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const UR=/^:[\w-]+$/,$R=3,BR=2,zR=1,WR=10,qR=-2,w0=t=>t==="*";function HR(t,e){let n=t.split("/"),r=n.length;return n.some(w0)&&(r+=qR),e&&(r+=BR),n.filter(i=>!w0(i)).reduce((i,s)=>i+(UR.test(s)?$R:s===""?zR:WR),r)}function GR(t,e){return t.length===e.length&&t.slice(0,-1).every((r,i)=>r===e[i])?t[t.length-1]-e[e.length-1]:0}function KR(t,e,n){let{routesMeta:r}=t,i={},s="/",o=[];for(let a=0;a<r.length;++a){let l=r[a],u=a===r.length-1,d=s==="/"?e:e.slice(s.length)||"/",h=Bm({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),p=l.route;if(!h)return null;Object.assign(i,h.params),o.push({params:i,pathname:Is([s,h.pathname]),pathnameBase:eN(Is([s,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(s=Is([s,h.pathnameBase]))}return o}function Bm(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=QR(t.path,t.caseSensitive,t.end),i=e.match(n);if(!i)return null;let s=i[0],o=s.replace(/(.)\/+$/,"$1"),a=i.slice(1);return{params:r.reduce((u,d,h)=>{let{paramName:p,isOptional:y}=d;if(p==="*"){let E=a[h]||"";o=s.slice(0,s.length-E.length).replace(/(.)\/+$/,"$1")}const T=a[h];return y&&!T?u[p]=void 0:u[p]=(T||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:o,pattern:t}}function QR(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Nb(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),r]}function JR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Nb(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function tl(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function YR(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:i=""}=typeof t=="string"?_l(t):t;return{pathname:n?n.startsWith("/")?n:ZR(n,e):e,search:tN(r),hash:nN(i)}}function ZR(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function xp(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function XR(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function qy(t,e){let n=XR(t);return e?n.map((r,i)=>i===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Hy(t,e,n,r){r===void 0&&(r=!1);let i;typeof t=="string"?i=_l(t):(i=qc({},t),Et(!i.pathname||!i.pathname.includes("?"),xp("?","pathname","search",i)),Et(!i.pathname||!i.pathname.includes("#"),xp("#","pathname","hash",i)),Et(!i.search||!i.search.includes("#"),xp("#","search","hash",i)));let s=t===""||i.pathname==="",o=s?"/":i.pathname,a;if(o==null)a=n;else{let h=e.length-1;if(!r&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),h-=1;i.pathname=p.join("/")}a=h>=0?e[h]:"/"}let l=YR(i,a),u=o&&o!=="/"&&o.endsWith("/"),d=(s||o===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const Is=t=>t.join("/").replace(/\/\/+/g,"/"),eN=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),tN=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,nN=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function rN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Lb=["post","put","patch","delete"];new Set(Lb);const iN=["get",...Lb];new Set(iN);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hc(){return Hc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Hc.apply(this,arguments)}const cf=N.createContext(null),Mb=N.createContext(null),Mi=N.createContext(null),uf=N.createContext(null),Vi=N.createContext({outlet:null,matches:[],isDataRoute:!1}),Vb=N.createContext(null);function sN(t,e){let{relative:n}=e===void 0?{}:e;vl()||Et(!1);let{basename:r,navigator:i}=N.useContext(Mi),{hash:s,pathname:o,search:a}=df(t,{relative:n}),l=o;return r!=="/"&&(l=o==="/"?r:Is([r,o])),i.createHref({pathname:l,search:a,hash:s})}function vl(){return N.useContext(uf)!=null}function ji(){return vl()||Et(!1),N.useContext(uf).location}function jb(t){N.useContext(Mi).static||N.useLayoutEffect(t)}function Eu(){let{isDataRoute:t}=N.useContext(Vi);return t?wN():oN()}function oN(){vl()||Et(!1);let t=N.useContext(cf),{basename:e,future:n,navigator:r}=N.useContext(Mi),{matches:i}=N.useContext(Vi),{pathname:s}=ji(),o=JSON.stringify(qy(i,n.v7_relativeSplatPath)),a=N.useRef(!1);return jb(()=>{a.current=!0}),N.useCallback(function(u,d){if(d===void 0&&(d={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let h=Hy(u,JSON.parse(o),s,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Is([e,h.pathname])),(d.replace?r.replace:r.push)(h,d.state,d)},[e,r,o,s,t])}const aN=N.createContext(null);function lN(t){let e=N.useContext(Vi).outlet;return e&&N.createElement(aN.Provider,{value:t},e)}function df(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=N.useContext(Mi),{matches:i}=N.useContext(Vi),{pathname:s}=ji(),o=JSON.stringify(qy(i,r.v7_relativeSplatPath));return N.useMemo(()=>Hy(t,JSON.parse(o),s,n==="path"),[t,o,s,n])}function cN(t,e){return uN(t,e)}function uN(t,e,n,r){vl()||Et(!1);let{navigator:i}=N.useContext(Mi),{matches:s}=N.useContext(Vi),o=s[s.length-1],a=o?o.params:{};o&&o.pathname;let l=o?o.pathnameBase:"/";o&&o.route;let u=ji(),d;if(e){var h;let R=typeof e=="string"?_l(e):e;l==="/"||(h=R.pathname)!=null&&h.startsWith(l)||Et(!1),d=R}else d=u;let p=d.pathname||"/",y=p;if(l!=="/"){let R=l.replace(/^\//,"").split("/");y="/"+p.replace(/^\//,"").split("/").slice(R.length).join("/")}let T=VR(t,{pathname:y}),E=mN(T&&T.map(R=>Object.assign({},R,{params:Object.assign({},a,R.params),pathname:Is([l,i.encodeLocation?i.encodeLocation(R.pathname).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?l:Is([l,i.encodeLocation?i.encodeLocation(R.pathnameBase).pathname:R.pathnameBase])})),s,n,r);return e&&E?N.createElement(uf.Provider,{value:{location:Hc({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:ms.Pop}},E):E}function dN(){let t=vN(),e=rN(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),n?N.createElement("pre",{style:i},n):null,null)}const hN=N.createElement(dN,null);class fN extends N.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?N.createElement(Vi.Provider,{value:this.props.routeContext},N.createElement(Vb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function pN(t){let{routeContext:e,match:n,children:r}=t,i=N.useContext(cf);return i&&i.static&&i.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=n.route.id),N.createElement(Vi.Provider,{value:e},r)}function mN(t,e,n,r){var i;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var s;if(!n)return null;if(n.errors)t=n.matches;else if((s=r)!=null&&s.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=(i=n)==null?void 0:i.errors;if(a!=null){let d=o.findIndex(h=>h.route.id&&(a==null?void 0:a[h.route.id])!==void 0);d>=0||Et(!1),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:p,errors:y}=n,T=h.route.loader&&p[h.route.id]===void 0&&(!y||y[h.route.id]===void 0);if(h.route.lazy||T){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,p)=>{let y,T=!1,E=null,R=null;n&&(y=a&&h.route.id?a[h.route.id]:void 0,E=h.route.errorElement||hN,l&&(u<0&&p===0?(EN("route-fallback"),T=!0,R=null):u===p&&(T=!0,R=h.route.hydrateFallbackElement||null)));let w=e.concat(o.slice(0,p+1)),v=()=>{let b;return y?b=E:T?b=R:h.route.Component?b=N.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=d,N.createElement(pN,{match:h,routeContext:{outlet:d,matches:w,isDataRoute:n!=null},children:b})};return n&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?N.createElement(fN,{location:n.location,revalidation:n.revalidation,component:E,error:y,children:v(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):v()},null)}var Fb=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Fb||{}),Ub=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Ub||{});function gN(t){let e=N.useContext(cf);return e||Et(!1),e}function yN(t){let e=N.useContext(Mb);return e||Et(!1),e}function _N(t){let e=N.useContext(Vi);return e||Et(!1),e}function $b(t){let e=_N(),n=e.matches[e.matches.length-1];return n.route.id||Et(!1),n.route.id}function vN(){var t;let e=N.useContext(Vb),n=yN(),r=$b();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function wN(){let{router:t}=gN(Fb.UseNavigateStable),e=$b(Ub.UseNavigateStable),n=N.useRef(!1);return jb(()=>{n.current=!0}),N.useCallback(function(i,s){s===void 0&&(s={}),n.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Hc({fromRouteId:e},s)))},[t,e])}const E0={};function EN(t,e,n){E0[t]||(E0[t]=!0)}function SN(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Bb(t){let{to:e,replace:n,state:r,relative:i}=t;vl()||Et(!1);let{future:s,static:o}=N.useContext(Mi),{matches:a}=N.useContext(Vi),{pathname:l}=ji(),u=Eu(),d=Hy(e,qy(a,s.v7_relativeSplatPath),l,i==="path"),h=JSON.stringify(d);return N.useEffect(()=>u(JSON.parse(h),{replace:n,state:r,relative:i}),[u,h,i,n,r]),null}function zb(t){return lN(t.context)}function xn(t){Et(!1)}function TN(t){let{basename:e="/",children:n=null,location:r,navigationType:i=ms.Pop,navigator:s,static:o=!1,future:a}=t;vl()&&Et(!1);let l=e.replace(/^\/*/,"/"),u=N.useMemo(()=>({basename:l,navigator:s,static:o,future:Hc({v7_relativeSplatPath:!1},a)}),[l,a,s,o]);typeof r=="string"&&(r=_l(r));let{pathname:d="/",search:h="",hash:p="",state:y=null,key:T="default"}=r,E=N.useMemo(()=>{let R=tl(d,l);return R==null?null:{location:{pathname:R,search:h,hash:p,state:y,key:T},navigationType:i}},[l,d,h,p,y,T,i]);return E==null?null:N.createElement(Mi.Provider,{value:u},N.createElement(uf.Provider,{children:n,value:E}))}function xN(t){let{children:e,location:n}=t;return cN(zm(e),n)}new Promise(()=>{});function zm(t,e){e===void 0&&(e=[]);let n=[];return N.Children.forEach(t,(r,i)=>{if(!N.isValidElement(r))return;let s=[...e,i];if(r.type===N.Fragment){n.push.apply(n,zm(r.props.children,s));return}r.type!==xn&&Et(!1),!r.props.index||!r.props.children||Et(!1);let o={id:r.props.id||s.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=zm(r.props.children,s)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vh(){return vh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},vh.apply(this,arguments)}function Wb(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function bN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function IN(t,e){return t.button===0&&(!e||e==="_self")&&!bN(t)}function Wm(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(i=>[n,i]):[[n,r]])},[]))}function CN(t,e){let n=Wm(t);return e&&e.forEach((r,i)=>{n.has(i)||e.getAll(i).forEach(s=>{n.append(i,s)})}),n}const kN=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],AN=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],PN="6";try{window.__reactRouterVersion=PN}catch{}const RN=N.createContext({isTransitioning:!1}),NN="startTransition",S0=kT[NN];function DN(t){let{basename:e,children:n,future:r,window:i}=t,s=N.useRef();s.current==null&&(s.current=OR({window:i,v5Compat:!0}));let o=s.current,[a,l]=N.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=N.useCallback(h=>{u&&S0?S0(()=>l(h)):l(h)},[l,u]);return N.useLayoutEffect(()=>o.listen(d),[o,d]),N.useEffect(()=>SN(r),[r]),N.createElement(TN,{basename:e,children:n,location:a.location,navigationType:a.action,navigator:o,future:r})}const ON=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",LN=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Gy=N.forwardRef(function(e,n){let{onClick:r,relative:i,reloadDocument:s,replace:o,state:a,target:l,to:u,preventScrollReset:d,viewTransition:h}=e,p=Wb(e,kN),{basename:y}=N.useContext(Mi),T,E=!1;if(typeof u=="string"&&LN.test(u)&&(T=u,ON))try{let b=new URL(window.location.href),D=u.startsWith("//")?new URL(b.protocol+u):new URL(u),L=tl(D.pathname,y);D.origin===b.origin&&L!=null?u=L+D.search+D.hash:E=!0}catch{}let R=sN(u,{relative:i}),w=jN(u,{replace:o,state:a,target:l,preventScrollReset:d,relative:i,viewTransition:h});function v(b){r&&r(b),b.defaultPrevented||w(b)}return N.createElement("a",vh({},p,{href:T||R,onClick:E||s?r:v,ref:n,target:l}))}),MN=N.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:i=!1,className:s="",end:o=!1,style:a,to:l,viewTransition:u,children:d}=e,h=Wb(e,AN),p=df(l,{relative:h.relative}),y=ji(),T=N.useContext(Mb),{navigator:E,basename:R}=N.useContext(Mi),w=T!=null&&UN(p)&&u===!0,v=E.encodeLocation?E.encodeLocation(p).pathname:p.pathname,b=y.pathname,D=T&&T.navigation&&T.navigation.location?T.navigation.location.pathname:null;i||(b=b.toLowerCase(),D=D?D.toLowerCase():null,v=v.toLowerCase()),D&&R&&(D=tl(D,R)||D);const L=v!=="/"&&v.endsWith("/")?v.length-1:v.length;let j=b===v||!o&&b.startsWith(v)&&b.charAt(L)==="/",I=D!=null&&(D===v||!o&&D.startsWith(v)&&D.charAt(v.length)==="/"),_={isActive:j,isPending:I,isTransitioning:w},C=j?r:void 0,A;typeof s=="function"?A=s(_):A=[s,j?"active":null,I?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let k=typeof a=="function"?a(_):a;return N.createElement(Gy,vh({},h,{"aria-current":C,className:A,ref:n,style:k,to:l,viewTransition:u}),typeof d=="function"?d(_):d)});var qm;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(qm||(qm={}));var T0;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(T0||(T0={}));function VN(t){let e=N.useContext(cf);return e||Et(!1),e}function jN(t,e){let{target:n,replace:r,state:i,preventScrollReset:s,relative:o,viewTransition:a}=e===void 0?{}:e,l=Eu(),u=ji(),d=df(t,{relative:o});return N.useCallback(h=>{if(IN(h,n)){h.preventDefault();let p=r!==void 0?r:_h(u)===_h(d);l(t,{replace:p,state:i,preventScrollReset:s,relative:o,viewTransition:a})}},[u,l,d,r,i,n,t,s,o,a])}function FN(t){let e=N.useRef(Wm(t)),n=N.useRef(!1),r=ji(),i=N.useMemo(()=>CN(r.search,n.current?null:e.current),[r.search]),s=Eu(),o=N.useCallback((a,l)=>{const u=Wm(typeof a=="function"?a(i):a);n.current=!0,s("?"+u,l)},[s,i]);return[i,o]}function UN(t,e){e===void 0&&(e={});let n=N.useContext(RN);n==null&&Et(!1);let{basename:r}=VN(qm.useViewTransitionState),i=df(t,{relative:e.relative});if(!n.isTransitioning)return!1;let s=tl(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=tl(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Bm(i.pathname,o)!=null||Bm(i.pathname,s)!=null}var Su=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},$N={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},ss,Jg,oT,BN=(oT=class{constructor(){ye(this,ss,$N);ye(this,Jg,!1)}setTimeoutProvider(t){se(this,ss,t)}setTimeout(t,e){return M(this,ss).setTimeout(t,e)}clearTimeout(t){M(this,ss).clearTimeout(t)}setInterval(t,e){return M(this,ss).setInterval(t,e)}clearInterval(t){M(this,ss).clearInterval(t)}},ss=new WeakMap,Jg=new WeakMap,oT),so=new BN;function zN(t){setTimeout(t,0)}var Po=typeof window>"u"||"Deno"in globalThis;function jn(){}function WN(t,e){return typeof t=="function"?t(e):t}function Hm(t){return typeof t=="number"&&t>=0&&t!==1/0}function qb(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Cs(t,e){return typeof t=="function"?t(e):t}function hr(t,e){return typeof t=="function"?t(e):t}function x0(t,e){const{type:n="all",exact:r,fetchStatus:i,predicate:s,queryKey:o,stale:a}=t;if(o){if(r){if(e.queryHash!==Ky(o,e.options))return!1}else if(!Kc(e.queryKey,o))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof a=="boolean"&&e.isStale()!==a||i&&i!==e.state.fetchStatus||s&&!s(e))}function b0(t,e){const{exact:n,status:r,predicate:i,mutationKey:s}=t;if(s){if(!e.options.mutationKey)return!1;if(n){if(Gc(e.options.mutationKey)!==Gc(s))return!1}else if(!Kc(e.options.mutationKey,s))return!1}return!(r&&e.state.status!==r||i&&!i(e))}function Ky(t,e){return((e==null?void 0:e.queryKeyHashFn)||Gc)(t)}function Gc(t){return JSON.stringify(t,(e,n)=>Km(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function Kc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Kc(t[n],e[n])):!1}var qN=Object.prototype.hasOwnProperty;function Hb(t,e){if(t===e)return t;const n=I0(t)&&I0(e);if(!n&&!(Km(t)&&Km(e)))return e;const i=(n?t:Object.keys(t)).length,s=n?e:Object.keys(e),o=s.length,a=n?new Array(o):{};let l=0;for(let u=0;u<o;u++){const d=n?u:s[u],h=t[d],p=e[d];if(h===p){a[d]=h,(n?u<i:qN.call(t,d))&&l++;continue}if(h===null||p===null||typeof h!="object"||typeof p!="object"){a[d]=p;continue}const y=Hb(h,p);a[d]=y,y===h&&l++}return i===o&&l===i?t:a}function Gm(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function I0(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Km(t){if(!C0(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!C0(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function C0(t){return Object.prototype.toString.call(t)==="[object Object]"}function HN(t){return new Promise(e=>{so.setTimeout(e,t)})}function Qm(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?Hb(t,e):e}function GN(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function KN(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var Qy=Symbol();function Gb(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===Qy?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function QN(t,e){return typeof t=="function"?t(...e):!!t}var uo,os,Ma,aT,JN=(aT=class extends Su{constructor(){super();ye(this,uo);ye(this,os);ye(this,Ma);se(this,Ma,e=>{if(!Po&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){M(this,os)||this.setEventListener(M(this,Ma))}onUnsubscribe(){var e;this.hasListeners()||((e=M(this,os))==null||e.call(this),se(this,os,void 0))}setEventListener(e){var n;se(this,Ma,e),(n=M(this,os))==null||n.call(this),se(this,os,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){M(this,uo)!==e&&(se(this,uo,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof M(this,uo)=="boolean"?M(this,uo):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},uo=new WeakMap,os=new WeakMap,Ma=new WeakMap,aT),Jy=new JN;function Jm(){let t,e;const n=new Promise((i,s)=>{t=i,e=s});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),t(i)},n.reject=i=>{r({status:"rejected",reason:i}),e(i)},n}var YN=zN;function ZN(){let t=[],e=0,n=a=>{a()},r=a=>{a()},i=YN;const s=a=>{e?t.push(a):i(()=>{n(a)})},o=()=>{const a=t;t=[],a.length&&i(()=>{r(()=>{a.forEach(l=>{n(l)})})})};return{batch:a=>{let l;e++;try{l=a()}finally{e--,e||o()}return l},batchCalls:a=>(...l)=>{s(()=>{a(...l)})},schedule:s,setNotifyFunction:a=>{n=a},setBatchNotifyFunction:a=>{r=a},setScheduler:a=>{i=a}}}var Xt=ZN(),Va,as,ja,lT,XN=(lT=class extends Su{constructor(){super();ye(this,Va,!0);ye(this,as);ye(this,ja);se(this,ja,e=>{if(!Po&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){M(this,as)||this.setEventListener(M(this,ja))}onUnsubscribe(){var e;this.hasListeners()||((e=M(this,as))==null||e.call(this),se(this,as,void 0))}setEventListener(e){var n;se(this,ja,e),(n=M(this,as))==null||n.call(this),se(this,as,e(this.setOnline.bind(this)))}setOnline(e){M(this,Va)!==e&&(se(this,Va,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return M(this,Va)}},Va=new WeakMap,as=new WeakMap,ja=new WeakMap,lT),wh=new XN;function e2(t){return Math.min(1e3*2**t,3e4)}function Kb(t){return(t??"online")==="online"?wh.isOnline():!0}var Ym=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function Qb(t){let e=!1,n=0,r;const i=Jm(),s=()=>i.status!=="pending",o=E=>{var R;if(!s()){const w=new Ym(E);p(w),(R=t.onCancel)==null||R.call(t,w)}},a=()=>{e=!0},l=()=>{e=!1},u=()=>Jy.isFocused()&&(t.networkMode==="always"||wh.isOnline())&&t.canRun(),d=()=>Kb(t.networkMode)&&t.canRun(),h=E=>{s()||(r==null||r(),i.resolve(E))},p=E=>{s()||(r==null||r(),i.reject(E))},y=()=>new Promise(E=>{var R;r=w=>{(s()||u())&&E(w)},(R=t.onPause)==null||R.call(t)}).then(()=>{var E;r=void 0,s()||(E=t.onContinue)==null||E.call(t)}),T=()=>{if(s())return;let E;const R=n===0?t.initialPromise:void 0;try{E=R??t.fn()}catch(w){E=Promise.reject(w)}Promise.resolve(E).then(h).catch(w=>{var j;if(s())return;const v=t.retry??(Po?0:3),b=t.retryDelay??e2,D=typeof b=="function"?b(n,w):b,L=v===!0||typeof v=="number"&&n<v||typeof v=="function"&&v(n,w);if(e||!L){p(w);return}n++,(j=t.onFail)==null||j.call(t,n,w),HN(D).then(()=>u()?void 0:y()).then(()=>{e?p(w):T()})})};return{promise:i,status:()=>i.status,cancel:o,continue:()=>(r==null||r(),i),cancelRetry:a,continueRetry:l,canStart:d,start:()=>(d()?T():y().then(T),i)}}var ho,cT,Jb=(cT=class{constructor(){ye(this,ho)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Hm(this.gcTime)&&se(this,ho,so.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Po?1/0:5*60*1e3))}clearGcTimeout(){M(this,ho)&&(so.clearTimeout(M(this,ho)),se(this,ho,void 0))}},ho=new WeakMap,cT),fo,Fa,dr,po,zt,du,mo,Ar,hi,uT,t2=(uT=class extends Jb{constructor(n){super();ye(this,Ar);ye(this,fo);ye(this,Fa);ye(this,dr);ye(this,po);ye(this,zt);ye(this,du);ye(this,mo);se(this,mo,!1),se(this,du,n.defaultOptions),this.setOptions(n.options),this.observers=[],se(this,po,n.client),se(this,dr,M(this,po).getQueryCache()),this.queryKey=n.queryKey,this.queryHash=n.queryHash,se(this,fo,k0(this.options)),this.state=n.state??M(this,fo),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var n;return(n=M(this,zt))==null?void 0:n.promise}setOptions(n){if(this.options={...M(this,du),...n},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=k0(this.options);r.data!==void 0&&(this.setData(r.data,{updatedAt:r.dataUpdatedAt,manual:!0}),se(this,fo,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&M(this,dr).remove(this)}setData(n,r){const i=Qm(this.state.data,n,this.options);return je(this,Ar,hi).call(this,{data:i,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),i}setState(n,r){je(this,Ar,hi).call(this,{type:"setState",state:n,setStateOptions:r})}cancel(n){var i,s;const r=(i=M(this,zt))==null?void 0:i.promise;return(s=M(this,zt))==null||s.cancel(n),r?r.then(jn).catch(jn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(M(this,fo))}isActive(){return this.observers.some(n=>hr(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Qy||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>Cs(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!qb(this.state.dataUpdatedAt,n)}onFocus(){var r;const n=this.observers.find(i=>i.shouldFetchOnWindowFocus());n==null||n.refetch({cancelRefetch:!1}),(r=M(this,zt))==null||r.continue()}onOnline(){var r;const n=this.observers.find(i=>i.shouldFetchOnReconnect());n==null||n.refetch({cancelRefetch:!1}),(r=M(this,zt))==null||r.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),M(this,dr).notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(r=>r!==n),this.observers.length||(M(this,zt)&&(M(this,mo)?M(this,zt).cancel({revert:!0}):M(this,zt).cancelRetry()),this.scheduleGc()),M(this,dr).notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||je(this,Ar,hi).call(this,{type:"invalidate"})}async fetch(n,r){var u,d,h,p,y,T,E,R,w,v,b,D;if(this.state.fetchStatus!=="idle"&&((u=M(this,zt))==null?void 0:u.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(M(this,zt))return M(this,zt).continueRetry(),M(this,zt).promise}if(n&&this.setOptions(n),!this.options.queryFn){const L=this.observers.find(j=>j.options.queryFn);L&&this.setOptions(L.options)}const i=new AbortController,s=L=>{Object.defineProperty(L,"signal",{enumerable:!0,get:()=>(se(this,mo,!0),i.signal)})},o=()=>{const L=Gb(this.options,r),I=(()=>{const _={client:M(this,po),queryKey:this.queryKey,meta:this.meta};return s(_),_})();return se(this,mo,!1),this.options.persister?this.options.persister(L,I,this):L(I)},l=(()=>{const L={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:M(this,po),state:this.state,fetchFn:o};return s(L),L})();(d=this.options.behavior)==null||d.onFetch(l,this),se(this,Fa,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=l.fetchOptions)==null?void 0:h.meta))&&je(this,Ar,hi).call(this,{type:"fetch",meta:(p=l.fetchOptions)==null?void 0:p.meta}),se(this,zt,Qb({initialPromise:r==null?void 0:r.initialPromise,fn:l.fetchFn,onCancel:L=>{L instanceof Ym&&L.revert&&this.setState({...M(this,Fa),fetchStatus:"idle"}),i.abort()},onFail:(L,j)=>{je(this,Ar,hi).call(this,{type:"failed",failureCount:L,error:j})},onPause:()=>{je(this,Ar,hi).call(this,{type:"pause"})},onContinue:()=>{je(this,Ar,hi).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0}));try{const L=await M(this,zt).start();if(L===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(L),(T=(y=M(this,dr).config).onSuccess)==null||T.call(y,L,this),(R=(E=M(this,dr).config).onSettled)==null||R.call(E,L,this.state.error,this),L}catch(L){if(L instanceof Ym){if(L.silent)return M(this,zt).promise;if(L.revert){if(this.state.data===void 0)throw L;return this.state.data}}throw je(this,Ar,hi).call(this,{type:"error",error:L}),(v=(w=M(this,dr).config).onError)==null||v.call(w,L,this),(D=(b=M(this,dr).config).onSettled)==null||D.call(b,this.state.data,L,this),L}finally{this.scheduleGc()}}},fo=new WeakMap,Fa=new WeakMap,dr=new WeakMap,po=new WeakMap,zt=new WeakMap,du=new WeakMap,mo=new WeakMap,Ar=new WeakSet,hi=function(n){const r=i=>{switch(n.type){case"failed":return{...i,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...Yb(i.data,this.options),fetchMeta:n.meta??null};case"success":const s={...i,data:n.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:n.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return se(this,Fa,n.manual?s:void 0),s;case"error":const o=n.error;return{...i,error:o,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:o,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...n.state}}};this.state=r(this.state),Xt.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),M(this,dr).notify({query:this,type:"updated",action:n})})},uT);function Yb(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Kb(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function k0(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Mn,Fe,hu,bn,go,Ua,gi,ls,fu,$a,Ba,yo,_o,cs,za,Je,rc,Zm,Xm,eg,tg,ng,rg,ig,Zb,dT,n2=(dT=class extends Su{constructor(e,n){super();ye(this,Je);ye(this,Mn);ye(this,Fe);ye(this,hu);ye(this,bn);ye(this,go);ye(this,Ua);ye(this,gi);ye(this,ls);ye(this,fu);ye(this,$a);ye(this,Ba);ye(this,yo);ye(this,_o);ye(this,cs);ye(this,za,new Set);this.options=n,se(this,Mn,e),se(this,ls,null),se(this,gi,Jm()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(M(this,Fe).addObserver(this),A0(M(this,Fe),this.options)?je(this,Je,rc).call(this):this.updateResult(),je(this,Je,tg).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return sg(M(this,Fe),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return sg(M(this,Fe),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,je(this,Je,ng).call(this),je(this,Je,rg).call(this),M(this,Fe).removeObserver(this)}setOptions(e){const n=this.options,r=M(this,Fe);if(this.options=M(this,Mn).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof hr(this.options.enabled,M(this,Fe))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");je(this,Je,ig).call(this),M(this,Fe).setOptions(this.options),n._defaulted&&!Gm(this.options,n)&&M(this,Mn).getQueryCache().notify({type:"observerOptionsUpdated",query:M(this,Fe),observer:this});const i=this.hasListeners();i&&P0(M(this,Fe),r,this.options,n)&&je(this,Je,rc).call(this),this.updateResult(),i&&(M(this,Fe)!==r||hr(this.options.enabled,M(this,Fe))!==hr(n.enabled,M(this,Fe))||Cs(this.options.staleTime,M(this,Fe))!==Cs(n.staleTime,M(this,Fe)))&&je(this,Je,Zm).call(this);const s=je(this,Je,Xm).call(this);i&&(M(this,Fe)!==r||hr(this.options.enabled,M(this,Fe))!==hr(n.enabled,M(this,Fe))||s!==M(this,cs))&&je(this,Je,eg).call(this,s)}getOptimisticResult(e){const n=M(this,Mn).getQueryCache().build(M(this,Mn),e),r=this.createResult(n,e);return i2(this,r)&&(se(this,bn,r),se(this,Ua,this.options),se(this,go,M(this,Fe).state)),r}getCurrentResult(){return M(this,bn)}trackResult(e,n){return new Proxy(e,{get:(r,i)=>(this.trackProp(i),n==null||n(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&M(this,gi).status==="pending"&&M(this,gi).reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,i))})}trackProp(e){M(this,za).add(e)}getCurrentQuery(){return M(this,Fe)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=M(this,Mn).defaultQueryOptions(e),r=M(this,Mn).getQueryCache().build(M(this,Mn),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(e){return je(this,Je,rc).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),M(this,bn)))}createResult(e,n){var C;const r=M(this,Fe),i=this.options,s=M(this,bn),o=M(this,go),a=M(this,Ua),u=e!==r?e.state:M(this,hu),{state:d}=e;let h={...d},p=!1,y;if(n._optimisticResults){const A=this.hasListeners(),k=!A&&A0(e,n),x=A&&P0(e,r,n,i);(k||x)&&(h={...h,...Yb(d.data,e.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:T,errorUpdatedAt:E,status:R}=h;y=h.data;let w=!1;if(n.placeholderData!==void 0&&y===void 0&&R==="pending"){let A;s!=null&&s.isPlaceholderData&&n.placeholderData===(a==null?void 0:a.placeholderData)?(A=s.data,w=!0):A=typeof n.placeholderData=="function"?n.placeholderData((C=M(this,Ba))==null?void 0:C.state.data,M(this,Ba)):n.placeholderData,A!==void 0&&(R="success",y=Qm(s==null?void 0:s.data,A,n),p=!0)}if(n.select&&y!==void 0&&!w)if(s&&y===(o==null?void 0:o.data)&&n.select===M(this,fu))y=M(this,$a);else try{se(this,fu,n.select),y=n.select(y),y=Qm(s==null?void 0:s.data,y,n),se(this,$a,y),se(this,ls,null)}catch(A){se(this,ls,A)}M(this,ls)&&(T=M(this,ls),y=M(this,$a),E=Date.now(),R="error");const v=h.fetchStatus==="fetching",b=R==="pending",D=R==="error",L=b&&v,j=y!==void 0,_={status:R,fetchStatus:h.fetchStatus,isPending:b,isSuccess:R==="success",isError:D,isInitialLoading:L,isLoading:L,data:y,dataUpdatedAt:h.dataUpdatedAt,error:T,errorUpdatedAt:E,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:v,isRefetching:v&&!b,isLoadingError:D&&!j,isPaused:h.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:D&&j,isStale:Yy(e,n),refetch:this.refetch,promise:M(this,gi),isEnabled:hr(n.enabled,e)!==!1};if(this.options.experimental_prefetchInRender){const A=P=>{_.status==="error"?P.reject(_.error):_.data!==void 0&&P.resolve(_.data)},k=()=>{const P=se(this,gi,_.promise=Jm());A(P)},x=M(this,gi);switch(x.status){case"pending":e.queryHash===r.queryHash&&A(x);break;case"fulfilled":(_.status==="error"||_.data!==x.value)&&k();break;case"rejected":(_.status!=="error"||_.error!==x.reason)&&k();break}}return _}updateResult(){const e=M(this,bn),n=this.createResult(M(this,Fe),this.options);if(se(this,go,M(this,Fe).state),se(this,Ua,this.options),M(this,go).data!==void 0&&se(this,Ba,M(this,Fe)),Gm(n,e))return;se(this,bn,n);const r=()=>{if(!e)return!0;const{notifyOnChangeProps:i}=this.options,s=typeof i=="function"?i():i;if(s==="all"||!s&&!M(this,za).size)return!0;const o=new Set(s??M(this,za));return this.options.throwOnError&&o.add("error"),Object.keys(M(this,bn)).some(a=>{const l=a;return M(this,bn)[l]!==e[l]&&o.has(l)})};je(this,Je,Zb).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&je(this,Je,tg).call(this)}},Mn=new WeakMap,Fe=new WeakMap,hu=new WeakMap,bn=new WeakMap,go=new WeakMap,Ua=new WeakMap,gi=new WeakMap,ls=new WeakMap,fu=new WeakMap,$a=new WeakMap,Ba=new WeakMap,yo=new WeakMap,_o=new WeakMap,cs=new WeakMap,za=new WeakMap,Je=new WeakSet,rc=function(e){je(this,Je,ig).call(this);let n=M(this,Fe).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(jn)),n},Zm=function(){je(this,Je,ng).call(this);const e=Cs(this.options.staleTime,M(this,Fe));if(Po||M(this,bn).isStale||!Hm(e))return;const r=qb(M(this,bn).dataUpdatedAt,e)+1;se(this,yo,so.setTimeout(()=>{M(this,bn).isStale||this.updateResult()},r))},Xm=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(M(this,Fe)):this.options.refetchInterval)??!1},eg=function(e){je(this,Je,rg).call(this),se(this,cs,e),!(Po||hr(this.options.enabled,M(this,Fe))===!1||!Hm(M(this,cs))||M(this,cs)===0)&&se(this,_o,so.setInterval(()=>{(this.options.refetchIntervalInBackground||Jy.isFocused())&&je(this,Je,rc).call(this)},M(this,cs)))},tg=function(){je(this,Je,Zm).call(this),je(this,Je,eg).call(this,je(this,Je,Xm).call(this))},ng=function(){M(this,yo)&&(so.clearTimeout(M(this,yo)),se(this,yo,void 0))},rg=function(){M(this,_o)&&(so.clearInterval(M(this,_o)),se(this,_o,void 0))},ig=function(){const e=M(this,Mn).getQueryCache().build(M(this,Mn),this.options);if(e===M(this,Fe))return;const n=M(this,Fe);se(this,Fe,e),se(this,hu,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},Zb=function(e){Xt.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(M(this,bn))}),M(this,Mn).getQueryCache().notify({query:M(this,Fe),type:"observerResultsUpdated"})})},dT);function r2(t,e){return hr(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function A0(t,e){return r2(t,e)||t.state.data!==void 0&&sg(t,e,e.refetchOnMount)}function sg(t,e,n){if(hr(e.enabled,t)!==!1&&Cs(e.staleTime,t)!=="static"){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&Yy(t,e)}return!1}function P0(t,e,n,r){return(t!==e||hr(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Yy(t,n)}function Yy(t,e){return hr(e.enabled,t)!==!1&&t.isStaleByTime(Cs(e.staleTime,t))}function i2(t,e){return!Gm(t.getCurrentResult(),e)}function R0(t){return{onFetch:(e,n)=>{var d,h,p,y,T;const r=e.options,i=(p=(h=(d=e.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:p.direction,s=((y=e.state.data)==null?void 0:y.pages)||[],o=((T=e.state.data)==null?void 0:T.pageParams)||[];let a={pages:[],pageParams:[]},l=0;const u=async()=>{let E=!1;const R=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(e.signal.aborted?E=!0:e.signal.addEventListener("abort",()=>{E=!0}),e.signal)})},w=Gb(e.options,e.fetchOptions),v=async(b,D,L)=>{if(E)return Promise.reject();if(D==null&&b.pages.length)return Promise.resolve(b);const I=(()=>{const k={client:e.client,queryKey:e.queryKey,pageParam:D,direction:L?"backward":"forward",meta:e.options.meta};return R(k),k})(),_=await w(I),{maxPages:C}=e.options,A=L?KN:GN;return{pages:A(b.pages,_,C),pageParams:A(b.pageParams,D,C)}};if(i&&s.length){const b=i==="backward",D=b?s2:N0,L={pages:s,pageParams:o},j=D(r,L);a=await v(L,j,b)}else{const b=t??s.length;do{const D=l===0?o[0]??r.initialPageParam:N0(r,a);if(l>0&&D==null)break;a=await v(a,D),l++}while(l<b)}return a};e.options.persister?e.fetchFn=()=>{var E,R;return(R=(E=e.options).persister)==null?void 0:R.call(E,u,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=u}}}function N0(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function s2(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var pu,Hr,In,vo,Gr,Qi,hT,o2=(hT=class extends Jb{constructor(n){super();ye(this,Gr);ye(this,pu);ye(this,Hr);ye(this,In);ye(this,vo);se(this,pu,n.client),this.mutationId=n.mutationId,se(this,In,n.mutationCache),se(this,Hr,[]),this.state=n.state||a2(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){M(this,Hr).includes(n)||(M(this,Hr).push(n),this.clearGcTimeout(),M(this,In).notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){se(this,Hr,M(this,Hr).filter(r=>r!==n)),this.scheduleGc(),M(this,In).notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){M(this,Hr).length||(this.state.status==="pending"?this.scheduleGc():M(this,In).remove(this))}continue(){var n;return((n=M(this,vo))==null?void 0:n.continue())??this.execute(this.state.variables)}async execute(n){var a,l,u,d,h,p,y,T,E,R,w,v,b,D,L,j,I,_,C,A;const r=()=>{je(this,Gr,Qi).call(this,{type:"continue"})},i={client:M(this,pu),meta:this.options.meta,mutationKey:this.options.mutationKey};se(this,vo,Qb({fn:()=>this.options.mutationFn?this.options.mutationFn(n,i):Promise.reject(new Error("No mutationFn found")),onFail:(k,x)=>{je(this,Gr,Qi).call(this,{type:"failed",failureCount:k,error:x})},onPause:()=>{je(this,Gr,Qi).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>M(this,In).canRun(this)}));const s=this.state.status==="pending",o=!M(this,vo).canStart();try{if(s)r();else{je(this,Gr,Qi).call(this,{type:"pending",variables:n,isPaused:o}),await((l=(a=M(this,In).config).onMutate)==null?void 0:l.call(a,n,this,i));const x=await((d=(u=this.options).onMutate)==null?void 0:d.call(u,n,i));x!==this.state.context&&je(this,Gr,Qi).call(this,{type:"pending",context:x,variables:n,isPaused:o})}const k=await M(this,vo).start();return await((p=(h=M(this,In).config).onSuccess)==null?void 0:p.call(h,k,n,this.state.context,this,i)),await((T=(y=this.options).onSuccess)==null?void 0:T.call(y,k,n,this.state.context,i)),await((R=(E=M(this,In).config).onSettled)==null?void 0:R.call(E,k,null,this.state.variables,this.state.context,this,i)),await((v=(w=this.options).onSettled)==null?void 0:v.call(w,k,null,n,this.state.context,i)),je(this,Gr,Qi).call(this,{type:"success",data:k}),k}catch(k){try{throw await((D=(b=M(this,In).config).onError)==null?void 0:D.call(b,k,n,this.state.context,this,i)),await((j=(L=this.options).onError)==null?void 0:j.call(L,k,n,this.state.context,i)),await((_=(I=M(this,In).config).onSettled)==null?void 0:_.call(I,void 0,k,this.state.variables,this.state.context,this,i)),await((A=(C=this.options).onSettled)==null?void 0:A.call(C,void 0,k,n,this.state.context,i)),k}finally{je(this,Gr,Qi).call(this,{type:"error",error:k})}}finally{M(this,In).runNext(this)}}},pu=new WeakMap,Hr=new WeakMap,In=new WeakMap,vo=new WeakMap,Gr=new WeakSet,Qi=function(n){const r=i=>{switch(n.type){case"failed":return{...i,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...i,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:n.error,failureCount:i.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Xt.batch(()=>{M(this,Hr).forEach(i=>{i.onMutationUpdate(n)}),M(this,In).notify({mutation:this,type:"updated",action:n})})},hT);function a2(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var yi,Pr,mu,fT,l2=(fT=class extends Su{constructor(e={}){super();ye(this,yi);ye(this,Pr);ye(this,mu);this.config=e,se(this,yi,new Set),se(this,Pr,new Map),se(this,mu,0)}build(e,n,r){const i=new o2({client:e,mutationCache:this,mutationId:++ed(this,mu)._,options:e.defaultMutationOptions(n),state:r});return this.add(i),i}add(e){M(this,yi).add(e);const n=_d(e);if(typeof n=="string"){const r=M(this,Pr).get(n);r?r.push(e):M(this,Pr).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(M(this,yi).delete(e)){const n=_d(e);if(typeof n=="string"){const r=M(this,Pr).get(n);if(r)if(r.length>1){const i=r.indexOf(e);i!==-1&&r.splice(i,1)}else r[0]===e&&M(this,Pr).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=_d(e);if(typeof n=="string"){const r=M(this,Pr).get(n),i=r==null?void 0:r.find(s=>s.state.status==="pending");return!i||i===e}else return!0}runNext(e){var r;const n=_d(e);if(typeof n=="string"){const i=(r=M(this,Pr).get(n))==null?void 0:r.find(s=>s!==e&&s.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Xt.batch(()=>{M(this,yi).forEach(e=>{this.notify({type:"removed",mutation:e})}),M(this,yi).clear(),M(this,Pr).clear()})}getAll(){return Array.from(M(this,yi))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>b0(n,r))}findAll(e={}){return this.getAll().filter(n=>b0(e,n))}notify(e){Xt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return Xt.batch(()=>Promise.all(e.map(n=>n.continue().catch(jn))))}},yi=new WeakMap,Pr=new WeakMap,mu=new WeakMap,fT);function _d(t){var e;return(e=t.options.scope)==null?void 0:e.id}var Kr,pT,c2=(pT=class extends Su{constructor(e={}){super();ye(this,Kr);this.config=e,se(this,Kr,new Map)}build(e,n,r){const i=n.queryKey,s=n.queryHash??Ky(i,n);let o=this.get(s);return o||(o=new t2({client:e,queryKey:i,queryHash:s,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(i)}),this.add(o)),o}add(e){M(this,Kr).has(e.queryHash)||(M(this,Kr).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=M(this,Kr).get(e.queryHash);n&&(e.destroy(),n===e&&M(this,Kr).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Xt.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return M(this,Kr).get(e)}getAll(){return[...M(this,Kr).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>x0(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>x0(e,r)):n}notify(e){Xt.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Xt.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Xt.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},Kr=new WeakMap,pT),bt,us,ds,Wa,qa,hs,Ha,Ga,mT,Xb=(mT=class{constructor(t={}){ye(this,bt);ye(this,us);ye(this,ds);ye(this,Wa);ye(this,qa);ye(this,hs);ye(this,Ha);ye(this,Ga);se(this,bt,t.queryCache||new c2),se(this,us,t.mutationCache||new l2),se(this,ds,t.defaultOptions||{}),se(this,Wa,new Map),se(this,qa,new Map),se(this,hs,0)}mount(){ed(this,hs)._++,M(this,hs)===1&&(se(this,Ha,Jy.subscribe(async t=>{t&&(await this.resumePausedMutations(),M(this,bt).onFocus())})),se(this,Ga,wh.subscribe(async t=>{t&&(await this.resumePausedMutations(),M(this,bt).onOnline())})))}unmount(){var t,e;ed(this,hs)._--,M(this,hs)===0&&((t=M(this,Ha))==null||t.call(this),se(this,Ha,void 0),(e=M(this,Ga))==null||e.call(this),se(this,Ga,void 0))}isFetching(t){return M(this,bt).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return M(this,us).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=M(this,bt).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=M(this,bt).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Cs(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return M(this,bt).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),i=M(this,bt).get(r.queryHash),s=i==null?void 0:i.state.data,o=WN(e,s);if(o!==void 0)return M(this,bt).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(t,e,n){return Xt.batch(()=>M(this,bt).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=M(this,bt).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=M(this,bt);Xt.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=M(this,bt);return Xt.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=Xt.batch(()=>M(this,bt).findAll(t).map(i=>i.cancel(n)));return Promise.all(r).then(jn).catch(jn)}invalidateQueries(t,e={}){return Xt.batch(()=>(M(this,bt).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=Xt.batch(()=>M(this,bt).findAll(t).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let s=i.fetch(void 0,n);return n.throwOnError||(s=s.catch(jn)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(r).then(jn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=M(this,bt).build(this,e);return n.isStaleByTime(Cs(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(jn).catch(jn)}fetchInfiniteQuery(t){return t.behavior=R0(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(jn).catch(jn)}ensureInfiniteQueryData(t){return t.behavior=R0(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return wh.isOnline()?M(this,us).resumePausedMutations():Promise.resolve()}getQueryCache(){return M(this,bt)}getMutationCache(){return M(this,us)}getDefaultOptions(){return M(this,ds)}setDefaultOptions(t){se(this,ds,t)}setQueryDefaults(t,e){M(this,Wa).set(Gc(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...M(this,Wa).values()],n={};return e.forEach(r=>{Kc(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){M(this,qa).set(Gc(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...M(this,qa).values()],n={};return e.forEach(r=>{Kc(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...M(this,ds).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Ky(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Qy&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...M(this,ds).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){M(this,bt).clear(),M(this,us).clear()}},bt=new WeakMap,us=new WeakMap,ds=new WeakMap,Wa=new WeakMap,qa=new WeakMap,hs=new WeakMap,Ha=new WeakMap,Ga=new WeakMap,mT),eI=N.createContext(void 0),u2=t=>{const e=N.useContext(eI);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},tI=({client:t,children:e})=>(N.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),m.jsx(eI.Provider,{value:t,children:e})),nI=N.createContext(!1),d2=()=>N.useContext(nI);nI.Provider;function h2(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var f2=N.createContext(h2()),p2=()=>N.useContext(f2),m2=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},g2=t=>{N.useEffect(()=>{t.clearReset()},[t])},y2=({result:t,errorResetBoundary:e,throwOnError:n,query:r,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(i&&t.data===void 0||QN(n,[t.error,r])),_2=t=>{if(t.suspense){const n=i=>i==="static"?i:Math.max(i??1e3,1e3),r=t.staleTime;t.staleTime=typeof r=="function"?(...i)=>n(r(...i)):n(r),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},v2=(t,e)=>t.isLoading&&t.isFetching&&!e,w2=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,D0=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function E2(t,e,n){var h,p,y,T,E;const r=d2(),i=p2(),s=u2(),o=s.defaultQueryOptions(t);(p=(h=s.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||p.call(h,o),o._optimisticResults=r?"isRestoring":"optimistic",_2(o),m2(o,i),g2(i);const a=!s.getQueryCache().get(o.queryHash),[l]=N.useState(()=>new e(s,o)),u=l.getOptimisticResult(o),d=!r&&t.subscribed!==!1;if(N.useSyncExternalStore(N.useCallback(R=>{const w=d?l.subscribe(Xt.batchCalls(R)):jn;return l.updateResult(),w},[l,d]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),N.useEffect(()=>{l.setOptions(o)},[o,l]),w2(o,u))throw D0(o,l,i);if(y2({result:u,errorResetBoundary:i,throwOnError:o.throwOnError,query:s.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw u.error;if((T=(y=s.getDefaultOptions().queries)==null?void 0:y._experimental_afterQuery)==null||T.call(y,o,u),o.experimental_prefetchInRender&&!Po&&v2(u,r)){const R=a?D0(o,l,i):(E=s.getQueryCache().get(o.queryHash))==null?void 0:E.promise;R==null||R.catch(jn).finally(()=>{l.updateResult()})}return o.notifyOnChangeProps?u:l.trackResult(u)}function S2(t,e){return E2(t,n2)}var O0={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},T2=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},iI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,u=l?t[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4;let p=(a&15)<<2|u>>6,y=u&63;l||(y=64,o||(p=64)),r.push(n[d],n[h],n[p],n[y])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(rI(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):T2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const u=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||u==null||h==null)throw new x2;const p=s<<2|a>>4;if(r.push(p),u!==64){const y=a<<4&240|u>>2;if(r.push(y),h!==64){const T=u<<6&192|h;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class x2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const b2=function(t){const e=rI(t);return iI.encodeByteArray(e,!0)},Eh=function(t){return b2(t).replace(/\./g,"")},sI=function(t){try{return iI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2=()=>I2().__FIREBASE_DEFAULTS__,k2=()=>{if(typeof process>"u"||typeof O0>"u")return;const t=O0.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},A2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&sI(t[1]);return e&&JSON.parse(e)},hf=()=>{try{return C2()||k2()||A2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},oI=t=>{var e,n;return(n=(e=hf())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},P2=t=>{const e=oI(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},aI=()=>{var t;return(t=hf())===null||t===void 0?void 0:t.config},lI=t=>{var e;return(e=hf())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let R2=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Eh(JSON.stringify(n)),Eh(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function D2(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(wn())}function O2(){var t;const e=(t=hf())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function L2(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function M2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function V2(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function j2(){const t=wn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function F2(){return!O2()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function U2(){try{return typeof indexedDB=="object"}catch{return!1}}function $2(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B2="FirebaseError";class Fi extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=B2,Object.setPrototypeOf(this,Fi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Tu.prototype.create)}}class Tu{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?z2(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Fi(i,a,r)}}function z2(t,e){return t.replace(W2,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const W2=/\{\$([^}]+)}/g;function q2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Sh(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(L0(s)&&L0(o)){if(!Sh(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function L0(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xu(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ic(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function sc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function H2(t,e){const n=new G2(t,e);return n.subscribe.bind(n)}class G2{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");K2(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=bp),i.error===void 0&&(i.error=bp),i.complete===void 0&&(i.complete=bp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function K2(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function bp(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ye(t){return t&&t._delegate?t._delegate:t}class Ro{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const to="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new R2;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Y2(e))try{this.getOrInitializeService({instanceIdentifier:to})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=to){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=to){return this.instances.has(e)}getOptions(e=to){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:J2(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=to){return this.component?this.component.multipleInstances?e:to:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function J2(t){return t===to?void 0:t}function Y2(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z2{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Q2(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ue;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ue||(Ue={}));const X2={debug:Ue.DEBUG,verbose:Ue.VERBOSE,info:Ue.INFO,warn:Ue.WARN,error:Ue.ERROR,silent:Ue.SILENT},eD=Ue.INFO,tD={[Ue.DEBUG]:"log",[Ue.VERBOSE]:"log",[Ue.INFO]:"info",[Ue.WARN]:"warn",[Ue.ERROR]:"error"},nD=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=tD[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Zy{constructor(e){this.name=e,this._logLevel=eD,this._logHandler=nD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ue))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?X2[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ue.DEBUG,...e),this._logHandler(this,Ue.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ue.VERBOSE,...e),this._logHandler(this,Ue.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ue.INFO,...e),this._logHandler(this,Ue.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ue.WARN,...e),this._logHandler(this,Ue.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ue.ERROR,...e),this._logHandler(this,Ue.ERROR,...e)}}const rD=(t,e)=>e.some(n=>t instanceof n);let M0,V0;function iD(){return M0||(M0=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sD(){return V0||(V0=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cI=new WeakMap,og=new WeakMap,uI=new WeakMap,Ip=new WeakMap,Xy=new WeakMap;function oD(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(ks(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&cI.set(n,t)}).catch(()=>{}),Xy.set(e,t),e}function aD(t){if(og.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});og.set(t,e)}let ag={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return og.get(t);if(e==="objectStoreNames")return t.objectStoreNames||uI.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ks(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function lD(t){ag=t(ag)}function cD(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Cp(this),e,...n);return uI.set(r,e.sort?e.sort():[e]),ks(r)}:sD().includes(t)?function(...e){return t.apply(Cp(this),e),ks(cI.get(this))}:function(...e){return ks(t.apply(Cp(this),e))}}function uD(t){return typeof t=="function"?cD(t):(t instanceof IDBTransaction&&aD(t),rD(t,iD())?new Proxy(t,ag):t)}function ks(t){if(t instanceof IDBRequest)return oD(t);if(Ip.has(t))return Ip.get(t);const e=uD(t);return e!==t&&(Ip.set(t,e),Xy.set(e,t)),e}const Cp=t=>Xy.get(t);function dD(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=ks(o);return r&&o.addEventListener("upgradeneeded",l=>{r(ks(o.result),l.oldVersion,l.newVersion,ks(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const hD=["get","getKey","getAll","getAllKeys","count"],fD=["put","add","delete","clear"],kp=new Map;function j0(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(kp.get(e))return kp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=fD.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||hD.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),i&&l.done]))[0]};return kp.set(e,s),s}lD(t=>({...t,get:(e,n,r)=>j0(e,n)||t.get(e,n,r),has:(e,n)=>!!j0(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(mD(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function mD(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const lg="@firebase/app",F0="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ai=new Zy("@firebase/app"),gD="@firebase/app-compat",yD="@firebase/analytics-compat",_D="@firebase/analytics",vD="@firebase/app-check-compat",wD="@firebase/app-check",ED="@firebase/auth",SD="@firebase/auth-compat",TD="@firebase/database",xD="@firebase/data-connect",bD="@firebase/database-compat",ID="@firebase/functions",CD="@firebase/functions-compat",kD="@firebase/installations",AD="@firebase/installations-compat",PD="@firebase/messaging",RD="@firebase/messaging-compat",ND="@firebase/performance",DD="@firebase/performance-compat",OD="@firebase/remote-config",LD="@firebase/remote-config-compat",MD="@firebase/storage",VD="@firebase/storage-compat",jD="@firebase/firestore",FD="@firebase/vertexai-preview",UD="@firebase/firestore-compat",$D="firebase",BD="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cg="[DEFAULT]",zD={[lg]:"fire-core",[gD]:"fire-core-compat",[_D]:"fire-analytics",[yD]:"fire-analytics-compat",[wD]:"fire-app-check",[vD]:"fire-app-check-compat",[ED]:"fire-auth",[SD]:"fire-auth-compat",[TD]:"fire-rtdb",[xD]:"fire-data-connect",[bD]:"fire-rtdb-compat",[ID]:"fire-fn",[CD]:"fire-fn-compat",[kD]:"fire-iid",[AD]:"fire-iid-compat",[PD]:"fire-fcm",[RD]:"fire-fcm-compat",[ND]:"fire-perf",[DD]:"fire-perf-compat",[OD]:"fire-rc",[LD]:"fire-rc-compat",[MD]:"fire-gcs",[VD]:"fire-gcs-compat",[jD]:"fire-fst",[UD]:"fire-fst-compat",[FD]:"fire-vertex","fire-js":"fire-js",[$D]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Th=new Map,WD=new Map,ug=new Map;function U0(t,e){try{t.container.addComponent(e)}catch(n){Ai.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function nl(t){const e=t.name;if(ug.has(e))return Ai.debug(`There were multiple attempts to register component ${e}.`),!1;ug.set(e,t);for(const n of Th.values())U0(n,t);for(const n of WD.values())U0(n,t);return!0}function e_(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function gr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},As=new Tu("app","Firebase",qD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ro("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw As.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wl=BD;function dI(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:cg,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw As.create("bad-app-name",{appName:String(i)});if(n||(n=aI()),!n)throw As.create("no-options");const s=Th.get(i);if(s){if(Sh(n,s.options)&&Sh(r,s.config))return s;throw As.create("duplicate-app",{appName:i})}const o=new Z2(i);for(const l of ug.values())o.addComponent(l);const a=new HD(n,r,o);return Th.set(i,a),a}function hI(t=cg){const e=Th.get(t);if(!e&&t===cg&&aI())return dI();if(!e)throw As.create("no-app",{appName:t});return e}function Ps(t,e,n){var r;let i=(r=zD[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ai.warn(a.join(" "));return}nl(new Ro(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GD="firebase-heartbeat-database",KD=1,Qc="firebase-heartbeat-store";let Ap=null;function fI(){return Ap||(Ap=dD(GD,KD,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Qc)}catch(n){console.warn(n)}}}}).catch(t=>{throw As.create("idb-open",{originalErrorMessage:t.message})})),Ap}async function QD(t){try{const n=(await fI()).transaction(Qc),r=await n.objectStore(Qc).get(pI(t));return await n.done,r}catch(e){if(e instanceof Fi)Ai.warn(e.message);else{const n=As.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ai.warn(n.message)}}}async function $0(t,e){try{const r=(await fI()).transaction(Qc,"readwrite");await r.objectStore(Qc).put(e,pI(t)),await r.done}catch(n){if(n instanceof Fi)Ai.warn(n.message);else{const r=As.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ai.warn(r.message)}}}function pI(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JD=1024,YD=30*24*60*60*1e3;class ZD{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new eO(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=B0();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=YD}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Ai.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=B0(),{heartbeatsToSend:r,unsentEntries:i}=XD(this._heartbeatsCache.heartbeats),s=Eh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Ai.warn(n),""}}}function B0(){return new Date().toISOString().substring(0,10)}function XD(t,e=JD){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),z0(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),z0(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class eO{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return U2()?$2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await QD(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return $0(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return $0(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function z0(t){return Eh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tO(t){nl(new Ro("platform-logger",e=>new pD(e),"PRIVATE")),nl(new Ro("heartbeat",e=>new ZD(e),"PRIVATE")),Ps(lg,F0,t),Ps(lg,F0,"esm2017"),Ps("fire-js","")}tO("");function t_(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function An(t,e,n,r){function i(s){return s instanceof n?s:new n(function(o){o(s)})}return new(n||(n=Promise))(function(s,o){function a(d){try{u(r.next(d))}catch(h){o(h)}}function l(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?s(d.value):i(d.value).then(a,l)}u((r=r.apply(t,e||[])).next())})}function mI(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const nO=mI,gI=new Tu("auth","Firebase",mI());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xh=new Zy("@firebase/auth");function rO(t,...e){xh.logLevel<=Ue.WARN&&xh.warn(`Auth (${wl}): ${t}`,...e)}function Vd(t,...e){xh.logLevel<=Ue.ERROR&&xh.error(`Auth (${wl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function or(t,...e){throw r_(t,...e)}function Vr(t,...e){return r_(t,...e)}function n_(t,e,n){const r=Object.assign(Object.assign({},nO()),{[e]:n});return new Tu("auth","Firebase",r).create(e,{appName:t.name})}function Xr(t){return n_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function iO(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&or(t,"argument-error"),n_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function r_(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return gI.create(t,...e)}function me(t,e,...n){if(!t)throw r_(e,...n)}function wi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Vd(e),new Error(e)}function Pi(t,e){t||wi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bh(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function yI(){return W0()==="http:"||W0()==="https:"}function W0(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(yI()||M2()||"connection"in navigator)?navigator.onLine:!0}function oO(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Pi(n>e,"Short delay should be less than long delay!"),this.isMobile=D2()||V2()}get(){return sO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i_(t,e){Pi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _I{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;wi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;wi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;wi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lO=new bu(3e4,6e4);function Tr(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Qn(t,e,n,r,i={}){return vI(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=xu(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:l},s);return L2()||(u.referrerPolicy="no-referrer"),_I.fetch()(wI(t,t.config.apiHost,n,a),u)})}async function vI(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},aO),e);try{const i=new uO(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw vd(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,u]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw vd(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw vd(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw vd(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw n_(t,d,u);or(t,d)}}catch(i){if(i instanceof Fi)throw i;or(t,"network-request-failed",{message:String(i)})}}async function Iu(t,e,n,r,i={}){const s=await Qn(t,e,n,r,i);return"mfaPendingCredential"in s&&or(t,"multi-factor-auth-required",{_serverResponse:s}),s}function wI(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?i_(t.config,i):`${t.config.apiScheme}://${i}`}function cO(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class uO{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Vr(this.auth,"network-request-failed")),lO.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function vd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Vr(t,e,r);return i.customData._tokenResponse=n,i}function q0(t){return t!==void 0&&t.enterprise!==void 0}class dO{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return cO(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function hO(t,e){return Qn(t,"GET","/v2/recaptchaConfig",Tr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fO(t,e){return Qn(t,"POST","/v1/accounts:delete",e)}async function EI(t,e){return Qn(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function pO(t,e=!1){const n=Ye(t),r=await n.getIdToken(e),i=s_(r);me(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:wc(Pp(i.auth_time)),issuedAtTime:wc(Pp(i.iat)),expirationTime:wc(Pp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Pp(t){return Number(t)*1e3}function s_(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Vd("JWT malformed, contained fewer than 3 sections"),null;try{const i=sI(n);return i?JSON.parse(i):(Vd("Failed to decode base64 JWT payload"),null)}catch(i){return Vd("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function H0(t){const e=s_(t);return me(e,"internal-error"),me(typeof e.exp<"u","internal-error"),me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function No(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Fi&&mO(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function mO({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=wc(this.lastLoginAt),this.creationTime=wc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ih(t){var e;const n=t.auth,r=await t.getIdToken(),i=await No(t,EI(n,{idToken:r}));me(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?SI(s.providerUserInfo):[],a=yO(t.providerData,o),l=t.isAnonymous,u=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),d=l?u:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new dg(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function na(t){const e=Ye(t);await Ih(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function yO(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function SI(t){return t.map(e=>{var{providerId:n}=e,r=t_(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _O(t,e){const n=await vI(t,{},async()=>{const r=xu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=wI(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",_I.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function vO(t,e){return Qn(t,"POST","/v2/accounts:revokeToken",Tr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){me(e.idToken,"internal-error"),me(typeof e.idToken<"u","internal-error"),me(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):H0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){me(e.length!==0,"internal-error");const n=H0(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await _O(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Ca;return r&&(me(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(me(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(me(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ca,this.toJSON())}_performRefresh(){return wi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qi(t,e){me(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ei{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=t_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new gO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new dg(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await No(this,this.stsTokenManager.getToken(this.auth,e));return me(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return pO(this,e)}reload(){return na(this)}_assign(e){this!==e&&(me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ei(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Ih(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(gr(this.auth.app))return Promise.reject(Xr(this.auth));const e=await this.getIdToken();return await No(this,fO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,l,u,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,p=(i=n.email)!==null&&i!==void 0?i:void 0,y=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,T=(o=n.photoURL)!==null&&o!==void 0?o:void 0,E=(a=n.tenantId)!==null&&a!==void 0?a:void 0,R=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,w=(u=n.createdAt)!==null&&u!==void 0?u:void 0,v=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:b,emailVerified:D,isAnonymous:L,providerData:j,stsTokenManager:I}=n;me(b&&I,e,"internal-error");const _=Ca.fromJSON(this.name,I);me(typeof b=="string",e,"internal-error"),qi(h,e.name),qi(p,e.name),me(typeof D=="boolean",e,"internal-error"),me(typeof L=="boolean",e,"internal-error"),qi(y,e.name),qi(T,e.name),qi(E,e.name),qi(R,e.name),qi(w,e.name),qi(v,e.name);const C=new Ei({uid:b,auth:e,email:p,emailVerified:D,displayName:h,isAnonymous:L,photoURL:T,phoneNumber:y,tenantId:E,stsTokenManager:_,createdAt:w,lastLoginAt:v});return j&&Array.isArray(j)&&(C.providerData=j.map(A=>Object.assign({},A))),R&&(C._redirectEventId=R),C}static async _fromIdTokenResponse(e,n,r=!1){const i=new Ca;i.updateFromServerResponse(n);const s=new Ei({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Ih(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];me(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?SI(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new Ca;a.updateFromIdToken(r);const l=new Ei({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new dg(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G0=new Map;function Si(t){Pi(t instanceof Function,"Expected a class definition");let e=G0.get(t);return e?(Pi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,G0.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TI{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}TI.type="NONE";const K0=TI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jd(t,e,n){return`firebase:${t}:${e}:${n}`}class ka{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=jd(this.userKey,i.apiKey,s),this.fullPersistenceKey=jd("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ei._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ka(Si(K0),e,r);const i=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let s=i[0]||Si(K0);const o=jd(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const d=await u._get(o);if(d){const h=Ei._fromJSON(e,d);u!==s&&(a=h),s=u;break}}catch{}const l=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new ka(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new ka(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q0(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(CI(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xI(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(AI(e))return"Blackberry";if(PI(e))return"Webos";if(bI(e))return"Safari";if((e.includes("chrome/")||II(e))&&!e.includes("edge/"))return"Chrome";if(kI(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function xI(t=wn()){return/firefox\//i.test(t)}function bI(t=wn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function II(t=wn()){return/crios\//i.test(t)}function CI(t=wn()){return/iemobile/i.test(t)}function kI(t=wn()){return/android/i.test(t)}function AI(t=wn()){return/blackberry/i.test(t)}function PI(t=wn()){return/webos/i.test(t)}function o_(t=wn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function wO(t=wn()){var e;return o_(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function EO(){return j2()&&document.documentMode===10}function RI(t=wn()){return o_(t)||kI(t)||PI(t)||AI(t)||/windows phone/i.test(t)||CI(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NI(t,e=[]){let n;switch(t){case"Browser":n=Q0(wn());break;case"Worker":n=`${Q0(wn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${wl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TO(t,e={}){return Qn(t,"GET","/v2/passwordPolicy",Tr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xO=6;class bO{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:xO,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IO{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new J0(this),this.idTokenSubscription=new J0(this),this.beforeStateQueue=new SO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=gI,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Si(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await ka.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await EI(this,{idToken:e}),r=await Ei._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(gr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Ih(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=oO()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(gr(this.app))return Promise.reject(Xr(this));const n=e?Ye(e):null;return n&&me(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return gr(this.app)?Promise.reject(Xr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return gr(this.app)?Promise.reject(Xr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Si(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await TO(this),n=new bO(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Tu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await vO(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Si(e)||this._popupRedirectResolver;me(n,this,"argument-error"),this.redirectPersistenceManager=await ka.create(this,[Si(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(me(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=NI(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&rO(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function ai(t){return Ye(t)}class J0{constructor(e){this.auth=e,this.observer=null,this.addObserver=H2(n=>this.observer=n)}get next(){return me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ff={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function CO(t){ff=t}function DI(t){return ff.loadJS(t)}function kO(){return ff.recaptchaEnterpriseScript}function AO(){return ff.gapiScript}function PO(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const RO="recaptcha-enterprise",NO="NO_RECAPTCHA";class DO{constructor(e){this.type=RO,this.auth=ai(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{hO(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new dO(l);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;q0(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(NO)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&q0(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=kO();l.length!==0&&(l+=a),DI(l).then(()=>{i(a,s,o)}).catch(u=>{o(u)})}}).catch(a=>{o(a)})})}}async function Y0(t,e,n,r=!1){const i=new DO(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Ch(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Y0(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Y0(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OO(t,e){const n=e_(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Sh(s,e??{}))return i;or(i,"already-initialized")}return n.initialize({options:e})}function LO(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Si);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function MO(t,e,n){const r=ai(t);me(r._canInitEmulator,r,"emulator-config-failed"),me(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=OI(e),{host:o,port:a}=VO(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),jO()}function OI(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function VO(t){const e=OI(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:Z0(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:Z0(o)}}}function Z0(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function jO(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return wi("not implemented")}_getIdTokenResponse(e){return wi("not implemented")}_linkToIdToken(e,n){return wi("not implemented")}_getReauthenticationResolver(e){return wi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LI(t,e){return Qn(t,"POST","/v1/accounts:resetPassword",Tr(t,e))}async function FO(t,e){return Qn(t,"POST","/v1/accounts:update",e)}async function UO(t,e){return Qn(t,"POST","/v1/accounts:signUp",e)}async function $O(t,e){return Qn(t,"POST","/v1/accounts:update",Tr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BO(t,e){return Iu(t,"POST","/v1/accounts:signInWithPassword",Tr(t,e))}async function MI(t,e){return Qn(t,"POST","/v1/accounts:sendOobCode",Tr(t,e))}async function zO(t,e){return MI(t,e)}async function WO(t,e){return MI(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qO(t,e){return Iu(t,"POST","/v1/accounts:signInWithEmailLink",Tr(t,e))}async function HO(t,e){return Iu(t,"POST","/v1/accounts:signInWithEmailLink",Tr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jc extends a_{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Jc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Jc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ch(e,n,"signInWithPassword",BO);case"emailLink":return qO(e,{email:this._email,oobCode:this._password});default:or(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ch(e,r,"signUpPassword",UO);case"emailLink":return HO(e,{idToken:n,email:this._email,oobCode:this._password});default:or(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Aa(t,e){return Iu(t,"POST","/v1/accounts:signInWithIdp",Tr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GO="http://localhost";class Do extends a_{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Do(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):or("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=t_(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new Do(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Aa(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Aa(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Aa(e,n)}buildRequest(){const e={requestUri:GO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=xu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KO(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function QO(t){const e=ic(sc(t)).link,n=e?ic(sc(e)).deep_link_id:null,r=ic(sc(t)).deep_link_id;return(r?ic(sc(r)).link:null)||r||n||e||t}class l_{constructor(e){var n,r,i,s,o,a;const l=ic(sc(e)),u=(n=l.apiKey)!==null&&n!==void 0?n:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,h=KO((i=l.mode)!==null&&i!==void 0?i:null);me(u&&d&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=d,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=QO(e);try{return new l_(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ls{constructor(){this.providerId=Ls.PROVIDER_ID}static credential(e,n){return Jc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=l_.parseLink(n);return me(r,"argument-error"),Jc._fromEmailAndCode(e,r.code,r.tenantId)}}Ls.PROVIDER_ID="password";Ls.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ls.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu extends c_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts extends Cu{constructor(){super("facebook.com")}static credential(e){return Do._fromParams({providerId:ts.PROVIDER_ID,signInMethod:ts.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ts.credentialFromTaggedObject(e)}static credentialFromError(e){return ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ts.credential(e.oauthAccessToken)}catch{return null}}}ts.FACEBOOK_SIGN_IN_METHOD="facebook.com";ts.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr extends Cu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Do._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Jr.credentialFromTaggedObject(e)}static credentialFromError(e){return Jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Jr.credential(n,r)}catch{return null}}}Jr.GOOGLE_SIGN_IN_METHOD="google.com";Jr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns extends Cu{constructor(){super("github.com")}static credential(e){return Do._fromParams({providerId:ns.PROVIDER_ID,signInMethod:ns.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ns.credentialFromTaggedObject(e)}static credentialFromError(e){return ns.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ns.credential(e.oauthAccessToken)}catch{return null}}}ns.GITHUB_SIGN_IN_METHOD="github.com";ns.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs extends Cu{constructor(){super("twitter.com")}static credential(e,n){return Do._fromParams({providerId:rs.PROVIDER_ID,signInMethod:rs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return rs.credentialFromTaggedObject(e)}static credentialFromError(e){return rs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return rs.credential(n,r)}catch{return null}}}rs.TWITTER_SIGN_IN_METHOD="twitter.com";rs.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JO(t,e){return Iu(t,"POST","/v1/accounts:signUp",Tr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oo{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Ei._fromIdTokenResponse(e,r,i),o=X0(r);return new Oo({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=X0(r);return new Oo({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function X0(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh extends Fi{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,kh.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new kh(e,n,r,i)}}function VI(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?kh._fromErrorAndOperation(t,s,e,r):s})}async function YO(t,e,n=!1){const r=await No(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Oo._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jI(t,e,n=!1){const{auth:r}=t;if(gr(r.app))return Promise.reject(Xr(r));const i="reauthenticate";try{const s=await No(t,VI(r,i,e,t),n);me(s.idToken,r,"internal-error");const o=s_(s.idToken);me(o,r,"internal-error");const{sub:a}=o;return me(t.uid===a,r,"user-mismatch"),Oo._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&or(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FI(t,e,n=!1){if(gr(t.app))return Promise.reject(Xr(t));const r="signIn",i=await VI(t,r,e),s=await Oo._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function ZO(t,e){return FI(ai(t),e)}async function eE(t,e){return jI(Ye(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?d_._fromServerResponse(e,n):"totpInfo"in n?h_._fromServerResponse(e,n):or(e,"internal-error")}}class d_ extends u_{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new d_(n)}}class h_ extends u_{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new h_(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f_(t){const e=ai(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function XO(t,e,n){const r=ai(t);await Ch(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",WO)}async function eL(t,e,n){await LI(Ye(t),{oobCode:e,newPassword:n}).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&f_(t),r})}async function Rp(t,e){await $O(Ye(t),{oobCode:e})}async function UI(t,e){const n=Ye(t),r=await LI(n,{oobCode:e}),i=r.requestType;switch(me(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":me(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":me(r.mfaInfo,n,"internal-error");default:me(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=u_._fromServerResponse(ai(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function tL(t,e){const{data:n}=await UI(Ye(t),e);return n.email}async function nL(t,e,n){if(gr(t.app))return Promise.reject(Xr(t));const r=ai(t),o=await Ch(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",JO).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&f_(t),l}),a=await Oo._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function rL(t,e,n){return gr(t.app)?Promise.reject(Xr(t)):ZO(Ye(t),Ls.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&f_(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iL(t,e){return Qn(t,"POST","/v1/accounts:createAuthUri",Tr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Np(t,e){const n=yI()?bh():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:i}=await iL(Ye(t),r);return i||[]}async function tE(t,e){const n=Ye(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:s}=await zO(n.auth,i);s!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sL(t,e){return Qn(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nE(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Ye(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await No(r,sL(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function oL(t,e){const n=Ye(t);return gr(n.auth.app)?Promise.reject(Xr(n.auth)):$I(n,e,null)}function aL(t,e){return $I(Ye(t),null,e)}async function $I(t,e,n){const{auth:r}=t,s={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(s.email=e),n&&(s.password=n);const o=await No(t,FO(r,s));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lL(t,e){return Ye(t).setPersistence(e)}function cL(t,e,n,r){return Ye(t).onIdTokenChanged(e,n,r)}function uL(t,e,n){return Ye(t).beforeAuthStateChanged(e,n)}function dL(t,e,n,r){return Ye(t).onAuthStateChanged(e,n,r)}function Dp(t){return Ye(t).signOut()}async function hL(t){return Ye(t).delete()}const Ah="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BI{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Ah,"1"),this.storage.removeItem(Ah),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fL=1e3,pL=10;class zI extends BI{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=RI(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);EO()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,pL):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},fL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}zI.type="LOCAL";const WI=zI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qI extends BI{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}qI.type="SESSION";const HI=qI;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mL(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new pf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async u=>u(n.origin,s)),l=await mL(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}pf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p_(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gL{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const u=p_("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){const p=h;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(p.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(){return window}function yL(t){ei().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GI(){return typeof ei().WorkerGlobalScope<"u"&&typeof ei().importScripts=="function"}async function _L(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function vL(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function wL(){return GI()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KI="firebaseLocalStorageDb",EL=1,Ph="firebaseLocalStorage",QI="fbase_key";class ku{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function mf(t,e){return t.transaction([Ph],e?"readwrite":"readonly").objectStore(Ph)}function SL(){const t=indexedDB.deleteDatabase(KI);return new ku(t).toPromise()}function hg(){const t=indexedDB.open(KI,EL);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Ph,{keyPath:QI})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Ph)?e(r):(r.close(),await SL(),e(await hg()))})})}async function rE(t,e,n){const r=mf(t,!0).put({[QI]:e,value:n});return new ku(r).toPromise()}async function TL(t,e){const n=mf(t,!1).get(e),r=await new ku(n).toPromise();return r===void 0?null:r.value}function iE(t,e){const n=mf(t,!0).delete(e);return new ku(n).toPromise()}const xL=800,bL=3;class JI{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await hg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>bL)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return GI()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=pf._getInstance(wL()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await _L(),!this.activeServiceWorker)return;this.sender=new gL(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||vL()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await hg();return await rE(e,Ah,"1"),await iE(e,Ah),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>rE(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>TL(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>iE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=mf(i,!1).getAll();return new ku(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),xL)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}JI.type="LOCAL";const IL=JI;new bu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YI(t,e){return e?Si(e):(me(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_ extends a_{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Aa(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Aa(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Aa(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function CL(t){return FI(t.auth,new m_(t),t.bypassAuthState)}function kL(t){const{auth:e,user:n}=t;return me(n,e,"internal-error"),jI(n,new m_(t),t.bypassAuthState)}async function AL(t){const{auth:e,user:n}=t;return me(n,e,"internal-error"),YO(n,new m_(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return CL;case"linkViaPopup":case"linkViaRedirect":return AL;case"reauthViaPopup":case"reauthViaRedirect":return kL;default:or(this.auth,"internal-error")}}resolve(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PL=new bu(2e3,1e4);async function sE(t,e,n){if(gr(t.app))return Promise.reject(Vr(t,"operation-not-supported-in-this-environment"));const r=ai(t);iO(t,e,c_);const i=YI(r,n);return new oo(r,"signInViaPopup",e,i).executeNotNull()}class oo extends ZI{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,oo.currentPopupAction&&oo.currentPopupAction.cancel(),oo.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return me(e,this.auth,"internal-error"),e}async onExecution(){Pi(this.filter.length===1,"Popup operations only handle one event");const e=p_();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Vr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Vr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,oo.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Vr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,PL.get())};e()}}oo.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RL="pendingRedirect",Fd=new Map;class NL extends ZI{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Fd.get(this.auth._key());if(!e){try{const r=await DL(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Fd.set(this.auth._key(),e)}return this.bypassAuthState||Fd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function DL(t,e){const n=ML(e),r=LL(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function OL(t,e){Fd.set(t._key(),e)}function LL(t){return Si(t._redirectPersistence)}function ML(t){return jd(RL,t.config.apiKey,t.name)}async function VL(t,e,n=!1){if(gr(t.app))return Promise.reject(Xr(t));const r=ai(t),i=YI(r,e),o=await new NL(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jL=10*60*1e3;class FL{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!UL(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!XI(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Vr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=jL&&this.cachedEventUids.clear(),this.cachedEventUids.has(oE(e))}saveEventToCache(e){this.cachedEventUids.add(oE(e)),this.lastProcessedEventTime=Date.now()}}function oE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function XI({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function UL(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return XI(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $L(t,e={}){return Qn(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BL=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,zL=/^https?/;async function WL(t){if(t.config.emulator)return;const{authorizedDomains:e}=await $L(t);for(const n of e)try{if(qL(n))return}catch{}or(t,"unauthorized-domain")}function qL(t){const e=bh(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!zL.test(n))return!1;if(BL.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HL=new bu(3e4,6e4);function aE(){const t=ei().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function GL(t){return new Promise((e,n)=>{var r,i,s;function o(){aE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{aE(),n(Vr(t,"network-request-failed"))},timeout:HL.get()})}if(!((i=(r=ei().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ei().gapi)===null||s===void 0)&&s.load)o();else{const a=PO("iframefcb");return ei()[a]=()=>{gapi.load?o():n(Vr(t,"network-request-failed"))},DI(`${AO()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Ud=null,e})}let Ud=null;function KL(t){return Ud=Ud||GL(t),Ud}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QL=new bu(5e3,15e3),JL="__/auth/iframe",YL="emulator/auth/iframe",ZL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},XL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function eM(t){const e=t.config;me(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?i_(e,YL):`https://${t.config.authDomain}/${JL}`,r={apiKey:e.apiKey,appName:t.name,v:wl},i=XL.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${xu(r).slice(1)}`}async function tM(t){const e=await KL(t),n=ei().gapi;return me(n,t,"internal-error"),e.open({where:document.body,url:eM(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ZL,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Vr(t,"network-request-failed"),a=ei().setTimeout(()=>{s(o)},QL.get());function l(){ei().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},rM=500,iM=600,sM="_blank",oM="http://localhost";class lE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function aM(t,e,n,r=rM,i=iM){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},nM),{width:r.toString(),height:i.toString(),top:s,left:o}),u=wn().toLowerCase();n&&(a=II(u)?sM:n),xI(u)&&(e=e||oM,l.scrollbars="yes");const d=Object.entries(l).reduce((p,[y,T])=>`${p}${y}=${T},`,"");if(wO(u)&&a!=="_self")return lM(e||"",a),new lE(null);const h=window.open(e||"",a,d);me(h,t,"popup-blocked");try{h.focus()}catch{}return new lE(h)}function lM(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cM="__/auth/handler",uM="emulator/auth/handler",dM=encodeURIComponent("fac");async function cE(t,e,n,r,i,s){me(t.config.authDomain,t,"auth-domain-config-required"),me(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:wl,eventId:i};if(e instanceof c_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",q2(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))o[d]=h}if(e instanceof Cu){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),u=l?`#${dM}=${encodeURIComponent(l)}`:"";return`${hM(t)}?${xu(a).slice(1)}${u}`}function hM({config:t}){return t.emulator?i_(t,uM):`https://${t.authDomain}/${cM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Op="webStorageSupport";class fM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=HI,this._completeRedirectFn=VL,this._overrideRedirectResult=OL}async _openPopup(e,n,r,i){var s;Pi((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await cE(e,n,r,bh(),i);return aM(e,o,p_())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await cE(e,n,r,bh(),i);return yL(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Pi(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await tM(e),r=new FL(e);return n.register("authEvent",i=>(me(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Op,{type:Op},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Op];o!==void 0&&n(!!o),or(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=WL(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return RI()||bI()||o_()}}const pM=fM;var uE="@firebase/auth",dE="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gM(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function yM(t){nl(new Ro("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;me(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:NI(t)},u=new IO(r,i,s,l);return LO(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),nl(new Ro("auth-internal",e=>{const n=ai(e.getProvider("auth").getImmediate());return(r=>new mM(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ps(uE,dE,gM(t)),Ps(uE,dE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _M=5*60,vM=lI("authIdTokenMaxAge")||_M;let hE=null;const wM=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>vM)return;const i=n==null?void 0:n.token;hE!==i&&(hE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function EM(t=hI()){const e=e_(t,"auth");if(e.isInitialized())return e.getImmediate();const n=OO(t,{popupRedirectResolver:pM,persistence:[IL,WI,HI]}),r=lI("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=wM(s.toString());uL(n,o,()=>o(n.currentUser)),cL(n,a=>o(a))}}const i=oI("auth");return i&&MO(n,`http://${i}`),n}function SM(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}CO({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Vr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",SM().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});yM("Browser");var fE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var So,eC;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(I,_){function C(){}C.prototype=_.prototype,I.D=_.prototype,I.prototype=new C,I.prototype.constructor=I,I.C=function(A,k,x){for(var P=Array(arguments.length-2),he=2;he<arguments.length;he++)P[he-2]=arguments[he];return _.prototype[k].apply(A,P)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(I,_,C){C||(C=0);var A=Array(16);if(typeof _=="string")for(var k=0;16>k;++k)A[k]=_.charCodeAt(C++)|_.charCodeAt(C++)<<8|_.charCodeAt(C++)<<16|_.charCodeAt(C++)<<24;else for(k=0;16>k;++k)A[k]=_[C++]|_[C++]<<8|_[C++]<<16|_[C++]<<24;_=I.g[0],C=I.g[1],k=I.g[2];var x=I.g[3],P=_+(x^C&(k^x))+A[0]+3614090360&4294967295;_=C+(P<<7&4294967295|P>>>25),P=x+(k^_&(C^k))+A[1]+3905402710&4294967295,x=_+(P<<12&4294967295|P>>>20),P=k+(C^x&(_^C))+A[2]+606105819&4294967295,k=x+(P<<17&4294967295|P>>>15),P=C+(_^k&(x^_))+A[3]+3250441966&4294967295,C=k+(P<<22&4294967295|P>>>10),P=_+(x^C&(k^x))+A[4]+4118548399&4294967295,_=C+(P<<7&4294967295|P>>>25),P=x+(k^_&(C^k))+A[5]+1200080426&4294967295,x=_+(P<<12&4294967295|P>>>20),P=k+(C^x&(_^C))+A[6]+2821735955&4294967295,k=x+(P<<17&4294967295|P>>>15),P=C+(_^k&(x^_))+A[7]+4249261313&4294967295,C=k+(P<<22&4294967295|P>>>10),P=_+(x^C&(k^x))+A[8]+1770035416&4294967295,_=C+(P<<7&4294967295|P>>>25),P=x+(k^_&(C^k))+A[9]+2336552879&4294967295,x=_+(P<<12&4294967295|P>>>20),P=k+(C^x&(_^C))+A[10]+4294925233&4294967295,k=x+(P<<17&4294967295|P>>>15),P=C+(_^k&(x^_))+A[11]+2304563134&4294967295,C=k+(P<<22&4294967295|P>>>10),P=_+(x^C&(k^x))+A[12]+1804603682&4294967295,_=C+(P<<7&4294967295|P>>>25),P=x+(k^_&(C^k))+A[13]+4254626195&4294967295,x=_+(P<<12&4294967295|P>>>20),P=k+(C^x&(_^C))+A[14]+2792965006&4294967295,k=x+(P<<17&4294967295|P>>>15),P=C+(_^k&(x^_))+A[15]+1236535329&4294967295,C=k+(P<<22&4294967295|P>>>10),P=_+(k^x&(C^k))+A[1]+4129170786&4294967295,_=C+(P<<5&4294967295|P>>>27),P=x+(C^k&(_^C))+A[6]+3225465664&4294967295,x=_+(P<<9&4294967295|P>>>23),P=k+(_^C&(x^_))+A[11]+643717713&4294967295,k=x+(P<<14&4294967295|P>>>18),P=C+(x^_&(k^x))+A[0]+3921069994&4294967295,C=k+(P<<20&4294967295|P>>>12),P=_+(k^x&(C^k))+A[5]+3593408605&4294967295,_=C+(P<<5&4294967295|P>>>27),P=x+(C^k&(_^C))+A[10]+38016083&4294967295,x=_+(P<<9&4294967295|P>>>23),P=k+(_^C&(x^_))+A[15]+3634488961&4294967295,k=x+(P<<14&4294967295|P>>>18),P=C+(x^_&(k^x))+A[4]+3889429448&4294967295,C=k+(P<<20&4294967295|P>>>12),P=_+(k^x&(C^k))+A[9]+568446438&4294967295,_=C+(P<<5&4294967295|P>>>27),P=x+(C^k&(_^C))+A[14]+3275163606&4294967295,x=_+(P<<9&4294967295|P>>>23),P=k+(_^C&(x^_))+A[3]+4107603335&4294967295,k=x+(P<<14&4294967295|P>>>18),P=C+(x^_&(k^x))+A[8]+1163531501&4294967295,C=k+(P<<20&4294967295|P>>>12),P=_+(k^x&(C^k))+A[13]+2850285829&4294967295,_=C+(P<<5&4294967295|P>>>27),P=x+(C^k&(_^C))+A[2]+4243563512&4294967295,x=_+(P<<9&4294967295|P>>>23),P=k+(_^C&(x^_))+A[7]+1735328473&4294967295,k=x+(P<<14&4294967295|P>>>18),P=C+(x^_&(k^x))+A[12]+2368359562&4294967295,C=k+(P<<20&4294967295|P>>>12),P=_+(C^k^x)+A[5]+4294588738&4294967295,_=C+(P<<4&4294967295|P>>>28),P=x+(_^C^k)+A[8]+2272392833&4294967295,x=_+(P<<11&4294967295|P>>>21),P=k+(x^_^C)+A[11]+1839030562&4294967295,k=x+(P<<16&4294967295|P>>>16),P=C+(k^x^_)+A[14]+4259657740&4294967295,C=k+(P<<23&4294967295|P>>>9),P=_+(C^k^x)+A[1]+2763975236&4294967295,_=C+(P<<4&4294967295|P>>>28),P=x+(_^C^k)+A[4]+1272893353&4294967295,x=_+(P<<11&4294967295|P>>>21),P=k+(x^_^C)+A[7]+4139469664&4294967295,k=x+(P<<16&4294967295|P>>>16),P=C+(k^x^_)+A[10]+3200236656&4294967295,C=k+(P<<23&4294967295|P>>>9),P=_+(C^k^x)+A[13]+681279174&4294967295,_=C+(P<<4&4294967295|P>>>28),P=x+(_^C^k)+A[0]+3936430074&4294967295,x=_+(P<<11&4294967295|P>>>21),P=k+(x^_^C)+A[3]+3572445317&4294967295,k=x+(P<<16&4294967295|P>>>16),P=C+(k^x^_)+A[6]+76029189&4294967295,C=k+(P<<23&4294967295|P>>>9),P=_+(C^k^x)+A[9]+3654602809&4294967295,_=C+(P<<4&4294967295|P>>>28),P=x+(_^C^k)+A[12]+3873151461&4294967295,x=_+(P<<11&4294967295|P>>>21),P=k+(x^_^C)+A[15]+530742520&4294967295,k=x+(P<<16&4294967295|P>>>16),P=C+(k^x^_)+A[2]+3299628645&4294967295,C=k+(P<<23&4294967295|P>>>9),P=_+(k^(C|~x))+A[0]+4096336452&4294967295,_=C+(P<<6&4294967295|P>>>26),P=x+(C^(_|~k))+A[7]+1126891415&4294967295,x=_+(P<<10&4294967295|P>>>22),P=k+(_^(x|~C))+A[14]+2878612391&4294967295,k=x+(P<<15&4294967295|P>>>17),P=C+(x^(k|~_))+A[5]+4237533241&4294967295,C=k+(P<<21&4294967295|P>>>11),P=_+(k^(C|~x))+A[12]+1700485571&4294967295,_=C+(P<<6&4294967295|P>>>26),P=x+(C^(_|~k))+A[3]+2399980690&4294967295,x=_+(P<<10&4294967295|P>>>22),P=k+(_^(x|~C))+A[10]+4293915773&4294967295,k=x+(P<<15&4294967295|P>>>17),P=C+(x^(k|~_))+A[1]+2240044497&4294967295,C=k+(P<<21&4294967295|P>>>11),P=_+(k^(C|~x))+A[8]+1873313359&4294967295,_=C+(P<<6&4294967295|P>>>26),P=x+(C^(_|~k))+A[15]+4264355552&4294967295,x=_+(P<<10&4294967295|P>>>22),P=k+(_^(x|~C))+A[6]+2734768916&4294967295,k=x+(P<<15&4294967295|P>>>17),P=C+(x^(k|~_))+A[13]+1309151649&4294967295,C=k+(P<<21&4294967295|P>>>11),P=_+(k^(C|~x))+A[4]+4149444226&4294967295,_=C+(P<<6&4294967295|P>>>26),P=x+(C^(_|~k))+A[11]+3174756917&4294967295,x=_+(P<<10&4294967295|P>>>22),P=k+(_^(x|~C))+A[2]+718787259&4294967295,k=x+(P<<15&4294967295|P>>>17),P=C+(x^(k|~_))+A[9]+3951481745&4294967295,I.g[0]=I.g[0]+_&4294967295,I.g[1]=I.g[1]+(k+(P<<21&4294967295|P>>>11))&4294967295,I.g[2]=I.g[2]+k&4294967295,I.g[3]=I.g[3]+x&4294967295}r.prototype.u=function(I,_){_===void 0&&(_=I.length);for(var C=_-this.blockSize,A=this.B,k=this.h,x=0;x<_;){if(k==0)for(;x<=C;)i(this,I,x),x+=this.blockSize;if(typeof I=="string"){for(;x<_;)if(A[k++]=I.charCodeAt(x++),k==this.blockSize){i(this,A),k=0;break}}else for(;x<_;)if(A[k++]=I[x++],k==this.blockSize){i(this,A),k=0;break}}this.h=k,this.o+=_},r.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var _=1;_<I.length-8;++_)I[_]=0;var C=8*this.o;for(_=I.length-8;_<I.length;++_)I[_]=C&255,C/=256;for(this.u(I),I=Array(16),_=C=0;4>_;++_)for(var A=0;32>A;A+=8)I[C++]=this.g[_]>>>A&255;return I};function s(I,_){var C=a;return Object.prototype.hasOwnProperty.call(C,I)?C[I]:C[I]=_(I)}function o(I,_){this.h=_;for(var C=[],A=!0,k=I.length-1;0<=k;k--){var x=I[k]|0;A&&x==_||(C[k]=x,A=!1)}this.g=C}var a={};function l(I){return-128<=I&&128>I?s(I,function(_){return new o([_|0],0>_?-1:0)}):new o([I|0],0>I?-1:0)}function u(I){if(isNaN(I)||!isFinite(I))return h;if(0>I)return R(u(-I));for(var _=[],C=1,A=0;I>=C;A++)_[A]=I/C|0,C*=4294967296;return new o(_,0)}function d(I,_){if(I.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(I.charAt(0)=="-")return R(d(I.substring(1),_));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var C=u(Math.pow(_,8)),A=h,k=0;k<I.length;k+=8){var x=Math.min(8,I.length-k),P=parseInt(I.substring(k,k+x),_);8>x?(x=u(Math.pow(_,x)),A=A.j(x).add(u(P))):(A=A.j(C),A=A.add(u(P)))}return A}var h=l(0),p=l(1),y=l(16777216);t=o.prototype,t.m=function(){if(E(this))return-R(this).m();for(var I=0,_=1,C=0;C<this.g.length;C++){var A=this.i(C);I+=(0<=A?A:4294967296+A)*_,_*=4294967296}return I},t.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(T(this))return"0";if(E(this))return"-"+R(this).toString(I);for(var _=u(Math.pow(I,6)),C=this,A="";;){var k=D(C,_).g;C=w(C,k.j(_));var x=((0<C.g.length?C.g[0]:C.h)>>>0).toString(I);if(C=k,T(C))return x+A;for(;6>x.length;)x="0"+x;A=x+A}},t.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function T(I){if(I.h!=0)return!1;for(var _=0;_<I.g.length;_++)if(I.g[_]!=0)return!1;return!0}function E(I){return I.h==-1}t.l=function(I){return I=w(this,I),E(I)?-1:T(I)?0:1};function R(I){for(var _=I.g.length,C=[],A=0;A<_;A++)C[A]=~I.g[A];return new o(C,~I.h).add(p)}t.abs=function(){return E(this)?R(this):this},t.add=function(I){for(var _=Math.max(this.g.length,I.g.length),C=[],A=0,k=0;k<=_;k++){var x=A+(this.i(k)&65535)+(I.i(k)&65535),P=(x>>>16)+(this.i(k)>>>16)+(I.i(k)>>>16);A=P>>>16,x&=65535,P&=65535,C[k]=P<<16|x}return new o(C,C[C.length-1]&-2147483648?-1:0)};function w(I,_){return I.add(R(_))}t.j=function(I){if(T(this)||T(I))return h;if(E(this))return E(I)?R(this).j(R(I)):R(R(this).j(I));if(E(I))return R(this.j(R(I)));if(0>this.l(y)&&0>I.l(y))return u(this.m()*I.m());for(var _=this.g.length+I.g.length,C=[],A=0;A<2*_;A++)C[A]=0;for(A=0;A<this.g.length;A++)for(var k=0;k<I.g.length;k++){var x=this.i(A)>>>16,P=this.i(A)&65535,he=I.i(k)>>>16,we=I.i(k)&65535;C[2*A+2*k]+=P*we,v(C,2*A+2*k),C[2*A+2*k+1]+=x*we,v(C,2*A+2*k+1),C[2*A+2*k+1]+=P*he,v(C,2*A+2*k+1),C[2*A+2*k+2]+=x*he,v(C,2*A+2*k+2)}for(A=0;A<_;A++)C[A]=C[2*A+1]<<16|C[2*A];for(A=_;A<2*_;A++)C[A]=0;return new o(C,0)};function v(I,_){for(;(I[_]&65535)!=I[_];)I[_+1]+=I[_]>>>16,I[_]&=65535,_++}function b(I,_){this.g=I,this.h=_}function D(I,_){if(T(_))throw Error("division by zero");if(T(I))return new b(h,h);if(E(I))return _=D(R(I),_),new b(R(_.g),R(_.h));if(E(_))return _=D(I,R(_)),new b(R(_.g),_.h);if(30<I.g.length){if(E(I)||E(_))throw Error("slowDivide_ only works with positive integers.");for(var C=p,A=_;0>=A.l(I);)C=L(C),A=L(A);var k=j(C,1),x=j(A,1);for(A=j(A,2),C=j(C,2);!T(A);){var P=x.add(A);0>=P.l(I)&&(k=k.add(C),x=P),A=j(A,1),C=j(C,1)}return _=w(I,k.j(_)),new b(k,_)}for(k=h;0<=I.l(_);){for(C=Math.max(1,Math.floor(I.m()/_.m())),A=Math.ceil(Math.log(C)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),x=u(C),P=x.j(_);E(P)||0<P.l(I);)C-=A,x=u(C),P=x.j(_);T(x)&&(x=p),k=k.add(x),I=w(I,P)}return new b(k,I)}t.A=function(I){return D(this,I).h},t.and=function(I){for(var _=Math.max(this.g.length,I.g.length),C=[],A=0;A<_;A++)C[A]=this.i(A)&I.i(A);return new o(C,this.h&I.h)},t.or=function(I){for(var _=Math.max(this.g.length,I.g.length),C=[],A=0;A<_;A++)C[A]=this.i(A)|I.i(A);return new o(C,this.h|I.h)},t.xor=function(I){for(var _=Math.max(this.g.length,I.g.length),C=[],A=0;A<_;A++)C[A]=this.i(A)^I.i(A);return new o(C,this.h^I.h)};function L(I){for(var _=I.g.length+1,C=[],A=0;A<_;A++)C[A]=I.i(A)<<1|I.i(A-1)>>>31;return new o(C,I.h)}function j(I,_){var C=_>>5;_%=32;for(var A=I.g.length-C,k=[],x=0;x<A;x++)k[x]=0<_?I.i(x+C)>>>_|I.i(x+C+1)<<32-_:I.i(x+C);return new o(k,I.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,eC=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,So=o}).apply(typeof fE<"u"?fE:typeof self<"u"?self:typeof window<"u"?window:{});var wd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var tC,oc,nC,$d,fg,rC,iC,sC;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,f,g){return c==Array.prototype||c==Object.prototype||(c[f]=g.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof wd=="object"&&wd];for(var f=0;f<c.length;++f){var g=c[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function i(c,f){if(f)e:{var g=r;c=c.split(".");for(var S=0;S<c.length-1;S++){var V=c[S];if(!(V in g))break e;g=g[V]}c=c[c.length-1],S=g[c],f=f(S),f!=S&&f!=null&&e(g,c,{configurable:!0,writable:!0,value:f})}}function s(c,f){c instanceof String&&(c+="");var g=0,S=!1,V={next:function(){if(!S&&g<c.length){var U=g++;return{value:f(U,c[U]),done:!1}}return S=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}i("Array.prototype.values",function(c){return c||function(){return s(this,function(f,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(c){var f=typeof c;return f=f!="object"?f:c?Array.isArray(c)?"array":f:"null",f=="array"||f=="object"&&typeof c.length=="number"}function u(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function d(c,f,g){return c.call.apply(c.bind,arguments)}function h(c,f,g){if(!c)throw Error();if(2<arguments.length){var S=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,S),c.apply(f,V)}}return function(){return c.apply(f,arguments)}}function p(c,f,g){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,p.apply(null,arguments)}function y(c,f){var g=Array.prototype.slice.call(arguments,1);return function(){var S=g.slice();return S.push.apply(S,arguments),c.apply(this,S)}}function T(c,f){function g(){}g.prototype=f.prototype,c.aa=f.prototype,c.prototype=new g,c.prototype.constructor=c,c.Qb=function(S,V,U){for(var J=Array(arguments.length-2),st=2;st<arguments.length;st++)J[st-2]=arguments[st];return f.prototype[V].apply(S,J)}}function E(c){const f=c.length;if(0<f){const g=Array(f);for(let S=0;S<f;S++)g[S]=c[S];return g}return[]}function R(c,f){for(let g=1;g<arguments.length;g++){const S=arguments[g];if(l(S)){const V=c.length||0,U=S.length||0;c.length=V+U;for(let J=0;J<U;J++)c[V+J]=S[J]}else c.push(S)}}class w{constructor(f,g){this.i=f,this.j=g,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function v(c){return/^[\s\xa0]*$/.test(c)}function b(){var c=a.navigator;return c&&(c=c.userAgent)?c:""}function D(c){return D[" "](c),c}D[" "]=function(){};var L=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function j(c,f,g){for(const S in c)f.call(g,c[S],S,c)}function I(c,f){for(const g in c)f.call(void 0,c[g],g,c)}function _(c){const f={};for(const g in c)f[g]=c[g];return f}const C="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(c,f){let g,S;for(let V=1;V<arguments.length;V++){S=arguments[V];for(g in S)c[g]=S[g];for(let U=0;U<C.length;U++)g=C[U],Object.prototype.hasOwnProperty.call(S,g)&&(c[g]=S[g])}}function k(c){var f=1;c=c.split(":");const g=[];for(;0<f&&c.length;)g.push(c.shift()),f--;return c.length&&g.push(c.join(":")),g}function x(c){a.setTimeout(()=>{throw c},0)}function P(){var c=Q;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class he{constructor(){this.h=this.g=null}add(f,g){const S=we.get();S.set(f,g),this.h?this.h.next=S:this.g=S,this.h=S}}var we=new w(()=>new Ne,c=>c.reset());class Ne{constructor(){this.next=this.g=this.h=null}set(f,g){this.h=f,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let De,B=!1,Q=new he,fe=()=>{const c=a.Promise.resolve(void 0);De=()=>{c.then(ke)}};var ke=()=>{for(var c;c=P();){try{c.h.call(c.g)}catch(g){x(g)}var f=we;f.j(c),100>f.h&&(f.h++,c.next=f.g,f.g=c)}B=!1};function $e(){this.s=this.s,this.C=this.C}$e.prototype.s=!1,$e.prototype.ma=function(){this.s||(this.s=!0,this.N())},$e.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ze(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}Ze.prototype.h=function(){this.defaultPrevented=!0};var Gt=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};a.addEventListener("test",g,f),a.removeEventListener("test",g,f)}catch{}return c}();function Kt(c,f){if(Ze.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var g=this.type=c.type,S=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget){if(L){e:{try{D(f.nodeName);var V=!0;break e}catch{}V=!1}V||(f=null)}}else g=="mouseover"?f=c.fromElement:g=="mouseout"&&(f=c.toElement);this.relatedTarget=f,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:En[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Kt.aa.h.call(this)}}T(Kt,Ze);var En={2:"touch",3:"pen",4:"mouse"};Kt.prototype.h=function(){Kt.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Z="closure_listenable_"+(1e6*Math.random()|0),Te=0;function Ae(c,f,g,S,V){this.listener=c,this.proxy=null,this.src=f,this.type=g,this.capture=!!S,this.ha=V,this.key=++Te,this.da=this.fa=!1}function te(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function ve(c){this.src=c,this.g={},this.h=0}ve.prototype.add=function(c,f,g,S,V){var U=c.toString();c=this.g[U],c||(c=this.g[U]=[],this.h++);var J=ot(c,f,S,V);return-1<J?(f=c[J],g||(f.fa=!1)):(f=new Ae(f,this.src,U,!!S,V),f.fa=g,c.push(f)),f};function Ve(c,f){var g=f.type;if(g in c.g){var S=c.g[g],V=Array.prototype.indexOf.call(S,f,void 0),U;(U=0<=V)&&Array.prototype.splice.call(S,V,1),U&&(te(f),c.g[g].length==0&&(delete c.g[g],c.h--))}}function ot(c,f,g,S){for(var V=0;V<c.length;++V){var U=c[V];if(!U.da&&U.listener==f&&U.capture==!!g&&U.ha==S)return V}return-1}var Mt="closure_lm_"+(1e6*Math.random()|0),Jn={};function ge(c,f,g,S,V){if(Array.isArray(f)){for(var U=0;U<f.length;U++)ge(c,f[U],g,S,V);return null}return g=H(g),c&&c[Z]?c.K(f,g,u(S)?!!S.capture:!1,V):Qt(c,f,g,!1,S,V)}function Qt(c,f,g,S,V,U){if(!f)throw Error("Invalid event type");var J=u(V)?!!V.capture:!!V,st=Y(c);if(st||(c[Mt]=st=new ve(c)),g=st.add(f,g,S,J,U),g.proxy)return g;if(S=Hs(),g.proxy=S,S.src=c,S.listener=g,c.addEventListener)Gt||(V=J),V===void 0&&(V=!1),c.addEventListener(f.toString(),S,V);else if(c.attachEvent)c.attachEvent(F(f.toString()),S);else if(c.addListener&&c.removeListener)c.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return g}function Hs(){function c(g){return f.call(c.src,c.listener,g)}const f=$;return c}function Cl(c,f,g,S,V){if(Array.isArray(f))for(var U=0;U<f.length;U++)Cl(c,f[U],g,S,V);else S=u(S)?!!S.capture:!!S,g=H(g),c&&c[Z]?(c=c.i,f=String(f).toString(),f in c.g&&(U=c.g[f],g=ot(U,g,S,V),-1<g&&(te(U[g]),Array.prototype.splice.call(U,g,1),U.length==0&&(delete c.g[f],c.h--)))):c&&(c=Y(c))&&(f=c.g[f.toString()],c=-1,f&&(c=ot(f,g,S,V)),(g=-1<c?f[c]:null)&&O(g))}function O(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[Z])Ve(f.i,c);else{var g=c.type,S=c.proxy;f.removeEventListener?f.removeEventListener(g,S,c.capture):f.detachEvent?f.detachEvent(F(g),S):f.addListener&&f.removeListener&&f.removeListener(S),(g=Y(f))?(Ve(g,c),g.h==0&&(g.src=null,f[Mt]=null)):te(c)}}}function F(c){return c in Jn?Jn[c]:Jn[c]="on"+c}function $(c,f){if(c.da)c=!0;else{f=new Kt(f,this);var g=c.listener,S=c.ha||c.src;c.fa&&O(c),c=g.call(S,f)}return c}function Y(c){return c=c[Mt],c instanceof ve?c:null}var K="__closure_events_fn_"+(1e9*Math.random()>>>0);function H(c){return typeof c=="function"?c:(c[K]||(c[K]=function(f){return c.handleEvent(f)}),c[K])}function X(){$e.call(this),this.i=new ve(this),this.M=this,this.F=null}T(X,$e),X.prototype[Z]=!0,X.prototype.removeEventListener=function(c,f,g,S){Cl(this,c,f,g,S)};function Se(c,f){var g,S=c.F;if(S)for(g=[];S;S=S.F)g.push(S);if(c=c.M,S=f.type||f,typeof f=="string")f=new Ze(f,c);else if(f instanceof Ze)f.target=f.target||c;else{var V=f;f=new Ze(S,c),A(f,V)}if(V=!0,g)for(var U=g.length-1;0<=U;U--){var J=f.g=g[U];V=Ke(J,S,!0,f)&&V}if(J=f.g=c,V=Ke(J,S,!0,f)&&V,V=Ke(J,S,!1,f)&&V,g)for(U=0;U<g.length;U++)J=f.g=g[U],V=Ke(J,S,!1,f)&&V}X.prototype.N=function(){if(X.aa.N.call(this),this.i){var c=this.i,f;for(f in c.g){for(var g=c.g[f],S=0;S<g.length;S++)te(g[S]);delete c.g[f],c.h--}}this.F=null},X.prototype.K=function(c,f,g,S){return this.i.add(String(c),f,!1,g,S)},X.prototype.L=function(c,f,g,S){return this.i.add(String(c),f,!0,g,S)};function Ke(c,f,g,S){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();for(var V=!0,U=0;U<f.length;++U){var J=f[U];if(J&&!J.da&&J.capture==g){var st=J.listener,Jt=J.ha||J.src;J.fa&&Ve(c.i,J),V=st.call(Jt,S)!==!1&&V}}return V&&!S.defaultPrevented}function Sn(c,f,g){if(typeof c=="function")g&&(c=p(c,g));else if(c&&typeof c.handleEvent=="function")c=p(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(c,f||0)}function Gs(c){c.g=Sn(()=>{c.g=null,c.i&&(c.i=!1,Gs(c))},c.l);const f=c.h;c.h=null,c.m.apply(null,f)}class Br extends $e{constructor(f,g){super(),this.m=f,this.l=g,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Gs(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ks(c){$e.call(this),this.h=c,this.g={}}T(Ks,$e);var Wo=[];function qo(c){j(c.g,function(f,g){this.g.hasOwnProperty(g)&&O(f)},c),c.g={}}Ks.prototype.N=function(){Ks.aa.N.call(this),qo(this)},Ks.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var kl=a.JSON.stringify,ju=a.JSON.parse,Mf=class{stringify(c){return a.JSON.stringify(c,void 0)}parse(c){return a.JSON.parse(c,void 0)}};function Ho(){}Ho.prototype.h=null;function gv(c){return c.h||(c.h=c.i())}function yv(){}var Al={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Vf(){Ze.call(this,"d")}T(Vf,Ze);function jf(){Ze.call(this,"c")}T(jf,Ze);var Qs={},_v=null;function Fu(){return _v=_v||new X}Qs.La="serverreachability";function vv(c){Ze.call(this,Qs.La,c)}T(vv,Ze);function Pl(c){const f=Fu();Se(f,new vv(f))}Qs.STAT_EVENT="statevent";function wv(c,f){Ze.call(this,Qs.STAT_EVENT,c),this.stat=f}T(wv,Ze);function Tn(c){const f=Fu();Se(f,new wv(f,c))}Qs.Ma="timingevent";function Ev(c,f){Ze.call(this,Qs.Ma,c),this.size=f}T(Ev,Ze);function Rl(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){c()},f)}function Nl(){this.g=!0}Nl.prototype.xa=function(){this.g=!1};function FA(c,f,g,S,V,U){c.info(function(){if(c.g)if(U)for(var J="",st=U.split("&"),Jt=0;Jt<st.length;Jt++){var qe=st[Jt].split("=");if(1<qe.length){var ln=qe[0];qe=qe[1];var cn=ln.split("_");J=2<=cn.length&&cn[1]=="type"?J+(ln+"="+qe+"&"):J+(ln+"=redacted&")}}else J=null;else J=U;return"XMLHTTP REQ ("+S+") [attempt "+V+"]: "+f+`
`+g+`
`+J})}function UA(c,f,g,S,V,U,J){c.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+V+"]: "+f+`
`+g+`
`+U+" "+J})}function Go(c,f,g,S){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+BA(c,g)+(S?" "+S:"")})}function $A(c,f){c.info(function(){return"TIMEOUT: "+f})}Nl.prototype.info=function(){};function BA(c,f){if(!c.g)return f;if(!f)return null;try{var g=JSON.parse(f);if(g){for(c=0;c<g.length;c++)if(Array.isArray(g[c])){var S=g[c];if(!(2>S.length)){var V=S[1];if(Array.isArray(V)&&!(1>V.length)){var U=V[0];if(U!="noop"&&U!="stop"&&U!="close")for(var J=1;J<V.length;J++)V[J]=""}}}}return kl(g)}catch{return f}}var Uu={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Sv={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ff;function $u(){}T($u,Ho),$u.prototype.g=function(){return new XMLHttpRequest},$u.prototype.i=function(){return{}},Ff=new $u;function $i(c,f,g,S){this.j=c,this.i=f,this.l=g,this.R=S||1,this.U=new Ks(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Tv}function Tv(){this.i=null,this.g="",this.h=!1}var xv={},Uf={};function $f(c,f,g){c.L=1,c.v=qu(li(f)),c.m=g,c.P=!0,bv(c,null)}function bv(c,f){c.F=Date.now(),Bu(c),c.A=li(c.v);var g=c.A,S=c.R;Array.isArray(S)||(S=[String(S)]),Fv(g.i,"t",S),c.C=0,g=c.j.J,c.h=new Tv,c.g=rw(c.j,g?f:null,!c.m),0<c.O&&(c.M=new Br(p(c.Y,c,c.g),c.O)),f=c.U,g=c.g,S=c.ca;var V="readystatechange";Array.isArray(V)||(V&&(Wo[0]=V.toString()),V=Wo);for(var U=0;U<V.length;U++){var J=ge(g,V[U],S||f.handleEvent,!1,f.h||f);if(!J)break;f.g[J.key]=J}f=c.H?_(c.H):{},c.m?(c.u||(c.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,f)):(c.u="GET",c.g.ea(c.A,c.u,null,f)),Pl(),FA(c.i,c.u,c.A,c.l,c.R,c.m)}$i.prototype.ca=function(c){c=c.target;const f=this.M;f&&ci(c)==3?f.j():this.Y(c)},$i.prototype.Y=function(c){try{if(c==this.g)e:{const cn=ci(this.g);var f=this.g.Ba();const Jo=this.g.Z();if(!(3>cn)&&(cn!=3||this.g&&(this.h.h||this.g.oa()||Hv(this.g)))){this.J||cn!=4||f==7||(f==8||0>=Jo?Pl(3):Pl(2)),Bf(this);var g=this.g.Z();this.X=g;t:if(Iv(this)){var S=Hv(this.g);c="";var V=S.length,U=ci(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Js(this),Dl(this);var J="";break t}this.h.i=new a.TextDecoder}for(f=0;f<V;f++)this.h.h=!0,c+=this.h.i.decode(S[f],{stream:!(U&&f==V-1)});S.length=0,this.h.g+=c,this.C=0,J=this.h.g}else J=this.g.oa();if(this.o=g==200,UA(this.i,this.u,this.A,this.l,this.R,cn,g),this.o){if(this.T&&!this.K){t:{if(this.g){var st,Jt=this.g;if((st=Jt.g?Jt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(st)){var qe=st;break t}}qe=null}if(g=qe)Go(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,zf(this,g);else{this.o=!1,this.s=3,Tn(12),Js(this),Dl(this);break e}}if(this.P){g=!0;let br;for(;!this.J&&this.C<J.length;)if(br=zA(this,J),br==Uf){cn==4&&(this.s=4,Tn(14),g=!1),Go(this.i,this.l,null,"[Incomplete Response]");break}else if(br==xv){this.s=4,Tn(15),Go(this.i,this.l,J,"[Invalid Chunk]"),g=!1;break}else Go(this.i,this.l,br,null),zf(this,br);if(Iv(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),cn!=4||J.length!=0||this.h.h||(this.s=1,Tn(16),g=!1),this.o=this.o&&g,!g)Go(this.i,this.l,J,"[Invalid Chunked Response]"),Js(this),Dl(this);else if(0<J.length&&!this.W){this.W=!0;var ln=this.j;ln.g==this&&ln.ba&&!ln.M&&(ln.j.info("Great, no buffering proxy detected. Bytes received: "+J.length),Qf(ln),ln.M=!0,Tn(11))}}else Go(this.i,this.l,J,null),zf(this,J);cn==4&&Js(this),this.o&&!this.J&&(cn==4?Xv(this.j,this):(this.o=!1,Bu(this)))}else o1(this.g),g==400&&0<J.indexOf("Unknown SID")?(this.s=3,Tn(12)):(this.s=0,Tn(13)),Js(this),Dl(this)}}}catch{}finally{}};function Iv(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function zA(c,f){var g=c.C,S=f.indexOf(`
`,g);return S==-1?Uf:(g=Number(f.substring(g,S)),isNaN(g)?xv:(S+=1,S+g>f.length?Uf:(f=f.slice(S,S+g),c.C=S+g,f)))}$i.prototype.cancel=function(){this.J=!0,Js(this)};function Bu(c){c.S=Date.now()+c.I,Cv(c,c.I)}function Cv(c,f){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Rl(p(c.ba,c),f)}function Bf(c){c.B&&(a.clearTimeout(c.B),c.B=null)}$i.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?($A(this.i,this.A),this.L!=2&&(Pl(),Tn(17)),Js(this),this.s=2,Dl(this)):Cv(this,this.S-c)};function Dl(c){c.j.G==0||c.J||Xv(c.j,c)}function Js(c){Bf(c);var f=c.M;f&&typeof f.ma=="function"&&f.ma(),c.M=null,qo(c.U),c.g&&(f=c.g,c.g=null,f.abort(),f.ma())}function zf(c,f){try{var g=c.j;if(g.G!=0&&(g.g==c||Wf(g.h,c))){if(!c.K&&Wf(g.h,c)&&g.G==3){try{var S=g.Da.g.parse(f)}catch{S=null}if(Array.isArray(S)&&S.length==3){var V=S;if(V[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<c.F)Yu(g),Qu(g);else break e;Kf(g),Tn(18)}}else g.za=V[1],0<g.za-g.T&&37500>V[2]&&g.F&&g.v==0&&!g.C&&(g.C=Rl(p(g.Za,g),6e3));if(1>=Pv(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else Zs(g,11)}else if((c.K||g.g==c)&&Yu(g),!v(f))for(V=g.Da.g.parse(f),f=0;f<V.length;f++){let qe=V[f];if(g.T=qe[0],qe=qe[1],g.G==2)if(qe[0]=="c"){g.K=qe[1],g.ia=qe[2];const ln=qe[3];ln!=null&&(g.la=ln,g.j.info("VER="+g.la));const cn=qe[4];cn!=null&&(g.Aa=cn,g.j.info("SVER="+g.Aa));const Jo=qe[5];Jo!=null&&typeof Jo=="number"&&0<Jo&&(S=1.5*Jo,g.L=S,g.j.info("backChannelRequestTimeoutMs_="+S)),S=g;const br=c.g;if(br){const Xu=br.g?br.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Xu){var U=S.h;U.g||Xu.indexOf("spdy")==-1&&Xu.indexOf("quic")==-1&&Xu.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(qf(U,U.h),U.h=null))}if(S.D){const Jf=br.g?br.g.getResponseHeader("X-HTTP-Session-Id"):null;Jf&&(S.ya=Jf,ut(S.I,S.D,Jf))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-c.F,g.j.info("Handshake RTT: "+g.R+"ms")),S=g;var J=c;if(S.qa=nw(S,S.J?S.ia:null,S.W),J.K){Rv(S.h,J);var st=J,Jt=S.L;Jt&&(st.I=Jt),st.B&&(Bf(st),Bu(st)),S.g=J}else Yv(S);0<g.i.length&&Ju(g)}else qe[0]!="stop"&&qe[0]!="close"||Zs(g,7);else g.G==3&&(qe[0]=="stop"||qe[0]=="close"?qe[0]=="stop"?Zs(g,7):Gf(g):qe[0]!="noop"&&g.l&&g.l.ta(qe),g.v=0)}}Pl(4)}catch{}}var WA=class{constructor(c,f){this.g=c,this.map=f}};function kv(c){this.l=c||10,a.PerformanceNavigationTiming?(c=a.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Av(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Pv(c){return c.h?1:c.g?c.g.size:0}function Wf(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function qf(c,f){c.g?c.g.add(f):c.h=f}function Rv(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}kv.prototype.cancel=function(){if(this.i=Nv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Nv(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let f=c.i;for(const g of c.g.values())f=f.concat(g.D);return f}return E(c.i)}function qA(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(l(c)){for(var f=[],g=c.length,S=0;S<g;S++)f.push(c[S]);return f}f=[],g=0;for(S in c)f[g++]=c[S];return f}function HA(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(l(c)||typeof c=="string"){var f=[];c=c.length;for(var g=0;g<c;g++)f.push(g);return f}f=[],g=0;for(const S in c)f[g++]=S;return f}}}function Dv(c,f){if(c.forEach&&typeof c.forEach=="function")c.forEach(f,void 0);else if(l(c)||typeof c=="string")Array.prototype.forEach.call(c,f,void 0);else for(var g=HA(c),S=qA(c),V=S.length,U=0;U<V;U++)f.call(void 0,S[U],g&&g[U],c)}var Ov=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function GA(c,f){if(c){c=c.split("&");for(var g=0;g<c.length;g++){var S=c[g].indexOf("="),V=null;if(0<=S){var U=c[g].substring(0,S);V=c[g].substring(S+1)}else U=c[g];f(U,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function Ys(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Ys){this.h=c.h,zu(this,c.j),this.o=c.o,this.g=c.g,Wu(this,c.s),this.l=c.l;var f=c.i,g=new Ml;g.i=f.i,f.g&&(g.g=new Map(f.g),g.h=f.h),Lv(this,g),this.m=c.m}else c&&(f=String(c).match(Ov))?(this.h=!1,zu(this,f[1]||"",!0),this.o=Ol(f[2]||""),this.g=Ol(f[3]||"",!0),Wu(this,f[4]),this.l=Ol(f[5]||"",!0),Lv(this,f[6]||"",!0),this.m=Ol(f[7]||"")):(this.h=!1,this.i=new Ml(null,this.h))}Ys.prototype.toString=function(){var c=[],f=this.j;f&&c.push(Ll(f,Mv,!0),":");var g=this.g;return(g||f=="file")&&(c.push("//"),(f=this.o)&&c.push(Ll(f,Mv,!0),"@"),c.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&c.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(Ll(g,g.charAt(0)=="/"?JA:QA,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",Ll(g,ZA)),c.join("")};function li(c){return new Ys(c)}function zu(c,f,g){c.j=g?Ol(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function Wu(c,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);c.s=f}else c.s=null}function Lv(c,f,g){f instanceof Ml?(c.i=f,XA(c.i,c.h)):(g||(f=Ll(f,YA)),c.i=new Ml(f,c.h))}function ut(c,f,g){c.i.set(f,g)}function qu(c){return ut(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Ol(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Ll(c,f,g){return typeof c=="string"?(c=encodeURI(c).replace(f,KA),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function KA(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Mv=/[#\/\?@]/g,QA=/[#\?:]/g,JA=/[#\?]/g,YA=/[#\?@]/g,ZA=/#/g;function Ml(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function Bi(c){c.g||(c.g=new Map,c.h=0,c.i&&GA(c.i,function(f,g){c.add(decodeURIComponent(f.replace(/\+/g," ")),g)}))}t=Ml.prototype,t.add=function(c,f){Bi(this),this.i=null,c=Ko(this,c);var g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(f),this.h+=1,this};function Vv(c,f){Bi(c),f=Ko(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function jv(c,f){return Bi(c),f=Ko(c,f),c.g.has(f)}t.forEach=function(c,f){Bi(this),this.g.forEach(function(g,S){g.forEach(function(V){c.call(f,V,S,this)},this)},this)},t.na=function(){Bi(this);const c=Array.from(this.g.values()),f=Array.from(this.g.keys()),g=[];for(let S=0;S<f.length;S++){const V=c[S];for(let U=0;U<V.length;U++)g.push(f[S])}return g},t.V=function(c){Bi(this);let f=[];if(typeof c=="string")jv(this,c)&&(f=f.concat(this.g.get(Ko(this,c))));else{c=Array.from(this.g.values());for(let g=0;g<c.length;g++)f=f.concat(c[g])}return f},t.set=function(c,f){return Bi(this),this.i=null,c=Ko(this,c),jv(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},t.get=function(c,f){return c?(c=this.V(c),0<c.length?String(c[0]):f):f};function Fv(c,f,g){Vv(c,f),0<g.length&&(c.i=null,c.g.set(Ko(c,f),E(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],f=Array.from(this.g.keys());for(var g=0;g<f.length;g++){var S=f[g];const U=encodeURIComponent(String(S)),J=this.V(S);for(S=0;S<J.length;S++){var V=U;J[S]!==""&&(V+="="+encodeURIComponent(String(J[S]))),c.push(V)}}return this.i=c.join("&")};function Ko(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function XA(c,f){f&&!c.j&&(Bi(c),c.i=null,c.g.forEach(function(g,S){var V=S.toLowerCase();S!=V&&(Vv(this,S),Fv(this,V,g))},c)),c.j=f}function e1(c,f){const g=new Nl;if(a.Image){const S=new Image;S.onload=y(zi,g,"TestLoadImage: loaded",!0,f,S),S.onerror=y(zi,g,"TestLoadImage: error",!1,f,S),S.onabort=y(zi,g,"TestLoadImage: abort",!1,f,S),S.ontimeout=y(zi,g,"TestLoadImage: timeout",!1,f,S),a.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=c}else f(!1)}function t1(c,f){const g=new Nl,S=new AbortController,V=setTimeout(()=>{S.abort(),zi(g,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:S.signal}).then(U=>{clearTimeout(V),U.ok?zi(g,"TestPingServer: ok",!0,f):zi(g,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(V),zi(g,"TestPingServer: error",!1,f)})}function zi(c,f,g,S,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),S(g)}catch{}}function n1(){this.g=new Mf}function r1(c,f,g){const S=g||"";try{Dv(c,function(V,U){let J=V;u(V)&&(J=kl(V)),f.push(S+U+"="+encodeURIComponent(J))})}catch(V){throw f.push(S+"type="+encodeURIComponent("_badmap")),V}}function Hu(c){this.l=c.Ub||null,this.j=c.eb||!1}T(Hu,Ho),Hu.prototype.g=function(){return new Gu(this.l,this.j)},Hu.prototype.i=function(c){return function(){return c}}({});function Gu(c,f){X.call(this),this.D=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(Gu,X),t=Gu.prototype,t.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=f,this.readyState=1,jl(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(f.body=c),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Vl(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,jl(this)),this.g&&(this.readyState=3,jl(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Uv(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function Uv(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?Vl(this):jl(this),this.readyState==3&&Uv(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,Vl(this))},t.Qa=function(c){this.g&&(this.response=c,Vl(this))},t.ga=function(){this.g&&Vl(this)};function Vl(c){c.readyState=4,c.l=null,c.j=null,c.v=null,jl(c)}t.setRequestHeader=function(c,f){this.u.append(c,f)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],f=this.h.entries();for(var g=f.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=f.next();return c.join(`\r
`)};function jl(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Gu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function $v(c){let f="";return j(c,function(g,S){f+=S,f+=":",f+=g,f+=`\r
`}),f}function Hf(c,f,g){e:{for(S in g){var S=!1;break e}S=!0}S||(g=$v(g),typeof c=="string"?g!=null&&encodeURIComponent(String(g)):ut(c,f,g))}function xt(c){X.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(xt,X);var i1=/^https?$/i,s1=["POST","PUT"];t=xt.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,f,g,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ff.g(),this.v=this.o?gv(this.o):gv(Ff),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(U){Bv(this,U);return}if(c=g||"",g=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var V in S)g.set(V,S[V]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const U of S.keys())g.set(U,S.get(U));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(g.keys()).find(U=>U.toLowerCase()=="content-type"),V=a.FormData&&c instanceof a.FormData,!(0<=Array.prototype.indexOf.call(s1,f,void 0))||S||V||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[U,J]of g)this.g.setRequestHeader(U,J);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{qv(this),this.u=!0,this.g.send(c),this.u=!1}catch(U){Bv(this,U)}};function Bv(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.m=5,zv(c),Ku(c)}function zv(c){c.A||(c.A=!0,Se(c,"complete"),Se(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Se(this,"complete"),Se(this,"abort"),Ku(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ku(this,!0)),xt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Wv(this):this.bb())},t.bb=function(){Wv(this)};function Wv(c){if(c.h&&typeof o<"u"&&(!c.v[1]||ci(c)!=4||c.Z()!=2)){if(c.u&&ci(c)==4)Sn(c.Ea,0,c);else if(Se(c,"readystatechange"),ci(c)==4){c.h=!1;try{const J=c.Z();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var g;if(!(g=f)){var S;if(S=J===0){var V=String(c.D).match(Ov)[1]||null;!V&&a.self&&a.self.location&&(V=a.self.location.protocol.slice(0,-1)),S=!i1.test(V?V.toLowerCase():"")}g=S}if(g)Se(c,"complete"),Se(c,"success");else{c.m=6;try{var U=2<ci(c)?c.g.statusText:""}catch{U=""}c.l=U+" ["+c.Z()+"]",zv(c)}}finally{Ku(c)}}}}function Ku(c,f){if(c.g){qv(c);const g=c.g,S=c.v[0]?()=>{}:null;c.g=null,c.v=null,f||Se(c,"ready");try{g.onreadystatechange=S}catch{}}}function qv(c){c.I&&(a.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function ci(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<ci(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),ju(f)}};function Hv(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function o1(c){const f={};c=(c.g&&2<=ci(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<c.length;S++){if(v(c[S]))continue;var g=k(c[S]);const V=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const U=f[V]||[];f[V]=U,U.push(g)}I(f,function(S){return S.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Fl(c,f,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||f}function Gv(c){this.Aa=0,this.i=[],this.j=new Nl,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Fl("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Fl("baseRetryDelayMs",5e3,c),this.cb=Fl("retryDelaySeedMs",1e4,c),this.Wa=Fl("forwardChannelMaxRetries",2,c),this.wa=Fl("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new kv(c&&c.concurrentRequestLimit),this.Da=new n1,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Gv.prototype,t.la=8,t.G=1,t.connect=function(c,f,g,S){Tn(0),this.W=c,this.H=f||{},g&&S!==void 0&&(this.H.OSID=g,this.H.OAID=S),this.F=this.X,this.I=nw(this,null,this.W),Ju(this)};function Gf(c){if(Kv(c),c.G==3){var f=c.U++,g=li(c.I);if(ut(g,"SID",c.K),ut(g,"RID",f),ut(g,"TYPE","terminate"),Ul(c,g),f=new $i(c,c.j,f),f.L=2,f.v=qu(li(g)),g=!1,a.navigator&&a.navigator.sendBeacon)try{g=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!g&&a.Image&&(new Image().src=f.v,g=!0),g||(f.g=rw(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Bu(f)}tw(c)}function Qu(c){c.g&&(Qf(c),c.g.cancel(),c.g=null)}function Kv(c){Qu(c),c.u&&(a.clearTimeout(c.u),c.u=null),Yu(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&a.clearTimeout(c.s),c.s=null)}function Ju(c){if(!Av(c.h)&&!c.s){c.s=!0;var f=c.Ga;De||fe(),B||(De(),B=!0),Q.add(f,c),c.B=0}}function a1(c,f){return Pv(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=f.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Rl(p(c.Ga,c,f),ew(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const V=new $i(this,this.j,c);let U=this.o;if(this.S&&(U?(U=_(U),A(U,this.S)):U=this.S),this.m!==null||this.O||(V.H=U,U=null),this.P)e:{for(var f=0,g=0;g<this.i.length;g++){t:{var S=this.i[g];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(f+=S,4096<f){f=g;break e}if(f===4096||g===this.i.length-1){f=g+1;break e}}f=1e3}else f=1e3;f=Jv(this,V,f),g=li(this.I),ut(g,"RID",c),ut(g,"CVER",22),this.D&&ut(g,"X-HTTP-Session-Id",this.D),Ul(this,g),U&&(this.O?f="headers="+encodeURIComponent(String($v(U)))+"&"+f:this.m&&Hf(g,this.m,U)),qf(this.h,V),this.Ua&&ut(g,"TYPE","init"),this.P?(ut(g,"$req",f),ut(g,"SID","null"),V.T=!0,$f(V,g,null)):$f(V,g,f),this.G=2}}else this.G==3&&(c?Qv(this,c):this.i.length==0||Av(this.h)||Qv(this))};function Qv(c,f){var g;f?g=f.l:g=c.U++;const S=li(c.I);ut(S,"SID",c.K),ut(S,"RID",g),ut(S,"AID",c.T),Ul(c,S),c.m&&c.o&&Hf(S,c.m,c.o),g=new $i(c,c.j,g,c.B+1),c.m===null&&(g.H=c.o),f&&(c.i=f.D.concat(c.i)),f=Jv(c,g,1e3),g.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),qf(c.h,g),$f(g,S,f)}function Ul(c,f){c.H&&j(c.H,function(g,S){ut(f,S,g)}),c.l&&Dv({},function(g,S){ut(f,S,g)})}function Jv(c,f,g){g=Math.min(c.i.length,g);var S=c.l?p(c.l.Na,c.l,c):null;e:{var V=c.i;let U=-1;for(;;){const J=["count="+g];U==-1?0<g?(U=V[0].g,J.push("ofs="+U)):U=0:J.push("ofs="+U);let st=!0;for(let Jt=0;Jt<g;Jt++){let qe=V[Jt].g;const ln=V[Jt].map;if(qe-=U,0>qe)U=Math.max(0,V[Jt].g-100),st=!1;else try{r1(ln,J,"req"+qe+"_")}catch{S&&S(ln)}}if(st){S=J.join("&");break e}}}return c=c.i.splice(0,g),f.D=c,S}function Yv(c){if(!c.g&&!c.u){c.Y=1;var f=c.Fa;De||fe(),B||(De(),B=!0),Q.add(f,c),c.v=0}}function Kf(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Rl(p(c.Fa,c),ew(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,Zv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Rl(p(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Tn(10),Qu(this),Zv(this))};function Qf(c){c.A!=null&&(a.clearTimeout(c.A),c.A=null)}function Zv(c){c.g=new $i(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var f=li(c.qa);ut(f,"RID","rpc"),ut(f,"SID",c.K),ut(f,"AID",c.T),ut(f,"CI",c.F?"0":"1"),!c.F&&c.ja&&ut(f,"TO",c.ja),ut(f,"TYPE","xmlhttp"),Ul(c,f),c.m&&c.o&&Hf(f,c.m,c.o),c.L&&(c.g.I=c.L);var g=c.g;c=c.ia,g.L=1,g.v=qu(li(f)),g.m=null,g.P=!0,bv(g,c)}t.Za=function(){this.C!=null&&(this.C=null,Qu(this),Kf(this),Tn(19))};function Yu(c){c.C!=null&&(a.clearTimeout(c.C),c.C=null)}function Xv(c,f){var g=null;if(c.g==f){Yu(c),Qf(c),c.g=null;var S=2}else if(Wf(c.h,f))g=f.D,Rv(c.h,f),S=1;else return;if(c.G!=0){if(f.o)if(S==1){g=f.m?f.m.length:0,f=Date.now()-f.F;var V=c.B;S=Fu(),Se(S,new Ev(S,g)),Ju(c)}else Yv(c);else if(V=f.s,V==3||V==0&&0<f.X||!(S==1&&a1(c,f)||S==2&&Kf(c)))switch(g&&0<g.length&&(f=c.h,f.i=f.i.concat(g)),V){case 1:Zs(c,5);break;case 4:Zs(c,10);break;case 3:Zs(c,6);break;default:Zs(c,2)}}}function ew(c,f){let g=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(g*=2),g*f}function Zs(c,f){if(c.j.info("Error code "+f),f==2){var g=p(c.fb,c),S=c.Xa;const V=!S;S=new Ys(S||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||zu(S,"https"),qu(S),V?e1(S.toString(),g):t1(S.toString(),g)}else Tn(2);c.G=0,c.l&&c.l.sa(f),tw(c),Kv(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Tn(2)):(this.j.info("Failed to ping google.com"),Tn(1))};function tw(c){if(c.G=0,c.ka=[],c.l){const f=Nv(c.h);(f.length!=0||c.i.length!=0)&&(R(c.ka,f),R(c.ka,c.i),c.h.i.length=0,E(c.i),c.i.length=0),c.l.ra()}}function nw(c,f,g){var S=g instanceof Ys?li(g):new Ys(g);if(S.g!="")f&&(S.g=f+"."+S.g),Wu(S,S.s);else{var V=a.location;S=V.protocol,f=f?f+"."+V.hostname:V.hostname,V=+V.port;var U=new Ys(null);S&&zu(U,S),f&&(U.g=f),V&&Wu(U,V),g&&(U.l=g),S=U}return g=c.D,f=c.ya,g&&f&&ut(S,g,f),ut(S,"VER",c.la),Ul(c,S),S}function rw(c,f,g){if(f&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Ca&&!c.pa?new xt(new Hu({eb:g})):new xt(c.pa),f.Ha(c.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function iw(){}t=iw.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Zu(){}Zu.prototype.g=function(c,f){return new Yn(c,f)};function Yn(c,f){X.call(this),this.g=new Gv(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(c?c["X-WebChannel-Client-Profile"]=f.va:c={"X-WebChannel-Client-Profile":f.va}),this.g.S=c,(c=f&&f.Sb)&&!v(c)&&(this.g.m=c),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!v(f)&&(this.g.D=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new Qo(this)}T(Yn,X),Yn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Yn.prototype.close=function(){Gf(this.g)},Yn.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.u&&(g={},g.__data__=kl(c),c=g);f.i.push(new WA(f.Ya++,c)),f.G==3&&Ju(f)},Yn.prototype.N=function(){this.g.l=null,delete this.j,Gf(this.g),delete this.g,Yn.aa.N.call(this)};function sw(c){Vf.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(const g in f){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}T(sw,Vf);function ow(){jf.call(this),this.status=1}T(ow,jf);function Qo(c){this.g=c}T(Qo,iw),Qo.prototype.ua=function(){Se(this.g,"a")},Qo.prototype.ta=function(c){Se(this.g,new sw(c))},Qo.prototype.sa=function(c){Se(this.g,new ow)},Qo.prototype.ra=function(){Se(this.g,"b")},Zu.prototype.createWebChannel=Zu.prototype.g,Yn.prototype.send=Yn.prototype.o,Yn.prototype.open=Yn.prototype.m,Yn.prototype.close=Yn.prototype.close,sC=function(){return new Zu},iC=function(){return Fu()},rC=Qs,fg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Uu.NO_ERROR=0,Uu.TIMEOUT=8,Uu.HTTP_ERROR=6,$d=Uu,Sv.COMPLETE="complete",nC=Sv,yv.EventType=Al,Al.OPEN="a",Al.CLOSE="b",Al.ERROR="c",Al.MESSAGE="d",X.prototype.listen=X.prototype.K,oc=yv,xt.prototype.listenOnce=xt.prototype.L,xt.prototype.getLastError=xt.prototype.Ka,xt.prototype.getLastErrorCode=xt.prototype.Ba,xt.prototype.getStatus=xt.prototype.Z,xt.prototype.getResponseJson=xt.prototype.Oa,xt.prototype.getResponseText=xt.prototype.oa,xt.prototype.send=xt.prototype.ea,xt.prototype.setWithCredentials=xt.prototype.Ha,tC=xt}).apply(typeof wd<"u"?wd:typeof self<"u"?self:typeof window<"u"?window:{});const pE="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fn.UNAUTHENTICATED=new fn(null),fn.GOOGLE_CREDENTIALS=new fn("google-credentials-uid"),fn.FIRST_PARTY=new fn("first-party-uid"),fn.MOCK_USER=new fn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let El="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lo=new Zy("@firebase/firestore");function Ql(){return Lo.logLevel}function le(t,...e){if(Lo.logLevel<=Ue.DEBUG){const n=e.map(g_);Lo.debug(`Firestore (${El}): ${t}`,...n)}}function Ri(t,...e){if(Lo.logLevel<=Ue.ERROR){const n=e.map(g_);Lo.error(`Firestore (${El}): ${t}`,...n)}}function rl(t,...e){if(Lo.logLevel<=Ue.WARN){const n=e.map(g_);Lo.warn(`Firestore (${El}): ${t}`,...n)}}function g_(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ee(t="Unexpected state"){const e=`FIRESTORE (${El}) INTERNAL ASSERTION FAILED: `+t;throw Ri(e),new Error(e)}function nt(t,e){t||Ee()}function Ce(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class oe extends Fi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xi{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class TM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(fn.UNAUTHENTICATED))}shutdown(){}}class xM{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class bM{constructor(e){this.t=e,this.currentUser=fn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){nt(this.o===void 0);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new xi;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new xi,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{le("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(le("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new xi)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(le("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(nt(typeof r.accessToken=="string"),new oC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return nt(e===null||typeof e=="string"),new fn(e)}}class IM{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=fn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class CM{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new IM(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(fn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class kM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class AM{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){nt(this.o===void 0);const r=s=>{s.error!=null&&le("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,le("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{le("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):le("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(nt(typeof n.token=="string"),this.R=n.token,new kM(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PM(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=PM(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function He(t,e){return t<e?-1:t>e?1:0}function il(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new oe(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new oe(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new oe(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new oe(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return $t.fromMillis(Date.now())}static fromDate(e){return $t.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new $t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?He(this.nanoseconds,e.nanoseconds):He(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new xe(e)}static min(){return new xe(new $t(0,0))}static max(){return new xe(new $t(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ee(),r===void 0?r=e.length-n:r>e.length-n&&Ee(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Yc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Yc?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ft extends Yc{construct(e,n,r){return new ft(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new oe(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ft(n)}static emptyPath(){return new ft([])}}const RM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class en extends Yc{construct(e,n,r){return new en(e,n,r)}static isValidIdentifier(e){return RM.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),en.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new en(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new oe(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new oe(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new oe(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new oe(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new en(n)}static emptyPath(){return new en([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.path=e}static fromPath(e){return new pe(ft.fromString(e))}static fromName(e){return new pe(ft.fromString(e).popFirst(5))}static empty(){return new pe(ft.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ft.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ft.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new pe(new ft(e.slice()))}}function NM(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=xe.fromTimestamp(r===1e9?new $t(n+1,0):new $t(n,r));return new Ms(i,pe.empty(),e)}function DM(t){return new Ms(t.readTime,t.key,-1)}class Ms{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Ms(xe.min(),pe.empty(),-1)}static max(){return new Ms(xe.max(),pe.empty(),-1)}}function OM(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=pe.comparator(t.documentKey,e.documentKey),n!==0?n:He(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class MM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Au(t){if(t.code!==z.FAILED_PRECONDITION||t.message!==LM)throw t;le("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ee(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new W((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof W?n:W.resolve(n)}catch(n){return W.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):W.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):W.reject(n)}static resolve(e){return new W((n,r)=>{n(e)})}static reject(e){return new W((n,r)=>{r(e)})}static waitFor(e){return new W((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=W.resolve(!1);for(const r of e)n=n.next(i=>i?W.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new W((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;n(e[u]).next(d=>{o[u]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new W((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}function VM(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Pu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}y_.oe=-1;function gf(t){return t==null}function Rh(t){return t===0&&1/t==-1/0}function jM(t){return typeof t=="number"&&Number.isInteger(t)&&!Rh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function $o(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function lC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e,n){this.comparator=e,this.root=n||Zt.EMPTY}insert(e,n){return new Tt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Zt.BLACK,null,null))}remove(e){return new Tt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ed(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ed(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ed(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ed(this.root,e,this.comparator,!0)}}class Ed{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Zt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Zt.RED,this.left=i??Zt.EMPTY,this.right=s??Zt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Zt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Zt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Zt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Zt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Zt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ee();const e=this.left.check();if(e!==this.right.check())throw Ee();return e+(this.isRed()?0:1)}}Zt.EMPTY=null,Zt.RED=!0,Zt.BLACK=!1;Zt.EMPTY=new class{constructor(){this.size=0}get key(){throw Ee()}get value(){throw Ee()}get color(){throw Ee()}get left(){throw Ee()}get right(){throw Ee()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Zt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e){this.comparator=e,this.data=new Tt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new gE(this.data.getIterator())}getIteratorFrom(e){return new gE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof sn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new sn(this.comparator);return n.data=e,n}}class gE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e){this.fields=e,e.sort(en.comparator)}static empty(){return new rr([])}unionWith(e){let n=new sn(en.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new rr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return il(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class an{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new cC("Invalid base64 string: "+s):s}}(e);return new an(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new an(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return He(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}an.EMPTY_BYTE_STRING=new an("");const FM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vs(t){if(nt(!!t),typeof t=="string"){let e=0;const n=FM.exec(t);if(nt(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ct(t.seconds),nanos:Ct(t.nanos)}}function Ct(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Mo(t){return typeof t=="string"?an.fromBase64String(t):an.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function v_(t){const e=t.mapValue.fields.__previous_value__;return __(e)?v_(e):e}function Zc(t){const e=Vs(t.mapValue.fields.__local_write_time__.timestampValue);return new $t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(e,n,r,i,s,o,a,l,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class Xc{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Xc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Xc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sd={mapValue:{}};function Vo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?__(t)?4:BM(t)?9007199254740991:$M(t)?10:11:Ee()}function si(t,e){if(t===e)return!0;const n=Vo(t);if(n!==Vo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Zc(t).isEqual(Zc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Vs(i.timestampValue),a=Vs(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Mo(i.bytesValue).isEqual(Mo(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Ct(i.geoPointValue.latitude)===Ct(s.geoPointValue.latitude)&&Ct(i.geoPointValue.longitude)===Ct(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ct(i.integerValue)===Ct(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Ct(i.doubleValue),a=Ct(s.doubleValue);return o===a?Rh(o)===Rh(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return il(t.arrayValue.values||[],e.arrayValue.values||[],si);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(mE(o)!==mE(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!si(o[l],a[l])))return!1;return!0}(t,e);default:return Ee()}}function eu(t,e){return(t.values||[]).find(n=>si(n,e))!==void 0}function sl(t,e){if(t===e)return 0;const n=Vo(t),r=Vo(e);if(n!==r)return He(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return He(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Ct(s.integerValue||s.doubleValue),l=Ct(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return yE(t.timestampValue,e.timestampValue);case 4:return yE(Zc(t),Zc(e));case 5:return He(t.stringValue,e.stringValue);case 6:return function(s,o){const a=Mo(s),l=Mo(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const d=He(a[u],l[u]);if(d!==0)return d}return He(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=He(Ct(s.latitude),Ct(o.latitude));return a!==0?a:He(Ct(s.longitude),Ct(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return _E(t.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,u,d;const h=s.fields||{},p=o.fields||{},y=(a=h.value)===null||a===void 0?void 0:a.arrayValue,T=(l=p.value)===null||l===void 0?void 0:l.arrayValue,E=He(((u=y==null?void 0:y.values)===null||u===void 0?void 0:u.length)||0,((d=T==null?void 0:T.values)===null||d===void 0?void 0:d.length)||0);return E!==0?E:_E(y,T)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Sd.mapValue&&o===Sd.mapValue)return 0;if(s===Sd.mapValue)return 1;if(o===Sd.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const p=He(l[h],d[h]);if(p!==0)return p;const y=sl(a[l[h]],u[d[h]]);if(y!==0)return y}return He(l.length,d.length)}(t.mapValue,e.mapValue);default:throw Ee()}}function yE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return He(t,e);const n=Vs(t),r=Vs(e),i=He(n.seconds,r.seconds);return i!==0?i:He(n.nanos,r.nanos)}function _E(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=sl(n[i],r[i]);if(s)return s}return He(n.length,r.length)}function ol(t){return pg(t)}function pg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Vs(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Mo(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return pe.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=pg(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${pg(n.fields[o])}`;return i+"}"}(t.mapValue):Ee()}function vE(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function mg(t){return!!t&&"integerValue"in t}function w_(t){return!!t&&"arrayValue"in t}function wE(t){return!!t&&"nullValue"in t}function EE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Bd(t){return!!t&&"mapValue"in t}function $M(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Ec(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return $o(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ec(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ec(t.arrayValue.values[n]);return e}return Object.assign({},t)}function BM(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $n{constructor(e){this.value=e}static empty(){return new $n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Bd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ec(n)}setAll(e){let n=en.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Ec(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Bd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return si(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Bd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){$o(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new $n(Ec(this.value))}}function uC(t){const e=[];return $o(t.fields,(n,r)=>{const i=new en([n]);if(Bd(r)){const s=uC(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new rr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new gn(e,0,xe.min(),xe.min(),xe.min(),$n.empty(),0)}static newFoundDocument(e,n,r,i){return new gn(e,1,n,xe.min(),r,i,0)}static newNoDocument(e,n){return new gn(e,2,n,xe.min(),xe.min(),$n.empty(),0)}static newUnknownDocument(e,n){return new gn(e,3,n,xe.min(),xe.min(),$n.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=$n.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=$n.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof gn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new gn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(e,n){this.position=e,this.inclusive=n}}function SE(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=pe.comparator(pe.fromName(o.referenceValue),n.key):r=sl(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function TE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!si(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(e,n="asc"){this.field=e,this.dir=n}}function zM(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{}class Ot extends dC{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new qM(e,n,r):n==="array-contains"?new KM(e,r):n==="in"?new QM(e,r):n==="not-in"?new JM(e,r):n==="array-contains-any"?new YM(e,r):new Ot(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new HM(e,r):new GM(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(sl(n,this.value)):n!==null&&Vo(this.value)===Vo(n)&&this.matchesComparison(sl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ee()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $r extends dC{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new $r(e,n)}matches(e){return hC(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function hC(t){return t.op==="and"}function fC(t){return WM(t)&&hC(t)}function WM(t){for(const e of t.filters)if(e instanceof $r)return!1;return!0}function gg(t){if(t instanceof Ot)return t.field.canonicalString()+t.op.toString()+ol(t.value);if(fC(t))return t.filters.map(e=>gg(e)).join(",");{const e=t.filters.map(n=>gg(n)).join(",");return`${t.op}(${e})`}}function pC(t,e){return t instanceof Ot?function(r,i){return i instanceof Ot&&r.op===i.op&&r.field.isEqual(i.field)&&si(r.value,i.value)}(t,e):t instanceof $r?function(r,i){return i instanceof $r&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&pC(o,i.filters[a]),!0):!1}(t,e):void Ee()}function mC(t){return t instanceof Ot?function(n){return`${n.field.canonicalString()} ${n.op} ${ol(n.value)}`}(t):t instanceof $r?function(n){return n.op.toString()+" {"+n.getFilters().map(mC).join(" ,")+"}"}(t):"Filter"}class qM extends Ot{constructor(e,n,r){super(e,n,r),this.key=pe.fromName(r.referenceValue)}matches(e){const n=pe.comparator(e.key,this.key);return this.matchesComparison(n)}}class HM extends Ot{constructor(e,n){super(e,"in",n),this.keys=gC("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class GM extends Ot{constructor(e,n){super(e,"not-in",n),this.keys=gC("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function gC(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>pe.fromName(r.referenceValue))}class KM extends Ot{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return w_(n)&&eu(n.arrayValue,this.value)}}class QM extends Ot{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&eu(this.value.arrayValue,n)}}class JM extends Ot{constructor(e,n){super(e,"not-in",n)}matches(e){if(eu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!eu(this.value.arrayValue,n)}}class YM extends Ot{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!w_(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>eu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function xE(t,e=null,n=[],r=[],i=null,s=null,o=null){return new ZM(t,e,n,r,i,s,o)}function E_(t){const e=Ce(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>gg(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),gf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ol(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ol(r)).join(",")),e.ue=n}return e.ue}function S_(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!zM(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!pC(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!TE(t.startAt,e.startAt)&&TE(t.endAt,e.endAt)}function yg(t){return pe.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function XM(t,e,n,r,i,s,o,a){return new Sl(t,e,n,r,i,s,o,a)}function T_(t){return new Sl(t)}function bE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function yC(t){return t.collectionGroup!==null}function Sc(t){const e=Ce(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new sn(en.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new tu(s,r))}),n.has(en.keyField().canonicalString())||e.ce.push(new tu(en.keyField(),r))}return e.ce}function ti(t){const e=Ce(t);return e.le||(e.le=eV(e,Sc(t))),e.le}function eV(t,e){if(t.limitType==="F")return xE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new tu(i.field,s)});const n=t.endAt?new Nh(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Nh(t.startAt.position,t.startAt.inclusive):null;return xE(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function _g(t,e){const n=t.filters.concat([e]);return new Sl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function vg(t,e,n){return new Sl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function yf(t,e){return S_(ti(t),ti(e))&&t.limitType===e.limitType}function _C(t){return`${E_(ti(t))}|lt:${t.limitType}`}function ra(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>mC(i)).join(", ")}]`),gf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>ol(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>ol(i)).join(",")),`Target(${r})`}(ti(t))}; limitType=${t.limitType})`}function _f(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):pe.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Sc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const u=SE(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,Sc(r),i)||r.endAt&&!function(o,a,l){const u=SE(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,Sc(r),i))}(t,e)}function tV(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function vC(t){return(e,n)=>{let r=!1;for(const i of Sc(t)){const s=nV(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function nV(t,e,n){const r=t.field.isKeyField()?pe.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return l!==null&&u!==null?sl(l,u):Ee()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ee()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){$o(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return lC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rV=new Tt(pe.comparator);function Ni(){return rV}const wC=new Tt(pe.comparator);function ac(...t){let e=wC;for(const n of t)e=e.insert(n.key,n);return e}function EC(t){let e=wC;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ao(){return Tc()}function SC(){return Tc()}function Tc(){return new Tl(t=>t.toString(),(t,e)=>t.isEqual(e))}const iV=new Tt(pe.comparator),sV=new sn(pe.comparator);function Me(...t){let e=sV;for(const n of t)e=e.add(n);return e}const oV=new sn(He);function aV(){return oV}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x_(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rh(e)?"-0":e}}function TC(t){return{integerValue:""+t}}function lV(t,e){return jM(e)?TC(e):x_(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(){this._=void 0}}function cV(t,e,n){return t instanceof nu?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&__(s)&&(s=v_(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ru?bC(t,e):t instanceof iu?IC(t,e):function(i,s){const o=xC(i,s),a=IE(o)+IE(i.Pe);return mg(o)&&mg(i.Pe)?TC(a):x_(i.serializer,a)}(t,e)}function uV(t,e,n){return t instanceof ru?bC(t,e):t instanceof iu?IC(t,e):n}function xC(t,e){return t instanceof Dh?function(r){return mg(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class nu extends vf{}class ru extends vf{constructor(e){super(),this.elements=e}}function bC(t,e){const n=CC(e);for(const r of t.elements)n.some(i=>si(i,r))||n.push(r);return{arrayValue:{values:n}}}class iu extends vf{constructor(e){super(),this.elements=e}}function IC(t,e){let n=CC(e);for(const r of t.elements)n=n.filter(i=>!si(i,r));return{arrayValue:{values:n}}}class Dh extends vf{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function IE(t){return Ct(t.integerValue||t.doubleValue)}function CC(t){return w_(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dV{constructor(e,n){this.field=e,this.transform=n}}function hV(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ru&&i instanceof ru||r instanceof iu&&i instanceof iu?il(r.elements,i.elements,si):r instanceof Dh&&i instanceof Dh?si(r.Pe,i.Pe):r instanceof nu&&i instanceof nu}(t.transform,e.transform)}class fV{constructor(e,n){this.version=e,this.transformResults=n}}class jr{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new jr}static exists(e){return new jr(void 0,e)}static updateTime(e){return new jr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function zd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class wf{}function kC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new PC(t.key,jr.none()):new Ru(t.key,t.data,jr.none());{const n=t.data,r=$n.empty();let i=new sn(en.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Ws(t.key,r,new rr(i.toArray()),jr.none())}}function pV(t,e,n){t instanceof Ru?function(i,s,o){const a=i.value.clone(),l=kE(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Ws?function(i,s,o){if(!zd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=kE(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(AC(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function xc(t,e,n,r){return t instanceof Ru?function(s,o,a,l){if(!zd(s.precondition,o))return a;const u=s.value.clone(),d=AE(s.fieldTransforms,l,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ws?function(s,o,a,l){if(!zd(s.precondition,o))return a;const u=AE(s.fieldTransforms,l,o),d=o.data;return d.setAll(AC(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(s,o,a){return zd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function mV(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=xC(r.transform,i||null);s!=null&&(n===null&&(n=$n.empty()),n.set(r.field,s))}return n||null}function CE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&il(r,i,(s,o)=>hV(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ru extends wf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ws extends wf{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function AC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function kE(t,e,n){const r=new Map;nt(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,uV(o,a,n[i]))}return r}function AE(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,cV(s,o,e))}return r}class PC extends wf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gV extends wf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yV{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&pV(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=xc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=xc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=SC();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=kC(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(xe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Me())}isEqual(e){return this.batchId===e.batchId&&il(this.mutations,e.mutations,(n,r)=>CE(n,r))&&il(this.baseMutations,e.baseMutations,(n,r)=>CE(n,r))}}class b_{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){nt(e.mutations.length===r.length);let i=function(){return iV}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new b_(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _V{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vV{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rt,Be;function wV(t){switch(t){default:return Ee();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function RC(t){if(t===void 0)return Ri("GRPC error has no .code"),z.UNKNOWN;switch(t){case Rt.OK:return z.OK;case Rt.CANCELLED:return z.CANCELLED;case Rt.UNKNOWN:return z.UNKNOWN;case Rt.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case Rt.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case Rt.INTERNAL:return z.INTERNAL;case Rt.UNAVAILABLE:return z.UNAVAILABLE;case Rt.UNAUTHENTICATED:return z.UNAUTHENTICATED;case Rt.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case Rt.NOT_FOUND:return z.NOT_FOUND;case Rt.ALREADY_EXISTS:return z.ALREADY_EXISTS;case Rt.PERMISSION_DENIED:return z.PERMISSION_DENIED;case Rt.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case Rt.ABORTED:return z.ABORTED;case Rt.OUT_OF_RANGE:return z.OUT_OF_RANGE;case Rt.UNIMPLEMENTED:return z.UNIMPLEMENTED;case Rt.DATA_LOSS:return z.DATA_LOSS;default:return Ee()}}(Be=Rt||(Rt={}))[Be.OK=0]="OK",Be[Be.CANCELLED=1]="CANCELLED",Be[Be.UNKNOWN=2]="UNKNOWN",Be[Be.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Be[Be.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Be[Be.NOT_FOUND=5]="NOT_FOUND",Be[Be.ALREADY_EXISTS=6]="ALREADY_EXISTS",Be[Be.PERMISSION_DENIED=7]="PERMISSION_DENIED",Be[Be.UNAUTHENTICATED=16]="UNAUTHENTICATED",Be[Be.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Be[Be.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Be[Be.ABORTED=10]="ABORTED",Be[Be.OUT_OF_RANGE=11]="OUT_OF_RANGE",Be[Be.UNIMPLEMENTED=12]="UNIMPLEMENTED",Be[Be.INTERNAL=13]="INTERNAL",Be[Be.UNAVAILABLE=14]="UNAVAILABLE",Be[Be.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SV=new So([4294967295,4294967295],0);function PE(t){const e=EV().encode(t),n=new eC;return n.update(e),new Uint8Array(n.digest())}function RE(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new So([n,r],0),new So([i,s],0)]}class I_{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new lc(`Invalid padding: ${n}`);if(r<0)throw new lc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new lc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new lc(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=So.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(So.fromNumber(r)));return i.compare(SV)===1&&(i=new So([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=PE(e),[r,i]=RE(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new I_(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const n=PE(e),[r,i]=RE(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class lc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Nu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Ef(xe.min(),i,new Tt(He),Ni(),Me())}}class Nu{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Nu(r,n,Me(),Me(),Me())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wd{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class NC{constructor(e,n){this.targetId=e,this.me=n}}class DC{constructor(e,n,r=an.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class NE{constructor(){this.fe=0,this.ge=OE(),this.pe=an.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Me(),n=Me(),r=Me();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Ee()}}),new Nu(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=OE()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,nt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class TV{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ni(),this.qe=DE(),this.Qe=new Tt(He)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Ee()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(yg(s))if(r===0){const o=new pe(s.path);this.Ue(n,o,gn.newNoDocument(o,xe.min()))}else nt(r===1);else{const o=this.Ye(n);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(n);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=Mo(r).toUint8Array()}catch(l){if(l instanceof cC)return rl("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new I_(o,i,s)}catch(l){return rl(l instanceof lc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&yg(a.target)){const l=new pe(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,gn.newNoDocument(l,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=Me();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Ef(e,n,this.Qe,this.ke,r);return this.ke=Ni(),this.qe=DE(),this.Qe=new Tt(He),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new NE,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new sn(He),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||le("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new NE),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function DE(){return new Tt(pe.comparator)}function OE(){return new Tt(pe.comparator)}const xV={asc:"ASCENDING",desc:"DESCENDING"},bV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},IV={and:"AND",or:"OR"};class CV{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function wg(t,e){return t.useProto3Json||gf(e)?e:{value:e}}function Oh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function OC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function kV(t,e){return Oh(t,e.toTimestamp())}function ni(t){return nt(!!t),xe.fromTimestamp(function(n){const r=Vs(n);return new $t(r.seconds,r.nanos)}(t))}function C_(t,e){return Eg(t,e).canonicalString()}function Eg(t,e){const n=function(i){return new ft(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function LC(t){const e=ft.fromString(t);return nt(UC(e)),e}function Sg(t,e){return C_(t.databaseId,e.path)}function Lp(t,e){const n=LC(e);if(n.get(1)!==t.databaseId.projectId)throw new oe(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new oe(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new pe(VC(n))}function MC(t,e){return C_(t.databaseId,e)}function AV(t){const e=LC(t);return e.length===4?ft.emptyPath():VC(e)}function Tg(t){return new ft(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function VC(t){return nt(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function LE(t,e,n){return{name:Sg(t,e),fields:n.value.mapValue.fields}}function PV(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Ee()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(nt(d===void 0||typeof d=="string"),an.fromBase64String(d||"")):(nt(d===void 0||d instanceof Buffer||d instanceof Uint8Array),an.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const d=u.code===void 0?z.UNKNOWN:RC(u.code);return new oe(d,u.message||"")}(o);n=new DC(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Lp(t,r.document.name),s=ni(r.document.updateTime),o=r.document.createTime?ni(r.document.createTime):xe.min(),a=new $n({mapValue:{fields:r.document.fields}}),l=gn.newFoundDocument(i,s,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Wd(u,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Lp(t,r.document),s=r.readTime?ni(r.readTime):xe.min(),o=gn.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Wd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Lp(t,r.document),s=r.removedTargetIds||[];n=new Wd([],s,i,null)}else{if(!("filter"in e))return Ee();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new vV(i,s),a=r.targetId;n=new NC(a,o)}}return n}function RV(t,e){let n;if(e instanceof Ru)n={update:LE(t,e.key,e.value)};else if(e instanceof PC)n={delete:Sg(t,e.key)};else if(e instanceof Ws)n={update:LE(t,e.key,e.data),updateMask:UV(e.fieldMask)};else{if(!(e instanceof gV))return Ee();n={verify:Sg(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof nu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ru)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof iu)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Dh)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Ee()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:kV(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ee()}(t,e.precondition)),n}function NV(t,e){return t&&t.length>0?(nt(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?ni(i.updateTime):ni(s);return o.isEqual(xe.min())&&(o=ni(s)),new fV(o,i.transformResults||[])}(n,e))):[]}function DV(t,e){return{documents:[MC(t,e.path)]}}function OV(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=MC(t,i);const s=function(u){if(u.length!==0)return FC($r.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(u){if(u.length!==0)return u.map(d=>function(p){return{field:ia(p.field),direction:VV(p.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=wg(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:i}}function LV(t){let e=AV(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){nt(r===1);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(h){const p=jC(h);return p instanceof $r&&fC(p)?p.getFilters():[p]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(p=>function(T){return new tu(sa(T.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(p))}(n.orderBy));let a=null;n.limit&&(a=function(h){let p;return p=typeof h=="object"?h.value:h,gf(p)?null:p}(n.limit));let l=null;n.startAt&&(l=function(h){const p=!!h.before,y=h.values||[];return new Nh(y,p)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const p=!h.before,y=h.values||[];return new Nh(y,p)}(n.endAt)),XM(e,i,o,s,a,"F",l,u)}function MV(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ee()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function jC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=sa(n.unaryFilter.field);return Ot.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=sa(n.unaryFilter.field);return Ot.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=sa(n.unaryFilter.field);return Ot.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=sa(n.unaryFilter.field);return Ot.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Ee()}}(t):t.fieldFilter!==void 0?function(n){return Ot.create(sa(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ee()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return $r.create(n.compositeFilter.filters.map(r=>jC(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ee()}}(n.compositeFilter.op))}(t):Ee()}function VV(t){return xV[t]}function jV(t){return bV[t]}function FV(t){return IV[t]}function ia(t){return{fieldPath:t.canonicalString()}}function sa(t){return en.fromServerFormat(t.fieldPath)}function FC(t){return t instanceof Ot?function(n){if(n.op==="=="){if(EE(n.value))return{unaryFilter:{field:ia(n.field),op:"IS_NAN"}};if(wE(n.value))return{unaryFilter:{field:ia(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(EE(n.value))return{unaryFilter:{field:ia(n.field),op:"IS_NOT_NAN"}};if(wE(n.value))return{unaryFilter:{field:ia(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ia(n.field),op:jV(n.op),value:n.value}}}(t):t instanceof $r?function(n){const r=n.getFilters().map(i=>FC(i));return r.length===1?r[0]:{compositeFilter:{op:FV(n.op),filters:r}}}(t):Ee()}function UV(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function UC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e,n,r,i,s=xe.min(),o=xe.min(),a=an.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new gs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new gs(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new gs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new gs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $V{constructor(e){this.ct=e}}function BV(t){const e=LV({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?vg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zV{constructor(){this.un=new WV}addToCollectionParentIndex(e,n){return this.un.add(n),W.resolve()}getCollectionParents(e,n){return W.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return W.resolve()}deleteFieldIndex(e,n){return W.resolve()}deleteAllFieldIndexes(e){return W.resolve()}createTargetIndexes(e,n){return W.resolve()}getDocumentsMatchingTarget(e,n){return W.resolve(null)}getIndexType(e,n){return W.resolve(0)}getFieldIndexes(e,n){return W.resolve([])}getNextCollectionGroupToUpdate(e){return W.resolve(null)}getMinOffset(e,n){return W.resolve(Ms.min())}getMinOffsetFromCollectionGroup(e,n){return W.resolve(Ms.min())}updateCollectionGroup(e,n,r){return W.resolve()}updateIndexEntries(e,n){return W.resolve()}}class WV{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new sn(ft.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new sn(ft.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new al(0)}static kn(){return new al(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{constructor(){this.changes=new Tl(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,gn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?W.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HV{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GV{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&xc(r.mutation,i,rr.empty(),$t.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Me()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Me()){const i=ao();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=ac();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=ao();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Me()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Ni();const o=Tc(),a=function(){return Tc()}();return n.forEach((l,u)=>{const d=r.get(u.key);i.has(u.key)&&(d===void 0||d.mutation instanceof Ws)?s=s.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),xc(d.mutation,u,d.mutation.getFieldMask(),$t.now())):o.set(u.key,rr.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var h;return a.set(u,new HV(d,(h=o.get(u))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Tc();let i=new Tt((o,a)=>o-a),s=Me();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=n.get(l);if(u===null)return;let d=r.get(l)||rr.empty();d=a.applyToLocalView(u,d),r.set(l,d);const h=(i.get(a.batchId)||Me()).add(l);i=i.insert(a.batchId,h)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,d=l.value,h=SC();d.forEach(p=>{if(!s.has(p)){const y=kC(n.get(p),r.get(p));y!==null&&h.set(p,y),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return W.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return pe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):yC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):W.resolve(ao());let a=-1,l=s;return o.next(u=>W.forEach(u,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?W.resolve():this.remoteDocumentCache.getEntry(e,d).next(p=>{l=l.insert(d,p)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,Me())).next(d=>({batchId:a,changes:EC(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new pe(n)).next(r=>{let i=ac();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=ac();return this.indexManager.getCollectionParents(e,s).next(a=>W.forEach(a,l=>{const u=function(h,p){return new Sl(p,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((h,p)=>{o=o.insert(h,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,gn.newInvalidDocument(d)))});let a=ac();return o.forEach((l,u)=>{const d=s.get(l);d!==void 0&&xc(d.mutation,u,rr.empty(),$t.now()),_f(n,u)&&(a=a.insert(l,u))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KV{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return W.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:ni(i.createTime)}}(n)),W.resolve()}getNamedQuery(e,n){return W.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:BV(i.bundledQuery),readTime:ni(i.readTime)}}(n)),W.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QV{constructor(){this.overlays=new Tt(pe.comparator),this.Ir=new Map}getOverlay(e,n){return W.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ao();return W.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),W.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),W.resolve()}getOverlaysForCollection(e,n,r){const i=ao(),s=n.length+1,o=new pe(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return W.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Tt((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=s.get(u.largestBatchId);d===null&&(d=ao(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=ao(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return W.resolve(a)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new _V(n,r));let s=this.Ir.get(n);s===void 0&&(s=Me(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JV{constructor(){this.sessionToken=an.EMPTY_BYTE_STRING}getSessionToken(e){return W.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,W.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k_{constructor(){this.Tr=new sn(Wt.Er),this.dr=new sn(Wt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Wt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Wt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new pe(new ft([])),r=new Wt(n,e),i=new Wt(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new pe(new ft([])),r=new Wt(n,e),i=new Wt(n,e+1);let s=Me();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Wt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Wt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return pe.comparator(e.key,n.key)||He(e.wr,n.wr)}static Ar(e,n){return He(e.wr,n.wr)||pe.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new sn(Wt.Er)}checkEmpty(e){return W.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new yV(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.br=this.br.add(new Wt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return W.resolve(o)}lookupMutationBatch(e,n){return W.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return W.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return W.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return W.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Wt(n,0),i=new Wt(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const a=this.Dr(o.wr);s.push(a)}),W.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new sn(He);return n.forEach(i=>{const s=new Wt(i,0),o=new Wt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),W.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;pe.isDocumentKey(s)||(s=s.child(""));const o=new Wt(new pe(s),0);let a=new sn(He);return this.br.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.wr)),!0)},o),W.resolve(this.Cr(a))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){nt(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return W.forEach(n.mutations,i=>{const s=new Wt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Wt(n,0),i=this.br.firstAfterOrEqual(r);return W.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,W.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZV{constructor(e){this.Mr=e,this.docs=function(){return new Tt(pe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return W.resolve(r?r.document.mutableCopy():gn.newInvalidDocument(n))}getEntries(e,n){let r=Ni();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():gn.newInvalidDocument(i))}),W.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Ni();const o=n.path,a=new pe(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:d}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||OM(DM(d),r)<=0||(i.has(d.key)||_f(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return W.resolve(s)}getAllFromCollectionGroup(e,n,r,i){Ee()}Or(e,n){return W.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new XV(this)}getSize(e){return W.resolve(this.size)}}class XV extends qV{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),W.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ej{constructor(e){this.persistence=e,this.Nr=new Tl(n=>E_(n),S_),this.lastRemoteSnapshotVersion=xe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new k_,this.targetCount=0,this.kr=al.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),W.resolve()}getLastRemoteSnapshotVersion(e){return W.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return W.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),W.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),W.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new al(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,W.resolve()}updateTargetData(e,n){return this.Kn(n),W.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,W.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),W.waitFor(s).next(()=>i)}getTargetCount(e){return W.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return W.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),W.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),W.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),W.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return W.resolve(r)}containsKey(e,n){return W.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tj{constructor(e,n){this.qr={},this.overlays={},this.Qr=new y_(0),this.Kr=!1,this.Kr=!0,this.$r=new JV,this.referenceDelegate=e(this),this.Ur=new ej(this),this.indexManager=new zV,this.remoteDocumentCache=function(i){return new ZV(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new $V(n),this.Gr=new KV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new QV,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new YV(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){le("MemoryPersistence","Starting transaction:",e);const i=new nj(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return W.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class nj extends MM{constructor(e){super(),this.currentSequenceNumber=e}}class A_{constructor(e){this.persistence=e,this.Jr=new k_,this.Yr=null}static Zr(e){return new A_(e)}get Xr(){if(this.Yr)return this.Yr;throw Ee()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),W.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),W.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),W.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return W.forEach(this.Xr,r=>{const i=pe.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,xe.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return W.or([()=>W.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=Me(),i=Me();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new P_(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ij{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return F2()?8:VM(wn())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new rj;return this.Xi(e,n,o).next(a=>{if(s.result=a,this.zi)return this.es(e,n,o,a.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(Ql()<=Ue.DEBUG&&le("QueryEngine","SDK will not create cache indexes for query:",ra(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),W.resolve()):(Ql()<=Ue.DEBUG&&le("QueryEngine","Query:",ra(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Ql()<=Ue.DEBUG&&le("QueryEngine","The SDK decides to create cache indexes for query:",ra(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ti(n))):W.resolve())}Yi(e,n){if(bE(n))return W.resolve(null);let r=ti(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=vg(n,null,"F"),r=ti(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Me(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.ts(n,a);return this.ns(n,u,o,l.readTime)?this.Yi(e,vg(n,null,"F")):this.rs(e,u,n,l)}))})))}Zi(e,n,r,i){return bE(n)||i.isEqual(xe.min())?W.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?W.resolve(null):(Ql()<=Ue.DEBUG&&le("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ra(n)),this.rs(e,o,n,NM(i,-1)).next(a=>a))})}ts(e,n){let r=new sn(vC(e));return n.forEach((i,s)=>{_f(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return Ql()<=Ue.DEBUG&&le("QueryEngine","Using full collection scan to execute query:",ra(n)),this.Ji.getDocumentsMatchingQuery(e,n,Ms.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new Tt(He),this._s=new Tl(s=>E_(s),S_),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new GV(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function oj(t,e,n,r){return new sj(t,e,n,r)}async function $C(t,e){const n=Ce(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Me();for(const u of i){o.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}for(const u of s){a.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:a}))})})}function aj(t,e){const n=Ce(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,u,d){const h=u.batch,p=h.keys();let y=W.resolve();return p.forEach(T=>{y=y.next(()=>d.getEntry(l,T)).next(E=>{const R=u.docVersions.get(T);nt(R!==null),E.version.compareTo(R)<0&&(h.applyToRemoteDocument(E,u),E.isValidDocument()&&(E.setReadTime(u.commitVersion),d.addEntry(E)))})}),y.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Me();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function BC(t){const e=Ce(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function lj(t,e){const n=Ce(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const a=[];e.targetChanges.forEach((d,h)=>{const p=i.get(h);if(!p)return;a.push(n.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>n.Ur.addMatchingKeys(s,d.addedDocuments,h)));let y=p.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?y=y.withResumeToken(an.EMPTY_BYTE_STRING,xe.min()).withLastLimboFreeSnapshotVersion(xe.min()):d.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(d.resumeToken,r)),i=i.insert(h,y),function(E,R,w){return E.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(p,y,d)&&a.push(n.Ur.updateTargetData(s,y))});let l=Ni(),u=Me();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(cj(s,o,e.documentUpdates).next(d=>{l=d.Ps,u=d.Is})),!r.isEqual(xe.min())){const d=n.Ur.getLastRemoteSnapshotVersion(s).next(h=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return W.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(n.os=i,s))}function cj(t,e,n){let r=Me(),i=Me();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Ni();return n.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(xe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):le("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Ps:o,Is:i}})}function uj(t,e){const n=Ce(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function dj(t,e){const n=Ce(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,W.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new gs(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function xg(t,e,n){const r=Ce(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Pu(o))throw o;le("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function ME(t,e,n){const r=Ce(t);let i=xe.min(),s=Me();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,d){const h=Ce(l),p=h._s.get(d);return p!==void 0?W.resolve(h.os.get(p)):h.Ur.getTargetData(u,d)}(r,o,ti(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:xe.min(),n?s:Me())).next(a=>(hj(r,tV(e),a),{documents:a,Ts:s})))}function hj(t,e,n){let r=t.us.get(e)||xe.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class VE{constructor(){this.activeTargetIds=aV()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fj{constructor(){this.so=new VE,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new VE,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pj{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){le("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){le("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Td=null;function Mp(){return Td===null?Td=function(){return 268435456+Math.round(2147483648*Math.random())}():Td++,"0x"+Td.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gj{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hn="WebChannelConnection";class yj extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const a=Mp(),l=this.xo(n,r.toUriEncodedString());le("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(n,l,u,i).then(d=>(le("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw rl("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(n,r,i,s,o,a){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+El}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=mj[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=Mp();return new Promise((o,a)=>{const l=new tC;l.setWithCredentials(!0),l.listenOnce(nC.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case $d.NO_ERROR:const d=l.getResponseJson();le(hn,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case $d.TIMEOUT:le(hn,`RPC '${e}' ${s} timed out`),a(new oe(z.DEADLINE_EXCEEDED,"Request time out"));break;case $d.HTTP_ERROR:const h=l.getStatus();if(le(hn,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const y=p==null?void 0:p.error;if(y&&y.status&&y.message){const T=function(R){const w=R.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(w)>=0?w:z.UNKNOWN}(y.status);a(new oe(T,y.message))}else a(new oe(z.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new oe(z.UNAVAILABLE,"Connection failed."));break;default:Ee()}}finally{le(hn,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);le(hn,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",u,r,15)})}Bo(e,n,r){const i=Mp(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=sC(),a=iC(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=s.join("");le(hn,`Creating RPC '${e}' stream ${i}: ${d}`,l);const h=o.createWebChannel(d,l);let p=!1,y=!1;const T=new gj({Io:R=>{y?le(hn,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(p||(le(hn,`Opening RPC '${e}' stream ${i} transport.`),h.open(),p=!0),le(hn,`RPC '${e}' stream ${i} sending:`,R),h.send(R))},To:()=>h.close()}),E=(R,w,v)=>{R.listen(w,b=>{try{v(b)}catch(D){setTimeout(()=>{throw D},0)}})};return E(h,oc.EventType.OPEN,()=>{y||(le(hn,`RPC '${e}' stream ${i} transport opened.`),T.yo())}),E(h,oc.EventType.CLOSE,()=>{y||(y=!0,le(hn,`RPC '${e}' stream ${i} transport closed`),T.So())}),E(h,oc.EventType.ERROR,R=>{y||(y=!0,rl(hn,`RPC '${e}' stream ${i} transport errored:`,R),T.So(new oe(z.UNAVAILABLE,"The operation could not be completed")))}),E(h,oc.EventType.MESSAGE,R=>{var w;if(!y){const v=R.data[0];nt(!!v);const b=v,D=b.error||((w=b[0])===null||w===void 0?void 0:w.error);if(D){le(hn,`RPC '${e}' stream ${i} received error:`,D);const L=D.status;let j=function(C){const A=Rt[C];if(A!==void 0)return RC(A)}(L),I=D.message;j===void 0&&(j=z.INTERNAL,I="Unknown error status: "+L+" with message "+D.message),y=!0,T.So(new oe(j,I)),h.close()}else le(hn,`RPC '${e}' stream ${i} received:`,v),T.bo(v)}}),E(a,rC.STAT_EVENT,R=>{R.stat===fg.PROXY?le(hn,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===fg.NOPROXY&&le(hn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{T.wo()},0),T}}function Vp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sf(t){return new CV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&le("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e,n,r,i,s,o,a,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new zC(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===z.RESOURCE_EXHAUSTED?(Ri(n.toString()),Ri("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new oe(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return le("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(le("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class _j extends WC{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=PV(this.serializer,e),r=function(s){if(!("targetChange"in s))return xe.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?xe.min():o.readTime?ni(o.readTime):xe.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Tg(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=yg(l)?{documents:DV(s,l)}:{query:OV(s,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=OC(s,o.resumeToken);const u=wg(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(xe.min())>0){a.readTime=Oh(s,o.snapshotVersion.toTimestamp());const u=wg(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);const r=MV(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Tg(this.serializer),n.removeTarget=e,this.a_(n)}}class vj extends WC{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return nt(!!e.streamToken),this.lastStreamToken=e.streamToken,nt(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){nt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=NV(e.writeResults,e.commitTime),r=ni(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Tg(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>RV(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new oe(z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Eg(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new oe(z.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Eg(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new oe(z.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class Ej{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ri(n),this.D_=!1):le("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{Bo(this)&&(le("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=Ce(l);u.L_.add(4),await Du(u),u.q_.set("Unknown"),u.L_.delete(4),await Tf(u)}(this))})}),this.q_=new Ej(r,i)}}async function Tf(t){if(Bo(t))for(const e of t.B_)await e(!0)}async function Du(t){for(const e of t.B_)await e(!1)}function qC(t,e){const n=Ce(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),O_(n)?D_(n):xl(n).r_()&&N_(n,e))}function R_(t,e){const n=Ce(t),r=xl(n);n.N_.delete(e),r.r_()&&HC(n,e),n.N_.size===0&&(r.r_()?r.o_():Bo(n)&&n.q_.set("Unknown"))}function N_(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(xe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}xl(t).A_(e)}function HC(t,e){t.Q_.xe(e),xl(t).R_(e)}function D_(t){t.Q_=new TV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),xl(t).start(),t.q_.v_()}function O_(t){return Bo(t)&&!xl(t).n_()&&t.N_.size>0}function Bo(t){return Ce(t).L_.size===0}function GC(t){t.Q_=void 0}async function Tj(t){t.q_.set("Online")}async function xj(t){t.N_.forEach((e,n)=>{N_(t,e)})}async function bj(t,e){GC(t),O_(t)?(t.q_.M_(e),D_(t)):t.q_.set("Unknown")}async function Ij(t,e,n){if(t.q_.set("Online"),e instanceof DC&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.N_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))}(t,e)}catch(r){le("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Lh(t,r)}else if(e instanceof Wd?t.Q_.Ke(e):e instanceof NC?t.Q_.He(e):t.Q_.We(e),!n.isEqual(xe.min()))try{const r=await BC(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Q_.rt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.N_.get(u);d&&s.N_.set(u,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const d=s.N_.get(l);if(!d)return;s.N_.set(l,d.withResumeToken(an.EMPTY_BYTE_STRING,d.snapshotVersion)),HC(s,l);const h=new gs(d.target,l,u,d.sequenceNumber);N_(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){le("RemoteStore","Failed to raise snapshot:",r),await Lh(t,r)}}async function Lh(t,e,n){if(!Pu(e))throw e;t.L_.add(1),await Du(t),t.q_.set("Offline"),n||(n=()=>BC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{le("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Tf(t)})}function KC(t,e){return e().catch(n=>Lh(t,n,e))}async function xf(t){const e=Ce(t),n=js(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;Cj(e);)try{const i=await uj(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,kj(e,i)}catch(i){await Lh(e,i)}QC(e)&&JC(e)}function Cj(t){return Bo(t)&&t.O_.length<10}function kj(t,e){t.O_.push(e);const n=js(t);n.r_()&&n.V_&&n.m_(e.mutations)}function QC(t){return Bo(t)&&!js(t).n_()&&t.O_.length>0}function JC(t){js(t).start()}async function Aj(t){js(t).p_()}async function Pj(t){const e=js(t);for(const n of t.O_)e.m_(n.mutations)}async function Rj(t,e,n){const r=t.O_.shift(),i=b_.from(r,e,n);await KC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await xf(t)}async function Nj(t,e){e&&js(t).V_&&await async function(r,i){if(function(o){return wV(o)&&o!==z.ABORTED}(i.code)){const s=r.O_.shift();js(r).s_(),await KC(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await xf(r)}}(t,e),QC(t)&&JC(t)}async function FE(t,e){const n=Ce(t);n.asyncQueue.verifyOperationInProgress(),le("RemoteStore","RemoteStore received new credentials");const r=Bo(n);n.L_.add(3),await Du(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Tf(n)}async function Dj(t,e){const n=Ce(t);e?(n.L_.delete(2),await Tf(n)):e||(n.L_.add(2),await Du(n),n.q_.set("Unknown"))}function xl(t){return t.K_||(t.K_=function(n,r,i){const s=Ce(n);return s.w_(),new _j(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:Tj.bind(null,t),Ro:xj.bind(null,t),mo:bj.bind(null,t),d_:Ij.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),O_(t)?D_(t):t.q_.set("Unknown")):(await t.K_.stop(),GC(t))})),t.K_}function js(t){return t.U_||(t.U_=function(n,r,i){const s=Ce(n);return s.w_(),new vj(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Aj.bind(null,t),mo:Nj.bind(null,t),f_:Pj.bind(null,t),g_:Rj.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await xf(t)):(await t.U_.stop(),t.O_.length>0&&(le("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L_{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new xi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new L_(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new oe(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function M_(t,e){if(Ri("AsyncQueue",`${e}: ${t}`),Pu(t))return new oe(z.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pa{constructor(e){this.comparator=e?(n,r)=>e(n,r)||pe.comparator(n.key,r.key):(n,r)=>pe.comparator(n.key,r.key),this.keyedMap=ac(),this.sortedSet=new Tt(this.comparator)}static emptySet(e){return new Pa(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Pa)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Pa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE{constructor(){this.W_=new Tt(pe.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Ee():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class ll{constructor(e,n,r,i,s,o,a,l,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new ll(e,n,Pa.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class Lj{constructor(){this.queries=$E(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=Ce(n),s=i.queries;i.queries=$E(),s.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new oe(z.ABORTED,"Firestore shutting down"))}}function $E(){return new Tl(t=>_C(t),yf)}async function YC(t,e){const n=Ce(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new Oj,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=M_(o,`Initialization of query '${ra(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&V_(n)}async function ZC(t,e){const n=Ce(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Mj(t,e){const n=Ce(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&V_(n)}function Vj(t,e,n){const r=Ce(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function V_(t){t.Y_.forEach(e=>{e.next()})}var bg,BE;(BE=bg||(bg={})).ea="default",BE.Cache="cache";class XC{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new ll(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=ll.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==bg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e){this.key=e}}class tk{constructor(e){this.key=e}}class jj{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Me(),this.mutatedKeys=Me(),this.Aa=vC(e),this.Ra=new Pa(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new UE,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{const p=i.get(d),y=_f(this.query,h)?h:null,T=!!p&&this.mutatedKeys.has(p.key),E=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let R=!1;p&&y?p.data.isEqual(y.data)?T!==E&&(r.track({type:3,doc:y}),R=!0):this.ga(p,y)||(r.track({type:2,doc:y}),R=!0,(l&&this.Aa(y,l)>0||u&&this.Aa(y,u)<0)&&(a=!0)):!p&&y?(r.track({type:0,doc:y}),R=!0):p&&!y&&(r.track({type:1,doc:p}),R=!0,(l||u)&&(a=!0)),R&&(y?(o=o.add(y),s=E?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,h)=>function(y,T){const E=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ee()}};return E(y)-E(T)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(r),i=i!=null&&i;const a=n&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,u=l!==this.Ea;return this.Ea=l,o.length!==0||u?{snapshot:new ll(this.query,e.Ra,s,o,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new UE,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Me(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new tk(r))}),this.da.forEach(r=>{e.has(r)||n.push(new ek(r))}),n}ba(e){this.Ta=e.Ts,this.da=Me();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return ll.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class Fj{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Uj{constructor(e){this.key=e,this.va=!1}}class $j{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Tl(a=>_C(a),yf),this.Ma=new Map,this.xa=new Set,this.Oa=new Tt(pe.comparator),this.Na=new Map,this.La=new k_,this.Ba={},this.ka=new Map,this.qa=al.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Bj(t,e,n=!0){const r=ak(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await nk(r,e,n,!0),i}async function zj(t,e){const n=ak(t);await nk(n,e,!0,!1)}async function nk(t,e,n,r){const i=await dj(t.localStore,ti(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await Wj(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&qC(t.remoteStore,i),a}async function Wj(t,e,n,r,i){t.Ka=(h,p,y)=>async function(E,R,w,v){let b=R.view.ma(w);b.ns&&(b=await ME(E.localStore,R.query,!1).then(({documents:I})=>R.view.ma(I,b)));const D=v&&v.targetChanges.get(R.targetId),L=v&&v.targetMismatches.get(R.targetId)!=null,j=R.view.applyChanges(b,E.isPrimaryClient,D,L);return WE(E,R.targetId,j.wa),j.snapshot}(t,h,p,y);const s=await ME(t.localStore,e,!0),o=new jj(e,s.Ts),a=o.ma(s.documents),l=Nu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,l);WE(t,n,u.wa);const d=new Fj(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function qj(t,e,n){const r=Ce(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!yf(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await xg(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&R_(r.remoteStore,i.targetId),Ig(r,i.targetId)}).catch(Au)):(Ig(r,i.targetId),await xg(r.localStore,i.targetId,!0))}async function Hj(t,e){const n=Ce(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),R_(n.remoteStore,r.targetId))}async function Gj(t,e,n){const r=eF(t);try{const i=await function(o,a){const l=Ce(o),u=$t.now(),d=a.reduce((y,T)=>y.add(T.key),Me());let h,p;return l.persistence.runTransaction("Locally write mutations","readwrite",y=>{let T=Ni(),E=Me();return l.cs.getEntries(y,d).next(R=>{T=R,T.forEach((w,v)=>{v.isValidDocument()||(E=E.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(y,T)).next(R=>{h=R;const w=[];for(const v of a){const b=mV(v,h.get(v.key).overlayedDocument);b!=null&&w.push(new Ws(v.key,b,uC(b.value.mapValue),jr.exists(!0)))}return l.mutationQueue.addMutationBatch(y,u,w,a)}).next(R=>{p=R;const w=R.applyToLocalDocumentSet(h,E);return l.documentOverlayCache.saveOverlays(y,R.batchId,w)})}).then(()=>({batchId:p.batchId,changes:EC(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Ba[o.currentUser.toKey()];u||(u=new Tt(He)),u=u.insert(a,l),o.Ba[o.currentUser.toKey()]=u}(r,i.batchId,n),await Ou(r,i.changes),await xf(r.remoteStore)}catch(i){const s=M_(i,"Failed to persist write");n.reject(s)}}async function rk(t,e){const n=Ce(t);try{const r=await lj(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(nt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?nt(o.va):i.removedDocuments.size>0&&(nt(o.va),o.va=!1))}),await Ou(n,r,e)}catch(r){await Au(r)}}function zE(t,e,n){const r=Ce(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=Ce(o);l.onlineState=a;let u=!1;l.queries.forEach((d,h)=>{for(const p of h.j_)p.Z_(a)&&(u=!0)}),u&&V_(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function Kj(t,e,n){const r=Ce(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new Tt(pe.comparator);o=o.insert(s,gn.newNoDocument(s,xe.min()));const a=Me().add(s),l=new Ef(xe.min(),new Map,new Tt(He),o,a);await rk(r,l),r.Oa=r.Oa.remove(s),r.Na.delete(e),j_(r)}else await xg(r.localStore,e,!1).then(()=>Ig(r,e,n)).catch(Au)}async function Qj(t,e){const n=Ce(t),r=e.batch.batchId;try{const i=await aj(n.localStore,e);sk(n,r,null),ik(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ou(n,i)}catch(i){await Au(i)}}async function Jj(t,e,n){const r=Ce(t);try{const i=await function(o,a){const l=Ce(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,a).next(h=>(nt(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(u,h))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})}(r.localStore,e);sk(r,e,n),ik(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Ou(r,i)}catch(i){await Au(i)}}function ik(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function sk(t,e,n){const r=Ce(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Ig(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||ok(t,r)})}function ok(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(R_(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),j_(t))}function WE(t,e,n){for(const r of n)r instanceof ek?(t.La.addReference(r.key,e),Yj(t,r)):r instanceof tk?(le("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||ok(t,r.key)):Ee()}function Yj(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(le("SyncEngine","New document in limbo: "+n),t.xa.add(r),j_(t))}function j_(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new pe(ft.fromString(e)),r=t.qa.next();t.Na.set(r,new Uj(n)),t.Oa=t.Oa.insert(n,r),qC(t.remoteStore,new gs(ti(T_(n.path)),r,"TargetPurposeLimboResolution",y_.oe))}}async function Ou(t,e,n){const r=Ce(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const h=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(u){i.push(u);const h=P_.Wi(l.targetId,u);s.push(h)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(l,u){const d=Ce(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>W.forEach(u,p=>W.forEach(p.$i,y=>d.persistence.referenceDelegate.addReference(h,p.targetId,y)).next(()=>W.forEach(p.Ui,y=>d.persistence.referenceDelegate.removeReference(h,p.targetId,y)))))}catch(h){if(!Pu(h))throw h;le("LocalStore","Failed to update sequence numbers: "+h)}for(const h of u){const p=h.targetId;if(!h.fromCache){const y=d.os.get(p),T=y.snapshotVersion,E=y.withLastLimboFreeSnapshotVersion(T);d.os=d.os.insert(p,E)}}}(r.localStore,s))}async function Zj(t,e){const n=Ce(t);if(!n.currentUser.isEqual(e)){le("SyncEngine","User change. New user:",e.toKey());const r=await $C(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(l=>{l.reject(new oe(z.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ou(n,r.hs)}}function Xj(t,e){const n=Ce(t),r=n.Na.get(e);if(r&&r.va)return Me().add(r.key);{let i=Me();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const a=n.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function ak(t){const e=Ce(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=rk.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Xj.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Kj.bind(null,e),e.Ca.d_=Mj.bind(null,e.eventManager),e.Ca.$a=Vj.bind(null,e.eventManager),e}function eF(t){const e=Ce(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Qj.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Jj.bind(null,e),e}class Mh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Sf(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return oj(this.persistence,new ij,e.initialUser,this.serializer)}Ga(e){return new tj(A_.Zr,this.serializer)}Wa(e){return new fj}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Mh.provider={build:()=>new Mh};class Cg{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>zE(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Zj.bind(null,this.syncEngine),await Dj(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Lj}()}createDatastore(e){const n=Sf(e.databaseInfo.databaseId),r=function(s){return new yj(s)}(e.databaseInfo);return function(s,o,a,l){return new wj(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new Sj(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>zE(this.syncEngine,n,0),function(){return jE.D()?new jE:new pj}())}createSyncEngine(e,n){return function(i,s,o,a,l,u,d){const h=new $j(i,s,o,a,l,u);return d&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=Ce(i);le("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Du(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Cg.provider={build:()=>new Cg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ri("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=fn.UNAUTHENTICATED,this.clientId=aC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{le("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(le("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new xi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=M_(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function jp(t,e){t.asyncQueue.verifyOperationInProgress(),le("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await $C(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function qE(t,e){t.asyncQueue.verifyOperationInProgress();const n=await nF(t);le("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>FE(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>FE(e.remoteStore,i)),t._onlineComponents=e}async function nF(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){le("FirestoreClient","Using user provided OfflineComponentProvider");try{await jp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===z.FAILED_PRECONDITION||i.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;rl("Error using user provided cache. Falling back to memory cache: "+n),await jp(t,new Mh)}}else le("FirestoreClient","Using default OfflineComponentProvider"),await jp(t,new Mh);return t._offlineComponents}async function ck(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(le("FirestoreClient","Using user provided OnlineComponentProvider"),await qE(t,t._uninitializedComponentsProvider._online)):(le("FirestoreClient","Using default OnlineComponentProvider"),await qE(t,new Cg))),t._onlineComponents}function rF(t){return ck(t).then(e=>e.syncEngine)}async function uk(t){const e=await ck(t),n=e.eventManager;return n.onListen=Bj.bind(null,e.syncEngine),n.onUnlisten=qj.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=zj.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Hj.bind(null,e.syncEngine),n}function iF(t,e,n={}){const r=new xi;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const d=new lk({next:p=>{d.Za(),o.enqueueAndForget(()=>ZC(s,h));const y=p.docs.has(a);!y&&p.fromCache?u.reject(new oe(z.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&p.fromCache&&l&&l.source==="server"?u.reject(new oe(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),h=new XC(T_(a.path),d,{includeMetadataChanges:!0,_a:!0});return YC(s,h)}(await uk(t),t.asyncQueue,e,n,r)),r.promise}function sF(t,e,n={}){const r=new xi;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,u){const d=new lk({next:p=>{d.Za(),o.enqueueAndForget(()=>ZC(s,h)),p.fromCache&&l.source==="server"?u.reject(new oe(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),h=new XC(a,d,{includeMetadataChanges:!0,_a:!0});return YC(s,h)}(await uk(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dk(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(t,e,n){if(!n)throw new oe(z.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function oF(t,e,n,r){if(e===!0&&r===!0)throw new oe(z.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function GE(t){if(!pe.isDocumentKey(t))throw new oe(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function KE(t){if(pe.isDocumentKey(t))throw new oe(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function bf(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ee()}function oi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new oe(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=bf(t);throw new oe(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QE{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new oe(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new oe(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}oF("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=dk((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new oe(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new oe(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new oe(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class If{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new QE({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new oe(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new oe(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new QE(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new TM;switch(r.type){case"firstParty":return new CM(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new oe(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=HE.get(n);r&&(le("ComponentProvider","Removing Datastore"),HE.delete(n),r.terminate())}(this),Promise.resolve()}}function aF(t,e,n,r={}){var i;const s=(t=oi(t,If))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&rl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=fn.MOCK_USER;else{a=N2(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new oe(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new fn(u)}t._authCredentials=new xM(new oC(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new zo(this.firestore,e,this._query)}}class Rn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Rs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Rn(this.firestore,e,this._key)}}class Rs extends zo{constructor(e,n,r){super(e,n,T_(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Rn(this.firestore,null,new pe(e))}withConverter(e){return new Rs(this.firestore,e,this._path)}}function fk(t,e,...n){if(t=Ye(t),hk("collection","path",e),t instanceof If){const r=ft.fromString(e,...n);return KE(r),new Rs(t,null,r)}{if(!(t instanceof Rn||t instanceof Rs))throw new oe(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ft.fromString(e,...n));return KE(r),new Rs(t.firestore,null,r)}}function To(t,e,...n){if(t=Ye(t),arguments.length===1&&(e=aC.newId()),hk("doc","path",e),t instanceof If){const r=ft.fromString(e,...n);return GE(r),new Rn(t,null,new pe(r))}{if(!(t instanceof Rn||t instanceof Rs))throw new oe(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ft.fromString(e,...n));return GE(r),new Rn(t.firestore,t instanceof Rs?t.converter:null,new pe(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JE{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new zC(this,"async_queue_retry"),this.Vu=()=>{const r=Vp();r&&le("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Vp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Vp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new xi;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Pu(e))throw e;le("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Ri("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=L_.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Ee()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class bl extends If{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new JE,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new JE(e),this._firestoreClient=void 0,await e}}}function lF(t,e){const n=typeof t=="object"?t:hI(),r=typeof t=="string"?t:"(default)",i=e_(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=P2("firestore");s&&aF(i,...s)}return i}function F_(t){if(t._terminated)throw new oe(z.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||cF(t),t._firestoreClient}function cF(t){var e,n,r;const i=t._freezeSettings(),s=function(a,l,u,d){return new UM(a,l,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,dk(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new tF(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cl(an.fromBase64String(e))}catch(n){throw new oe(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new cl(an.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new oe(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new en(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kf{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U_{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new oe(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new oe(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return He(this._lat,e._lat)||He(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $_{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uF=/^__.*__$/;class dF{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ws(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ru(e,this.data,n,this.fieldTransforms)}}class pk{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ws(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function mk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ee()}}class B_{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new B_(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Vh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(mk(this.Cu)&&uF.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class hF{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Sf(e)}Qu(e,n,r,i=!1){return new B_({Cu:e,methodName:n,qu:r,path:en.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Af(t){const e=t._freezeSettings(),n=Sf(t._databaseId);return new hF(t._databaseId,!!e.ignoreUndefinedProperties,n)}function gk(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);W_("Data must be an object, but it was:",o,r);const a=yk(r,o);let l,u;if(s.merge)l=new rr(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const h of s.mergeFields){const p=kg(e,h,n);if(!o.contains(p))throw new oe(z.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);vk(d,p)||d.push(p)}l=new rr(d),u=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,u=o.fieldTransforms;return new dF(new $n(a),l,u)}class Lu extends kf{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Lu}}class z_ extends kf{_toFieldTransform(e){return new dV(e.path,new nu)}isEqual(e){return e instanceof z_}}function fF(t,e,n,r){const i=t.Qu(1,e,n);W_("Data must be an object, but it was:",i,r);const s=[],o=$n.empty();$o(r,(l,u)=>{const d=q_(e,l,n);u=Ye(u);const h=i.Nu(d);if(u instanceof Lu)s.push(d);else{const p=Mu(u,h);p!=null&&(s.push(d),o.set(d,p))}});const a=new rr(s);return new pk(o,a,i.fieldTransforms)}function pF(t,e,n,r,i,s){const o=t.Qu(1,e,n),a=[kg(e,r,n)],l=[i];if(s.length%2!=0)throw new oe(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(kg(e,s[p])),l.push(s[p+1]);const u=[],d=$n.empty();for(let p=a.length-1;p>=0;--p)if(!vk(u,a[p])){const y=a[p];let T=l[p];T=Ye(T);const E=o.Nu(y);if(T instanceof Lu)u.push(y);else{const R=Mu(T,E);R!=null&&(u.push(y),d.set(y,R))}}const h=new rr(u);return new pk(d,h,o.fieldTransforms)}function mF(t,e,n,r=!1){return Mu(n,t.Qu(r?4:3,e))}function Mu(t,e){if(_k(t=Ye(t)))return W_("Unsupported field value:",e,t),yk(t,e);if(t instanceof kf)return function(r,i){if(!mk(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=Mu(a,i.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Ye(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return lV(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=$t.fromDate(r);return{timestampValue:Oh(i.serializer,s)}}if(r instanceof $t){const s=new $t(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Oh(i.serializer,s)}}if(r instanceof U_)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof cl)return{bytesValue:OC(i.serializer,r._byteString)};if(r instanceof Rn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:C_(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof $_)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return x_(a.serializer,l)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${bf(r)}`)}(t,e)}function yk(t,e){const n={};return lC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):$o(t,(r,i)=>{const s=Mu(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function _k(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $t||t instanceof U_||t instanceof cl||t instanceof Rn||t instanceof kf||t instanceof $_)}function W_(t,e,n){if(!_k(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=bf(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function kg(t,e,n){if((e=Ye(e))instanceof Cf)return e._internalPath;if(typeof e=="string")return q_(t,e);throw Vh("Field path arguments must be of type string or ",t,!1,void 0,n)}const gF=new RegExp("[~\\*/\\[\\]]");function q_(t,e,n){if(e.search(gF)>=0)throw Vh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Cf(...e.split("."))._internalPath}catch{throw Vh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Vh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new oe(z.INVALID_ARGUMENT,a+t+l)}function vk(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wk{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Rn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new yF(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(H_("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class yF extends wk{data(){return super.data()}}function H_(t,e){return typeof e=="string"?q_(t,e):e instanceof Cf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _F(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new oe(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class G_{}class Ek extends G_{}function vF(t,e,...n){let r=[];e instanceof G_&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof Q_).length,a=s.filter(l=>l instanceof K_).length;if(o>1||o>0&&a>0)throw new oe(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class K_ extends Ek{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new K_(e,n,r)}_apply(e){const n=this._parse(e);return Sk(e._query,n),new zo(e.firestore,e.converter,_g(e._query,n))}_parse(e){const n=Af(e.firestore);return function(s,o,a,l,u,d,h){let p;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new oe(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){ZE(h,d);const y=[];for(const T of h)y.push(YE(l,s,T));p={arrayValue:{values:y}}}else p=YE(l,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||ZE(h,d),p=mF(a,o,h,d==="in"||d==="not-in");return Ot.create(u,d,p)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class Q_ extends G_{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Q_(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:$r.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)Sk(o,l),o=_g(o,l)}(e._query,n),new zo(e.firestore,e.converter,_g(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class J_ extends Ek{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new J_(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new oe(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new oe(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new tu(s,o)}(e._query,this._field,this._direction);return new zo(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Sl(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function wF(t,e="asc"){const n=e,r=H_("orderBy",t);return J_._create(r,n)}function YE(t,e,n){if(typeof(n=Ye(n))=="string"){if(n==="")throw new oe(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yC(e)&&n.indexOf("/")!==-1)throw new oe(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ft.fromString(n));if(!pe.isDocumentKey(r))throw new oe(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return vE(t,new pe(r))}if(n instanceof Rn)return vE(t,n._key);throw new oe(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bf(n)}.`)}function ZE(t,e){if(!Array.isArray(t)||t.length===0)throw new oe(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Sk(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new oe(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new oe(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class EF{convertValue(e,n="none"){switch(Vo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ct(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Mo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ee()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return $o(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Ct(o.doubleValue));return new $_(s)}convertGeoPoint(e){return new U_(Ct(e.latitude),Ct(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=v_(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Zc(e));default:return null}}convertTimestamp(e){const n=Vs(e);return new $t(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ft.fromString(e);nt(UC(r));const i=new Xc(r.get(1),r.get(3)),s=new pe(r.popFirst(5));return i.isEqual(n)||Ri(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tk(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class xk extends wk{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new qd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(H_("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class qd extends xk{data(e={}){return super.data(e)}}class SF{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new cc(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new qd(this._firestore,this._userDataWriter,r.key,r,new cc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new oe(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new qd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new cc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new qd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new cc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,d=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:TF(a.type),doc:l,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function TF(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ee()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bk(t){t=oi(t,Rn);const e=oi(t.firestore,bl);return iF(F_(e),t._key).then(n=>CF(e,t,n))}class Ik extends EF{constructor(e){super(),this.firestore=e}convertBytes(e){return new cl(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Rn(this.firestore,null,n)}}function xF(t){t=oi(t,zo);const e=oi(t.firestore,bl),n=F_(e),r=new Ik(e);return _F(t._query),sF(n,t._query).then(i=>new SF(e,r,t,i))}function Ag(t,e,n){t=oi(t,Rn);const r=oi(t.firestore,bl),i=Tk(t.converter,e,n);return Y_(r,[gk(Af(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,jr.none())])}function bF(t,e,n,...r){t=oi(t,Rn);const i=oi(t.firestore,bl),s=Af(i);let o;return o=typeof(e=Ye(e))=="string"||e instanceof Cf?pF(s,"updateDoc",t._key,e,n,r):fF(s,"updateDoc",t._key,e),Y_(i,[o.toMutation(t._key,jr.exists(!0))])}function IF(t,e){const n=oi(t.firestore,bl),r=To(t),i=Tk(t.converter,e);return Y_(n,[gk(Af(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,jr.exists(!1))]).then(()=>r)}function Y_(t,e){return function(r,i){const s=new xi;return r.asyncQueue.enqueueAndForget(async()=>Gj(await rF(r),i,s)),s.promise}(F_(t),e)}function CF(t,e,n){const r=n.docs.get(e._key),i=new Ik(t);return new xk(t,i,e._key,r,new cc(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kF(){return new Lu("deleteField")}function su(){return new z_("serverTimestamp")}(function(e,n=!0){(function(i){El=i})(wl),nl(new Ro("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new bl(new bM(r.getProvider("auth-internal")),new AM(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new oe(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Xc(u.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Ps(pE,"4.7.3",e),Ps(pE,"4.7.3","esm2017")})();var AF="firebase",PF="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ps(AF,PF,"app");const XE={apiKey:void 0,authDomain:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0};let ou;Object.values(XE).every(t=>t)&&(ou=dI(XE));const ne=ou?EM(ou):void 0,_n=ou?lF(ou):void 0,eS=typeof globalThis<"u"&&typeof globalThis.TextEncoder<"u"?new globalThis.TextEncoder:null;function RF(t){return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}async function NF(t){var e;if(typeof t!="string"||!t)return null;try{if(typeof globalThis<"u"&&((e=globalThis.crypto)!=null&&e.subtle)&&eS){const n=eS.encode(t),r=await globalThis.crypto.subtle.digest("SHA-256",n);return RF(r)}}catch(n){console.error("Unable to compute SHA-256 hash",n)}return null}async function tS(t){if(typeof t!="string")return null;const e=t.trim().toLowerCase();if(!e)return null;const n=await NF(e);if(n)return n;try{if(typeof globalThis<"u"&&typeof globalThis.btoa=="function")return globalThis.btoa(e)}catch(r){return console.error("Unable to base64 encode email",r),e}return e}const Ck=N.createContext(void 0);function DF({children:t}){const[e,n]=N.useState(null),[r,i]=N.useState(!0),[s,o]=N.useState(!1),a=N.useCallback(async(d,h)=>{if(!_n||!(d!=null&&d.uid)||!d.email)return;const p=d.email.trim().toLowerCase(),y=await tS(p),T=h??nS(d),E={userId:d.uid,email:p,emailVerified:!!d.emailVerified,provider:T,updatedAt:su()};try{await Ag(To(_n,"users",d.uid),{...E,displayName:d.displayName??"",photoURL:d.photoURL??null},{merge:!0}),y&&await Ag(To(_n,"userDirectory",y),E,{merge:!0})}catch(R){console.error("Failed to persist user profile",R)}},[]),l=N.useCallback(async d=>{if(!_n||typeof d!="string")return null;const h=d.trim().toLowerCase();if(!h)return null;const p=await tS(h);if(!p)return null;try{const y=await bk(To(_n,"userDirectory",p));return y.exists()?y.data():null}catch(y){return console.error("Failed to fetch directory record",y),null}},[]);N.useEffect(()=>{if(!ne){i(!1);return}lL(ne,WI).catch(console.error);const d=dL(ne,async h=>{h&&await a(h),n(h),i(!1)});return()=>d()},[a]);const u=N.useMemo(()=>({user:e,loading:r,verifying:s,signIn:async(d,h)=>{if(!ne)throw new Error("Firebase is not configured");const p=d.trim().toLowerCase(),y=await Np(ne,p);if(y.includes("google.com")&&!y.includes("password"))throw new Error('This email is linked to Google sign-in. Use "Sign in with Google".');const T=await rL(ne,p,h);return await a(T.user,"password"),n(T.user),T.user},signInWithGoogle:async()=>{var y;if(!ne)throw new Error("Firebase is not configured");const d=new Jr;d.setCustomParameters({prompt:"select_account"});const h=await sE(ne,d);if((y=h==null?void 0:h._tokenResponse)==null?void 0:y.isNewUser){try{await hL(h.user)}catch(T){console.error("Failed to delete unexpected Google registration",T)}throw await Dp(ne),n(null),new Error("No account exists for this Google user. Register with Google before signing in.")}return await a(h.user,"google"),n(h.user),h.user},registerWithGoogle:async()=>{var y;if(!ne)throw new Error("Firebase is not configured");const d=new Jr;d.setCustomParameters({prompt:"select_account"});const h=await sE(ne,d);if(!((y=h==null?void 0:h._tokenResponse)==null?void 0:y.isNewUser))throw await Dp(ne),n(null),new Error('This Google account is already registered. Use "Sign in with Google".');return await a(h.user,"google"),n(h.user),h.user},signUp:async({email:d,password:h,displayName:p})=>{if(!ne)throw new Error("Firebase is not configured");const y=d.trim().toLowerCase(),T=await Np(ne,y);if(T.includes("google.com")&&!T.includes("password"))throw new Error('This email is registered with Google. Use "Register with Google".');if(T.includes("password"))throw new Error("An account with this email already exists. Try signing in instead.");const E=await nL(ne,y,h);return p&&await nE(E.user,{displayName:p}),await tE(E.user),await a(E.user,"password"),n(E.user),E.user},signOutUser:async()=>{if(!ne)throw new Error("Firebase is not configured");await Dp(ne),n(null)},sendPasswordReset:async d=>{if(!ne)throw new Error("Firebase is not configured");const h=d.trim().toLowerCase(),[p,y]=await Promise.all([Np(ne,h),l(h)]),T=y==null?void 0:y.provider,E=p.includes("google.com")||T==="google";if(!(p.includes("password")||T==="password"))throw E?new Error("This email is linked to Google sign-in. Use the Google option to access your account."):new Error("No password-based account exists for this email.");if(y&&y.emailVerified===!1)throw new Error("Verify your email from the onboarding message before requesting a password reset.");await XO(ne,h)},sendVerificationEmail:async()=>{if(!ne)throw new Error("Firebase is not configured");if(!ne.currentUser)throw new Error("No authenticated user");if(!ne.currentUser.emailVerified){o(!0);try{await tE(ne.currentUser),await na(ne.currentUser),await a(ne.currentUser),n({...ne.currentUser})}finally{o(!1)}}},refreshUser:async()=>{ne!=null&&ne.currentUser&&(await na(ne.currentUser),await a(ne.currentUser),n({...ne.currentUser}))},updateDisplayName:async d=>{if(!(ne!=null&&ne.currentUser))throw new Error("No authenticated user");await nE(ne.currentUser,{displayName:d}),await na(ne.currentUser),await a(ne.currentUser),n({...ne.currentUser})},updateEmailAddress:async({currentPassword:d,newEmail:h})=>{if(!(ne!=null&&ne.currentUser)||!ne.currentUser.email)throw new Error("No authenticated user");const p=Ls.credential(ne.currentUser.email,d);await eE(ne.currentUser,p),await oL(ne.currentUser,h.trim().toLowerCase()),await na(ne.currentUser),await a(ne.currentUser),n({...ne.currentUser})},updateUserPassword:async({currentPassword:d,newPassword:h})=>{if(!(ne!=null&&ne.currentUser)||!ne.currentUser.email)throw new Error("No authenticated user");const p=Ls.credential(ne.currentUser.email,d);await eE(ne.currentUser,p),await aL(ne.currentUser,h),await na(ne.currentUser),await a(ne.currentUser),n({...ne.currentUser})},determineProvider:()=>nS(e)}),[l,r,a,e,s]);return m.jsx(Ck.Provider,{value:u,children:t})}function nS(t){var n;if(!t)return"unknown";const e=((n=t.providerData)==null?void 0:n.map(r=>r.providerId))??[];return e.includes("google.com")&&!e.includes("password")?"google":e.includes("password")?"password":e[0]??"unknown"}function Ui(){const t=N.useContext(Ck);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t}var Z_={exports:{}},Ra=typeof Reflect=="object"?Reflect:null,rS=Ra&&typeof Ra.apply=="function"?Ra.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},Hd;Ra&&typeof Ra.ownKeys=="function"?Hd=Ra.ownKeys:Object.getOwnPropertySymbols?Hd=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Hd=function(e){return Object.getOwnPropertyNames(e)};function OF(t){console&&console.warn&&console.warn(t)}var kk=Number.isNaN||function(e){return e!==e};function rt(){rt.init.call(this)}Z_.exports=rt;Z_.exports.once=jF;rt.EventEmitter=rt;rt.prototype._events=void 0;rt.prototype._eventsCount=0;rt.prototype._maxListeners=void 0;var iS=10;function Pf(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(rt,"defaultMaxListeners",{enumerable:!0,get:function(){return iS},set:function(t){if(typeof t!="number"||t<0||kk(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");iS=t}});rt.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};rt.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||kk(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Ak(t){return t._maxListeners===void 0?rt.defaultMaxListeners:t._maxListeners}rt.prototype.getMaxListeners=function(){return Ak(this)};rt.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")rS(l,this,n);else for(var u=l.length,d=Ok(l,u),r=0;r<u;++r)rS(d[r],this,n);return!0};function Pk(t,e,n,r){var i,s,o;if(Pf(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]),o===void 0)o=s[e]=n,++t._eventsCount;else if(typeof o=="function"?o=s[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),i=Ak(t),i>0&&o.length>i&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,OF(a)}return t}rt.prototype.addListener=function(e,n){return Pk(this,e,n,!1)};rt.prototype.on=rt.prototype.addListener;rt.prototype.prependListener=function(e,n){return Pk(this,e,n,!0)};function LF(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Rk(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=LF.bind(r);return i.listener=n,r.wrapFn=i,i}rt.prototype.once=function(e,n){return Pf(n),this.on(e,Rk(this,e,n)),this};rt.prototype.prependOnceListener=function(e,n){return Pf(n),this.prependListener(e,Rk(this,e,n)),this};rt.prototype.removeListener=function(e,n){var r,i,s,o,a;if(Pf(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){a=r[o].listener,s=o;break}if(s<0)return this;s===0?r.shift():MF(r,s),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};rt.prototype.off=rt.prototype.removeListener;rt.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var s=Object.keys(r),o;for(i=0;i<s.length;++i)o=s[i],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function Nk(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?VF(i):Ok(i,i.length)}rt.prototype.listeners=function(e){return Nk(this,e,!0)};rt.prototype.rawListeners=function(e){return Nk(this,e,!1)};rt.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Dk.call(t,e)};rt.prototype.listenerCount=Dk;function Dk(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}rt.prototype.eventNames=function(){return this._eventsCount>0?Hd(this._events):[]};function Ok(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function MF(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function VF(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function jF(t,e){return new Promise(function(n,r){function i(o){t.removeListener(e,s),r(o)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}Lk(t,e,s,{once:!0}),e!=="error"&&FF(t,i,{once:!0})})}function FF(t,e,n){typeof t.on=="function"&&Lk(t,"error",e,n)}function Lk(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(s){r.once&&t.removeEventListener(e,i),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Er=Z_.exports;class Pg extends Er.EventEmitter{constructor(e){super(),Object.defineProperties(this,{_attempts:{value:0,writable:!0},_duration:{enumerable:!1,get(){let n=this._min*Math.pow(this._factor,this._attempts);if(this._jitter){const r=Math.random(),i=Math.floor(r*this._jitter*n);n=Math.floor(r*10)&1?n+i:n-i}return Math.min(n,this._max)|0}},_factor:{value:e.factor||2},_jitter:{value:e.jitter>0&&e.jitter<=1?e.jitter:0},_max:{value:e.max||1e4},_min:{value:e.min||100},_timeoutID:{value:null,writable:!0}})}backoff(){const e=this._duration;this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null),this.emit("backoff",this._attempts,e),this._timeoutID=setTimeout(()=>{this.emit("ready",this._attempts,e),this._attempts++},e)}reset(){this._attempts=0,this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=null)}}var Mk={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(l1,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],s={},o=null;function a(E,R){var w=E[R];if(typeof w.bind=="function")return w.bind(E);try{return Function.prototype.bind.call(w,E)}catch{return function(){return Function.prototype.apply.apply(w,[E,arguments])}}}function l(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function u(E){return E==="debug"&&(E="log"),typeof console===n?!1:E==="trace"&&r?l:console[E]!==void 0?a(console,E):console.log!==void 0?a(console,"log"):e}function d(){for(var E=this.getLevel(),R=0;R<i.length;R++){var w=i[R];this[w]=R<E?e:this.methodFactory(w,E,this.name)}if(this.log=this.debug,typeof console===n&&E<this.levels.SILENT)return"No console available for logging"}function h(E){return function(){typeof console!==n&&(d.call(this),this[E].apply(this,arguments))}}function p(E,R,w){return u(E)||h.apply(this,arguments)}function y(E,R){var w=this,v,b,D,L="loglevel";typeof E=="string"?L+=":"+E:typeof E=="symbol"&&(L=void 0);function j(k){var x=(i[k]||"silent").toUpperCase();if(!(typeof window===n||!L)){try{window.localStorage[L]=x;return}catch{}try{window.document.cookie=encodeURIComponent(L)+"="+x+";"}catch{}}}function I(){var k;if(!(typeof window===n||!L)){try{k=window.localStorage[L]}catch{}if(typeof k===n)try{var x=window.document.cookie,P=encodeURIComponent(L),he=x.indexOf(P+"=");he!==-1&&(k=/^([^;]+)/.exec(x.slice(he+P.length+1))[1])}catch{}return w.levels[k]===void 0&&(k=void 0),k}}function _(){if(!(typeof window===n||!L)){try{window.localStorage.removeItem(L)}catch{}try{window.document.cookie=encodeURIComponent(L)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function C(k){var x=k;if(typeof x=="string"&&w.levels[x.toUpperCase()]!==void 0&&(x=w.levels[x.toUpperCase()]),typeof x=="number"&&x>=0&&x<=w.levels.SILENT)return x;throw new TypeError("log.setLevel() called with invalid level: "+k)}w.name=E,w.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},w.methodFactory=R||p,w.getLevel=function(){return D??b??v},w.setLevel=function(k,x){return D=C(k),x!==!1&&j(D),d.call(w)},w.setDefaultLevel=function(k){b=C(k),I()||w.setLevel(k,!1)},w.resetLevel=function(){D=null,_(),d.call(w)},w.enableAll=function(k){w.setLevel(w.levels.TRACE,k)},w.disableAll=function(k){w.setLevel(w.levels.SILENT,k)},w.rebuild=function(){if(o!==w&&(v=C(o.getLevel())),d.call(w),o===w)for(var k in s)s[k].rebuild()},v=C(o?o.getLevel():"WARN");var A=I();A!=null&&(D=C(A)),d.call(w)}o=new y,o.getLogger=function(R){if(typeof R!="symbol"&&typeof R!="string"||R==="")throw new TypeError("You must supply a name when creating a logger.");var w=s[R];return w||(w=s[R]=new y(R,o.methodFactory)),w};var T=typeof window!==n?window.log:void 0;return o.noConflict=function(){return typeof window!==n&&window.log===o&&(window.log=T),o},o.getLoggers=function(){return s},o.default=o,o})})(Mk);var au=Mk.exports;const UF=yT(au),$F=gT({__proto__:null,default:UF},[au]);class Re extends Error{constructor(e,n){super(),Object.setPrototypeOf(this,Re.prototype);const r=typeof e=="string"?e:this.explanation,i=typeof e=="object"?e:n;this.message=`${this.name} (${this.code}): ${r}`,this.originalError=i}}var Vt;(function(t){class e extends Re{constructor(s,o){super(s,o),this.causes=[],this.code=20101,this.description="Invalid access token",this.explanation="Twilio was unable to validate your Access Token",this.name="AccessTokenInvalid",this.solutions=[],Object.setPrototypeOf(this,t.AccessTokenInvalid.prototype);const a=typeof s=="string"?s:this.explanation,l=typeof s=="object"?s:o;this.message=`${this.name} (${this.code}): ${a}`,this.originalError=l}}t.AccessTokenInvalid=e;class n extends Re{constructor(s,o){super(s,o),this.causes=[],this.code=20104,this.description="Access token expired or expiration date invalid",this.explanation="The Access Token provided to the Twilio API has expired, the expiration time specified in the token was invalid, or the expiration time specified was too far in the future",this.name="AccessTokenExpired",this.solutions=[],Object.setPrototypeOf(this,t.AccessTokenExpired.prototype);const a=typeof s=="string"?s:this.explanation,l=typeof s=="object"?s:o;this.message=`${this.name} (${this.code}): ${a}`,this.originalError=l}}t.AccessTokenExpired=n;class r extends Re{constructor(s,o){super(s,o),this.causes=[],this.code=20151,this.description="Authentication Failed",this.explanation="The Authentication with the provided JWT failed",this.name="AuthenticationFailed",this.solutions=[],Object.setPrototypeOf(this,t.AuthenticationFailed.prototype);const a=typeof s=="string"?s:this.explanation,l=typeof s=="object"?s:o;this.message=`${this.name} (${this.code}): ${a}`,this.originalError=l}}t.AuthenticationFailed=r})(Vt||(Vt={}));var Rg;(function(t){class e extends Re{constructor(r,i){super(r,i),this.causes=["The access token has an invalid Account SID, API Key, or API Key Secret."],this.code=31202,this.description="Signature validation failed.",this.explanation="The provided access token failed signature validation.",this.name="AccessTokenSignatureValidationFailed",this.solutions=["Ensure the Account SID, API Key, and API Key Secret are valid when generating your access token."],Object.setPrototypeOf(this,t.AccessTokenSignatureValidationFailed.prototype);const s=typeof r=="string"?r:this.explanation,o=typeof r=="object"?r:i;this.message=`${this.name} (${this.code}): ${s}`,this.originalError=o}}t.AccessTokenSignatureValidationFailed=e})(Rg||(Rg={}));var lo;(function(t){class e extends Re{constructor(o,a){super(o,a),this.causes=[],this.code=31400,this.description="Bad Request (HTTP/SIP)",this.explanation="The request could not be understood due to malformed syntax.",this.name="BadRequest",this.solutions=[],Object.setPrototypeOf(this,t.BadRequest.prototype);const l=typeof o=="string"?o:this.explanation,u=typeof o=="object"?o:a;this.message=`${this.name} (${this.code}): ${l}`,this.originalError=u}}t.BadRequest=e;class n extends Re{constructor(o,a){super(o,a),this.causes=["The outbound call was made to an invalid phone number.","The TwiML application sid is missing a Voice URL."],this.code=31404,this.description="Not Found (HTTP/SIP)",this.explanation="The server has not found anything matching the request.",this.name="NotFound",this.solutions=["Ensure the phone number dialed is valid.","Ensure the TwiML application is configured correctly with a Voice URL link."],Object.setPrototypeOf(this,t.NotFound.prototype);const l=typeof o=="string"?o:this.explanation,u=typeof o=="object"?o:a;this.message=`${this.name} (${this.code}): ${l}`,this.originalError=u}}t.NotFound=n;class r extends Re{constructor(o,a){super(o,a),this.causes=[],this.code=31480,this.description="Temporarily Unavailable (SIP)",this.explanation="The callee is currently unavailable.",this.name="TemporarilyUnavailable",this.solutions=[],Object.setPrototypeOf(this,t.TemporarilyUnavailable.prototype);const l=typeof o=="string"?o:this.explanation,u=typeof o=="object"?o:a;this.message=`${this.name} (${this.code}): ${l}`,this.originalError=u}}t.TemporarilyUnavailable=r;class i extends Re{constructor(o,a){super(o,a),this.causes=[],this.code=31486,this.description="Busy Here (SIP)",this.explanation="The callee is busy.",this.name="BusyHere",this.solutions=[],Object.setPrototypeOf(this,t.BusyHere.prototype);const l=typeof o=="string"?o:this.explanation,u=typeof o=="object"?o:a;this.message=`${this.name} (${this.code}): ${l}`,this.originalError=u}}t.BusyHere=i})(lo||(lo={}));var Ng;(function(t){class e extends Re{constructor(r,i){super(r,i),this.causes=[],this.code=31603,this.description="Decline (SIP)",this.explanation="The callee does not wish to participate in the call.",this.name="Decline",this.solutions=[],Object.setPrototypeOf(this,t.Decline.prototype);const s=typeof r=="string"?r:this.explanation,o=typeof r=="object"?r:i;this.message=`${this.name} (${this.code}): ${s}`,this.originalError=o}}t.Decline=e})(Ng||(Ng={}));var pn;(function(t){class e extends Re{constructor(u,d){super(u,d),this.causes=[],this.code=31e3,this.description="Unknown Error",this.explanation="An unknown error has occurred. See error details for more information.",this.name="UnknownError",this.solutions=[],Object.setPrototypeOf(this,t.UnknownError.prototype);const h=typeof u=="string"?u:this.explanation,p=typeof u=="object"?u:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=p}}t.UnknownError=e;class n extends Re{constructor(u,d){super(u,d),this.causes=[],this.code=31001,this.description="Application Not Found",this.explanation="",this.name="ApplicationNotFoundError",this.solutions=[],Object.setPrototypeOf(this,t.ApplicationNotFoundError.prototype);const h=typeof u=="string"?u:this.explanation,p=typeof u=="object"?u:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=p}}t.ApplicationNotFoundError=n;class r extends Re{constructor(u,d){super(u,d),this.causes=[],this.code=31002,this.description="Connection Declined",this.explanation="",this.name="ConnectionDeclinedError",this.solutions=[],Object.setPrototypeOf(this,t.ConnectionDeclinedError.prototype);const h=typeof u=="string"?u:this.explanation,p=typeof u=="object"?u:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=p}}t.ConnectionDeclinedError=r;class i extends Re{constructor(u,d){super(u,d),this.causes=[],this.code=31003,this.description="Connection Timeout",this.explanation="The server could not produce a response within a suitable amount of time.",this.name="ConnectionTimeoutError",this.solutions=[],Object.setPrototypeOf(this,t.ConnectionTimeoutError.prototype);const h=typeof u=="string"?u:this.explanation,p=typeof u=="object"?u:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=p}}t.ConnectionTimeoutError=i;class s extends Re{constructor(u,d){super(u,d),this.causes=[],this.code=31005,this.description="Connection error",this.explanation="A connection error occurred during the call",this.name="ConnectionError",this.solutions=[],Object.setPrototypeOf(this,t.ConnectionError.prototype);const h=typeof u=="string"?u:this.explanation,p=typeof u=="object"?u:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=p}}t.ConnectionError=s;class o extends Re{constructor(u,d){super(u,d),this.causes=["The incoming call was cancelled because it was not answered in time or it was accepted/rejected by another application instance registered with the same identity."],this.code=31008,this.description="Call cancelled",this.explanation="Unable to answer because the call has ended",this.name="CallCancelledError",this.solutions=[],Object.setPrototypeOf(this,t.CallCancelledError.prototype);const h=typeof u=="string"?u:this.explanation,p=typeof u=="object"?u:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=p}}t.CallCancelledError=o;class a extends Re{constructor(u,d){super(u,d),this.causes=[],this.code=31009,this.description="Transport error",this.explanation="No transport available to send or receive messages",this.name="TransportError",this.solutions=[],Object.setPrototypeOf(this,t.TransportError.prototype);const h=typeof u=="string"?u:this.explanation,p=typeof u=="object"?u:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=p}}t.TransportError=a})(pn||(pn={}));var pi;(function(t){class e extends Re{constructor(u,d){super(u,d),this.causes=["Invalid content or MessageType passed to sendMessage method."],this.code=31100,this.description="The request had malformed syntax.",this.explanation="The request could not be understood due to malformed syntax.",this.name="MalformedRequestError",this.solutions=["Ensure content and MessageType passed to sendMessage method are valid."],Object.setPrototypeOf(this,t.MalformedRequestError.prototype);const h=typeof u=="string"?u:this.explanation,p=typeof u=="object"?u:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=p}}t.MalformedRequestError=e;class n extends Re{constructor(u,d){super(u,d),this.causes=[],this.code=31101,this.description="Missing parameter array in request",this.explanation="",this.name="MissingParameterArrayError",this.solutions=[],Object.setPrototypeOf(this,t.MissingParameterArrayError.prototype);const h=typeof u=="string"?u:this.explanation,p=typeof u=="object"?u:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=p}}t.MissingParameterArrayError=n;class r extends Re{constructor(u,d){super(u,d),this.causes=[],this.code=31102,this.description="Authorization token missing in request.",this.explanation="",this.name="AuthorizationTokenMissingError",this.solutions=[],Object.setPrototypeOf(this,t.AuthorizationTokenMissingError.prototype);const h=typeof u=="string"?u:this.explanation,p=typeof u=="object"?u:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=p}}t.AuthorizationTokenMissingError=r;class i extends Re{constructor(u,d){super(u,d),this.causes=[],this.code=31103,this.description="Maximum parameter length has been exceeded.",this.explanation="Length of parameters cannot exceed MAX_PARAM_LENGTH.",this.name="MaxParameterLengthExceededError",this.solutions=[],Object.setPrototypeOf(this,t.MaxParameterLengthExceededError.prototype);const h=typeof u=="string"?u:this.explanation,p=typeof u=="object"?u:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=p}}t.MaxParameterLengthExceededError=i;class s extends Re{constructor(u,d){super(u,d),this.causes=[],this.code=31104,this.description="Invalid bridge token",this.explanation="",this.name="InvalidBridgeTokenError",this.solutions=[],Object.setPrototypeOf(this,t.InvalidBridgeTokenError.prototype);const h=typeof u=="string"?u:this.explanation,p=typeof u=="object"?u:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=p}}t.InvalidBridgeTokenError=s;class o extends Re{constructor(u,d){super(u,d),this.causes=["Client name contains invalid characters."],this.code=31105,this.description="Invalid client name",this.explanation="Client name should not contain control, space, delims, or unwise characters.",this.name="InvalidClientNameError",this.solutions=["Make sure that client name does not contain any of the invalid characters."],Object.setPrototypeOf(this,t.InvalidClientNameError.prototype);const h=typeof u=="string"?u:this.explanation,p=typeof u=="object"?u:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=p}}t.InvalidClientNameError=o;class a extends Re{constructor(u,d){super(u,d),this.causes=[],this.code=31107,this.description="The reconnect parameter is invalid",this.explanation="",this.name="ReconnectParameterInvalidError",this.solutions=[],Object.setPrototypeOf(this,t.ReconnectParameterInvalidError.prototype);const h=typeof u=="string"?u:this.explanation,p=typeof u=="object"?u:d;this.message=`${this.name} (${this.code}): ${h}`,this.originalError=p}}t.ReconnectParameterInvalidError=a})(pi||(pi={}));(function(t){class e extends Re{constructor(h,p){super(h,p),this.causes=[],this.code=31201,this.description="Authorization error",this.explanation="The request requires user authentication. The server understood the request, but is refusing to fulfill it.",this.name="AuthorizationError",this.solutions=[],Object.setPrototypeOf(this,t.AuthorizationError.prototype);const y=typeof h=="string"?h:this.explanation,T=typeof h=="object"?h:p;this.message=`${this.name} (${this.code}): ${y}`,this.originalError=T}}t.AuthorizationError=e;class n extends Re{constructor(h,p){super(h,p),this.causes=[],this.code=31203,this.description="No valid account",this.explanation="",this.name="NoValidAccountError",this.solutions=[],Object.setPrototypeOf(this,t.NoValidAccountError.prototype);const y=typeof h=="string"?h:this.explanation,T=typeof h=="object"?h:p;this.message=`${this.name} (${this.code}): ${y}`,this.originalError=T}}t.NoValidAccountError=n;class r extends Re{constructor(h,p){super(h,p),this.causes=[],this.code=31204,this.description="Invalid JWT token",this.explanation="",this.name="InvalidJWTTokenError",this.solutions=[],Object.setPrototypeOf(this,t.InvalidJWTTokenError.prototype);const y=typeof h=="string"?h:this.explanation,T=typeof h=="object"?h:p;this.message=`${this.name} (${this.code}): ${y}`,this.originalError=T}}t.InvalidJWTTokenError=r;class i extends Re{constructor(h,p){super(h,p),this.causes=[],this.code=31205,this.description="JWT token expired",this.explanation="",this.name="JWTTokenExpiredError",this.solutions=[],Object.setPrototypeOf(this,t.JWTTokenExpiredError.prototype);const y=typeof h=="string"?h:this.explanation,T=typeof h=="object"?h:p;this.message=`${this.name} (${this.code}): ${y}`,this.originalError=T}}t.JWTTokenExpiredError=i;class s extends Re{constructor(h,p){super(h,p),this.causes=["Rate limit exceeded."],this.code=31206,this.description="Rate exceeded authorized limit.",this.explanation="The request performed exceeds the authorized limit.",this.name="RateExceededError",this.solutions=["Ensure message send rate does not exceed authorized limits."],Object.setPrototypeOf(this,t.RateExceededError.prototype);const y=typeof h=="string"?h:this.explanation,T=typeof h=="object"?h:p;this.message=`${this.name} (${this.code}): ${y}`,this.originalError=T}}t.RateExceededError=s;class o extends Re{constructor(h,p){super(h,p),this.causes=[],this.code=31207,this.description="JWT token expiration too long",this.explanation="",this.name="JWTTokenExpirationTooLongError",this.solutions=[],Object.setPrototypeOf(this,t.JWTTokenExpirationTooLongError.prototype);const y=typeof h=="string"?h:this.explanation,T=typeof h=="object"?h:p;this.message=`${this.name} (${this.code}): ${y}`,this.originalError=T}}t.JWTTokenExpirationTooLongError=o;class a extends Re{constructor(h,p){super(h,p),this.causes=[],this.code=31209,this.description="Reconnect attempt is not authorized.",this.explanation="",this.name="ReconnectAttemptError",this.solutions=[],Object.setPrototypeOf(this,t.ReconnectAttemptError.prototype);const y=typeof h=="string"?h:this.explanation,T=typeof h=="object"?h:p;this.message=`${this.name} (${this.code}): ${y}`,this.originalError=T}}t.ReconnectAttemptError=a;class l extends Re{constructor(h,p){super(h,p),this.causes=["The Call Message Event Type is invalid and is not understood by Twilio Voice."],this.code=31210,this.description="Call Message Event Type is invalid.",this.explanation="The Call Message Event Type is invalid and is not understood by Twilio Voice.",this.name="CallMessageEventTypeInvalidError",this.solutions=["Ensure the Call Message Event Type is Valid and understood by Twilio Voice and try again."],Object.setPrototypeOf(this,t.CallMessageEventTypeInvalidError.prototype);const y=typeof h=="string"?h:this.explanation,T=typeof h=="object"?h:p;this.message=`${this.name} (${this.code}): ${y}`,this.originalError=T}}t.CallMessageEventTypeInvalidError=l;class u extends Re{constructor(h,p){super(h,p),this.causes=["The payload size of Call Message Event exceeds the authorized limit."],this.code=31212,this.description="Call Message Event Payload size exceeded authorized limit.",this.explanation="The request performed to send a Call Message Event exceeds the payload size authorized limit",this.name="PayloadSizeExceededError",this.solutions=["Reduce payload size of Call Message Event to be within the authorized limit and try again."],Object.setPrototypeOf(this,t.PayloadSizeExceededError.prototype);const y=typeof h=="string"?h:this.explanation,T=typeof h=="object"?h:p;this.message=`${this.name} (${this.code}): ${y}`,this.originalError=T}}t.PayloadSizeExceededError=u})(Vt||(Vt={}));var ul;(function(t){class e extends Re{constructor(i,s){super(i,s),this.causes=["The user denied the getUserMedia request.","The browser denied the getUserMedia request."],this.code=31401,this.description="UserMedia Permission Denied Error",this.explanation="The browser or end-user denied permissions to user media. Therefore we were unable to acquire input audio.",this.name="PermissionDeniedError",this.solutions=["The user should accept the request next time prompted. If the browser saved the deny, the user should change that permission in their browser.","The user should to verify that the browser has permission to access the microphone at this address."],Object.setPrototypeOf(this,t.PermissionDeniedError.prototype);const o=typeof i=="string"?i:this.explanation,a=typeof i=="object"?i:s;this.message=`${this.name} (${this.code}): ${o}`,this.originalError=a}}t.PermissionDeniedError=e;class n extends Re{constructor(i,s){super(i,s),this.causes=["NotFoundError - The deviceID specified was not found.","The getUserMedia constraints were overconstrained and no devices matched."],this.code=31402,this.description="UserMedia Acquisition Failed Error",this.explanation="The browser and end-user allowed permissions, however getting the media failed. Usually this is due to bad constraints, but can sometimes fail due to browser, OS or hardware issues.",this.name="AcquisitionFailedError",this.solutions=["Ensure the deviceID being specified exists.","Try acquiring media with fewer constraints."],Object.setPrototypeOf(this,t.AcquisitionFailedError.prototype);const o=typeof i=="string"?i:this.explanation,a=typeof i=="object"?i:s;this.message=`${this.name} (${this.code}): ${o}`,this.originalError=a}}t.AcquisitionFailedError=n})(ul||(ul={}));var _r;(function(t){class e extends Re{constructor(i,s){super(i,s),this.causes=[],this.code=53e3,this.description="Signaling connection error",this.explanation="Raised whenever a signaling connection error occurs that is not covered by a more specific error code.",this.name="ConnectionError",this.solutions=[],Object.setPrototypeOf(this,t.ConnectionError.prototype);const o=typeof i=="string"?i:this.explanation,a=typeof i=="object"?i:s;this.message=`${this.name} (${this.code}): ${o}`,this.originalError=a}}t.ConnectionError=e;class n extends Re{constructor(i,s){super(i,s),this.causes=["The device running your application lost its Internet connection."],this.code=53001,this.description="Signaling connection disconnected",this.explanation="Raised whenever the signaling connection is unexpectedly disconnected.",this.name="ConnectionDisconnected",this.solutions=["Ensure the device running your application has access to a stable Internet connection."],Object.setPrototypeOf(this,t.ConnectionDisconnected.prototype);const o=typeof i=="string"?i:this.explanation,a=typeof i=="object"?i:s;this.message=`${this.name} (${this.code}): ${o}`,this.originalError=a}}t.ConnectionDisconnected=n})(_r||(_r={}));var ri;(function(t){class e extends Re{constructor(s,o){super(s,o),this.causes=["The Client may not be using a supported WebRTC implementation.","The Client may not have the necessary resources to create or apply a new media description."],this.code=53400,this.description="Client is unable to create or apply a local media description",this.explanation="Raised whenever a Client is unable to create or apply a local media description.",this.name="ClientLocalDescFailed",this.solutions=["If you are experiencing this error using the JavaScript SDK, ensure you are running it with a supported WebRTC implementation."],Object.setPrototypeOf(this,t.ClientLocalDescFailed.prototype);const a=typeof s=="string"?s:this.explanation,l=typeof s=="object"?s:o;this.message=`${this.name} (${this.code}): ${a}`,this.originalError=l}}t.ClientLocalDescFailed=e;class n extends Re{constructor(s,o){super(s,o),this.causes=["The Client may not be using a supported WebRTC implementation.","The Client may be connecting peer-to-peer with another Participant that is not using a supported WebRTC implementation.","The Client may not have the necessary resources to apply a new media description."],this.code=53402,this.description="Client is unable to apply a remote media description",this.explanation="Raised whenever the Client receives a remote media description but is unable to apply it.",this.name="ClientRemoteDescFailed",this.solutions=["If you are experiencing this error using the JavaScript SDK, ensure you are running it with a supported WebRTC implementation."],Object.setPrototypeOf(this,t.ClientRemoteDescFailed.prototype);const a=typeof s=="string"?s:this.explanation,l=typeof s=="object"?s:o;this.message=`${this.name} (${this.code}): ${a}`,this.originalError=l}}t.ClientRemoteDescFailed=n;class r extends Re{constructor(s,o){super(s,o),this.causes=["The Client was unable to establish a media connection.","A media connection which was active failed liveliness checks."],this.code=53405,this.description="Media connection failed",this.explanation="Raised by the Client or Server whenever a media connection fails.",this.name="ConnectionError",this.solutions=["If the problem persists, try connecting to another region.","Check your Client's network connectivity.","If you've provided custom ICE Servers then ensure that the URLs and credentials are valid."],Object.setPrototypeOf(this,t.ConnectionError.prototype);const a=typeof s=="string"?s:this.explanation,l=typeof s=="object"?s:o;this.message=`${this.name} (${this.code}): ${a}`,this.originalError=l}}t.ConnectionError=r})(ri||(ri={}));const X_=new Map([[20101,Vt.AccessTokenInvalid],[20104,Vt.AccessTokenExpired],[20151,Vt.AuthenticationFailed],[31202,Rg.AccessTokenSignatureValidationFailed],[31400,lo.BadRequest],[31404,lo.NotFound],[31480,lo.TemporarilyUnavailable],[31486,lo.BusyHere],[31603,Ng.Decline],[31e3,pn.UnknownError],[31001,pn.ApplicationNotFoundError],[31002,pn.ConnectionDeclinedError],[31003,pn.ConnectionTimeoutError],[31005,pn.ConnectionError],[31008,pn.CallCancelledError],[31009,pn.TransportError],[31100,pi.MalformedRequestError],[31101,pi.MissingParameterArrayError],[31102,pi.AuthorizationTokenMissingError],[31103,pi.MaxParameterLengthExceededError],[31104,pi.InvalidBridgeTokenError],[31105,pi.InvalidClientNameError],[31107,pi.ReconnectParameterInvalidError],[31201,Vt.AuthorizationError],[31203,Vt.NoValidAccountError],[31204,Vt.InvalidJWTTokenError],[31205,Vt.JWTTokenExpiredError],[31206,Vt.RateExceededError],[31207,Vt.JWTTokenExpirationTooLongError],[31209,Vt.ReconnectAttemptError],[31210,Vt.CallMessageEventTypeInvalidError],[31212,Vt.PayloadSizeExceededError],[31401,ul.PermissionDeniedError],[31402,ul.AcquisitionFailedError],[53e3,_r.ConnectionError],[53001,_r.ConnectionDisconnected],[53400,ri.ClientLocalDescFailed],[53402,ri.ClientRemoteDescFailed],[53405,ri.ConnectionError]]);Object.freeze(X_);const BF=new Set([31001,31002,31003,31101,31102,31103,31104,31105,31107,31201,31202,31203,31204,31205,31207,31404,31480,31486,31603]);function Dg(t,e){if(!(typeof e!="number"||!WF(e)||!(t||!BF.has(e))))return zF(e)}class et extends Error{constructor(e){super(e),this.name="InvalidArgumentError"}}class kr extends Error{constructor(e){super(e),this.name="InvalidStateError"}}class tn extends Error{constructor(e){super(e),this.name="NotSupportedError"}}function zF(t){const e=X_.get(t);if(!e)throw new et(`Error code ${t} not found`);return e}function WF(t){return X_.has(t)}const Vk="@twilio/voice-sdk",Na="2.16.0",ev="https://sdk.twilio.com/js/client/sounds/releases/1.0.0",qF=`${ev}/cowbell.mp3?cache=${Na}`,HF=2e4;class Ft{static getLogLevelInstance(e){if(!Ft.loglevelInstance)try{Ft.loglevelInstance=(e&&e.LogLevelModule?e.LogLevelModule:$F).getLogger(Vk)}catch{console.warn("Cannot create custom logger"),Ft.loglevelInstance=console}return Ft.loglevelInstance}constructor(e,n){this._log=Ft.getLogLevelInstance(n),this._prefix=`[TwilioVoice][${e}]`}debug(...e){this._log.debug(this._prefix,...e)}error(...e){this._log.error(this._prefix,...e)}info(...e){this._log.info(this._prefix,...e)}setDefaultLevel(e){this._log.setDefaultLevel?this._log.setDefaultLevel(e):console.warn("Logger cannot setDefaultLevel")}warn(...e){this._log.warn(this._prefix,...e)}}Ft.levels=au.levels;Ft.getLogLevelInstance();const GF=`${ev}/outgoing.mp3`;class sS{constructor(e,n,r,i){this._name=e,this._availableDevices=n,this._beforeChange=r,this._isSupported=i,this._activeDevices=new Set,this._log=new Ft("OutputDeviceCollection")}delete(e){this._log.debug(".delete",e);const n=!!this._activeDevices.delete(e),r=this._availableDevices.get("default")||Array.from(this._availableDevices.values())[0];!this._activeDevices.size&&r&&this._activeDevices.add(r);const i=Array.from(this._activeDevices.values()).map(s=>s.deviceId);return this._beforeChange(this._name,i),!!n}get(){return this._activeDevices}set(e){if(this._log.debug(".set",e),!this._isSupported)return Promise.reject(new tn("This browser does not support audio output selection"));const n=Array.isArray(e)?e:[e];if(!n.length)return Promise.reject(new et("Must specify at least one device to set"));const r=[],i=n.map(s=>{const o=this._availableDevices.get(s);return o||r.push(s),o});return r.length?Promise.reject(new et(`Devices not found: ${r.join(", ")}`)):new Promise(s=>{s(this._beforeChange(this._name,n))}).then(()=>{this._activeDevices.clear(),i.forEach(this._activeDevices.add,this._activeDevices)})}test(e=GF){return this._isSupported?this._activeDevices.size?Promise.all(Array.from(this._activeDevices).map(n=>{let r;return new Promise(i=>{r=new Audio(e),r.oncanplay=i}).then(()=>r.setSinkId(n.deviceId).then(()=>r.play()))})):Promise.reject(new kr("No active output devices to test")):Promise.reject(new tn("This browser does not support audio output selection"))}}class KF{constructor(e){Object.defineProperties(this,{deviceId:{get(){return e.deviceId}},groupId:{get(){return e.groupId}},kind:{get(){return e.kind}},label:{get(){return e.label}}})}}function jh(t){if(!(this instanceof jh))return new jh(t);this.message=t}jh.prototype.toString=function(){return`Twilio.Exception: ${this.message}`};function bc(t){return t&&t.length?t.reduce((e,n)=>e+n)/t.length:0}function tv(t,e,n){n=n||(i=>i);const r=new Set(e.map(n));return t.filter(i=>!r.has(n(i)))}function jk(t){return!!t.userAgent.match("Electron")}function nv(t,e){const n=!!e.userAgent.match("CriOS"),r=!!e.userAgent.match("HeadlessChrome"),i=typeof t.chrome<"u"&&e.vendor==="Google Inc."&&e.userAgent.indexOf("OPR")===-1&&e.userAgent.indexOf("Edge")===-1;return n||jk(e)||i||r}function QF(t){return t=t||(typeof window>"u"?global.navigator:window.navigator),!!t&&typeof t.userAgent=="string"&&/firefox|fxios/i.test(t.userAgent)}function Rf(t){return t=t||(typeof window>"u"?global.navigator:window.navigator),!!t&&typeof t.userAgent=="string"&&/edge\/\d+/i.test(t.userAgent)}function JF(t){return!!t.vendor&&t.vendor.indexOf("Apple")!==-1&&t.userAgent&&t.userAgent.indexOf("CriOS")===-1&&t.userAgent.indexOf("FxiOS")===-1}function Fk(t){return t?t.split("&").reduce((e,n)=>{const r=n.split("="),i=r[0],s=decodeURIComponent((r[1]||"").replace(/\+/g,"%20"));return i&&(e[i]=s),e},{}):""}function Og(t,e){const n=t instanceof Map||t instanceof Set?Array.from(t.values()):t;return e=e||(r=>r),n.reduce((r,i)=>{const s=e(i);return r.concat(s)},[])}function Lg(t,e,n){return new Promise((r,i)=>{function s(){t.removeListener(n,o),r()}function o(){t.removeListener(e,s),i()}t.once(e,s),t.once(n,o)})}function Uk(t,e){const n=e.map(r=>"audio/"+r.toLowerCase());return t.sort((r,i)=>{const s=n.indexOf(r.mimeType.toLowerCase()),o=n.indexOf(i.mimeType.toLowerCase()),a=s>=0?s:Number.MAX_VALUE,l=o>=0?o:Number.MAX_VALUE;return a-l})}const YF=jh,$k=Object.freeze(Object.defineProperty({__proto__:null,Exception:YF,average:bc,difference:tv,flatMap:Og,isChrome:nv,isElectron:jk,isFirefox:QF,isLegacyEdge:Rf,isSafari:JF,promisifyEvents:Lg,queryToJson:Fk,sortByMimeTypes:Uk},Symbol.toStringTag,{value:"Module"})),ZF={audioinput:"Audio Input",audiooutput:"Audio Output"};class Mg extends Er.EventEmitter{get audioConstraints(){return this._audioConstraints}get inputDevice(){return this._inputDevice}get inputStream(){return this._processedStream||this._selectedInputDeviceStream}get processedStream(){return this._processedStream}constructor(e,n,r){super(),this.availableInputDevices=new Map,this.availableOutputDevices=new Map,this._audioConstraints=null,this._defaultInputDeviceStream=null,this._enabledSounds={[ie.SoundName.Disconnect]:!0,[ie.SoundName.Incoming]:!0,[ie.SoundName.Outgoing]:!0},this._inputDevice=null,this._inputDevicePromise=null,this._isPollingInputVolume=!1,this._log=new Ft("AudioHelper"),this._processedStream=null,this._selectedInputDeviceStream=null,this._unknownDeviceIndexes={audioinput:{},audiooutput:{}},this._updateAvailableDevices=()=>!this._mediaDevices||!this._enumerateDevices?Promise.reject("Enumeration not supported"):this._enumerateDevices().then(a=>{this._updateDevices(a.filter(u=>u.kind==="audiooutput"),this.availableOutputDevices,this._removeLostOutput),this._updateDevices(a.filter(u=>u.kind==="audioinput"),this.availableInputDevices,this._removeLostInput);const l=this.availableOutputDevices.get("default")||Array.from(this.availableOutputDevices.values())[0];[this.speakerDevices,this.ringtoneDevices].forEach(u=>{!u.get().size&&this.availableOutputDevices.size&&this.isOutputSelectionSupported&&u.set(l.deviceId).catch(d=>{this._log.warn(`Unable to set audio output devices. ${d}`)})})}),this._removeLostInput=a=>{if(!this.inputDevice||this.inputDevice.deviceId!==a.deviceId)return!1;this._destroyProcessedStream(),this._replaceStream(null),this._inputDevice=null,this._maybeStopPollingVolume();const l=this.availableInputDevices.get("default")||Array.from(this.availableInputDevices.values())[0];return l&&this.setInputDevice(l.deviceId),!0},this._removeLostOutput=a=>{const l=this.speakerDevices.delete(a),u=this.ringtoneDevices.delete(a);return l||u},r=Object.assign({AudioContext:typeof AudioContext<"u"&&AudioContext,setSinkId:typeof HTMLAudioElement<"u"&&HTMLAudioElement.prototype.setSinkId},r),this._beforeSetInputDevice=r.beforeSetInputDevice||(()=>Promise.resolve()),this._updateUserOptions(r),this._audioProcessorEventObserver=r.audioProcessorEventObserver,this._mediaDevices=r.mediaDevices||navigator.mediaDevices,this._onActiveInputChanged=n,this._enumerateDevices=typeof r.enumerateDevices=="function"?r.enumerateDevices:this._mediaDevices&&this._mediaDevices.enumerateDevices.bind(this._mediaDevices);const i=!!(r.AudioContext||r.audioContext),s=!!this._enumerateDevices;r.enabledSounds&&(this._enabledSounds=r.enabledSounds);const o=typeof r.setSinkId=="function";this.isOutputSelectionSupported=s&&o,this.isVolumeSupported=i,this.isVolumeSupported&&(this._audioContext=r.audioContext||r.AudioContext&&new r.AudioContext,this._audioContext&&(this._inputVolumeAnalyser=this._audioContext.createAnalyser(),this._inputVolumeAnalyser.fftSize=32,this._inputVolumeAnalyser.smoothingTimeConstant=.3)),this.ringtoneDevices=new sS("ringtone",this.availableOutputDevices,e,this.isOutputSelectionSupported),this.speakerDevices=new sS("speaker",this.availableOutputDevices,e,this.isOutputSelectionSupported),this.addListener("newListener",a=>{a==="inputVolume"&&this._maybeStartPollingVolume()}),this.addListener("removeListener",a=>{a==="inputVolume"&&this._maybeStopPollingVolume()}),this.once("newListener",()=>{this.isOutputSelectionSupported||this._log.warn("Warning: This browser does not support audio output selection."),this.isVolumeSupported||this._log.warn("Warning: This browser does not support Twilio's volume indicator feature.")}),s&&this._initializeEnumeration(),navigator&&navigator.permissions&&typeof navigator.permissions.query=="function"?navigator.permissions.query({name:"microphone"}).then(a=>{if(a.state!=="granted"){const l=()=>{this._updateAvailableDevices(),this._stopMicrophonePermissionListener()};a.addEventListener("change",l),this._microphonePermissionStatus=a,this._onMicrophonePermissionStatusChanged=l}}).catch(a=>this._log.warn(`Warning: unable to listen for microphone permission changes. ${a}`)):this._log.warn("Warning: current browser does not support permissions API.")}_destroy(){this._stopDefaultInputDeviceStream(),this._stopSelectedInputDeviceStream(),this._destroyProcessedStream(),this._maybeStopPollingVolume(),this.removeAllListeners(),this._stopMicrophonePermissionListener(),this._unbind()}_getInputDevicePromise(){return this._inputDevicePromise}_maybeStartPollingVolume(){if(!this.isVolumeSupported||!this.inputStream||(this._updateVolumeSource(),this._isPollingInputVolume||!this._inputVolumeAnalyser))return;const e=this._inputVolumeAnalyser.frequencyBinCount,n=new Uint8Array(e);this._isPollingInputVolume=!0;const r=()=>{if(this._isPollingInputVolume){if(this._inputVolumeAnalyser){this._inputVolumeAnalyser.getByteFrequencyData(n);const i=bc(n);this.emit("inputVolume",i/255)}requestAnimationFrame(r)}};requestAnimationFrame(r)}_maybeStopPollingVolume(){this.isVolumeSupported&&(!this._isPollingInputVolume||this.inputStream&&this.listenerCount("inputVolume")||(this._inputVolumeSource&&(this._inputVolumeSource.disconnect(),delete this._inputVolumeSource),this._isPollingInputVolume=!1))}_openDefaultDeviceWithConstraints(e){return this._log.info("Opening default device with constraints",e),this._getUserMedia(e).then(n=>(this._log.info("Opened default device. Updating available devices."),this._updateAvailableDevices().catch(r=>{this._log.warn("Unable to updateAvailableDevices after gUM call",r)}),this._defaultInputDeviceStream=n,this._maybeCreateProcessedStream(n)))}_stopDefaultInputDeviceStream(){this._defaultInputDeviceStream&&(this._log.info("stopping default device stream"),this._defaultInputDeviceStream.getTracks().forEach(e=>e.stop()),this._defaultInputDeviceStream=null,this._destroyProcessedStream())}_unbind(){var e;!((e=this._mediaDevices)===null||e===void 0)&&e.removeEventListener&&this._mediaDevices.removeEventListener("devicechange",this._updateAvailableDevices)}_updateUserOptions(e){typeof e.enumerateDevices=="function"&&(this._enumerateDevices=e.enumerateDevices),typeof e.getUserMedia=="function"&&(this._getUserMedia=e.getUserMedia)}addProcessor(e){if(this._log.debug(".addProcessor"),this._processor)throw new tn("Adding multiple AudioProcessors is not supported at this time.");if(typeof e!="object"||e===null)throw new et("Missing AudioProcessor argument.");if(typeof e.createProcessedStream!="function")throw new et("Missing createProcessedStream() method.");if(typeof e.destroyProcessedStream!="function")throw new et("Missing destroyProcessedStream() method.");return this._processor=e,this._audioProcessorEventObserver.emit("add"),this._restartStreams()}disconnect(e){return this._log.debug(".disconnect",e),this._maybeEnableSound(ie.SoundName.Disconnect,e)}incoming(e){return this._log.debug(".incoming",e),this._maybeEnableSound(ie.SoundName.Incoming,e)}outgoing(e){return this._log.debug(".outgoing",e),this._maybeEnableSound(ie.SoundName.Outgoing,e)}removeProcessor(e){if(this._log.debug(".removeProcessor"),typeof e!="object"||e===null)throw new et("Missing AudioProcessor argument.");if(this._processor!==e)throw new et("Cannot remove an AudioProcessor that has not been previously added.");return this._destroyProcessedStream(),this._processor=null,this._audioProcessorEventObserver.emit("remove"),this._restartStreams()}setAudioConstraints(e){return this._log.debug(".setAudioConstraints",e),this._audioConstraints=Object.assign({},e),delete this._audioConstraints.deviceId,this.inputDevice?this._setInputDevice(this.inputDevice.deviceId,!0):Promise.resolve()}setInputDevice(e){return this._log.debug(".setInputDevice",e),this._setInputDevice(e,!1)}unsetAudioConstraints(){return this._log.debug(".unsetAudioConstraints"),this._audioConstraints=null,this.inputDevice?this._setInputDevice(this.inputDevice.deviceId,!0):Promise.resolve()}unsetInputDevice(){return this._log.debug(".unsetInputDevice",this.inputDevice),this.inputDevice?(this._destroyProcessedStream(),this._onActiveInputChanged(null).then(()=>{this._replaceStream(null),this._inputDevice=null,this._maybeStopPollingVolume()})):Promise.resolve()}_destroyProcessedStream(){if(this._processor&&this._processedStream){this._log.info("destroying processed stream");const e=this._processedStream;this._processedStream.getTracks().forEach(n=>n.stop()),this._processedStream=null,this._processor.destroyProcessedStream(e),this._audioProcessorEventObserver.emit("destroy")}}_getUnknownDeviceIndex(e){const n=e.deviceId,r=e.kind;let i=this._unknownDeviceIndexes[r][n];return i||(i=Object.keys(this._unknownDeviceIndexes[r]).length+1,this._unknownDeviceIndexes[r][n]=i),i}_initializeEnumeration(){if(!this._mediaDevices||!this._enumerateDevices)throw new tn("Enumeration is not supported");this._mediaDevices.addEventListener&&this._mediaDevices.addEventListener("devicechange",this._updateAvailableDevices),this._updateAvailableDevices().then(()=>{this.isOutputSelectionSupported&&Promise.all([this.speakerDevices.set("default"),this.ringtoneDevices.set("default")]).catch(e=>{this._log.warn(`Warning: Unable to set audio output devices. ${e}`)})})}_maybeCreateProcessedStream(e){return this._processor?(this._log.info("Creating processed stream"),this._processor.createProcessedStream(e).then(n=>(this._processedStream=n,this._audioProcessorEventObserver.emit("create"),this._processedStream))):Promise.resolve(e)}_maybeEnableSound(e,n){return typeof n<"u"&&(this._enabledSounds[e]=n),this._enabledSounds[e]}_replaceStream(e){this._log.info("Replacing with new stream."),this._selectedInputDeviceStream&&(this._log.info("Old stream detected. Stopping tracks."),this._stopSelectedInputDeviceStream()),this._selectedInputDeviceStream=e}_restartStreams(){if(this.inputDevice&&this._selectedInputDeviceStream)return this._log.info("Restarting selected input device"),this._setInputDevice(this.inputDevice.deviceId,!0);if(this._defaultInputDeviceStream){const e=this.availableInputDevices.get("default")||Array.from(this.availableInputDevices.values())[0];return this._log.info("Restarting default input device, now becoming selected."),this._setInputDevice(e.deviceId,!0)}return Promise.resolve()}_setInputDevice(e,n){return An(this,void 0,void 0,function*(){const r=()=>An(this,void 0,void 0,function*(){if(yield this._beforeSetInputDevice(),typeof e!="string")return Promise.reject(new et("Must specify the device to set"));const i=this.availableInputDevices.get(e);if(!i)return Promise.reject(new et(`Device not found: ${e}`));if(this._log.info("Setting input device. ID: "+e),this._inputDevice&&this._inputDevice.deviceId===e&&this._selectedInputDeviceStream){if(!n)return Promise.resolve();this._log.info("Same track detected on setInputDevice, stopping old tracks."),this._stopSelectedInputDeviceStream()}this._stopDefaultInputDeviceStream();const s={audio:Object.assign({deviceId:{exact:e}},this.audioConstraints)};return this._log.info("setInputDevice: getting new tracks."),this._getUserMedia(s).then(o=>(this._destroyProcessedStream(),this._maybeCreateProcessedStream(o).then(a=>(this._log.info("setInputDevice: invoking _onActiveInputChanged."),this._onActiveInputChanged(a).then(()=>{this._replaceStream(o),this._inputDevice=i,this._maybeStartPollingVolume()})))))});return this._inputDevicePromise=r().finally(()=>{this._inputDevicePromise=null})})}_stopMicrophonePermissionListener(){var e;!((e=this._microphonePermissionStatus)===null||e===void 0)&&e.removeEventListener&&this._microphonePermissionStatus.removeEventListener("change",this._onMicrophonePermissionStatusChanged)}_stopSelectedInputDeviceStream(){this._selectedInputDeviceStream&&(this._log.info("Stopping selected device stream"),this._selectedInputDeviceStream.getTracks().forEach(e=>e.stop()))}_updateDevices(e,n,r){const i=e.map(u=>u.deviceId),s=Array.from(n.values()).map(u=>u.deviceId),o=[],a=tv(s,i);a.forEach(u=>{const d=n.get(u);d&&(n.delete(u),r(d)&&o.push(d))});let l=!1;if(e.forEach(u=>{const d=n.get(u.deviceId),h=this._wrapMediaDeviceInfo(u);(!d||d.label!==h.label)&&(n.set(u.deviceId,h),l=!0)}),l||a.length){const u="default",d=this.inputDevice&&this.inputDevice.deviceId===u,h=this._defaultInputDeviceStream&&this.availableInputDevices.get(u);(d||h)&&(this._log.warn("Calling getUserMedia after device change to ensure that the           tracks of the active device (default) have not gone stale."),setTimeout(()=>{this._setInputDevice(u,!0)},0)),this._log.debug("#deviceChange",o),this.emit("deviceChange",o)}}_updateVolumeSource(){if(!(!this.inputStream||!this._audioContext||!this._inputVolumeAnalyser)){this._inputVolumeSource&&this._inputVolumeSource.disconnect();try{this._inputVolumeSource=this._audioContext.createMediaStreamSource(this.inputStream),this._inputVolumeSource.connect(this._inputVolumeAnalyser)}catch(e){this._log.warn("Unable to update volume source",e),delete this._inputVolumeSource}}}_wrapMediaDeviceInfo(e){const n={deviceId:e.deviceId,groupId:e.groupId,kind:e.kind,label:e.label};if(!n.label)if(n.deviceId==="default")n.label="Default";else{const r=this._getUnknownDeviceIndex(e);n.label=`Unknown ${ZF[n.kind]} Device ${r}`}return new KF(n)}}Mg||(Mg={});var XF=Mg;class e4 extends Er.EventEmitter{constructor(){super(),this._log=new Ft("AudioProcessorEventObserver"),this._log.info("Creating AudioProcessorEventObserver instance"),this.on("enabled",()=>this._reEmitEvent("enabled")),this.on("add",()=>this._reEmitEvent("add")),this.on("remove",()=>this._reEmitEvent("remove")),this.on("create",()=>this._reEmitEvent("create-processed-stream")),this.on("destroy",()=>this._reEmitEvent("destroy-processed-stream"))}destroy(){this.removeAllListeners()}_reEmitEvent(e){this._log.info(`AudioProcessor:${e}`),this.emit("event",{name:e,group:"audio-processor"})}}const t4={dtmf0:[1360,960],dtmf1:[1230,720],dtmf2:[1360,720],dtmf3:[1480,720],dtmf4:[1230,790],dtmf5:[1360,790],dtmf6:[1480,790],dtmf7:[1230,870],dtmf8:[1360,870],dtmf9:[1480,870],dtmfh:[1480,960],dtmfs:[1230,960]};class n4{constructor(e){this._context=e,this._gainNodes=[],this._gainNodes=[this._context.createGain(),this._context.createGain()],this._gainNodes.forEach(n=>{n.connect(this._context.destination),n.gain.value=.1,this._gainNodes.push(n)})}cleanup(){this._gainNodes.forEach(e=>{e.disconnect()})}play(e){const n=t4[e];if(!n)throw new et("Invalid DTMF sound name");[this._context.createOscillator(),this._context.createOscillator()].forEach((i,s)=>{i.type="sine",i.frequency.value=n[s],i.connect(this._gainNodes[s]),i.start(),i.stop(this._context.currentTime+.1),i.addEventListener("ended",()=>i.disconnect())})}}function r4(t,e,n){const r=JSON.stringify(e.body||{}),i=new Headers;e.headers=e.headers||[],Object.entries(e.headers).forEach(([s,o])=>i.append(s,o)),fetch(e.url,{body:r,headers:i,method:t}).then(s=>s.text(),n).then(s=>n(null,s),n)}const rv=r4;rv.get=function(e,n){return new this("GET",e,n)};rv.post=function(e,n){return new this("POST",e,n)};class Dn extends Er.EventEmitter{constructor(e,n,r){if(super(),!(this instanceof Dn))return new Dn(e,n,r);r=Object.assign({defaultPayload(){return{}}},r);let i=r.defaultPayload;typeof i!="function"&&(i=()=>Object.assign({},r.defaultPayload));let s=!0;const o=Object.assign({app_name:void 0,app_version:void 0},r.metadata);Object.defineProperties(this,{_defaultPayload:{value:i},_host:{value:r.host,writable:!0},_isEnabled:{get(){return s},set(a){s=a}},_log:{value:new Ft("EventPublisher")},_request:{value:r.request||rv,writable:!0},_token:{value:n,writable:!0},isEnabled:{enumerable:!0,get(){return s}},metadata:{enumerable:!0,get(){return o}},productName:{enumerable:!0,value:e},token:{enumerable:!0,get(){return this._token}}})}}Dn.prototype._post=function(e,n,r,i,s,o,a){if(!this.isEnabled&&!a||!this._host)return this._log.debug("Publishing cancelled",JSON.stringify({isEnabled:this.isEnabled,force:a,host:this._host})),Promise.resolve();if(!o||(!o.parameters||!o.parameters.CallSid)&&!o.outboundConnectionId)return o?this._log.debug("Publishing cancelled. Missing connection info",JSON.stringify({outboundConnectionId:o.outboundConnectionId,parameters:o.parameters})):this._log.debug("Publishing cancelled. Missing connection object"),Promise.resolve();const l={group:r,level:n.toUpperCase(),name:i,payload:s&&s.forEach?s.slice(0):Object.assign(this._defaultPayload(o),s),payload_type:"application/json",private:!1,publisher:this.productName,timestamp:new Date().toISOString()};this.metadata&&(l.publisher_metadata=this.metadata),e==="EndpointEvents"&&this._log.debug("Publishing insights",JSON.stringify({endpointName:e,event:l,force:a,host:this._host}));const u={body:l,headers:{"Content-Type":"application/json","X-Twilio-Token":this.token},url:`https://${this._host}/v4/${e}`};return new Promise((d,h)=>{this._request.post(u,p=>{p?(this.emit("error",p),h(p)):d()})}).catch(d=>{this._log.error(`Unable to post ${r} ${i} event to Insights. Received error: ${d}`)})};Dn.prototype.post=function(e,n,r,i,s,o){return this._post("EndpointEvents",e,n,r,i,s,o)};Dn.prototype.debug=function(e,n,r,i){return this.post("debug",e,n,r,i)};Dn.prototype.info=function(e,n,r,i){return this.post("info",e,n,r,i)};Dn.prototype.warn=function(e,n,r,i){return this.post("warning",e,n,r,i)};Dn.prototype.error=function(e,n,r,i){return this.post("error",e,n,r,i)};Dn.prototype.postMetrics=function(e,n,r,i,s){return new Promise(o=>{const a=r.map(i4).map(l=>Object.assign(l,i));o(this._post("EndpointMetrics","info",e,n,a,s))})};Dn.prototype.setHost=function(e){this._host=e};Dn.prototype.setToken=function(e){this._token=e};Dn.prototype.enable=function(){this._isEnabled=!0};Dn.prototype.disable=function(){this._isEnabled=!1};function i4(t){return{audio_codec:t.codecName,audio_level_in:t.audioInputLevel,audio_level_out:t.audioOutputLevel,bytes_received:t.bytesReceived,bytes_sent:t.bytesSent,call_volume_input:t.inputVolume,call_volume_output:t.outputVolume,jitter:t.jitter,mos:t.mos&&Math.round(t.mos*100)/100,packets_lost:t.packetsLost,packets_lost_fraction:t.packetsLostFraction&&Math.round(t.packetsLostFraction*100)/100,packets_received:t.packetsReceived,rtt:t.rtt,timestamp:new Date(t.timestamp).toISOString(),total_bytes_received:t.totals.bytesReceived,total_bytes_sent:t.totals.bytesSent,total_packets_lost:t.totals.packetsLost,total_packets_received:t.totals.packetsReceived,total_packets_sent:t.totals.packetsSent}}const oS=32767,aS=typeof window<"u"?window.RTCStatsReport:void 0;function Fr(t){if(!(this instanceof Fr))return new Fr(t);const e=this;Object.defineProperties(this,{_map:{value:t},size:{enumerable:!0,get(){return e._map.size}}}),this[Symbol.iterator]=t[Symbol.iterator]}aS&&(Fr.prototype=Object.create(aS.prototype),Fr.prototype.constructor=Fr);["entries","forEach","get","has","keys","values"].forEach(t=>{Fr.prototype[t]=function(...e){return this._map[t](...e)}});Fr.fromArray=function(e){return new Fr(e.reduce((n,r)=>(n.set(r.id,r),n),new Map))};Fr.fromRTCStatsResponse=function(e){let n;const r=new Map,i=e.result().reduce((s,o)=>{const a=o.id;switch(o.type){case"googCertificate":s.set(a,u4(o));break;case"datachannel":s.set(a,d4(o));break;case"googCandidatePair":zk(o,"googActiveConnection")&&(n=a),s.set(a,c4(o));break;case"localcandidate":s.set(a,cS(o,!1));break;case"remotecandidate":s.set(a,cS(o,!0));break;case"ssrc":xo(o,"packetsReceived")?s.set(`rtp-${a}`,a4(o)):s.set(`rtp-${a}`,l4(o)),s.set(`track-${a}`,o4(o)),s.set(`codec-${a}`,s4(o));break;case"googComponent":const l=lS(o);r.set(l.selectedCandidatePairId,a),s.set(a,lS(o));break}return s},new Map);if(n){const s=r.get(n);s&&(i.get(s).dtlsState="connected")}return new Fr(i)};function lS(t){return{bytesReceived:void 0,bytesSent:void 0,dtlsState:void 0,id:t.id,localCertificateId:t.stat("localCertificateId"),remoteCertificateId:t.stat("remoteCertificateId"),rtcpTransportStatsId:void 0,selectedCandidatePairId:t.stat("selectedCandidatePairId"),timestamp:Date.parse(t.timestamp),type:"transport"}}function s4(t){return{channels:void 0,clockRate:void 0,id:t.id,implementation:void 0,mimeType:`${t.stat("mediaType")}/${t.stat("googCodecName")}`,payloadType:void 0,sdpFmtpLine:void 0,timestamp:Date.parse(t.timestamp),type:"codec"}}function o4(t){return{audioLevel:xo(t,"audioOutputLevel")?Xe(t,"audioOutputLevel")/oS:(Xe(t,"audioInputLevel")||0)/oS,detached:void 0,echoReturnLoss:jg(t,"googEchoCancellationReturnLoss"),echoReturnLossEnhancement:jg(t,"googEchoCancellationReturnLossEnhancement"),ended:void 0,frameHeight:xo(t,"googFrameHeightReceived")?Xe(t,"googFrameHeightReceived"):Xe(t,"googFrameHeightSent"),frameWidth:xo(t,"googFrameWidthReceived")?Xe(t,"googFrameWidthReceived"):Xe(t,"googFrameWidthSent"),framesCorrupted:void 0,framesDecoded:Xe(t,"framesDecoded"),framesDropped:void 0,framesPerSecond:void 0,framesReceived:void 0,framesSent:Xe(t,"framesEncoded"),fullFramesLost:void 0,id:t.id,kind:t.stat("mediaType"),partialFramesLost:void 0,remoteSource:void 0,ssrcIds:void 0,timestamp:Date.parse(t.timestamp),trackIdentifier:t.stat("googTrackId"),type:"track"}}function Bk(t,e){return{associateStatsId:void 0,codecId:`codec-${t.id}`,firCount:e?Xe(t,"googFirsSent"):void 0,id:t.id,isRemote:void 0,mediaType:t.stat("mediaType"),nackCount:e?Xe(t,"googNacksSent"):Xe(t,"googNacksReceived"),pliCount:e?Xe(t,"googPlisSent"):Xe(t,"googPlisReceived"),qpSum:Xe(t,"qpSum"),sliCount:void 0,ssrc:t.stat("ssrc"),timestamp:Date.parse(t.timestamp),trackId:`track-${t.id}`,transportId:t.stat("transportId")}}function a4(t){const e=Bk(t,!0);return Object.assign(e,{burstDiscardCount:void 0,burstDiscardRate:void 0,burstLossCount:void 0,burstLossRate:void 0,burstPacketsDiscarded:void 0,burstPacketsLost:void 0,bytesReceived:Xe(t,"bytesReceived"),fractionLost:void 0,framesDecoded:Xe(t,"framesDecoded"),gapDiscardRate:void 0,gapLossRate:void 0,jitter:Vg(t.stat("googJitterReceived")),packetsDiscarded:void 0,packetsLost:Xe(t,"packetsLost"),packetsReceived:Xe(t,"packetsReceived"),packetsRepaired:void 0,roundTripTime:Vg(t.stat("googRtt")),type:"inbound-rtp"}),e}function l4(t){const e=Bk(t,!1);return Object.assign(e,{bytesSent:Xe(t,"bytesSent"),framesEncoded:Xe(t,"framesEncoded"),packetsSent:Xe(t,"packetsSent"),remoteTimestamp:void 0,targetBitrate:void 0,type:"outbound-rtp"}),e}function cS(t,e){return{candidateType:h4(t.stat("candidateType")),deleted:void 0,id:t.id,ip:t.stat("ipAddress"),isRemote:e,port:Xe(t,"portNumber"),priority:jg(t,"priority"),protocol:t.stat("transport"),relayProtocol:void 0,timestamp:Date.parse(t.timestamp),transportId:void 0,type:e?"remote-candidate":"local-candidate",url:void 0}}function c4(t){return{availableIncomingBitrate:void 0,availableOutgoingBitrate:void 0,bytesReceived:Xe(t,"bytesReceived"),bytesSent:Xe(t,"bytesSent"),consentRequestsSent:Xe(t,"consentRequestsSent"),currentRoundTripTime:Vg(t.stat("googRtt")),id:t.id,lastPacketReceivedTimestamp:void 0,lastPacketSentTimestamp:void 0,localCandidateId:t.stat("localCandidateId"),nominated:void 0,priority:void 0,readable:void 0,remoteCandidateId:t.stat("remoteCandidateId"),requestsReceived:Xe(t,"requestsReceived"),requestsSent:Xe(t,"requestsSent"),responsesReceived:Xe(t,"responsesReceived"),responsesSent:Xe(t,"responsesSent"),retransmissionsReceived:void 0,retransmissionsSent:void 0,state:void 0,timestamp:Date.parse(t.timestamp),totalRoundTripTime:void 0,transportId:t.stat("googChannelId"),type:"candidate-pair",writable:zk(t,"googWritable")}}function u4(t){return{base64Certificate:t.stat("googDerBase64"),fingerprint:t.stat("googFingerprint"),fingerprintAlgorithm:t.stat("googFingerprintAlgorithm"),id:t.id,issuerCertificateId:t.stat("googIssuerId"),timestamp:Date.parse(t.timestamp),type:"certificate"}}function d4(t){return{bytesReceived:void 0,bytesSent:void 0,datachannelid:t.stat("datachannelid"),id:t.id,label:t.stat("label"),messagesReceived:void 0,messagesSent:void 0,protocol:t.stat("protocol"),state:t.stat("state"),timestamp:Date.parse(t.timestamp),transportId:t.stat("transportId"),type:"data-channel"}}function Vg(t){return isNaN(t)||t===""?void 0:parseInt(t,10)/1e3}function h4(t){switch(t){case"peerreflexive":return"prflx";case"serverreflexive":return"srflx";case"host":case"relay":default:return t}}function Xe(t,e){const n=t.stat(e);return xo(t,e)?parseInt(n,10):void 0}function jg(t,e){const n=t.stat(e);return xo(t,e)?parseFloat(n):void 0}function zk(t,e){const n=t.stat(e);return xo(t,e)?n==="true"||n===!0:void 0}function xo(t,e){const n=t.stat(e);return typeof n<"u"&&n!==""}const f4="PeerConnection is null",p4="WebRTC statistics are unsupported";function Zo(t,e){return typeof t.get=="function"?t.get(e):t.find(n=>n.id===e)}function Wk(t){if(!t)return Promise.reject(new et(f4));if(typeof t.getStats!="function")return Promise.reject(new tn(p4));let e;try{e=t.getStats()}catch{e=new Promise(r=>t.getStats(r)).then(Fr.fromRTCStatsResponse)}return e}function m4(t,e){return e=Object.assign({createRTCSample:_4},e),Wk(t).then(e.createRTCSample)}function g4(t){return Wk(t).then(e=>{const{candidatePairs:n,localCandidates:r,remoteCandidates:i,transport:s}=Array.from(e.values()).reduce((l,u)=>{switch(["candidatePairs","localCandidates","remoteCandidates"].forEach(d=>{l[d]||(l[d]=[])}),u.type){case"candidate-pair":l.candidatePairs.push(u);break;case"local-candidate":l.localCandidates.push(u);break;case"remote-candidate":l.remoteCandidates.push(u);break;case"transport":u.selectedCandidatePairId&&(l.transport=u);break}return l},{}),o=n.find(l=>l.selected||s&&l.id===s.selectedCandidatePairId);let a;return o&&(a={localCandidate:r.find(l=>l.id===o.localCandidateId),remoteCandidate:i.find(l=>l.id===o.remoteCandidateId)}),{iceCandidateStats:[...r,...i],selectedIceCandidatePairStats:a}})}function y4(){}function _4(t){let e=null;const n=new y4;let r;Array.from(t.values()).forEach(l=>{if(l.isRemote)return;const u=l.type.replace("-","");if(r=r||l.timestamp,l.remoteId){const d=Zo(t,l.remoteId);d&&d.roundTripTime&&(n.rtt=d.roundTripTime*1e3)}switch(u){case"inboundrtp":n.timestamp=n.timestamp||l.timestamp,n.jitter=l.jitter*1e3,n.packetsLost=l.packetsLost,n.packetsReceived=l.packetsReceived,n.bytesReceived=l.bytesReceived;break;case"outboundrtp":if(n.timestamp=l.timestamp,n.packetsSent=l.packetsSent,n.bytesSent=l.bytesSent,l.codecId){const d=Zo(t,l.codecId);n.codecName=d?d.mimeType&&d.mimeType.match(/(.*\/)?(.*)/)[2]:l.codecId}break;case"transport":e=l.id;break}}),n.timestamp||(n.timestamp=r);const i=Zo(t,e);if(!i)return n;const s=Zo(t,i.selectedCandidatePairId);if(!s)return n;const o=Zo(t,s.localCandidateId),a=Zo(t,s.remoteCandidateId);return n.rtt||(n.rtt=s&&s.currentRoundTripTime*1e3),Object.assign(n,{localAddress:o&&(o.address||o.ip),remoteAddress:a&&(a.address||a.ip)}),n}class gt extends Er.EventEmitter{constructor(e,n){super(),this._hasInsightsErrored=!1,this._log=new Ft("PreflightTest"),this._networkTiming={},this._options={codecPreferences:[re.Codec.PCMU,re.Codec.Opus],edge:"roaming",fakeMicInput:!1,logLevel:"error",signalingTimeoutMs:1e4},this._status=gt.Status.Connecting,Object.assign(this._options,n),this._samples=[],this._warnings=[],this._startTime=Date.now(),this._initDevice(e,Object.assign(Object.assign({},this._options),{fileInputStream:this._options.fakeMicInput?this._getStreamFromFile():void 0}));const r=["codecPreferences","edge","fakeMicInput","logLevel","signalingTimeoutMs"],i=["audioContext","deviceFactory","fileInputStream","getRTCIceCandidateStatsReport","iceServers","rtcConfiguration"];if(typeof n=="object"){const s=Object.assign({},n);Object.keys(s).forEach(o=>{!r.includes(o)&&!i.includes(o)&&delete s[o],i.includes(o)&&(s[o]=!0)}),this._log.debug(".constructor",JSON.stringify(s))}}stop(){this._log.debug(".stop");const e=new pn.CallCancelledError;this._device?(this._device.once(ie.EventName.Unregistered,()=>this._onFailed(e)),this._device.destroy()):this._onFailed(e)}_emitWarning(e,n,r){const i={name:e,description:n};r&&(i.rtcWarning=r),this._warnings.push(i),this._log.debug(`#${gt.Events.Warning}`,JSON.stringify(i)),this.emit(gt.Events.Warning,i)}_getCallQuality(e){return e>4.2?gt.CallQuality.Excellent:e>=4.1&&e<=4.2?gt.CallQuality.Great:e>=3.7&&e<=4?gt.CallQuality.Good:e>=3.1&&e<=3.6?gt.CallQuality.Fair:gt.CallQuality.Degraded}_getReport(){var e,n,r;const i=this._getRTCStats(),s={start:this._startTime};this._endTime&&(s.end=this._endTime,s.duration=this._endTime-this._startTime);const o={callSid:this._callSid,edge:this._edge,iceCandidateStats:(n=(e=this._rtcIceCandidateStatsReport)===null||e===void 0?void 0:e.iceCandidateStats)!==null&&n!==void 0?n:[],networkTiming:this._networkTiming,samples:this._samples,selectedEdge:this._options.edge,stats:i,testTiming:s,totals:this._getRTCSampleTotals(),warnings:this._warnings},a=(r=this._rtcIceCandidateStatsReport)===null||r===void 0?void 0:r.selectedIceCandidatePairStats;return a&&(o.selectedIceCandidatePairStats=a,o.isTurnRequired=a.localCandidate.candidateType==="relay"||a.remoteCandidate.candidateType==="relay"),i&&(o.callQuality=this._getCallQuality(i.mos.average)),o}_getRTCSampleTotals(){if(this._latestSample)return Object.assign({},this._latestSample.totals)}_getRTCStats(){const e=this._samples.findIndex(r=>typeof r.mos=="number"&&r.mos>0),n=e>=0?this._samples.slice(e):[];if(!(!n||!n.length))return["jitter","mos","rtt"].reduce((r,i)=>{const s=n.map(o=>o[i]);return Object.assign(Object.assign({},r),{[i]:{average:Number((s.reduce((o,a)=>o+a)/s.length).toPrecision(5)),max:Math.max(...s),min:Math.min(...s)}})},{})}_getStreamFromFile(){const e=this._options.audioContext;if(!e)throw new tn("Cannot fake input audio stream: AudioContext is not supported by this browser.");const n=new Audio(qF);n.addEventListener("canplaythrough",()=>n.play()),typeof n.setAttribute=="function"&&n.setAttribute("crossorigin","anonymous");const r=e.createMediaElementSource(n),i=e.createMediaStreamDestination();return r.connect(i),i.stream}_initDevice(e,n){try{this._device=new(n.deviceFactory||ie)(e,{chunderw:n.chunderw,codecPreferences:n.codecPreferences,edge:n.edge,eventgw:n.eventgw,fileInputStream:n.fileInputStream,logLevel:n.logLevel,preflight:!0}),this._device.once(ie.EventName.Registered,()=>{this._onDeviceRegistered()}),this._device.once(ie.EventName.Error,r=>{this._onDeviceError(r)}),this._device.register()}catch(r){setTimeout(()=>{this._onFailed(r)});return}this._signalingTimeoutTimer=setTimeout(()=>{this._onDeviceError(new _r.ConnectionError("WebSocket Connection Timeout"))},n.signalingTimeoutMs)}_onDeviceError(e){this._device.destroy(),this._onFailed(e)}_onDeviceRegistered(){return An(this,void 0,void 0,function*(){if(clearTimeout(this._echoTimer),clearTimeout(this._signalingTimeoutTimer),this._call=yield this._device.connect({rtcConfiguration:this._options.rtcConfiguration}),this._networkTiming.signaling={start:Date.now()},this._setupCallHandlers(this._call),this._edge=this._device.edge||void 0,this._options.fakeMicInput){this._echoTimer=setTimeout(()=>this._device.disconnectAll(),HF);const n=this._device.audio;n&&(n.disconnect(!1),n.outgoing(!1))}this._call.once("disconnect",()=>{this._device.once(ie.EventName.Unregistered,()=>this._onUnregistered()),this._device.destroy()}),this._call._publisher.on("error",()=>{this._hasInsightsErrored||this._emitWarning("insights-connection-error","Received an error when attempting to connect to Insights gateway"),this._hasInsightsErrored=!0})})}_onFailed(e){clearTimeout(this._echoTimer),clearTimeout(this._signalingTimeoutTimer),this._releaseHandlers(),this._endTime=Date.now(),this._status=gt.Status.Failed,this._log.debug(`#${gt.Events.Failed}`,e),this.emit(gt.Events.Failed,e)}_onUnregistered(){setTimeout(()=>{this._status!==gt.Status.Failed&&(clearTimeout(this._echoTimer),clearTimeout(this._signalingTimeoutTimer),this._releaseHandlers(),this._endTime=Date.now(),this._status=gt.Status.Completed,this._report=this._getReport(),this._log.debug(`#${gt.Events.Completed}`,JSON.stringify(this._report)),this.emit(gt.Events.Completed,this._report))},10)}_releaseHandlers(){[this._device,this._call].forEach(e=>{e&&e.eventNames().forEach(n=>e.removeAllListeners(n))})}_setupCallHandlers(e){this._options.fakeMicInput&&e.once("volume",()=>{e._mediaHandler.outputs.forEach(n=>n.audio.muted=!0)}),e.on("warning",(n,r)=>{this._emitWarning(n,"Received an RTCWarning. See .rtcWarning for the RTCWarning",r)}),e.once("accept",()=>{this._callSid=e._mediaHandler.callSid,this._status=gt.Status.Connected,this._log.debug(`#${gt.Events.Connected}`),this.emit(gt.Events.Connected)}),e.on("sample",n=>An(this,void 0,void 0,function*(){this._latestSample||(this._rtcIceCandidateStatsReport=yield(this._options.getRTCIceCandidateStatsReport||g4)(e._mediaHandler.version.pc)),this._latestSample=n,this._samples.push(n),this._log.debug(`#${gt.Events.Sample}`,JSON.stringify(n)),this.emit(gt.Events.Sample,n)})),[{reportLabel:"peerConnection",type:"pcconnection"},{reportLabel:"ice",type:"iceconnection"},{reportLabel:"dtls",type:"dtlstransport"},{reportLabel:"signaling",type:"signaling"}].forEach(({type:n,reportLabel:r})=>{const i=`on${n}statechange`,s=e._mediaHandler[i];e._mediaHandler[i]=o=>{const a=this._networkTiming[r]=this._networkTiming[r]||{start:0};o==="connecting"||o==="checking"?a.start=Date.now():(o==="connected"||o==="stable")&&!a.duration&&(a.end=Date.now(),a.duration=a.end-a.start),s(o)}})}get callSid(){return this._callSid}get endTime(){return this._endTime}get latestSample(){return this._latestSample}get report(){return this._report}get startTime(){return this._startTime}get status(){return this._status}}(function(t){(function(e){e.Excellent="excellent",e.Great="great",e.Good="good",e.Fair="fair",e.Degraded="degraded"})(t.CallQuality||(t.CallQuality={})),function(e){e.Completed="completed",e.Connected="connected",e.Failed="failed",e.Sample="sample",e.Warning="warning"}(t.Events||(t.Events={})),function(e){e.Connecting="connecting",e.Connected="connected",e.Completed="completed",e.Failed="failed"}(t.Status||(t.Status={}))})(gt||(gt={}));const oa=globalThis.WebSocket,v4=1e4,w4=5e3,uS=15e3,E4=15e3,S4=1/0,T4=1e3,x4=2e4;var Zn;(function(t){t.Connecting="connecting",t.Closed="closed",t.Open="open"})(Zn||(Zn={}));class Nf extends Er.EventEmitter{constructor(e,n={}){super(),this.state=Zn.Closed,this._backoffStartTime={preferred:null,primary:null},this._connectedUri=null,this._log=new Ft("WSTransport"),this._shouldFallback=!1,this._uriIndex=0,this._moveUriIndex=()=>{this._uriIndex++,this._uriIndex>=this._uris.length&&(this._uriIndex=0)},this._onSocketClose=r=>{if(this._log.error(`Received websocket close event code: ${r.code}. Reason: ${r.reason}`),r.code===1006||r.code===1015){this.emit("error",{code:31005,message:r.reason||"Websocket connection to Twilio's signaling servers were unexpectedly ended. If this is happening consistently, there may be an issue resolving the hostname provided. If a region or an edge is being specified in Device setup, ensure it is valid.",twilioError:new _r.ConnectionError});const i=this.state===Zn.Open||this._previousState===Zn.Open;(this._shouldFallback||!i)&&this._moveUriIndex(),this._shouldFallback=!0}this._closeSocket()},this._onSocketError=r=>{this._log.error(`WebSocket received error: ${r.message}`),this.emit("error",{code:31e3,message:r.message||"WSTransport socket error",twilioError:new _r.ConnectionDisconnected})},this._onSocketMessage=r=>{if(this._setHeartbeatTimeout(),this._socket&&r.data===`
`){this._socket.send(`
`),this._log.debug("heartbeat");return}r&&typeof r.data=="string"&&this._log.debug(`Received: ${r.data}`),this.emit("message",r)},this._onSocketOpen=()=>{this._log.info("WebSocket opened successfully."),this._timeOpened=Date.now(),this._shouldFallback=!1,this._setState(Zn.Open),clearTimeout(this._connectTimeout),this._resetBackoffs(),this._setHeartbeatTimeout(),this.emit("open")},this._options=Object.assign(Object.assign({},Nf.defaultConstructorOptions),n),this._uris=e,this._backoff=this._setupBackoffs()}close(){this._log.info("WSTransport.close() called..."),this._close()}open(){if(this._log.info("WSTransport.open() called..."),this._socket&&(this._socket.readyState===oa.CONNECTING||this._socket.readyState===oa.OPEN)){this._log.info("WebSocket already open.");return}this._preferredUri?this._connect(this._preferredUri):this._connect(this._uris[this._uriIndex])}send(e){if(this._log.debug(`Sending: ${e}`),!this._socket||this._socket.readyState!==oa.OPEN)return this._log.debug("Cannot send message. WebSocket is not open."),!1;try{this._socket.send(e)}catch(n){return this._log.error("Error while sending message:",n.message),this._closeSocket(),!1}return!0}updatePreferredURI(e){this._preferredUri=e}updateURIs(e){typeof e=="string"&&(e=[e]),this._uris=e,this._uriIndex=0}_close(){this._setState(Zn.Closed),this._closeSocket()}_closeSocket(){if(clearTimeout(this._connectTimeout),clearTimeout(this._heartbeatTimeout),this._log.info("Closing and cleaning up WebSocket..."),!this._socket){this._log.info("No WebSocket to clean up.");return}this._socket.removeEventListener("close",this._onSocketClose),this._socket.removeEventListener("error",this._onSocketError),this._socket.removeEventListener("message",this._onSocketMessage),this._socket.removeEventListener("open",this._onSocketOpen),(this._socket.readyState===oa.CONNECTING||this._socket.readyState===oa.OPEN)&&this._socket.close(),this._timeOpened&&Date.now()-this._timeOpened>v4&&this._resetBackoffs(),this.state!==Zn.Closed&&this._performBackoff(),delete this._socket,this.emit("close")}_connect(e,n){this._log.info(typeof n=="number"?`Attempting to reconnect (retry #${n})...`:"Attempting to connect..."),this._closeSocket(),this._setState(Zn.Connecting),this._connectedUri=e;try{this._socket=new this._options.WebSocket(this._connectedUri)}catch(r){this._log.error("Could not connect to endpoint:",r.message),this._close(),this.emit("error",{code:31e3,message:r.message||`Could not connect to ${this._connectedUri}`,twilioError:new _r.ConnectionDisconnected});return}this._socket.addEventListener("close",this._onSocketClose),this._socket.addEventListener("error",this._onSocketError),this._socket.addEventListener("message",this._onSocketMessage),this._socket.addEventListener("open",this._onSocketOpen),delete this._timeOpened,this._connectTimeout=setTimeout(()=>{this._log.info("WebSocket connection attempt timed out."),this._moveUriIndex(),this._closeSocket()},this._options.connectTimeoutMs)}_performBackoff(){this._preferredUri?(this._log.info("Preferred URI set; backing off."),this._backoff.preferred.backoff()):(this._log.info("Preferred URI not set; backing off."),this._backoff.primary.backoff())}_resetBackoffs(){this._backoff.preferred.reset(),this._backoff.primary.reset(),this._backoffStartTime.preferred=null,this._backoffStartTime.primary=null}_setHeartbeatTimeout(){clearTimeout(this._heartbeatTimeout),this._heartbeatTimeout=setTimeout(()=>{this._log.info(`No messages received in ${uS/1e3} seconds. Reconnecting...`),this._shouldFallback=!0,this._closeSocket()},uS)}_setState(e){this._previousState=this.state,this.state=e}_setupBackoffs(){const e={factor:2,jitter:.4,max:this._options.maxPreferredDelayMs,min:100};this._log.info("Initializing preferred transport backoff using config: ",e);const n=new Pg(e);n.on("backoff",(s,o)=>{if(this.state===Zn.Closed){this._log.info("Preferred backoff initiated but transport state is closed; not attempting a connection.");return}this._log.info(`Will attempt to reconnect Websocket to preferred URI in ${o}ms`),s===0&&(this._backoffStartTime.preferred=Date.now(),this._log.info(`Preferred backoff start; ${this._backoffStartTime.preferred}`))}),n.on("ready",(s,o)=>{if(this.state===Zn.Closed){this._log.info("Preferred backoff ready but transport state is closed; not attempting a connection.");return}if(this._backoffStartTime.preferred===null){this._log.info("Preferred backoff start time invalid; not attempting a connection.");return}if(Date.now()-this._backoffStartTime.preferred>this._options.maxPreferredDurationMs){this._log.info("Max preferred backoff attempt time exceeded; falling back to primary backoff."),this._preferredUri=null,this._backoff.primary.backoff();return}if(typeof this._preferredUri!="string"){this._log.info("Preferred URI cleared; falling back to primary backoff."),this._preferredUri=null,this._backoff.primary.backoff();return}this._connect(this._preferredUri,s+1)});const r={factor:2,jitter:.4,max:this._options.maxPrimaryDelayMs,min:this._uris&&this._uris.length>1?Math.floor(Math.random()*4001)+1e3:100};this._log.info("Initializing primary transport backoff using config: ",r);const i=new Pg(r);return i.on("backoff",(s,o)=>{if(this.state===Zn.Closed){this._log.info("Primary backoff initiated but transport state is closed; not attempting a connection.");return}this._log.info(`Will attempt to reconnect WebSocket in ${o}ms`),s===0&&(this._backoffStartTime.primary=Date.now(),this._log.info(`Primary backoff start; ${this._backoffStartTime.primary}`))}),i.on("ready",(s,o)=>{if(this.state===Zn.Closed){this._log.info("Primary backoff ready but transport state is closed; not attempting a connection.");return}if(this._backoffStartTime.primary===null){this._log.info("Primary backoff start time invalid; not attempting a connection.");return}if(Date.now()-this._backoffStartTime.primary>this._options.maxPrimaryDurationMs){this._log.info("Max primary backoff attempt time exceeded; not attempting a connection.");return}this._connect(this._uris[this._uriIndex],s+1)}),{preferred:n,primary:i}}get uri(){return this._connectedUri}}Nf.defaultConstructorOptions={WebSocket:oa,connectTimeoutMs:w4,maxPreferredDelayMs:T4,maxPreferredDurationMs:E4,maxPrimaryDelayMs:x4,maxPrimaryDurationMs:S4};const b4="1.6",I4=30;class ct extends Er.EventEmitter{constructor(e,n,r){if(super(),!(this instanceof ct))return new ct(e,n,r);const i={TransportFactory:Nf};r=r||{};for(const o in i)o in r||(r[o]=i[o]);this.options=r,this.token=e||"",this.status="disconnected",this.gateway=null,this.region=null,this._messageQueue=[],this._preferredUri=null,this._uris=n,this._handleTransportClose=this._handleTransportClose.bind(this),this._handleTransportError=this._handleTransportError.bind(this),this._handleTransportMessage=this._handleTransportMessage.bind(this),this._handleTransportOpen=this._handleTransportOpen.bind(this),this._log=new Ft("PStream"),this.on("error",()=>{this._log.warn("Unexpected error handled in pstream")});const s=this;return this.addListener("ready",()=>{s.status="ready"}),this.addListener("offline",()=>{s.status="offline"}),this.addListener("close",()=>{s._log.info('Received "close" from server. Destroying PStream...'),s._destroy()}),this.transport=new this.options.TransportFactory(this._uris,{backoffMaxMs:this.options.backoffMaxMs,maxPreferredDurationMs:this.options.maxPreferredDurationMs}),Object.defineProperties(this,{uri:{enumerable:!0,get(){return this.transport.uri}}}),this.transport.on("close",this._handleTransportClose),this.transport.on("error",this._handleTransportError),this.transport.on("message",this._handleTransportMessage),this.transport.on("open",this._handleTransportOpen),this.transport.open(),this}}ct.prototype._handleTransportClose=function(){this.emit("transportClose"),this.status!=="disconnected"&&(this.status!=="offline"&&this.emit("offline",this),this.status="disconnected")};ct.prototype._handleTransportError=function(t){if(!t){this.emit("error",{error:{code:31e3,message:"Websocket closed without a provided reason",twilioError:new _r.ConnectionDisconnected}});return}this.emit("error",typeof t.code<"u"?{error:t}:t)};ct.prototype._handleTransportMessage=function(t){if(!t||!t.data||typeof t.data!="string")return;const{type:e,payload:n={}}=JSON.parse(t.data);this.gateway=n.gateway||this.gateway,this.region=n.region||this.region,e==="error"&&n.error&&(n.error.twilioError=new _r.ConnectionError),this.emit(e,n)};ct.prototype._handleTransportOpen=function(){this.status="connected",this.setToken(this.token),this.emit("transportOpen"),this._messageQueue.splice(0,this._messageQueue.length).forEach(e=>this._publish(...e))};ct.toString=()=>"[Twilio.PStream class]";ct.prototype.toString=()=>"[Twilio.PStream instance]";ct.prototype.setToken=function(t){this._log.info("Setting token and publishing listen"),this.token=t;let e=0;const n=this.options.maxPreferredDurationMs;this._log.info(`maxPreferredDurationMs:${n}`),typeof n=="number"&&n>=0&&(e=Math.min(Math.ceil(n/1e3),I4)),this._log.info(`reconnectTimeout:${e}`);const r={browserinfo:C4(),reconnectTimeout:e,token:t};this._publish("listen",r)};ct.prototype.sendMessage=function(t,e,n="application/json",r,i){const s={callsid:t,content:e,contenttype:n,messagetype:r,voiceeventsid:i};this._publish("message",s,!0)};ct.prototype.register=function(t){const e={media:t};this._publish("register",e,!0)};ct.prototype.invite=function(t,e,n){const r={callsid:e,sdp:t,twilio:n?{params:n}:{}};this._publish("invite",r,!0)};ct.prototype.reconnect=function(t,e,n){const r={callsid:e,reconnect:n,sdp:t,twilio:{}};this._publish("invite",r,!0)};ct.prototype.answer=function(t,e){this._publish("answer",{sdp:t,callsid:e},!0)};ct.prototype.dtmf=function(t,e){this._publish("dtmf",{callsid:t,dtmf:e},!0)};ct.prototype.hangup=function(t,e){const n=e?{callsid:t,message:e}:{callsid:t};this._publish("hangup",n,!0)};ct.prototype.reject=function(t){this._publish("reject",{callsid:t},!0)};ct.prototype.reinvite=function(t,e){this._publish("reinvite",{sdp:t,callsid:e},!1)};ct.prototype._destroy=function(){this.transport.removeListener("close",this._handleTransportClose),this.transport.removeListener("error",this._handleTransportError),this.transport.removeListener("message",this._handleTransportMessage),this.transport.removeListener("open",this._handleTransportOpen),this.transport.close(),this.emit("offline",this)};ct.prototype.destroy=function(){return this._log.info("PStream.destroy() called..."),this._destroy(),this};ct.prototype.updatePreferredURI=function(t){this._preferredUri=t,this.transport.updatePreferredURI(t)};ct.prototype.updateURIs=function(t){this._uris=t,this.transport.updateURIs(this._uris)};ct.prototype.publish=function(t,e){return this._publish(t,e,!0)};ct.prototype._publish=function(t,e,n){const r=JSON.stringify({payload:e,type:t,version:b4});!!this.transport.send(r)||(this.emit("error",{error:{code:31009,message:"No transport available to send or receive messages",twilioError:new pn.TransportError}}),n&&this._messageQueue.push([t,e,!0]))};function C4(){const t=typeof navigator<"u"?navigator:{};return{browser:{platform:t.platform||"unknown",userAgent:t.userAgent||"unknown"},p:"browser",plugin:"rtc",v:Na}}var _t;(function(t){t.Sydney="sydney",t.SaoPaulo="sao-paulo",t.Dublin="dublin",t.Frankfurt="frankfurt",t.Tokyo="tokyo",t.Singapore="singapore",t.Ashburn="ashburn",t.Umatilla="umatilla",t.Roaming="roaming",t.AshburnIx="ashburn-ix",t.SanJoseIx="san-jose-ix",t.LondonIx="london-ix",t.FrankfurtIx="frankfurt-ix",t.SingaporeIx="singapore-ix",t.SydneyIx="sydney-ix",t.TokyoIx="tokyo-ix"})(_t||(_t={}));var Qe;(function(t){t.Au1="au1",t.Au1Ix="au1-ix",t.Br1="br1",t.De1="de1",t.De1Ix="de1-ix",t.Gll="gll",t.Ie1="ie1",t.Ie1Ix="ie1-ix",t.Ie1Tnx="ie1-tnx",t.Jp1="jp1",t.Jp1Ix="jp1-ix",t.Sg1="sg1",t.Sg1Ix="sg1-ix",t.Sg1Tnx="sg1-tnx",t.Us1="us1",t.Us1Ix="us1-ix",t.Us1Tnx="us1-tnx",t.Us2="us2",t.Us2Ix="us2-ix",t.Us2Tnx="us2-tnx"})(Qe||(Qe={}));const k4={ASIAPAC_SINGAPORE:Qe.Sg1,ASIAPAC_SYDNEY:Qe.Au1,ASIAPAC_TOKYO:Qe.Jp1,EU_FRANKFURT:Qe.De1,EU_IRELAND:Qe.Ie1,SOUTH_AMERICA_SAO_PAULO:Qe.Br1,US_EAST_VIRGINIA:Qe.Us1,US_WEST_OREGON:Qe.Us2},A4={[Qe.Au1]:_t.Sydney,[Qe.Br1]:_t.SaoPaulo,[Qe.Ie1]:_t.Dublin,[Qe.De1]:_t.Frankfurt,[Qe.Jp1]:_t.Tokyo,[Qe.Sg1]:_t.Singapore,[Qe.Us1]:_t.Ashburn,[Qe.Us2]:_t.Umatilla,[Qe.Gll]:_t.Roaming,[Qe.Us1Ix]:_t.AshburnIx,[Qe.Us2Ix]:_t.SanJoseIx,[Qe.Ie1Ix]:_t.LondonIx,[Qe.De1Ix]:_t.FrankfurtIx,[Qe.Sg1Ix]:_t.SingaporeIx,[Qe.Au1Ix]:_t.SydneyIx,[Qe.Jp1Ix]:_t.TokyoIx,[Qe.Us1Tnx]:_t.AshburnIx,[Qe.Us2Tnx]:_t.AshburnIx,[Qe.Ie1Tnx]:_t.LondonIx,[Qe.Sg1Tnx]:_t.SingaporeIx},P4=_t.Roaming,R4="eventgw.twilio.com";function dS(t){return`voice-js.${t}.twilio.com`}function hS(t){return t?`eventgw.${t}.twilio.com`:R4}function fS(t){return`wss://${t}/signal`}function pS(t){if(t&&typeof t!="string"&&!Array.isArray(t))throw new et("If `edge` is provided, it must be of type `string` or an array of strings.");let e;return t?e=(Array.isArray(t)?t:[t]).map(r=>dS(r)):e=[dS(P4)],e}function N4(t){return k4[t]||null}const mS={0:"PCMU",8:"PCMA"},D4=111,O4=51e4,L4=6e3;function M4(t){const[,e,n]=/a=rtpmap:(\d+) (\S+)/m.exec(t)||[null,"",""],r=new RegExp(`a=fmtp:${e} (\\S+)`,"m"),[,i]=r.exec(t)||[null,""];return{codecName:n,codecParams:i}}function V4(t){return nv(window,window.navigator)?t.split(`
`).filter(e=>e.indexOf("a=ice-lite")===-1).join(`
`):t}function qk(t,e){if(typeof e!="number"||e<L4||e>O4)return t;const n=/a=rtpmap:(\d+) opus/m.exec(t),r=n&&n.length?n[1]:D4,i=new RegExp(`a=fmtp:${r}`);return t.split(`
`).map(o=>i.test(o)?o+`;maxaveragebitrate=${e}`:o).join(`
`)}function Hk(t,e){const n=j4(t);return[t.split(`\r
m=`)[0]].concat(n.map(i=>{if(!/^m=(audio|video)/.test(i))return i;const s=i.match(/^m=(audio|video)/)[1],o=F4(i),a=U4(o,e),l=$4(a,i),u=o.get("pcma")||[],d=o.get("pcmu")||[];return(s==="audio"?new Set(u.concat(d)):new Set).has(a[0])?l.replace(/\r\nb=(AS|TIAS):([0-9]+)/g,""):l})).join(`\r
`)}function j4(t,e,n){return t.replace(/\r\n\r\n$/,`\r
`).split(`\r
m=`).slice(1).map(r=>`m=${r}`).filter(r=>{const i=new RegExp("m=.*","gm"),s=new RegExp("a=.*","gm");return i.test(r)&&s.test(r)})}function F4(t){return Array.from(B4(t)).reduce((e,n)=>{const r=n[0],i=n[1],s=e.get(i)||[];return e.set(i,s.concat(r))},new Map)}function U4(t,e){e=e.map(s=>s.toLowerCase());const n=Og(e,s=>t.get(s)||[]),r=tv(Array.from(t.keys()),e),i=Og(r,s=>t.get(s));return n.concat(i)}function $4(t,e){const n=e.split(`\r
`);let r=n[0];const i=n.slice(1);return r=r.replace(/([0-9]+\s?)+$/,t.join(" ")),[r].concat(i).join(`\r
`)}function B4(t){return z4(t).reduce((e,n)=>{const r=new RegExp(`a=rtpmap:${n} ([^/]+)`),i=t.match(r),s=i?i[1].toLowerCase():mS[n]?mS[n].toLowerCase():"";return e.set(n,s)},new Map)}function z4(t){const n=t.split(`\r
`)[0].match(/([0-9]+)/g);return n?n.slice(1).map(r=>parseInt(r,10)):[]}function ar(t){if(this.log=new Ft("RTCPC"),typeof window>"u"){this.log.info("No RTCPeerConnection implementation available. The window object was not found.");return}t&&t.RTCPeerConnection?this.RTCPeerConnection=t.RTCPeerConnection:typeof window.RTCPeerConnection=="function"?this.RTCPeerConnection=window.RTCPeerConnection:typeof window.webkitRTCPeerConnection=="function"?this.RTCPeerConnection=webkitRTCPeerConnection:typeof window.mozRTCPeerConnection=="function"?(this.RTCPeerConnection=mozRTCPeerConnection,window.RTCSessionDescription=mozRTCSessionDescription,window.RTCIceCandidate=mozRTCIceCandidate):this.log.info("No RTCPeerConnection implementation available")}ar.prototype.create=function(t){this.pc=new this.RTCPeerConnection(t)};ar.prototype.createModernConstraints=t=>{if(typeof t>"u")return null;const e=Object.assign({},t);return typeof webkitRTCPeerConnection<"u"&&!Rf()?(e.mandatory={},typeof t.audio<"u"&&(e.mandatory.OfferToReceiveAudio=t.audio),typeof t.video<"u"&&(e.mandatory.OfferToReceiveVideo=t.video)):(typeof t.audio<"u"&&(e.offerToReceiveAudio=t.audio),typeof t.video<"u"&&(e.offerToReceiveVideo=t.video)),delete e.audio,delete e.video,e};ar.prototype.createOffer=function(t,e,n,r){return e=this.createModernConstraints(e),Kk(this.pc.createOffer,this.pc)(e).then(i=>{if(!this.pc)return Promise.resolve();const s=qk(i.sdp,t);return Df(this.pc.setLocalDescription,this.pc)(new RTCSessionDescription({sdp:s,type:"offer"}))}).then(n,r)};ar.prototype.createAnswer=function(t,e,n,r){return e=this.createModernConstraints(e),Kk(this.pc.createAnswer,this.pc)(e).then(i=>{if(!this.pc)return Promise.resolve();const s=qk(i.sdp,t);return Df(this.pc.setLocalDescription,this.pc)(new RTCSessionDescription({sdp:s,type:"answer"}))}).then(n,r)};ar.prototype.processSDP=function(t,e,n,r,i,s){n=Hk(n,e);const o=new RTCSessionDescription({sdp:n,type:"offer"});return Df(this.pc.setRemoteDescription,this.pc)(o).then(()=>{this.createAnswer(t,r,i,s)})};ar.prototype.getSDP=function(){return this.pc.localDescription.sdp};ar.prototype.processAnswer=function(t,e,n,r){return this.pc?(e=Hk(e,t),Df(this.pc.setRemoteDescription,this.pc)(new RTCSessionDescription({sdp:e,type:"answer"})).then(n,r)):Promise.resolve()};ar.test=()=>{if(typeof navigator=="object"){const t=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.getUserMedia;if(Rf(navigator))return!1;if(t&&typeof window.RTCPeerConnection=="function")return!0;if(t&&typeof window.webkitRTCPeerConnection=="function")return!0;if(t&&typeof window.mozRTCPeerConnection=="function"){try{if(typeof new window.mozRTCPeerConnection().getLocalStreams!="function")return!1}catch{return!1}return!0}else if(typeof RTCIceGatherer<"u")return!0}return!1};function Gk(t,e,n,r){return function(){const i=Array.prototype.slice.call(arguments);return new Promise(s=>{const o=t.apply(e,i);if(!r){s(o);return}if(typeof o=="object"&&typeof o.then=="function")s(o);else throw new Error}).catch(()=>new Promise((s,o)=>{t.apply(e,n?[s,o].concat(i):i.concat([s,o]))}))}}function Kk(t,e){return Gk(t,e,!0,!0)}function Df(t,e){return Gk(t,e,!1,!1)}const W4=15e3,q4="none",H4="timeout",G4="new",gS=50;function _e(t,e,n){if(!t||!e)throw new et("Audiohelper, and pstream are required arguments");if(!(this instanceof _e))return new _e(t,e,n);this._log=new Ft("PeerConnection");function r(){this._log.warn("Unexpected noop call in peerconnection")}this.onaudio=r,this.onopen=r,this.onerror=r,this.onclose=r,this.ondisconnected=r,this.onfailed=r,this.onconnected=r,this.onreconnected=r,this.onsignalingstatechange=r,this.ondtlstransportstatechange=r,this.onicegatheringfailure=r,this.onicegatheringstatechange=r,this.oniceconnectionstatechange=r,this.onpcconnectionstatechange=r,this.onicecandidate=r,this.onselectedcandidatepairchange=r,this.onvolume=r,this.version=null,this.pstream=e,this.stream=null,this.sinkIds=new Set(["default"]),this.outputs=new Map,this.status="connecting",this.callSid=null,this.isMuted=!1;const i=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);return this._isSinkSupported=!!i&&typeof HTMLAudioElement<"u"&&HTMLAudioElement.prototype.setSinkId,this._audioContext=i&&t._audioContext,this._audioHelper=t,this._hasIceCandidates=!1,this._hasIceGatheringFailures=!1,this._iceGatheringTimeoutId=null,this._masterAudio=null,this._masterAudioDeviceId=null,this._mediaStreamSource=null,this._dtmfSender=null,this._dtmfSenderUnsupported=!1,this._callEvents=[],this._nextTimeToPublish=Date.now(),this._onAnswerOrRinging=r,this._onHangup=r,this._remoteStream=null,this._shouldManageStream=!0,this._iceState=G4,this.options=n=n||{},this.navigator=n.navigator||(typeof navigator<"u"?navigator:null),this.util=n.util||$k,this.codecPreferences=n.codecPreferences,this}_e.prototype.uri=function(){return this._uri};_e.prototype.openDefaultDeviceWithConstraints=function(t){return this._audioHelper._openDefaultDeviceWithConstraints(t).then(this._setInputTracksFromStream.bind(this,!1))};_e.prototype.setInputTracksFromStream=function(t){const e=this;return this._setInputTracksFromStream(!0,t).then(()=>{e._shouldManageStream=!1})};_e.prototype._createAnalyser=(t,e)=>{e=Object.assign({fftSize:32,smoothingTimeConstant:.3},e);const n=t.createAnalyser();for(const r in e)n[r]=e[r];return n};_e.prototype._setVolumeHandler=function(t){this.onvolume=t};_e.prototype._startPollingVolume=function(){if(!this._audioContext||!this.stream||!this._remoteStream)return;const t=this._audioContext,n=(this._inputAnalyser=this._createAnalyser(t)).frequencyBinCount,r=new Uint8Array(n);this._inputAnalyser2=this._createAnalyser(t,{maxDecibels:0,minDecibels:-127,smoothingTimeConstant:0});const s=(this._outputAnalyser=this._createAnalyser(t)).frequencyBinCount,o=new Uint8Array(s);this._outputAnalyser2=this._createAnalyser(t,{maxDecibels:0,minDecibels:-127,smoothingTimeConstant:0}),this._updateInputStreamSource(this.stream),this._updateOutputStreamSource(this._remoteStream);const a=this;setTimeout(function l(){if(a._audioContext){if(a.status==="closed"){a._inputAnalyser.disconnect(),a._outputAnalyser.disconnect(),a._inputAnalyser2.disconnect(),a._outputAnalyser2.disconnect();return}}else return;a._inputAnalyser.getByteFrequencyData(r);const u=a.util.average(r);a._inputAnalyser2.getByteFrequencyData(r);const d=a.util.average(r);a._outputAnalyser.getByteFrequencyData(o);const h=a.util.average(o);a._outputAnalyser2.getByteFrequencyData(o);const p=a.util.average(o);a.onvolume(u/255,h/255,d,p),setTimeout(l,gS)},gS)};_e.prototype._stopStream=function(){this._shouldManageStream&&this._audioHelper._stopDefaultInputDeviceStream()};_e.prototype._updateInputStreamSource=function(t){this._inputStreamSource&&this._inputStreamSource.disconnect();try{this._inputStreamSource=this._audioContext.createMediaStreamSource(t),this._inputStreamSource.connect(this._inputAnalyser),this._inputStreamSource.connect(this._inputAnalyser2)}catch(e){this._log.warn("Unable to update input MediaStreamSource",e),this._inputStreamSource=null}};_e.prototype._updateOutputStreamSource=function(t){this._outputStreamSource&&this._outputStreamSource.disconnect();try{this._outputStreamSource=this._audioContext.createMediaStreamSource(t),this._outputStreamSource.connect(this._outputAnalyser),this._outputStreamSource.connect(this._outputAnalyser2)}catch(e){this._log.warn("Unable to update output MediaStreamSource",e),this._outputStreamSource=null}};_e.prototype._setInputTracksFromStream=function(t,e){if(!e)return Promise.reject(new et("Can not set input stream to null while in a call"));if(!e.getAudioTracks().length)return Promise.reject(new et("Supplied input stream has no audio tracks"));const n=this.stream,r=()=>(this.mute(this.isMuted),Promise.resolve(this.stream));if(!n)this.stream=t?yS(e,this.options.MediaStream):e;else return this._shouldManageStream&&this._stopStream(),this._sender||(this._sender=this.version.pc.getSenders()[0]),this._sender.replaceTrack(e.getAudioTracks()[0]).then(()=>(this._updateInputStreamSource(e),this.stream=t?yS(e,this.options.MediaStream):e,r()));return r()};_e.prototype._onInputDevicesChanged=function(){if(!this.stream)return;this.stream.getAudioTracks().every(e=>e.readyState==="ended")&&this._shouldManageStream&&this.openDefaultDeviceWithConstraints({audio:!0})};_e.prototype._onIceGatheringFailure=function(t){this._hasIceGatheringFailures=!0,this.onicegatheringfailure(t)};_e.prototype._onMediaConnectionStateChange=function(t){const e=this._iceState;if(e===t||t!=="connected"&&t!=="disconnected"&&t!=="failed")return;this._iceState=t;let n;switch(t){case"connected":e==="disconnected"||e==="failed"?(n="ICE liveliness check succeeded. Connection with Twilio restored",this._log.info(n),this.onreconnected(n)):(n="Media connection established.",this._log.info(n),this.onconnected(n)),this._stopIceGatheringTimeout(),this._hasIceGatheringFailures=!1;break;case"disconnected":n="ICE liveliness check failed. May be having trouble connecting to Twilio",this._log.warn(n),this.ondisconnected(n);break;case"failed":n="Connection with Twilio was interrupted.",this._log.warn(n),this.onfailed(n);break}};_e.prototype._setSinkIds=function(t){return this._isSinkSupported?(this.sinkIds=new Set(t.forEach?t:[t]),this.version?this._updateAudioOutputs():Promise.resolve()):Promise.reject(new tn("Audio output selection is not supported by this browser"))};_e.prototype._startIceGatheringTimeout=function(){this._stopIceGatheringTimeout(),this._iceGatheringTimeoutId=setTimeout(()=>{this._onIceGatheringFailure(H4)},W4)};_e.prototype._stopIceGatheringTimeout=function(){clearInterval(this._iceGatheringTimeoutId)};_e.prototype._updateAudioOutputs=function(){const e=Array.from(this.sinkIds).filter(function(s){return!this.outputs.has(s)},this),n=Array.from(this.outputs.keys()).filter(function(s){return!this.sinkIds.has(s)},this),r=this,i=e.map(this._createAudioOutput,this);return Promise.all(i).then(()=>Promise.all(n.map(r._removeAudioOutput,r)))};_e.prototype._createAudio=function(e){const n=new Audio(e);return this.onaudio(n),n};_e.prototype._createAudioOutput=function(e){let n=null;this._mediaStreamSource&&(n=this._audioContext.createMediaStreamDestination(),this._mediaStreamSource.connect(n));const r=this._createAudio();iv(r,n&&n.stream?n.stream:this.pcStream);const i=this;return r.setSinkId(e).then(()=>r.play()).then(()=>{i.outputs.set(e,{audio:r,dest:n})})};_e.prototype._removeAudioOutputs=function(){return this._masterAudio&&typeof this._masterAudioDeviceId<"u"&&(this._disableOutput(this,this._masterAudioDeviceId),this.outputs.delete(this._masterAudioDeviceId),this._masterAudioDeviceId=null,this._masterAudio.paused||this._masterAudio.pause(),typeof this._masterAudio.srcObject<"u"?this._masterAudio.srcObject=null:this._masterAudio.src="",this._masterAudio=null),Array.from(this.outputs.keys()).map(this._removeAudioOutput,this)};_e.prototype._disableOutput=function(e,n){const r=e.outputs.get(n);r&&(r.audio&&(r.audio.pause(),r.audio.src=""),r.dest&&r.dest.disconnect())};_e.prototype._reassignMasterOutput=function(e,n){const r=e.outputs.get(n);e.outputs.delete(n);const i=this,s=Array.from(e.outputs.keys())[0],o=typeof s=="string"?s:"default";return r.audio.setSinkId(o).then(()=>{i._disableOutput(e,o),e.outputs.set(o,r),e._masterAudioDeviceId=o}).catch(function(){e.outputs.set(n,r),i._log.info("Could not reassign master output. Attempted to roll back.")})};_e.prototype._removeAudioOutput=function(e){return this._masterAudioDeviceId===e?this._reassignMasterOutput(this,e):(this._disableOutput(this,e),this.outputs.delete(e),Promise.resolve())};_e.prototype._onAddTrack=function(e,n){const r=e._masterAudio=this._createAudio();iv(r,n),r.play();const i=Array.from(e.outputs.keys())[0],s=typeof i=="string"?i:"default";e._masterAudioDeviceId=s,e.outputs.set(s,{audio:r});try{e._mediaStreamSource=e._audioContext.createMediaStreamSource(n)}catch(o){this._log.warn("Unable to create a MediaStreamSource from onAddTrack",o),this._mediaStreamSource=null}e.pcStream=n,e._updateAudioOutputs()};_e.prototype._fallbackOnAddTrack=function(e,n){const r=document&&document.createElement("audio");r.autoplay=!0,iv(r,n)||e._log.info("Error attaching stream to element."),e.outputs.set("default",{audio:r})};_e.prototype._setEncodingParameters=function(t){if(!t||!this._sender||typeof this._sender.getParameters!="function"||typeof this._sender.setParameters!="function")return;const e=this._sender.getParameters();!e.priority&&!(e.encodings&&e.encodings.length)||(e.priority="high",e.encodings&&e.encodings.length&&e.encodings.forEach(n=>{n.priority="high",n.networkPriority="high"}),this._sender.setParameters(e))};_e.prototype._setupPeerConnection=function(t){const e=this,n=new(this.options.rtcpcFactory||ar)({RTCPeerConnection:this.options.RTCPeerConnection});n.create(t),K4(n.pc,this.stream);const r=RTCRtpReceiver.getCapabilities("audio").codecs;this._log.debug("sorting codecs",r,this.codecPreferences);const i=Uk(r,this.codecPreferences),[s]=n.pc.getTransceivers();this._log.debug("setting sorted codecs",i),s.setCodecPreferences(i);const o="ontrack"in n.pc?"ontrack":"onaddstream";return n.pc[o]=a=>{const l=e._remoteStream=a.stream||a.streams[0];typeof n.pc.getSenders=="function"&&(this._sender=n.pc.getSenders()[0]),e._isSinkSupported?e._onAddTrack(e,l):e._fallbackOnAddTrack(e,l),e._startPollingVolume()},n};_e.prototype._maybeSetIceAggressiveNomination=function(t){return this.options.forceAggressiveIceNomination?V4(t):t};_e.prototype._setupChannel=function(){const t=this.version.pc;this.version.pc.onopen=()=>{this.status="open",this.onopen()},this.version.pc.onstatechange=()=>{this.version.pc&&this.version.pc.readyState==="stable"&&(this.status="open",this.onopen())},this.version.pc.onsignalingstatechange=()=>{const e=t.signalingState;this._log.info(`signalingState is "${e}"`),this.version.pc&&this.version.pc.signalingState==="stable"&&(this.status="open",this.onopen()),this.onsignalingstatechange(t.signalingState)},t.onconnectionstatechange=e=>{let n=t.connectionState;if(!n&&e&&e.target){const r=e.target;n=r.connectionState||r.connectionState_,this._log.info(`pc.connectionState not detected. Using target PC. State=${n}`)}n?this._log.info(`pc.connectionState is "${n}"`):this._log.warn(`onconnectionstatechange detected but state is "${n}"`),this.onpcconnectionstatechange(n),this._onMediaConnectionStateChange(n)},t.onicecandidate=e=>{const{candidate:n}=e;n&&(this._hasIceCandidates=!0,this.onicecandidate(n),this._setupRTCIceTransportListener()),this._log.info(`ICE Candidate: ${JSON.stringify(n)}`)},t.onicegatheringstatechange=()=>{const e=t.iceGatheringState;e==="gathering"?this._startIceGatheringTimeout():e==="complete"&&(this._stopIceGatheringTimeout(),this._hasIceCandidates||this._onIceGatheringFailure(q4),this._hasIceCandidates&&this._hasIceGatheringFailures&&this._startIceGatheringTimeout()),this._log.info(`pc.iceGatheringState is "${t.iceGatheringState}"`),this.onicegatheringstatechange(e)},t.oniceconnectionstatechange=()=>{this._log.info(`pc.iceConnectionState is "${t.iceConnectionState}"`),this.oniceconnectionstatechange(t.iceConnectionState),this._onMediaConnectionStateChange(t.iceConnectionState)}};_e.prototype._initializeMediaStream=function(t){return this.status==="open"?!1:this.pstream.status==="disconnected"?(this.onerror({info:{code:31e3,message:"Cannot establish connection. Client is disconnected",twilioError:new _r.ConnectionDisconnected}}),this.close(),!1):(this.version=this._setupPeerConnection(t),this._setupChannel(),!0)};_e.prototype._removeReconnectionListeners=function(){this.pstream&&(this.pstream.removeListener("answer",this._onAnswerOrRinging),this.pstream.removeListener("hangup",this._onHangup))};_e.prototype._setupRTCDtlsTransportListener=function(){const t=this.getRTCDtlsTransport();if(!t||t.onstatechange)return;const e=()=>{this._log.info(`dtlsTransportState is "${t.state}"`),this.ondtlstransportstatechange(t.state)};e(),t.onstatechange=e};_e.prototype._setupRTCIceTransportListener=function(){const t=this._getRTCIceTransport();!t||t.onselectedcandidatepairchange||(t.onselectedcandidatepairchange=()=>this.onselectedcandidatepairchange(t.getSelectedCandidatePair()))};_e.prototype.iceRestart=function(){this._log.info("Attempting to restart ICE..."),this._hasIceCandidates=!1,this.version.createOffer(this.options.maxAverageBitrate,{iceRestart:!0}).then(()=>{this._removeReconnectionListeners(),this._onAnswerOrRinging=t=>{if(this._removeReconnectionListeners(),!t.sdp||this.version.pc.signalingState!=="have-local-offer"){const n=`Invalid state or param during ICE Restart:hasSdp:${!!t.sdp}, signalingState:${this.version.pc.signalingState}`;this._log.warn(n);return}const e=this._maybeSetIceAggressiveNomination(t.sdp);this._answerSdp=e,this.status!=="closed"&&this.version.processAnswer(this.codecPreferences,e,null,n=>{const r=n&&n.message?n.message:n;this._log.error(`Failed to process answer during ICE Restart. Error: ${r}`)})},this._onHangup=()=>{this._log.info("Received hangup during ICE Restart"),this._removeReconnectionListeners()},this.pstream.on("answer",this._onAnswerOrRinging),this.pstream.on("hangup",this._onHangup),this.pstream.reinvite(this.version.getSDP(),this.callSid)}).catch(t=>{const e=t&&t.message?t.message:t;this._log.error(`Failed to createOffer during ICE Restart. Error: ${e}`),this.onfailed(e)})};_e.prototype.makeOutgoingCall=function(t,e,n,r,i){if(!this._initializeMediaStream(r))return;const s=this;this.callSid=n;function o(){s.options&&s._setEncodingParameters(s.options.dscp),i(s.version.pc)}function a(d){const h=d.message||d;s.onerror({info:{code:31e3,message:`Error processing answer: ${h}`,twilioError:new ri.ClientRemoteDescFailed}})}this._onAnswerOrRinging=d=>{if(!d.sdp)return;const h=this._maybeSetIceAggressiveNomination(d.sdp);s._answerSdp=h,s.status!=="closed"&&s.version.processAnswer(this.codecPreferences,h,o,a),s.pstream.removeListener("answer",s._onAnswerOrRinging),s.pstream.removeListener("ringing",s._onAnswerOrRinging)},this.pstream.on("answer",this._onAnswerOrRinging),this.pstream.on("ringing",this._onAnswerOrRinging);function l(){s.status!=="closed"&&(e?s.pstream.reconnect(s.version.getSDP(),s.callSid,e):s.pstream.invite(s.version.getSDP(),s.callSid,t),s._setupRTCDtlsTransportListener())}function u(d){const h=d.message||d;s.onerror({info:{code:31e3,message:`Error creating the offer: ${h}`,twilioError:new ri.ClientLocalDescFailed}})}this.version.createOffer(this.options.maxAverageBitrate,{audio:!0},l,u)};_e.prototype.answerIncomingCall=function(t,e,n,r){if(!this._initializeMediaStream(n))return;e=this._maybeSetIceAggressiveNomination(e),this._answerSdp=e.replace(/^a=setup:actpass$/gm,"a=setup:passive"),this.callSid=t;const i=this;function s(){i.status!=="closed"&&(i.pstream.answer(i.version.getSDP(),t),i.options&&i._setEncodingParameters(i.options.dscp),r(i.version.pc),i._setupRTCDtlsTransportListener())}function o(a){const l=a.message||a;i.onerror({info:{code:31e3,message:`Error creating the answer: ${l}`,twilioError:new ri.ClientRemoteDescFailed}})}this.version.processSDP(this.options.maxAverageBitrate,this.codecPreferences,e,{audio:!0},s,o)};_e.prototype.close=function(){this.version&&this.version.pc&&(this.version.pc.signalingState!=="closed"&&this.version.pc.close(),this.version.pc=null),this.stream&&(this.mute(!1),this._stopStream()),this.stream=null,this._removeReconnectionListeners(),this._stopIceGatheringTimeout(),Promise.all(this._removeAudioOutputs()).catch(()=>{}),this._mediaStreamSource&&this._mediaStreamSource.disconnect(),this._inputAnalyser&&this._inputAnalyser.disconnect(),this._outputAnalyser&&this._outputAnalyser.disconnect(),this._inputAnalyser2&&this._inputAnalyser2.disconnect(),this._outputAnalyser2&&this._outputAnalyser2.disconnect(),this.status="closed",this.onclose()};_e.prototype.reject=function(t){this.callSid=t};_e.prototype.ignore=function(t){this.callSid=t};_e.prototype.mute=function(t){this.isMuted=t,this.stream&&(this._sender&&this._sender.track?this._sender.track.enabled=!t:(typeof this.stream.getAudioTracks=="function"?this.stream.getAudioTracks():this.stream.audioTracks).forEach(n=>{n.enabled=!t}))};_e.prototype.getOrCreateDTMFSender=function(){if(this._dtmfSender||this._dtmfSenderUnsupported)return this._dtmfSender||null;const e=this,n=this.version.pc;if(!n)return this._log.warn("No RTCPeerConnection available to call createDTMFSender on"),null;if(typeof n.getSenders=="function"&&(typeof RTCDTMFSender=="function"||typeof RTCDtmfSender=="function")){const r=n.getSenders().find(i=>i.dtmf);if(r)return this._log.info("Using RTCRtpSender#dtmf"),this._dtmfSender=r.dtmf,this._dtmfSender}if(typeof n.createDTMFSender=="function"&&typeof n.getLocalStreams=="function"){const r=n.getLocalStreams().map(i=>{const s=e._getAudioTracks(i);return s&&s[0]})[0];return r?(this._log.info("Creating RTCDTMFSender"),this._dtmfSender=n.createDTMFSender(r),this._dtmfSender):(this._log.warn("No local audio MediaStreamTrack available on the RTCPeerConnection to pass to createDTMFSender"),null)}return this._log.info("RTCPeerConnection does not support RTCDTMFSender"),this._dtmfSenderUnsupported=!0,null};_e.prototype.getRTCDtlsTransport=function(){const e=this.version&&this.version.pc&&typeof this.version.pc.getSenders=="function"&&this.version.pc.getSenders()[0];return e&&e.transport||null};_e.prototype._canStopMediaStreamTrack=()=>typeof MediaStreamTrack.prototype.stop=="function";_e.prototype._getAudioTracks=t=>typeof t.getAudioTracks=="function"?t.getAudioTracks():t.audioTracks;_e.prototype._getRTCIceTransport=function(){const e=this.getRTCDtlsTransport();return e&&e.iceTransport||null};_e.protocol=ar.test()?new ar:null;function K4(t,e){typeof t.addTrack=="function"?e.getAudioTracks().forEach(n=>{t.addTrack(n,e)}):t.addStream(e)}function yS(t,e){let n;return e?n=new e:typeof MediaStream<"u"?n=new MediaStream:n=new webkitMediaStream,t.getAudioTracks().forEach(n.addTrack,n),n}function iv(t,e){if(typeof t.srcObject<"u")t.srcObject=e;else if(typeof t.mozSrcObject<"u")t.mozSrcObject=e;else if(typeof t.src<"u"){const n=t.options.window||window;t.src=(n.URL||n.webkitURL).createObjectURL(e)}else return!1;return!0}_e.enabled=ar.test();function Q4(){return ar.test()}function J4(){return typeof RTCIceGatherer<"u"?"ORTC":"WebRTC"}function Y4(t,e){return e=e||{},e.util=e.util||$k,e.navigator=e.navigator||(typeof navigator<"u"?navigator:null),new Promise((n,r)=>{if(!e.navigator)throw new tn("getUserMedia is not supported");switch("function"){case typeof(e.navigator.mediaDevices&&e.navigator.mediaDevices.getUserMedia):return n(e.navigator.mediaDevices.getUserMedia(t));case typeof e.navigator.webkitGetUserMedia:return e.navigator.webkitGetUserMedia(t,n,r);case typeof e.navigator.mozGetUserMedia:return e.navigator.mozGetUserMedia(t,n,r);case typeof e.navigator.getUserMedia:return e.navigator.getUserMedia(t,n,r);default:throw new tn("getUserMedia is not supported")}}).catch(n=>{throw e.util.isFirefox()&&n.name==="NotReadableError"?new tn(`Firefox does not currently support opening multiple audio input trackssimultaneously, even across different tabs.
Related Bugzilla thread: https://bugzilla.mozilla.org/show_bug.cgi?id=1299324`):n})}function Z4(){if(typeof window!="object")throw new tn("This platform is not supported.");const{crypto:t}=window;if(typeof t!="object")throw new tn("The `crypto` module is not available on this platform.");if(typeof t.getRandomValues!="function")throw new tn("The function `crypto.getRandomValues` is not available on this platform.");if(typeof window.Uint8Array!="function")throw new tn("The `Uint8Array` module is not available on this platform.");return t.getRandomValues(new window.Uint8Array(16)).reduce((e,n)=>`${e}${n.toString(16).padStart(2,"0")}`,"")}function Fg(){return`KX${Z4()}`}let X4=class{constructor(){this._promise=new Promise((e,n)=>{this._resolve=e,this._reject=n})}get promise(){return this._promise}reject(e){this._reject(e)}resolve(e){this._resolve(e)}};class eU{constructor(){this._operations=[]}enqueue(e){const n=!!this._operations.length,r=new X4;return this._operations.push({deferred:r,callback:e}),n||this._processQueue(),r.promise}_processQueue(){return An(this,void 0,void 0,function*(){for(;this._operations.length;){const{deferred:e,callback:n}=this._operations[0];let r,i,s;try{r=yield n(),s=!0}catch(o){i=o}this._operations.shift(),s?e.resolve(r):e.reject(i)}})}}class tU{get reject(){return this._reject}get resolve(){return this._resolve}constructor(){this.promise=new Promise((e,n)=>{this._resolve=e,this._reject=n})}}class nU{constructor(){this._eventEmitter=new Er.EventEmitter}addEventListener(e,n){return this._eventEmitter.addListener(e,n)}dispatchEvent(e,...n){return this._eventEmitter.emit(e,...n)}removeEventListener(e,n){return this._eventEmitter.removeListener(e,n)}}class _S extends nU{get destination(){return this._destination}get loop(){return this._loop}set loop(e){const n=this;function r(){n._audioNode.removeEventListener("ended",r),n.pause()}!e&&this.loop&&!this.paused&&this._audioNode.addEventListener("ended",r),this._loop=e}get muted(){return this._gainNode.gain.value===0}set muted(e){this._gainNode.gain.value=e?0:1}get paused(){return this._audioNode===null}get src(){return this._src}set src(e){this._load(e)}get srcObject(){return this._audioElement.srcObject}set srcObject(e){this._audioElement.srcObject=e}get sinkId(){return this._sinkId}constructor(e,n={},r={}){super(),this._audioNode=null,this._loop=!1,this._pendingPlayDeferreds=[],this._sinkId="default",this._src="",typeof n!="string"&&(r=n),this._audioContext=e,this._audioElement=new(r.AudioFactory||Audio),this._bufferPromise=this._createPlayDeferred().promise,this._destination=this._audioContext.destination,this._gainNode=this._audioContext.createGain(),this._gainNode.connect(this._destination),this._XMLHttpRequest=r.XMLHttpRequestFactory||XMLHttpRequest,this.addEventListener("canplaythrough",()=>{this._resolvePlayDeferreds()}),typeof n=="string"&&(this.src=n)}load(){this._load(this._src)}pause(){this.paused||(this._audioElement.pause(),this._audioNode.stop(),this._audioNode.disconnect(this._gainNode),this._audioNode=null,this._rejectPlayDeferreds(new Error("The play() request was interrupted by a call to pause().")))}play(){return An(this,void 0,void 0,function*(){if(!this.paused){if(yield this._bufferPromise,!this.paused)return;throw new Error("The play() request was interrupted by a call to pause().")}this._audioNode=this._audioContext.createBufferSource(),this._audioNode.loop=this.loop,this._audioNode.addEventListener("ended",()=>{this._audioNode&&this._audioNode.loop||this.dispatchEvent("ended")});const e=yield this._bufferPromise;if(this.paused)throw new Error("The play() request was interrupted by a call to pause().");if(this._audioNode.buffer=e,this._audioNode.connect(this._gainNode),this._audioNode.start(),this._audioElement.srcObject)return this._audioElement.play()})}setSinkId(e){return An(this,void 0,void 0,function*(){if(typeof this._audioElement.setSinkId!="function")throw new Error("This browser does not support setSinkId.");if(e!==this.sinkId){if(e==="default"){this.paused||this._gainNode.disconnect(this._destination),this._audioElement.srcObject=null,this._destination=this._audioContext.destination,this._gainNode.connect(this._destination),this._sinkId=e;return}yield this._audioElement.setSinkId(e),!this._audioElement.srcObject&&(this._gainNode.disconnect(this._audioContext.destination),this._destination=this._audioContext.createMediaStreamDestination(),this._audioElement.srcObject=this._destination.stream,this._sinkId=e,this._gainNode.connect(this._destination))}})}_createPlayDeferred(){const e=new tU;return this._pendingPlayDeferreds.push(e),e}_load(e){this._src&&this._src!==e&&this.pause(),this._src=e,this._bufferPromise=new Promise((n,r)=>An(this,void 0,void 0,function*(){if(!e)return this._createPlayDeferred().promise;const i=yield rU(this._audioContext,this._XMLHttpRequest,e);this.dispatchEvent("canplaythrough"),n(i)}))}_rejectPlayDeferreds(e){const n=this._pendingPlayDeferreds;n.splice(0,n.length).forEach(({reject:r})=>r(e))}_resolvePlayDeferreds(e){const n=this._pendingPlayDeferreds;n.splice(0,n.length).forEach(({resolve:r})=>r(e))}}function rU(t,e,n){return An(this,void 0,void 0,function*(){const r=new e;r.open("GET",n,!0),r.responseType="arraybuffer";const i=yield new Promise(s=>{r.addEventListener("load",s),r.send()});try{return t.decodeAudioData(i.target.response)}catch{return new Promise(o=>{t.decodeAudioData(i.target.response,o)})}})}function Di(t,e,n){if(!(this instanceof Di))return new Di(t,e,n);if(!t||!e)throw new et("name and url are required arguments");n=Object.assign({AudioFactory:typeof Audio<"u"?Audio:null,maxDuration:0,shouldLoop:!1},n),n.AudioPlayer=n.audioContext?_S.bind(_S,n.audioContext):n.AudioFactory,Object.defineProperties(this,{_Audio:{value:n.AudioPlayer},_activeEls:{value:new Map},_isSinkSupported:{value:n.AudioFactory!==null&&typeof n.AudioFactory.prototype.setSinkId=="function"},_maxDuration:{value:n.maxDuration},_maxDurationTimeout:{value:null,writable:!0},_operations:{value:new eU},_playPromise:{value:null,writable:!0},_shouldLoop:{value:n.shouldLoop},_sinkIds:{value:["default"]},isPlaying:{enumerable:!0,get(){return!!this._playPromise}},name:{enumerable:!0,value:t},url:{enumerable:!0,value:e}}),this._Audio&&this._play(!0,!1)}function Qk(t){t&&(t.pause(),t.src="",t.srcObject=null,t.load())}Di.prototype._playAudioElement=function(e,n,r){const i=this._activeEls.get(e);if(!i)throw new et(`sinkId: "${e}" doesn't have an audio element`);return i.muted=!!n,i.loop=!!r,i.play().then(()=>i).catch(s=>{throw Qk(i),this._activeEls.delete(e),s})};Di.prototype._play=function(e,n){this.isPlaying&&this._stop(),this._maxDuration>0&&(this._maxDurationTimeout=setTimeout(this._stop.bind(this),this._maxDuration)),n=typeof n=="boolean"?n:this._shouldLoop;const r=this;return this._playPromise=Promise.all(this._sinkIds.map(function(o){if(!r._Audio)return Promise.resolve();let a=r._activeEls.get(o);return a?r._playAudioElement(o,e,n):(a=new r._Audio(r.url),typeof a.setAttribute=="function"&&a.setAttribute("crossorigin","anonymous"),new Promise(l=>{a.addEventListener("canplaythrough",l)}).then(()=>(r._isSinkSupported?a.setSinkId(o):Promise.resolve()).then(function(){return r._activeEls.set(o,a),r._playPromise?r._playAudioElement(o,e,n):Promise.resolve()})))}))};Di.prototype._stop=function(){this._activeEls.forEach((e,n)=>{this._sinkIds.includes(n)?(e.pause(),e.currentTime=0):(Qk(e),this._activeEls.delete(n))}),clearTimeout(this._maxDurationTimeout),this._playPromise=null,this._maxDurationTimeout=null};Di.prototype.setSinkIds=function(e){this._isSinkSupported&&(e=e.forEach?e:[e],[].splice.apply(this._sinkIds,[0,this._sinkIds.length].concat(e)))};Di.prototype.stop=function(){this._operations.enqueue(()=>(this._stop(),Promise.resolve()))};Di.prototype.play=function(){return this._operations.enqueue(()=>this._play())};const iU=3e4,sU=2e3,oU="twilio-js-sdk",aU='Parameter "token" must be of type "string".';class ie extends Er.EventEmitter{static get audioContext(){return ie._audioContext}static get extension(){const e=typeof document<"u"?document.createElement("audio"):{canPlayType:!1};let n;try{n=e.canPlayType&&!!e.canPlayType("audio/mpeg").replace(/no/,"")}catch{n=!1}let r;try{r=e.canPlayType&&!!e.canPlayType("audio/ogg;codecs='vorbis'").replace(/no/,"")}catch{r=!1}return r&&!n?"ogg":"mp3"}static get isSupported(){return Q4()}static get packageName(){return Vk}static runPreflight(e,n){return new gt(e,Object.assign({audioContext:ie._getOrCreateAudioContext()},n))}static toString(){return"[Twilio.Device class]"}static get version(){return Na}static _getOrCreateAudioContext(){return ie._audioContext||(typeof AudioContext<"u"?ie._audioContext=new AudioContext:typeof webkitAudioContext<"u"&&(ie._audioContext=new webkitAudioContext)),ie._audioContext}constructor(e,n={}){if(super(),this._activeCall=null,this._audio=null,this._audioProcessorEventObserver=null,this._callInputStream=null,this._calls=[],this._callSinkIds=["default"],this._chunderURIs=[],this._defaultOptions={allowIncomingWhileBusy:!1,closeProtection:!1,codecPreferences:[re.Codec.PCMU,re.Codec.Opus],dscp:!0,enableImprovedSignalingErrorPrecision:!1,forceAggressiveIceNomination:!1,logLevel:au.levels.ERROR,maxCallSignalingTimeoutMs:0,preflight:!1,sounds:{},tokenRefreshMs:1e4,voiceEventSidGenerator:Fg},this._edge=null,this._home=null,this._identity=null,this._log=new Ft("Device"),this._makeCallPromise=null,this._options={},this._preferredURI=null,this._publisher=null,this._region=null,this._regTimer=null,this._shouldReRegister=!1,this._soundcache=new Map,this._state=ie.State.Unregistered,this._stateEventMapping={[ie.State.Destroyed]:ie.EventName.Destroyed,[ie.State.Unregistered]:ie.EventName.Unregistered,[ie.State.Registering]:ie.EventName.Registering,[ie.State.Registered]:ie.EventName.Registered},this._stream=null,this._streamConnectedPromise=null,this._tokenWillExpireTimeout=null,this._createDefaultPayload=s=>{const o={aggressive_nomination:this._options.forceAggressiveIceNomination,browser_extension:this._isBrowserExtension,dscp:!!this._options.dscp,ice_restart_enabled:!0,platform:J4(),sdk_version:Na};function a(l,u){u&&(o[l]=u)}if(s){const l=s.parameters.CallSid;a("call_sid",/^TJ/.test(l)?void 0:l),a("temp_call_sid",s.outboundConnectionId),a("audio_codec",s.codec),o.direction=s.direction}return a("gateway",this._stream&&this._stream.gateway),a("region",this._stream&&this._stream.region),o},this._onSignalingClose=()=>{this._stream=null,this._streamConnectedPromise=null},this._onSignalingConnected=s=>{var o;const a=N4(s.region);if(this._edge=s.edge||A4[a]||s.region,this._region=a||s.region,this._home=s.home,(o=this._publisher)===null||o===void 0||o.setHost(hS(s.home)),s.token&&(this._identity=s.token.identity,typeof s.token.ttl=="number"&&typeof this._options.tokenRefreshMs=="number")){const u=s.token.ttl*1e3,d=Math.max(0,u-this._options.tokenRefreshMs);this._tokenWillExpireTimeout=setTimeout(()=>{this._log.debug("#tokenWillExpire"),this.emit("tokenWillExpire",this),this._tokenWillExpireTimeout&&(clearTimeout(this._tokenWillExpireTimeout),this._tokenWillExpireTimeout=null)},d)}const l=this._getChunderws()||pS(this._edge);if(l.length>0){const[u]=l;this._preferredURI=fS(u)}else this._log.warn("Could not parse a preferred URI from the stream#connected event.");this._shouldReRegister&&this.register()},this._onSignalingError=s=>{if(typeof s!="object"){this._log.warn("Invalid signaling error payload",s);return}const{error:o,callsid:a,voiceeventsid:l}=s;if(typeof o!="object"||l){this._log.warn("Ignoring signaling error payload",{originalError:o,voiceeventsid:l});return}const u=typeof a=="string"&&this._findCall(a)||void 0,{code:d,message:h}=o;let{twilioError:p}=o;if(typeof d=="number")if(d===31201)p=new Vt.AuthenticationFailed(o);else if(d===31204)p=new Vt.AccessTokenInvalid(o);else if(d===31205)this._stopRegistrationTimer(),p=new Vt.AccessTokenExpired(o);else{const y=Dg(!!this._options.enableImprovedSignalingErrorPrecision,d);typeof y<"u"&&(p=new y(o))}p||(this._log.error("Unknown signaling error: ",o),p=new pn.UnknownError(h,o)),this._log.error("Received error: ",p),this._log.debug("#error",o),this.emit(ie.EventName.Error,p,u)},this._onSignalingInvite=s=>An(this,void 0,void 0,function*(){var o;const a=!!this._activeCall;if(a&&!this._options.allowIncomingWhileBusy){this._log.info("Device busy; ignoring incoming invite");return}if(!s.callsid||!s.sdp){this._log.debug("#error",s),this.emit(ie.EventName.Error,new lo.BadRequest("Malformed invite from gateway"));return}const l=s.parameters||{};l.CallSid=l.CallSid||s.callsid;const u=Object.assign({},Fk(l.Params));this._makeCallPromise=this._makeCall(u,{callParameters:l,enableImprovedSignalingErrorPrecision:!!this._options.enableImprovedSignalingErrorPrecision,offerSdp:s.sdp,reconnectToken:s.reconnect,voiceEventSidGenerator:this._options.voiceEventSidGenerator});let d;try{d=yield this._makeCallPromise}finally{this._makeCallPromise=null}this._calls.push(d),d.once("accept",()=>{this._soundcache.get(ie.SoundName.Incoming).stop(),this._publishNetworkChange()});const h=!((o=this._audio)===null||o===void 0)&&o.incoming()&&!a?()=>this._soundcache.get(ie.SoundName.Incoming).play():()=>Promise.resolve();this._showIncomingCall(d,h)}),this._onSignalingOffline=()=>{this._log.info("Stream is offline"),this._edge=null,this._region=null,this._shouldReRegister=this.state!==ie.State.Unregistered,this._setState(ie.State.Unregistered)},this._onSignalingReady=()=>{this._log.info("Stream is ready"),this._setState(ie.State.Registered)},this._publishNetworkChange=()=>{this._activeCall&&this._networkInformation&&this._publisher.info("network-information","network-change",{connection_type:this._networkInformation.type,downlink:this._networkInformation.downlink,downlinkMax:this._networkInformation.downlinkMax,effective_type:this._networkInformation.effectiveType,rtt:this._networkInformation.rtt},this._activeCall)},this._updateInputStream=s=>{const o=this._activeCall;return o&&!s?Promise.reject(new kr("Cannot unset input device while a call is in progress.")):(this._callInputStream=s,o?o._setInputTracksFromStream(s):Promise.resolve())},this._updateSinkIds=(s,o)=>(s==="ringtone"?this._updateRingtoneSinkIds(o):this._updateSpeakerSinkIds(o)).then(()=>{this._publisher.info("audio",`${s}-devices-set`,{audio_device_ids:o},this._activeCall)},l=>{throw this._publisher.error("audio",`${s}-devices-set-failed`,{audio_device_ids:o,message:l.message},this._activeCall),l}),this._setupLoglevel(n.logLevel),this._logOptions("constructor",n),this.updateToken(e),Rf())throw new tn("Microsoft Edge Legacy (https://support.microsoft.com/en-us/help/4533505/what-is-microsoft-edge-legacy) is deprecated and will not be able to connect to Twilio to make or receive calls after September 1st, 2020. Please see this documentation for a list of supported browsers https://www.twilio.com/docs/voice/client/javascript#supported-browsers");if(!ie.isSupported&&n.ignoreBrowserSupport)throw window&&window.location&&window.location.protocol==="http:"?new tn("twilio.js wasn't able to find WebRTC browser support.           This is most likely because this page is served over http rather than https,           which does not support WebRTC in many browsers. Please load this page over https and           try again."):new tn("twilio.js 1.3+ SDKs require WebRTC browser support.         For more information, see <https://www.twilio.com/docs/api/client/twilio-js>.         If you have any questions about this announcement, please contact         Twilio Support at <help@twilio.com>.");const r=globalThis,i=r.msBrowser||r.browser||r.chrome;if(this._isBrowserExtension=!!i&&!!i.runtime&&!!i.runtime.id||!!r.safari&&!!r.safari.extension,this._isBrowserExtension&&this._log.info("Running as browser extension."),navigator){const s=navigator;this._networkInformation=s.connection||s.mozConnection||s.webkitConnection}this._networkInformation&&typeof this._networkInformation.addEventListener=="function"&&this._networkInformation.addEventListener("change",this._publishNetworkChange),ie._getOrCreateAudioContext(),ie._audioContext&&(ie._dialtonePlayer||(ie._dialtonePlayer=new n4(ie._audioContext))),this._boundDestroy=this.destroy.bind(this),this._boundConfirmClose=this._confirmClose.bind(this),typeof window<"u"&&window.addEventListener&&(window.addEventListener("unload",this._boundDestroy),window.addEventListener("pagehide",this._boundDestroy)),this.updateOptions(n)}get audio(){return this._audio}connect(){return An(this,arguments,void 0,function*(e={}){if(this._log.debug(".connect",JSON.stringify(e)),this._throwIfDestroyed(),this._activeCall)throw new kr("A Call is already active");let n,r,i;if(e.connectToken){try{const u=JSON.parse(decodeURIComponent(atob(e.connectToken)));n=u.customParameters,r=u.parameters,i=u.signalingReconnectToken}catch{throw new et("Cannot parse connectToken")}if(!r||!r.CallSid||!i)throw new et("Invalid connectToken")}let s=!1,o={};const a={enableImprovedSignalingErrorPrecision:!!this._options.enableImprovedSignalingErrorPrecision,rtcConfiguration:e.rtcConfiguration,voiceEventSidGenerator:this._options.voiceEventSidGenerator};i&&r?(s=!0,a.callParameters=r,a.reconnectCallSid=r.CallSid,a.reconnectToken=i,o=n||o):o=e.params||o;let l;this._makeCallPromise=this._makeCall(o,a,s);try{l=this._activeCall=yield this._makeCallPromise}finally{this._makeCallPromise=null}return this._calls.splice(0).forEach(u=>u.ignore()),this._soundcache.get(ie.SoundName.Incoming).stop(),l.accept({rtcConstraints:e.rtcConstraints}),this._publishNetworkChange(),l})}get calls(){return this._calls}destroy(){var e;this._log.debug(".destroy"),this._log.debug("Rejecting any incoming calls"),this._calls.slice(0).forEach(r=>r.reject()),this.disconnectAll(),this._stopRegistrationTimer(),this._destroyStream(),this._destroyAudioHelper(),(e=this._audioProcessorEventObserver)===null||e===void 0||e.destroy(),this._destroyPublisher(),this._networkInformation&&typeof this._networkInformation.removeEventListener=="function"&&this._networkInformation.removeEventListener("change",this._publishNetworkChange),typeof window<"u"&&window.removeEventListener&&(window.removeEventListener("beforeunload",this._boundConfirmClose),window.removeEventListener("unload",this._boundDestroy),window.removeEventListener("pagehide",this._boundDestroy)),this._setState(ie.State.Destroyed),Er.EventEmitter.prototype.removeAllListeners.call(this)}disconnectAll(){this._log.debug(".disconnectAll"),this._calls.splice(0).forEach(n=>n.disconnect()),this._activeCall&&this._activeCall.disconnect()}get edge(){return this._edge}get home(){return this._home}get identity(){return this._identity}get isBusy(){return!!this._activeCall}register(){return An(this,void 0,void 0,function*(){if(this._log.debug(".register"),this.state!==ie.State.Unregistered)throw new kr(`Attempt to register when device is in state "${this.state}". Must be "${ie.State.Unregistered}".`);this._shouldReRegister=!1,this._setState(ie.State.Registering),yield this._streamConnectedPromise||this._setupStream(),yield this._sendPresence(!0),yield Lg(this,ie.State.Registered,ie.State.Unregistered)})}get state(){return this._state}get token(){return this._token}toString(){return"[Twilio.Device instance]"}unregister(){return An(this,void 0,void 0,function*(){if(this._log.debug(".unregister"),this.state!==ie.State.Registered)throw new kr(`Attempt to unregister when device is in state "${this.state}". Must be "${ie.State.Registered}".`);this._shouldReRegister=!1;const e=yield this._streamConnectedPromise,n=new Promise(r=>{e.on("offline",r)});yield this._sendPresence(!1),yield n})}updateOptions(e={}){if(this._logOptions("updateOptions",e),this.state===ie.State.Destroyed)throw new kr(`Attempt to "updateOptions" when device is in state "${this.state}".`);this._options=Object.assign(Object.assign(Object.assign({},this._defaultOptions),this._options),e);const n=new Set(this._chunderURIs),r=this._chunderURIs=(this._getChunderws()||pS(this._options.edge)).map(fS);let i=n.size!==r.length;if(!i){for(const s of r)if(!n.has(s)){i=!0;break}}if(this.isBusy&&i)throw new kr("Cannot change Edge while on an active Call");this._setupLoglevel(this._options.logLevel);for(const s of Object.keys(ie._defaultSounds)){const o=ie._defaultSounds[s],a=`${ev}/${o.filename}.${ie.extension}?cache=${Na}`,l=this._options.sounds&&this._options.sounds[s]||a,u=new(this._options.Sound||Di)(s,l,{audioContext:this._options.disableAudioContextSounds?null:ie.audioContext,maxDuration:o.maxDuration,shouldLoop:o.shouldLoop});this._soundcache.set(s,u)}this._setupAudioHelper(),this._setupPublisher(),i&&this._streamConnectedPromise&&this._setupStream(),typeof window<"u"&&typeof window.addEventListener=="function"&&this._options.closeProtection&&(window.removeEventListener("beforeunload",this._boundConfirmClose),window.addEventListener("beforeunload",this._boundConfirmClose))}updateToken(e){if(this._log.debug(".updateToken"),this.state===ie.State.Destroyed)throw new kr(`Attempt to "updateToken" when device is in state "${this.state}".`);if(typeof e!="string")throw new et(aU);this._token=e,this._stream&&this._stream.setToken(this._token),this._publisher&&this._publisher.setToken(this._token)}_confirmClose(e){if(!this._activeCall)return"";const n=this._options.closeProtection||!1,r=typeof n!="string"?"A call is currently in-progress. Leaving or reloading this page will end the call.":n;return(e||window.event).returnValue=r,r}_destroyAudioHelper(){this._audio&&(this._audio._destroy(),this._audio=null)}_destroyPublisher(){this._publisher&&(this._publisher=null)}_destroyStream(){this._stream&&(this._stream.removeListener("close",this._onSignalingClose),this._stream.removeListener("connected",this._onSignalingConnected),this._stream.removeListener("error",this._onSignalingError),this._stream.removeListener("invite",this._onSignalingInvite),this._stream.removeListener("offline",this._onSignalingOffline),this._stream.removeListener("ready",this._onSignalingReady),this._stream.destroy(),this._stream=null),this._onSignalingOffline(),this._streamConnectedPromise=null}_findCall(e){return this._calls.find(n=>n.parameters.CallSid===e||n.outboundConnectionId===e)||null}_getChunderws(){return typeof this._options.chunderw=="string"?[this._options.chunderw]:Array.isArray(this._options.chunderw)?this._options.chunderw:null}_logOptions(e,n={}){const r=["allowIncomingWhileBusy","appName","appVersion","closeProtection","codecPreferences","disableAudioContextSounds","dscp","edge","enableImprovedSignalingErrorPrecision","forceAggressiveIceNomination","logLevel","maxAverageBitrate","maxCallSignalingTimeoutMs","sounds","tokenRefreshMs"],i=["RTCPeerConnection","enumerateDevices","getUserMedia","MediaStream"];if(typeof n=="object"){const s=Object.assign({},n);Object.keys(s).forEach(o=>{!r.includes(o)&&!i.includes(o)&&delete s[o],i.includes(o)&&(s[o]=!0)}),this._log.debug(`.${e}`,JSON.stringify(s))}}_makeCall(e,n){return An(this,arguments,void 0,function*(r,i,s=!1){var o;const a=(o=this._audio)===null||o===void 0?void 0:o._getInputDevicePromise();a&&(this._log.debug("inputDevicePromise detected, waiting..."),yield a,this._log.debug("inputDevicePromise resolved"));const l={audioHelper:this._audio,onIgnore:()=>{this._soundcache.get(ie.SoundName.Incoming).stop()},pstream:yield this._streamConnectedPromise||this._setupStream(),publisher:this._publisher,soundcache:this._soundcache};i=Object.assign({MediaStream:this._options.MediaStream,RTCPeerConnection:this._options.RTCPeerConnection,beforeAccept:h=>{!this._activeCall||this._activeCall===h||(this._activeCall.disconnect(),this._removeCall(this._activeCall))},codecPreferences:this._options.codecPreferences,customSounds:this._options.sounds,dialtonePlayer:ie._dialtonePlayer,dscp:this._options.dscp,forceAggressiveIceNomination:this._options.forceAggressiveIceNomination,getInputStream:()=>this._options.fileInputStream||this._callInputStream,getSinkIds:()=>this._callSinkIds,maxAverageBitrate:this._options.maxAverageBitrate,preflight:this._options.preflight,rtcConstraints:this._options.rtcConstraints,shouldPlayDisconnect:()=>{var h;return(h=this._audio)===null||h===void 0?void 0:h.disconnect()},twimlParams:r,voiceEventSidGenerator:this._options.voiceEventSidGenerator},i);const u=()=>{if(!this._stream){this._log.warn("UnsetPreferredUri called without a stream");return}this._activeCall===null&&this._calls.length===0&&this._stream.updatePreferredURI(null)},d=new(this._options.Call||re)(l,i);return this._publisher.info("settings","init",{MediaStream:!!this._options.MediaStream,RTCPeerConnection:!!this._options.RTCPeerConnection,enumerateDevices:!!this._options.enumerateDevices,getUserMedia:!!this._options.getUserMedia},d),d.once("accept",()=>{var h,p,y;this._stream.updatePreferredURI(this._preferredURI),this._removeCall(d),this._activeCall=d,this._audio&&this._audio._maybeStartPollingVolume(),d.direction===re.CallDirection.Outgoing&&(!((h=this._audio)===null||h===void 0)&&h.outgoing())&&!s&&this._soundcache.get(ie.SoundName.Outgoing).play();const T={edge:this._edge||this._region};this._options.edge&&(T.selected_edge=Array.isArray(this._options.edge)?this._options.edge:[this._options.edge]),this._publisher.info("settings","edge",T,d),!((p=this._audio)===null||p===void 0)&&p.processedStream&&((y=this._audioProcessorEventObserver)===null||y===void 0||y.emit("enabled"))}),d.addListener("error",h=>{d.status()==="closed"&&(this._removeCall(d),u()),this._audio&&this._audio._maybeStopPollingVolume(),this._maybeStopIncomingSound()}),d.once("cancel",()=>{this._log.info(`Canceled: ${d.parameters.CallSid}`),this._removeCall(d),u(),this._audio&&this._audio._maybeStopPollingVolume(),this._maybeStopIncomingSound()}),d.once("disconnect",()=>{this._audio&&this._audio._maybeStopPollingVolume(),this._removeCall(d),u(),this._maybeStopIncomingSound()}),d.once("reject",()=>{this._log.info(`Rejected: ${d.parameters.CallSid}`),this._audio&&this._audio._maybeStopPollingVolume(),this._removeCall(d),u(),this._maybeStopIncomingSound()}),d.on("transportClose",()=>{d.status()===re.State.Pending&&(this._audio&&this._audio._maybeStopPollingVolume(),this._removeCall(d),this._maybeStopIncomingSound())}),d})}_maybeStopIncomingSound(){this._calls.length||this._soundcache.get(ie.SoundName.Incoming).stop()}_removeCall(e){this._activeCall===e&&(this._activeCall=null,this._makeCallPromise=null);for(let n=this._calls.length-1;n>=0;n--)e===this._calls[n]&&this._calls.splice(n,1)}_sendPresence(e){return An(this,void 0,void 0,function*(){const n=yield this._streamConnectedPromise;n&&(n.register({audio:e}),e?this._startRegistrationTimer():this._stopRegistrationTimer())})}_setState(e){if(e===this.state)return;this._state=e;const n=this._stateEventMapping[e];this._log.debug(`#${n}`),this.emit(n)}_setupAudioHelper(){this._audioProcessorEventObserver||(this._audioProcessorEventObserver=new e4,this._audioProcessorEventObserver.on("event",({name:n,group:r})=>{this._publisher.info(r,n,{},this._activeCall)}));const e={audioContext:ie.audioContext,audioProcessorEventObserver:this._audioProcessorEventObserver,beforeSetInputDevice:()=>this._makeCallPromise?(this._log.debug("beforeSetInputDevice pause detected"),this._makeCallPromise):(this._log.debug("beforeSetInputDevice pause not detected, setting default"),Promise.resolve()),enumerateDevices:this._options.enumerateDevices,getUserMedia:this._options.getUserMedia||Y4};if(this._audio){this._log.info("Found existing audio helper; updating options..."),this._audio._updateUserOptions(e);return}this._audio=new(this._options.AudioHelper||XF)(this._updateSinkIds,this._updateInputStream,e),this._audio.on("deviceChange",n=>{const r=this._activeCall,i=n.map(s=>s.deviceId);this._publisher.info("audio","device-change",{lost_active_device_ids:i},r),r&&r._mediaHandler._onInputDevicesChanged()})}_setupLoglevel(e){const n=typeof e=="number"||typeof e=="string"?e:au.levels.ERROR;this._log.setDefaultLevel(n),this._log.info("Set logger default level to",n)}_setupPublisher(){this._publisher&&(this._log.info("Found existing publisher; destroying..."),this._destroyPublisher());const e={defaultPayload:this._createDefaultPayload,metadata:{app_name:this._options.appName,app_version:this._options.appVersion}};return this._options.eventgw&&(e.host=this._options.eventgw),this._home&&(e.host=hS(this._home)),this._publisher=new(this._options.Publisher||Dn)(oU,this.token,e),this._options.publishEvents===!1?this._publisher.disable():this._publisher.on("error",n=>{this._log.warn("Cannot connect to insights.",n)}),this._publisher}_setupStream(){return this._stream&&(this._log.info("Found existing stream; destroying..."),this._destroyStream()),this._log.info("Setting up VSP"),this._stream=new(this._options.PStream||ct)(this.token,this._chunderURIs,{backoffMaxMs:this._options.backoffMaxMs,maxPreferredDurationMs:this._options.maxCallSignalingTimeoutMs}),this._stream.addListener("close",this._onSignalingClose),this._stream.addListener("connected",this._onSignalingConnected),this._stream.addListener("error",this._onSignalingError),this._stream.addListener("invite",this._onSignalingInvite),this._stream.addListener("offline",this._onSignalingOffline),this._stream.addListener("ready",this._onSignalingReady),this._streamConnectedPromise=Lg(this._stream,"connected","close").then(()=>this._stream)}_showIncomingCall(e,n){let r;return Promise.race([n(),new Promise((i,s)=>{r=setTimeout(()=>{const o="Playing incoming ringtone took too long; it might not play. Continuing execution...";s(new Error(o))},sU)})]).catch(i=>{this._log.warn(i.message)}).then(()=>{clearTimeout(r),this._log.debug("#incoming",JSON.stringify({customParameters:e.customParameters,parameters:e.parameters})),this.emit(ie.EventName.Incoming,e)})}_startRegistrationTimer(){this._stopRegistrationTimer(),this._regTimer=setTimeout(()=>{this._sendPresence(!0)},iU)}_stopRegistrationTimer(){this._regTimer&&clearTimeout(this._regTimer)}_throwIfDestroyed(){if(this.state===ie.State.Destroyed)throw new kr("Device has been destroyed.")}_updateRingtoneSinkIds(e){return Promise.resolve(this._soundcache.get(ie.SoundName.Incoming).setSinkIds(e))}_updateSpeakerSinkIds(e){Array.from(this._soundcache.entries()).filter(r=>r[0]!==ie.SoundName.Incoming).forEach(r=>r[1].setSinkIds(e)),this._callSinkIds=e;const n=this._activeCall;return n?n._setSinkIds(e):Promise.resolve()}}ie._defaultSounds={disconnect:{filename:"disconnect",maxDuration:3e3},dtmf0:{filename:"dtmf-0",maxDuration:1e3},dtmf1:{filename:"dtmf-1",maxDuration:1e3},dtmf2:{filename:"dtmf-2",maxDuration:1e3},dtmf3:{filename:"dtmf-3",maxDuration:1e3},dtmf4:{filename:"dtmf-4",maxDuration:1e3},dtmf5:{filename:"dtmf-5",maxDuration:1e3},dtmf6:{filename:"dtmf-6",maxDuration:1e3},dtmf7:{filename:"dtmf-7",maxDuration:1e3},dtmf8:{filename:"dtmf-8",maxDuration:1e3},dtmf9:{filename:"dtmf-9",maxDuration:1e3},dtmfh:{filename:"dtmf-hash",maxDuration:1e3},dtmfs:{filename:"dtmf-star",maxDuration:1e3},incoming:{filename:"incoming",shouldLoop:!0},outgoing:{filename:"outgoing",maxDuration:3e3}};(function(t){(function(e){e.Error="error",e.Incoming="incoming",e.Destroyed="destroyed",e.Unregistered="unregistered",e.Registering="registering",e.Registered="registered",e.TokenWillExpire="tokenWillExpire"})(t.EventName||(t.EventName={})),function(e){e.Destroyed="destroyed",e.Unregistered="unregistered",e.Registering="registering",e.Registered="registered"}(t.State||(t.State={})),function(e){e.Incoming="incoming",e.Outgoing="outgoing",e.Disconnect="disconnect",e.Dtmf0="dtmf0",e.Dtmf1="dtmf1",e.Dtmf2="dtmf2",e.Dtmf3="dtmf3",e.Dtmf4="dtmf4",e.Dtmf5="dtmf5",e.Dtmf6="dtmf6",e.Dtmf7="dtmf7",e.Dtmf8="dtmf8",e.Dtmf9="dtmf9",e.DtmfS="dtmfs",e.DtmfH="dtmfh"}(t.SoundName||(t.SoundName={}))})(ie||(ie={}));class Fp{constructor(e,n=!1){this.deleted=!1;let r;const i=e.candidate.split("network-cost ");i[1]&&(r=parseInt(i[1],10)),this.candidateType=e.type,this.ip=e.ip||e.address,this.isRemote=n,this.networkCost=r,this.port=e.port,this.priority=e.priority,this.protocol=e.protocol,this.relatedAddress=e.relatedAddress,this.relatedPort=e.relatedPort,this.tcpType=e.tcpType,this.transportId=e.sdpMid}toPayload(){return{candidate_type:this.candidateType,deleted:this.deleted,ip:this.ip,is_remote:this.isRemote,"network-cost":this.networkCost,port:this.port,priority:this.priority,protocol:this.protocol,related_address:this.relatedAddress,related_port:this.relatedPort,tcp_type:this.tcpType,transport_id:this.transportId}}}const vS=94.768;function lU(t,e,n){if(typeof t!="number"||typeof e!="number"||typeof n!="number"||!Gd(t)||!Gd(e)||!Gd(n))return null;const r=t+e*2+10;let i=0;switch(!0){case r<160:i=vS-r/40;break;case r<1e3:i=vS-(r-120)/10;break}switch(!0){case n<=i/2.5:i=Math.max(i-n*2.5,6.52);break;default:i=0;break}return 1+.035*i+7e-6*i*(i-60)*(100-i)}function Gd(t){return typeof t=="number"&&!isNaN(t)&&isFinite(t)&&t>=0}var cU={calculate:lU,isNonNegativeNumber:Gd};const uU=5,dU=0,hU=3,fU=1e3,pU=5*1e3,mU={audioInputLevel:{minStandardDeviation:327.67,sampleCount:10},audioOutputLevel:{minStandardDeviation:327.67,sampleCount:10},bytesReceived:{clearCount:2,min:1,raiseCount:3,sampleCount:3},bytesSent:{clearCount:2,min:1,raiseCount:3,sampleCount:3},jitter:{max:30},mos:{min:3},packetsLostFraction:[{max:1},{clearValue:1,maxAverage:3,sampleCount:7}],rtt:{max:400}};function gU(t,e){return e.reduce((n,r)=>n+=r>t?1:0,0)}function yU(t,e){return e.reduce((n,r)=>n+=r<t?1:0,0)}function _U(t){if(t.length<=0)return null;const e=t.reduce((i,s)=>i+s,0)/t.length,n=t.map(i=>Math.pow(i-e,2));return Math.sqrt(n.reduce((i,s)=>i+s,0)/n.length)}function vU(t){return t.reduce((e,n)=>[...e,...n],[])}class wU extends Er.EventEmitter{constructor(e){super(),this._activeWarnings=new Map,this._currentStreaks=new Map,this._inputVolumes=[],this._outputVolumes=[],this._sampleBuffer=[],this._supplementalSampleBuffers={audioInputLevel:[],audioOutputLevel:[]},this._warningsEnabled=!0,e=e||{},this._getRTCStats=e.getRTCStats||m4,this._mos=e.Mos||cU,this._peerConnection=e.peerConnection,this._thresholds=Object.assign(Object.assign({},mU),e.thresholds);const n=Object.values(this._thresholds).map(r=>r.sampleCount).filter(r=>!!r);this._maxSampleCount=Math.max(uU,...n),this._peerConnection&&this.enable(this._peerConnection)}addVolumes(e,n){this._inputVolumes.push(e),this._outputVolumes.push(n)}disable(){return this._sampleInterval&&(clearInterval(this._sampleInterval),delete this._sampleInterval),this}disableWarnings(){return this._warningsEnabled&&this._activeWarnings.clear(),this._warningsEnabled=!1,this}enable(e){if(e){if(this._peerConnection&&e!==this._peerConnection)throw new et("Attempted to replace an existing PeerConnection in StatsMonitor.enable");this._peerConnection=e}if(!this._peerConnection)throw new et("Can not enable StatsMonitor without a PeerConnection");return this._sampleInterval=this._sampleInterval||setInterval(this._fetchSample.bind(this),fU),this}enableWarnings(){return this._warningsEnabled=!0,this}hasActiveWarning(e,n){const r=`${e}:${n}`;return!!this._activeWarnings.get(r)}_addSample(e){const n=this._sampleBuffer;n.push(e),n.length>this._maxSampleCount&&n.splice(0,n.length-this._maxSampleCount)}_clearWarning(e,n,r){const i=`${e}:${n}`,s=this._activeWarnings.get(i);!s||Date.now()-s.timeRaised<pU||(this._activeWarnings.delete(i),this.emit("warning-cleared",Object.assign(Object.assign({},r),{name:e,threshold:{name:n,value:this._thresholds[e][n]}})))}_createSample(e,n){const r=n&&n.totals.bytesSent||0,i=n&&n.totals.bytesReceived||0,s=n&&n.totals.packetsSent||0,o=n&&n.totals.packetsReceived||0,a=n&&n.totals.packetsLost||0,l=e.bytesSent-r,u=e.bytesReceived-i,d=e.packetsSent-s,h=e.packetsReceived-o,p=e.packetsLost-a,y=h+p,T=y>0?p/y*100:0,E=e.packetsReceived+e.packetsLost,R=E>0?e.packetsLost/E*100:100,w=typeof e.rtt=="number"||!n?e.rtt:n.rtt,v=this._inputVolumes.splice(0);this._supplementalSampleBuffers.audioInputLevel.push(v);const b=this._outputVolumes.splice(0);return this._supplementalSampleBuffers.audioOutputLevel.push(b),{audioInputLevel:Math.round(bc(v)),audioOutputLevel:Math.round(bc(b)),bytesReceived:u,bytesSent:l,codecName:e.codecName,jitter:e.jitter,mos:this._mos.calculate(w,e.jitter,n&&T),packetsLost:p,packetsLostFraction:T,packetsReceived:h,packetsSent:d,rtt:w,timestamp:e.timestamp,totals:{bytesReceived:e.bytesReceived,bytesSent:e.bytesSent,packetsLost:e.packetsLost,packetsLostFraction:R,packetsReceived:e.packetsReceived,packetsSent:e.packetsSent}}}_fetchSample(){this._getSample().then(e=>{this._addSample(e),this._raiseWarnings(),this.emit("sample",e)}).catch(e=>{this.disable(),this.emit("error",e)})}_getSample(){return this._getRTCStats(this._peerConnection).then(e=>{let n=null;return this._sampleBuffer.length&&(n=this._sampleBuffer[this._sampleBuffer.length-1]),this._createSample(e,n)})}_raiseWarning(e,n,r){const i=`${e}:${n}`;if(this._activeWarnings.has(i))return;this._activeWarnings.set(i,{timeRaised:Date.now()});const s=this._thresholds[e];let o;if(Array.isArray(s)){const a=s.find(l=>n in l);a&&(o=a[n])}else o=this._thresholds[e][n];this.emit("warning",Object.assign(Object.assign({},r),{name:e,threshold:{name:n,value:o}}))}_raiseWarnings(){this._warningsEnabled&&Object.keys(this._thresholds).forEach(e=>this._raiseWarningsForStat(e))}_raiseWarningsForStat(e){(Array.isArray(this._thresholds[e])?this._thresholds[e]:[this._thresholds[e]]).forEach(r=>{const i=this._sampleBuffer,s=r.clearCount||dU,o=r.raiseCount||hU,a=r.sampleCount||this._maxSampleCount;let l=i.slice(-a);const u=l.map(p=>p[e]);if(u.some(p=>typeof p>"u"||p===null))return;let h;if(typeof r.max=="number"&&(h=gU(r.max,u),h>=o?this._raiseWarning(e,"max",{values:u,samples:l}):h<=s&&this._clearWarning(e,"max",{values:u,samples:l})),typeof r.min=="number"&&(h=yU(r.min,u),h>=o?this._raiseWarning(e,"min",{values:u,samples:l}):h<=s&&this._clearWarning(e,"min",{values:u,samples:l})),typeof r.maxDuration=="number"&&i.length>1){l=i.slice(-2);const p=l[0][e],y=l[1][e],T=this._currentStreaks.get(e)||0,E=p===y?T+1:0;this._currentStreaks.set(e,E),E>=r.maxDuration?this._raiseWarning(e,"maxDuration",{value:E}):E===0&&this._clearWarning(e,"maxDuration",{value:T})}if(typeof r.minStandardDeviation=="number"){const p=this._supplementalSampleBuffers[e];if(!p||p.length<r.sampleCount)return;p.length>r.sampleCount&&p.splice(0,p.length-r.sampleCount);const y=vU(p.slice(-a)),T=_U(y);if(typeof T!="number")return;T<r.minStandardDeviation?this._raiseWarning(e,"minStandardDeviation",{value:T}):this._clearWarning(e,"minStandardDeviation",{value:T})}[["maxAverage",(p,y)=>p>y],["minAverage",(p,y)=>p<y]].forEach(([p,y])=>{if(typeof r[p]=="number"&&u.length>=a){const T=bc(u);y(T,r[p])?this._raiseWarning(e,p,{values:u,samples:l}):y(T,r.clearValue||r[p])||this._clearWarning(e,p,{values:u,samples:l})}})})}}const wS={factor:1.1,jitter:.5,max:3e4,min:1},EU=70,SU=500,TU=160,xU=10,bU=5e3,ES={disconnect:!0,info:{code:31003,message:"Connection with Twilio was interrupted.",twilioError:new ri.ConnectionError}},SS={packetsLostFraction:{max:"packet-loss",maxAverage:"packets-lost-fraction"}},TS={audioInputLevel:"audio-input-level",audioOutputLevel:"audio-output-level",bytesReceived:"bytes-received",bytesSent:"bytes-sent",jitter:"jitter",mos:"mos",rtt:"rtt"},IU={max:"high-",maxAverage:"high-",maxDuration:"constant-",min:"low-",minStandardDeviation:"constant-"};class re extends Er.EventEmitter{get direction(){return this._direction}get codec(){return this._codec}get connectToken(){const e=this._signalingReconnectToken,n=this.parameters&&this.parameters.CallSid?this.parameters.CallSid:void 0;if(!e||!n)return;const r=this.customParameters&&typeof this.customParameters.keys=="function"?Array.from(this.customParameters.keys()).reduce((s,o)=>(s[o]=this.customParameters.get(o),s),{}):{},i=this.parameters||{};return btoa(encodeURIComponent(JSON.stringify({customParameters:r,parameters:i,signalingReconnectToken:e})))}constructor(e,n){super(),this.parameters={},this._inputVolumeStreak=0,this._isAnswered=!1,this._isCancelled=!1,this._isRejected=!1,this._latestInputVolume=0,this._latestOutputVolume=0,this._log=new Ft("Call"),this._mediaStatus=re.State.Pending,this._messages=new Map,this._metricsSamples=[],this._options={MediaHandler:_e,MediaStream:null,enableImprovedSignalingErrorPrecision:!1,offerSdp:null,shouldPlayDisconnect:()=>!0,voiceEventSidGenerator:Fg},this._outputVolumeStreak=0,this._shouldSendHangup=!0,this._signalingStatus=re.State.Pending,this._soundcache=new Map,this._status=re.State.Pending,this._wasConnected=!1,this.toString=()=>"[Twilio.Call instance]",this._emitWarning=(o,a,l,u,d,h)=>{const y=`${o}warning${d?"-cleared":"-raised"}`;if(a==="constant-audio-input-level"&&this.isMuted())return;let T=d?"info":"warning";a==="constant-audio-output-level"&&(T="info");const E={threshold:l};if(u&&(u instanceof Array?E.values=u.map(R=>typeof R=="number"?Math.round(R*100)/100:u):E.value=u),this._publisher.post(T,y,a,{data:E},this),a!=="constant-audio-output-level"){const R=d?"warning-cleared":"warning";this._log.debug(`#${R}`,a),this.emit(R,a,h&&!d?h:null)}},this._onAck=o=>{const{acktype:a,callsid:l,voiceeventsid:u}=o;if(this.parameters.CallSid!==l){this._log.warn(`Received ack from a different callsid: ${l}`);return}a==="message"&&this._onMessageSent(u)},this._onAnswer=o=>{typeof o.reconnect=="string"&&(this._signalingReconnectToken=o.reconnect),!(this._isAnswered&&this._status!==re.State.Reconnecting)&&(this._setCallSid(o),this._isAnswered=!0,this._maybeTransitionToOpen())},this._onCancel=o=>{const a=o.callsid;this.parameters.CallSid===a&&(this._isCancelled=!0,this._publisher.info("connection","cancel",null,this),this._cleanupEventListeners(),this._mediaHandler.close(),this._status=re.State.Closed,this._log.debug("#cancel"),this.emit("cancel"),this._pstream.removeListener("cancel",this._onCancel))},this._onConnected=()=>{this._log.info("Received connected from pstream"),this._signalingReconnectToken&&this._mediaHandler.version&&this._pstream.reconnect(this._mediaHandler.version.getSDP(),this.parameters.CallSid,this._signalingReconnectToken)},this._onHangup=o=>{if(this.status()!==re.State.Closed){if(o.callsid&&(this.parameters.CallSid||this.outboundConnectionId)){if(o.callsid!==this.parameters.CallSid&&o.callsid!==this.outboundConnectionId)return}else if(o.callsid)return;if(this._log.info("Received HANGUP from gateway"),o.error){const a=o.error.code,l=Dg(this._options.enableImprovedSignalingErrorPrecision,a),u=typeof l<"u"?new l(o.error.message):new pn.ConnectionError("Error sent from gateway in HANGUP",o.error);this._log.error("Received an error from the gateway:",u),this._log.debug("#error",u),this.emit("error",u)}this._shouldSendHangup=!1,this._publisher.info("connection","disconnected-by-remote",null,this),this._disconnect(null,!0),this._cleanupEventListeners()}},this._onMediaFailure=o=>{const{ConnectionDisconnected:a,ConnectionFailed:l,IceGatheringFailed:u,LowBytes:d}=re.MediaFailure,h=o===l||o===u;if(!nv(window,window.navigator)&&o===l)return this._mediaHandler.onerror(ES);if(this._mediaStatus===re.State.Reconnecting){if(h){if(Date.now()-this._mediaReconnectStartTime>wS.max)return this._log.warn("Exceeded max ICE retries"),this._mediaHandler.onerror(ES);try{this._mediaReconnectBackoff.backoff()}catch(E){if(!(E.message&&E.message==="Backoff in progress."))throw E}}return}const p=this._mediaHandler.version.pc,y=p&&p.iceConnectionState==="disconnected",T=this._monitor.hasActiveWarning("bytesSent","min")||this._monitor.hasActiveWarning("bytesReceived","min");if(o===d&&y||o===a&&T||h){const E=new ri.ConnectionError("Media connection failed.");this._log.warn("ICE Connection disconnected."),this._publisher.warn("connection","error",E,this),this._publisher.info("connection","reconnecting",null,this),this._mediaReconnectStartTime=Date.now(),this._status=re.State.Reconnecting,this._mediaStatus=re.State.Reconnecting,this._mediaReconnectBackoff.reset(),this._mediaReconnectBackoff.backoff(),this._log.debug("#reconnecting"),this.emit("reconnecting",E)}},this._onMediaReconnected=()=>{this._mediaStatus===re.State.Reconnecting&&(this._log.info("ICE Connection reestablished."),this._mediaStatus=re.State.Open,this._signalingStatus===re.State.Open&&(this._publisher.info("connection","reconnected",null,this),this._log.debug("#reconnected"),this.emit("reconnected"),this._status=re.State.Open))},this._onMessageReceived=o=>{const{callsid:a,content:l,contenttype:u,messagetype:d,voiceeventsid:h}=o;if(this.parameters.CallSid!==a){this._log.warn(`Received a message from a different callsid: ${a}`);return}const p={content:l,contentType:u,messageType:d,voiceEventSid:h};this._publisher.info("call-message",d,{content_type:u,event_type:"received",voice_event_sid:h},this),this._log.debug("#messageReceived",JSON.stringify(p)),this.emit("messageReceived",p)},this._onMessageSent=o=>{if(!this._messages.has(o)){this._log.warn(`Received a messageSent with a voiceEventSid that doesn't exists: ${o}`);return}const a=this._messages.get(o);this._messages.delete(o),this._publisher.info("call-message",a==null?void 0:a.messageType,{content_type:a==null?void 0:a.contentType,event_type:"sent",voice_event_sid:o},this),this._log.debug("#messageSent",JSON.stringify(a)),this.emit("messageSent",a)},this._onRinging=o=>{if(this._setCallSid(o),this._status!==re.State.Connecting&&this._status!==re.State.Ringing)return;const a=!!o.sdp;this._status=re.State.Ringing,this._publisher.info("connection","outgoing-ringing",{hasEarlyMedia:a},this),this._log.debug("#ringing"),this.emit("ringing",a)},this._onRTCSample=o=>{const a=Object.assign(Object.assign({},o),{inputVolume:this._latestInputVolume,outputVolume:this._latestOutputVolume});this._codec=a.codecName,this._metricsSamples.push(a),this._metricsSamples.length>=xU&&this._publishMetrics(),this.emit("sample",o)},this._onSignalingError=o=>{const{callsid:a,voiceeventsid:l,error:u}=o;if(this.parameters.CallSid!==a){this._log.warn(`Received an error from a different callsid: ${a}`);return}if(l&&this._messages.has(l)){this._messages.delete(l),this._log.warn("Received an error while sending a message.",o),this._publisher.error("call-message","error",{code:u.code,message:u.message,voice_event_sid:l},this);let d;const h=Dg(!!this._options.enableImprovedSignalingErrorPrecision,u.code);typeof h<"u"&&(d=new h(u)),d||(this._log.error("Unknown Call Message Error: ",u),d=new pn.UnknownError(u.message,u)),this._log.debug("#error",u,d),this.emit("error",d)}},this._onSignalingReconnected=()=>{this._signalingStatus===re.State.Reconnecting&&(this._log.info("Signaling Connection reestablished."),this._signalingStatus=re.State.Open,this._mediaStatus===re.State.Open&&(this._publisher.info("connection","reconnected",null,this),this._log.debug("#reconnected"),this.emit("reconnected"),this._status=re.State.Open))},this._onTransportClose=()=>{this._log.error("Received transportClose from pstream"),this._log.debug("#transportClose"),this.emit("transportClose"),this._signalingReconnectToken?(this._status=re.State.Reconnecting,this._signalingStatus=re.State.Reconnecting,this._publisher.info("connection","reconnecting",null,this),this._log.debug("#reconnecting"),this.emit("reconnecting",new _r.ConnectionDisconnected)):(this._status=re.State.Closed,this._signalingStatus=re.State.Closed)},this._reemitWarning=(o,a)=>{const l=/^audio/.test(o.name)?"audio-level-":"network-quality-",u=IU[o.threshold.name];let d;o.name in SS?d=SS[o.name][o.threshold.name]:o.name in TS&&(d=TS[o.name]);const h=u+d;this._emitWarning(l,h,o.threshold.value,o.values||o.value,a,o)},this._reemitWarningCleared=o=>{this._reemitWarning(o,!0)},this._soundcache=e.soundcache,typeof e.onIgnore=="function"&&(this._onIgnore=e.onIgnore);const r=n&&n.twimlParams||{};this.customParameters=new Map(Object.entries(r).map(([o,a])=>[o,String(a)])),Object.assign(this._options,n),this._options.callParameters&&(this.parameters=this._options.callParameters),this._options.reconnectToken&&(this._signalingReconnectToken=this._options.reconnectToken),this._voiceEventSidGenerator=this._options.voiceEventSidGenerator||Fg,this._direction=this.parameters.CallSid&&!this._options.reconnectCallSid?re.CallDirection.Incoming:re.CallDirection.Outgoing,this.parameters?this.callerInfo=this.parameters.StirStatus?{isVerified:this.parameters.StirStatus==="TN-Validation-Passed-A"}:null:this.callerInfo=null,this._mediaReconnectBackoff=new Pg(wS),this._mediaReconnectBackoff.on("ready",()=>this._mediaHandler.iceRestart()),this.outboundConnectionId=CU();const i=this._publisher=e.publisher;this._direction===re.CallDirection.Incoming?i.info("connection","incoming",null,this):i.info("connection","outgoing",{preflight:this._options.preflight,reconnect:!!this._options.reconnectCallSid},this);const s=this._monitor=new(this._options.StatsMonitor||wU);s.on("sample",this._onRTCSample),s.disableWarnings(),setTimeout(()=>s.enableWarnings(),bU),s.on("warning",(o,a)=>{(o.name==="bytesSent"||o.name==="bytesReceived")&&this._onMediaFailure(re.MediaFailure.LowBytes),this._reemitWarning(o,a)}),s.on("warning-cleared",o=>{this._reemitWarningCleared(o)}),this._mediaHandler=new this._options.MediaHandler(e.audioHelper,e.pstream,{MediaStream:this._options.MediaStream,RTCPeerConnection:this._options.RTCPeerConnection,codecPreferences:this._options.codecPreferences,dscp:this._options.dscp,forceAggressiveIceNomination:this._options.forceAggressiveIceNomination,maxAverageBitrate:this._options.maxAverageBitrate}),this.on("volume",(o,a)=>{this._inputVolumeStreak=this._checkVolume(o,this._inputVolumeStreak,this._latestInputVolume,"input"),this._outputVolumeStreak=this._checkVolume(a,this._outputVolumeStreak,this._latestOutputVolume,"output"),this._latestInputVolume=o,this._latestOutputVolume=a}),this._mediaHandler.onaudio=o=>{this._log.debug("#audio"),this.emit("audio",o)},this._mediaHandler.onvolume=(o,a,l,u)=>{s.addVolumes(l/255*32767,u/255*32767),this.emit("volume",o,a)},this._mediaHandler.ondtlstransportstatechange=o=>{const a=o==="failed"?"error":"debug";this._publisher.post(a,"dtls-transport-state",o,null,this)},this._mediaHandler.onpcconnectionstatechange=o=>{let a="debug";const l=this._mediaHandler.getRTCDtlsTransport();o==="failed"&&(a=l&&l.state==="failed"?"error":"warning"),this._publisher.post(a,"pc-connection-state",o,null,this)},this._mediaHandler.onicecandidate=o=>{const a=new Fp(o).toPayload();this._publisher.debug("ice-candidate","ice-candidate",a,this)},this._mediaHandler.onselectedcandidatepairchange=o=>{const a=new Fp(o.local).toPayload(),l=new Fp(o.remote,!0).toPayload();this._publisher.debug("ice-candidate","selected-ice-candidate-pair",{local_candidate:a,remote_candidate:l},this)},this._mediaHandler.oniceconnectionstatechange=o=>{const a=o==="failed"?"error":"debug";this._publisher.post(a,"ice-connection-state",o,null,this)},this._mediaHandler.onicegatheringfailure=o=>{this._publisher.warn("ice-gathering-state",o,null,this),this._onMediaFailure(re.MediaFailure.IceGatheringFailed)},this._mediaHandler.onicegatheringstatechange=o=>{this._publisher.debug("ice-gathering-state",o,null,this)},this._mediaHandler.onsignalingstatechange=o=>{this._publisher.debug("signaling-state",o,null,this)},this._mediaHandler.ondisconnected=o=>{this._log.warn(o),this._publisher.warn("network-quality-warning-raised","ice-connectivity-lost",{message:o},this),this._log.debug("#warning","ice-connectivity-lost"),this.emit("warning","ice-connectivity-lost"),this._onMediaFailure(re.MediaFailure.ConnectionDisconnected)},this._mediaHandler.onfailed=o=>{this._onMediaFailure(re.MediaFailure.ConnectionFailed)},this._mediaHandler.onconnected=()=>{this._status===re.State.Reconnecting&&this._onMediaReconnected()},this._mediaHandler.onreconnected=o=>{this._log.info(o),this._publisher.info("network-quality-warning-cleared","ice-connectivity-lost",{message:o},this),this._log.debug("#warning-cleared","ice-connectivity-lost"),this.emit("warning-cleared","ice-connectivity-lost"),this._onMediaReconnected()},this._mediaHandler.onerror=o=>{o.disconnect===!0&&this._disconnect(o.info&&o.info.message);const a=o.info.twilioError||new pn.UnknownError(o.info.message);this._log.error("Received an error from MediaStream:",o),this._log.debug("#error",a),this.emit("error",a)},this._mediaHandler.onopen=()=>{this._status===re.State.Open||this._status===re.State.Reconnecting||(this._status===re.State.Ringing||this._status===re.State.Connecting?(this.mute(this._mediaHandler.isMuted),this._mediaStatus=re.State.Open,this._maybeTransitionToOpen()):this._mediaHandler.close())},this._mediaHandler.onclose=()=>{this._status=re.State.Closed,this._options.shouldPlayDisconnect&&this._options.shouldPlayDisconnect()&&!this._isCancelled&&!this._isRejected&&this._soundcache.get(ie.SoundName.Disconnect).play(),s.disable(),this._publishMetrics(),!this._isCancelled&&!this._isRejected&&(this._log.debug("#disconnect"),this.emit("disconnect",this))},this._pstream=e.pstream,this._pstream.on("ack",this._onAck),this._pstream.on("cancel",this._onCancel),this._pstream.on("error",this._onSignalingError),this._pstream.on("ringing",this._onRinging),this._pstream.on("transportClose",this._onTransportClose),this._pstream.on("connected",this._onConnected),this._pstream.on("message",this._onMessageReceived),this.on("error",o=>{this._publisher.error("connection","error",{code:o.code,message:o.message},this),this._pstream&&this._pstream.status==="disconnected"&&this._cleanupEventListeners()}),this.on("disconnect",()=>{this._cleanupEventListeners()})}_setInputTracksFromStream(e){return this._mediaHandler.setInputTracksFromStream(e)}_setSinkIds(e){return this._mediaHandler._setSinkIds(e)}accept(e){if(this._log.debug(".accept",e),this._status!==re.State.Pending){this._log.debug(`.accept noop. status is '${this._status}'`);return}e=e||{};const n=e.rtcConfiguration||this._options.rtcConfiguration,r=e.rtcConstraints||this._options.rtcConstraints||{},i={audio:typeof r.audio<"u"?r.audio:!0};this._status=re.State.Connecting;const s=()=>{if(this._status!==re.State.Connecting){this._cleanupEventListeners(),this._mediaHandler.close();return}const l=d=>{const h=this._direction===re.CallDirection.Incoming?"accepted-by-local":"accepted-by-remote";this._publisher.info("connection",h,null,this);const{codecName:p,codecParams:y}=M4(this._mediaHandler.version.getSDP());this._publisher.info("settings","codec",{codec_params:y,selected_codec:p},this),this._monitor.enable(d)},u=typeof this._options.getSinkIds=="function"&&this._options.getSinkIds();if(Array.isArray(u)&&this._mediaHandler._setSinkIds(u).catch(()=>{}),this._pstream.addListener("hangup",this._onHangup),this._direction===re.CallDirection.Incoming)this._isAnswered=!0,this._pstream.on("answer",this._onAnswer),this._mediaHandler.answerIncomingCall(this.parameters.CallSid,this._options.offerSdp,n,l);else{const d=Array.from(this.customParameters.entries()).map(h=>`${encodeURIComponent(h[0])}=${encodeURIComponent(h[1])}`).join("&");this._pstream.on("answer",this._onAnswer),this._mediaHandler.makeOutgoingCall(d,this._signalingReconnectToken,this._options.reconnectCallSid||this.outboundConnectionId,n,l)}};this._options.beforeAccept&&this._options.beforeAccept(this);const o=typeof this._options.getInputStream=="function"&&this._options.getInputStream();(o?this._mediaHandler.setInputTracksFromStream(o):this._mediaHandler.openDefaultDeviceWithConstraints(i)).then(()=>{this._publisher.info("get-user-media","succeeded",{data:{audioConstraints:i}},this),s()},l=>{let u;l.code===31208||["PermissionDeniedError","NotAllowedError"].indexOf(l.name)!==-1?(u=new ul.PermissionDeniedError,this._publisher.error("get-user-media","denied",{data:{audioConstraints:i,error:l}},this)):(u=new ul.AcquisitionFailedError,this._publisher.error("get-user-media","failed",{data:{audioConstraints:i,error:l}},this)),this._disconnect(),this._log.debug("#error",l),this.emit("error",u)})}disconnect(){this._log.debug(".disconnect"),this._disconnect()}getLocalStream(){return this._mediaHandler&&this._mediaHandler.stream}getRemoteStream(){return this._mediaHandler&&this._mediaHandler._remoteStream}ignore(){if(this._log.debug(".ignore"),this._status!==re.State.Pending){this._log.debug(`.ignore noop. status is '${this._status}'`);return}this._status=re.State.Closed,this._mediaHandler.ignore(this.parameters.CallSid),this._publisher.info("connection","ignored-by-local",null,this),this._onIgnore&&this._onIgnore()}isMuted(){return this._mediaHandler.isMuted}mute(e=!0){this._log.debug(".mute",e);const n=this._mediaHandler.isMuted;this._mediaHandler.mute(e);const r=this._mediaHandler.isMuted;n!==r&&(this._publisher.info("connection",r?"muted":"unmuted",null,this),this._log.debug("#mute",r),this.emit("mute",r,this))}postFeedback(e,n){if(typeof e>"u"||e===null)return this._postFeedbackDeclined();if(!Object.values(re.FeedbackScore).includes(e))throw new et(`Feedback score must be one of: ${Object.values(re.FeedbackScore)}`);if(typeof n<"u"&&n!==null&&!Object.values(re.FeedbackIssue).includes(n))throw new et(`Feedback issue must be one of: ${Object.values(re.FeedbackIssue)}`);return this._publisher.info("feedback","received",{issue_name:n,quality_score:e},this,!0)}reject(){if(this._log.debug(".reject"),this._status!==re.State.Pending){this._log.debug(`.reject noop. status is '${this._status}'`);return}this._isRejected=!0,this._pstream.reject(this.parameters.CallSid),this._mediaHandler.reject(this.parameters.CallSid),this._publisher.info("connection","rejected-by-local",null,this),this._cleanupEventListeners(),this._mediaHandler.close(),this._status=re.State.Closed,this._log.debug("#reject"),this.emit("reject")}sendDigits(e){if(this._log.debug(".sendDigits",e),e.match(/[^0-9*#w]/))throw new et("Illegal character passed into sendDigits");const n=this._options.customSounds||{},r=[];e.split("").forEach(a=>{let l=a!=="w"?`dtmf${a}`:"";l==="dtmf*"&&(l="dtmfs"),l==="dtmf#"&&(l="dtmfh"),r.push(l)});const i=()=>{const a=r.shift();a&&(this._options.dialtonePlayer&&!n[a]?this._options.dialtonePlayer.play(a):this._soundcache.get(a).play()),r.length&&setTimeout(()=>i(),200)};i();const s=this._mediaHandler.getOrCreateDTMFSender();function o(a){if(!a.length)return;const l=a.shift();l&&l.length&&s.insertDTMF(l,TU,EU),setTimeout(o.bind(null,a),SU)}if(s){if(!("canInsertDTMF"in s)||s.canInsertDTMF){this._log.info("Sending digits using RTCDTMFSender"),o(e.split("w"));return}this._log.info("RTCDTMFSender cannot insert DTMF")}if(this._log.info("Sending digits over PStream"),this._pstream!==null&&this._pstream.status!=="disconnected")this._pstream.dtmf(this.parameters.CallSid,e);else{const a=new pn.ConnectionError("Could not send DTMF: Signaling channel is disconnected");this._log.debug("#error",a),this.emit("error",a)}}sendMessage(e){this._log.debug(".sendMessage",JSON.stringify(e));const{content:n,contentType:r,messageType:i}=e;if(typeof n>"u"||n===null)throw new et("`content` is empty");if(typeof i!="string")throw new et("`messageType` must be a string.");if(i.length===0)throw new et("`messageType` must be a non-empty string.");if(this._pstream===null)throw new kr("Could not send CallMessage; Signaling channel is disconnected");const s=this.parameters.CallSid;if(typeof this.parameters.CallSid>"u")throw new kr("Could not send CallMessage; Call has no CallSid");const o=this._voiceEventSidGenerator();return this._messages.set(o,{content:n,contentType:r,messageType:i,voiceEventSid:o}),this._pstream.sendMessage(s,n,r,i,o),o}status(){return this._status}_checkVolume(e,n,r,i){const s=n>=10;let o=0;return r===e&&(o=n),o>=10?this._emitWarning("audio-level-",`constant-audio-${i}-level`,10,o,!1):s&&this._emitWarning("audio-level-",`constant-audio-${i}-level`,10,o,!0),o}_cleanupEventListeners(){const e=()=>{this._pstream&&(this._pstream.removeListener("ack",this._onAck),this._pstream.removeListener("answer",this._onAnswer),this._pstream.removeListener("cancel",this._onCancel),this._pstream.removeListener("error",this._onSignalingError),this._pstream.removeListener("hangup",this._onHangup),this._pstream.removeListener("ringing",this._onRinging),this._pstream.removeListener("transportClose",this._onTransportClose),this._pstream.removeListener("connected",this._onConnected),this._pstream.removeListener("message",this._onMessageReceived))};e(),setTimeout(e,0)}_createMetricPayload(){const e={call_sid:this.parameters.CallSid,dscp:!!this._options.dscp,sdk_version:Na};return this._options.gateway&&(e.gateway=this._options.gateway),e.direction=this._direction,e}_disconnect(e,n){if(e=typeof e=="string"?e:null,!(this._status!==re.State.Open&&this._status!==re.State.Connecting&&this._status!==re.State.Reconnecting&&this._status!==re.State.Ringing)){if(this._log.info("Disconnecting..."),this._pstream!==null&&this._pstream.status!=="disconnected"&&this._shouldSendHangup){const r=this.parameters.CallSid||this.outboundConnectionId;r&&this._pstream.hangup(r,e)}this._cleanupEventListeners(),this._mediaHandler.close(),n||this._publisher.info("connection","disconnected-by-local",null,this)}}_maybeTransitionToOpen(){this._wasConnected,this._isAnswered&&(this._onSignalingReconnected(),this._signalingStatus=re.State.Open,this._mediaHandler&&this._mediaHandler.status==="open"&&(this._status=re.State.Open,this._wasConnected||(this._wasConnected=!0,this._log.debug("#accept"),this.emit("accept",this))))}_postFeedbackDeclined(){return this._publisher.info("feedback","received-none",null,this,!0)}_publishMetrics(){this._metricsSamples.length!==0&&this._publisher.postMetrics("quality-metrics-samples","metrics-sample",this._metricsSamples.splice(0),this._createMetricPayload(),this).catch(e=>{this._log.warn("Unable to post metrics to Insights. Received error:",e)})}_setCallSid(e){const n=e.callsid;n&&(this.parameters.CallSid=n,this._mediaHandler.callSid=n)}}re.toString=()=>"[Twilio.Call class]";(function(t){(function(e){e.Closed="closed",e.Connecting="connecting",e.Open="open",e.Pending="pending",e.Reconnecting="reconnecting",e.Ringing="ringing"})(t.State||(t.State={})),function(e){e.AudioLatency="audio-latency",e.ChoppyAudio="choppy-audio",e.DroppedCall="dropped-call",e.Echo="echo",e.NoisyCall="noisy-call",e.OneWayAudio="one-way-audio"}(t.FeedbackIssue||(t.FeedbackIssue={})),function(e){e[e.One=1]="One",e[e.Two=2]="Two",e[e.Three=3]="Three",e[e.Four=4]="Four",e[e.Five=5]="Five"}(t.FeedbackScore||(t.FeedbackScore={})),function(e){e.Incoming="INCOMING",e.Outgoing="OUTGOING"}(t.CallDirection||(t.CallDirection={})),function(e){e.Opus="opus",e.PCMU="pcmu"}(t.Codec||(t.Codec={})),function(e){e.None="none",e.Timeout="timeout"}(t.IceGatheringFailureReason||(t.IceGatheringFailureReason={})),function(e){e.ConnectionDisconnected="ConnectionDisconnected",e.ConnectionFailed="ConnectionFailed",e.IceGatheringFailed="IceGatheringFailed",e.LowBytes="LowBytes"}(t.MediaFailure||(t.MediaFailure={}))})(re||(re={}));function CU(){return"TJSxxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}async function xS(t,e){if(!_n)throw new Error("Firebase is not configured");const n=fk(_n,"users",t,"callLogs");return(await IF(n,{direction:"outbound",status:"connecting",durationSeconds:0,startedAt:su(),createdAt:su(),...e})).id}async function kU(t,e,n){if(!_n)throw new Error("Firebase is not configured");const r=To(_n,"users",t,"callLogs",e),i=typeof n.note=="string"?n.note.trim():"",s={...n,note:i.length>0?i:kF(),endedAt:su()};await bF(r,s)}const AU=100,PU={state:"idle",message:"Twilio client not initialised"},RU="http://localhost:3001".replace(/\/+$/,""),Jk=N.createContext(void 0);function NU(t,e){if(!t)return e;const n=t.trim();return n?n.replace(/[^a-zA-Z0-9_\-@.]/g,"_"):e}function bS(t){if(!t)return null;const e=t.replace(/[^0-9+]/g,"");return e?e.startsWith("+")?e:`+${e}`:null}async function Up(t){const e=await fetch(`${RU}/api/twilio/token?identity=${encodeURIComponent(t)}`);if(!e.ok){const n=await e.text().catch(()=>"Twilio token request failed");throw new Error(n||`Unable to fetch Twilio token (status ${e.status})`)}return e.json()}function Hi(t,e,n){const r=(...i)=>{typeof t.off=="function"?t.off(e,r):typeof t.removeListener=="function"&&t.removeListener(e,r),n(...i)};t.on(e,r)}function DU({children:t}){const{user:e}=Ui(),[n,r]=N.useState(PU),[i,s]=N.useState("idle"),[o,a]=N.useState([]),[l,u]=N.useState(!1),[d,h]=N.useState(!1),[p,y]=N.useState(!1),[T,E]=N.useState(null),[R,w]=N.useState(null),[v,b]=N.useState(null),D=N.useRef("agent"),L=N.useRef(null),j=N.useRef(null),I=N.useRef(null),_=N.useRef(null),C=N.useRef(null),A=N.useRef(null),k=N.useRef(""),x=N.useCallback(Z=>{a(Te=>[{id:typeof crypto<"u"&&"randomUUID"in crypto?crypto.randomUUID():Math.random().toString(36).slice(2),at:Date.now(),message:Z},...Te].slice(0,AU))},[]),P=N.useCallback(()=>{const Z=L.current;if(Z)try{Z.removeAllListeners(),Z.destroy()}catch(Te){console.error("Failed to destroy Twilio device",Te)}L.current=null,j.current=null,I.current=null,_.current&&(clearTimeout(_.current),_.current=null),u(!1),r({state:"disconnected",message:"Twilio client disconnected"})},[]);N.useEffect(()=>()=>{P()},[P]);const he=N.useCallback((Z,Te)=>{if(_.current&&clearTimeout(_.current),!Z||Z<=0)return;const Ae=Math.max((Z-120)*1e3,3e4);_.current=setTimeout(async()=>{try{const te=L.current;if(!te)return;const ve=Te??D.current??"agent",Ve=await Up(ve);await te.updateToken(Ve.token),D.current=Ve.identity??ve,he(Ve.expiresIn,Ve.identity),x("Twilio token refreshed")}catch(te){console.error("Twilio token refresh failed",te),x("Twilio token refresh failed")}},Ae)},[x]),we=N.useCallback(async(Z,Te)=>{if(!e||!C.current)return;const Ae=C.current;C.current=null;const te=A.current;A.current=null;const ve=k.current.trim();k.current="";const Ve=te?Math.max(Math.round((Date.now()-te)/1e3),0):0;try{await kU(e.uid,Ae,{status:Z,durationSeconds:Ve,...ve?{note:ve}:{},...Te})}catch(ot){console.error("Failed to finalise call log",ot),x("Unable to update call log with final status")}},[x,e]),Ne=N.useCallback(async()=>{if(!e)throw new Error("Twilio client requires an authenticated user");if(L.current&&l)return L.current;L.current&&P();const Z=NU(e.email??e.uid??"agent","agent");D.current=Z,r({state:"initialising",message:"Initialising Twilio device"}),x(`Requesting Twilio token for ${Z}`);const Te=await Up(Z);D.current=Te.identity??Z;const Ae=new ie(Te.token,{codecPreferences:["opus","pcmu"],logLevel:"error",fakeLocalDTMF:!0});return Ae.on("ready",()=>{r({state:"registered",message:"Twilio device ready"}),u(!0),x("Twilio device ready")}),Ae.on("error",te=>{const ve=typeof(te==null?void 0:te.message)=="string"?te.message:"Twilio device error";r({state:"error",message:ve}),E(ve),x(`Device error: ${ve}`)}),Ae.on("disconnect",()=>{r({state:"disconnected",message:"Twilio device disconnected"}),u(!1),x("Twilio device disconnected")}),Ae.on("tokenWillExpire",async()=>{try{x("Twilio token expiring soon, refreshing");const te=D.current??Z,ve=await Up(te);await Ae.updateToken(ve.token),D.current=ve.identity??te,he(ve.expiresIn,ve.identity)}catch(te){console.error("Failed to refresh token on expiry event",te),x("Twilio token refresh failed on expiry event")}}),Ae.on("incoming",te=>{var Ve,ot;I.current=te,s("incoming");const ve=bS((Ve=te.parameters)==null?void 0:Ve.From)??((ot=te.parameters)==null?void 0:ot.From)??null;w(ve),b(null),h(!1),y(!1),E(null),k.current="",x(`Incoming call from ${ve??"unknown"}`),Hi(te,"cancel",()=>{x("Incoming call cancelled by remote party"),I.current===te&&(I.current=null,s("idle"),w(null))}),Hi(te,"reject",()=>{x("Incoming call rejected"),I.current===te&&(I.current=null,s("idle"),w(null))})}),Ae.on("connect",te=>{var Ve,ot,Mt;j.current=te,s("active"),h(((Ve=te.isMuted)==null?void 0:Ve.call(te))??!1),y(((ot=te.isOnHold)==null?void 0:ot.call(te))??!1),E(null),w(null),A.current=Date.now();const ve=((Mt=te.parameters)==null?void 0:Mt.To)??v;b(ve??null),x(`Call connected with ${ve??"unknown destination"}`),Hi(te,"disconnect",()=>{x("Call disconnected"),j.current=null,s("completed"),h(!1),y(!1),b(null),we("completed")}),Hi(te,"error",Jn=>{const ge=typeof(Jn==null?void 0:Jn.message)=="string"?Jn.message:"Call error";x(`Call error: ${ge}`),E(ge),we("failed",{statusReason:ge})})}),L.current=Ae,he(Te.expiresIn,Te.identity),await Ae.register(),Ae},[P,we,l,x,he,e]),De=N.useCallback(async Z=>{if(!e)throw new Error("You must be signed in to place calls");const Te=Z.trim();if(!Te)return E("Enter a number to call"),!1;const Ae=await Ne(),te=Te.startsWith("+")?Te:Te.replace(/[^0-9+]/g,"");k.current="",s("connecting"),b(te),h(!1),y(!1),w(null),E(null);try{const Ve=await xS(e.uid,{to:te,direction:"outbound"});C.current=Ve}catch(Ve){console.error("Failed to create call log",Ve)}x(`Dialling ${te}`);const ve=Ae.connect({params:{To:te}});return j.current=ve,Hi(ve,"ringing",()=>{s("ringing"),x("Call ringing")}),Hi(ve,"cancel",()=>{x("Call cancelled"),s("failed"),we("cancelled")}),Hi(ve,"reject",()=>{x("Call rejected by Twilio"),s("failed"),we("failed",{statusReason:"rejected"})}),Hi(ve,"error",Ve=>{const ot=typeof(Ve==null?void 0:Ve.message)=="string"?Ve.message:"Call error";E(ot),s("failed"),x(`Call error: ${ot}`),we("failed",{statusReason:ot})}),!0},[we,Ne,x,e]),B=N.useCallback(async()=>{const Z=L.current,Te=j.current;Te&&Te.disconnect(),Z&&Z.disconnectAll(),we("completed"),s("idle"),h(!1),y(!1),b(null),w(null),k.current=""},[we]),Q=N.useCallback(async()=>{var Ae,te,ve,Ve;const Z=I.current;if(!Z||!await Ne())return!1;try{await Z.accept(),j.current=Z,I.current=null;const ot=bS((Ae=Z.parameters)==null?void 0:Ae.From)??((te=Z.parameters)==null?void 0:te.From)??null;if(b(ot),w(null),s("active"),h(((ve=Z.isMuted)==null?void 0:ve.call(Z))??!1),y(((Ve=Z.isOnHold)==null?void 0:Ve.call(Z))??!1),x(`Accepted incoming call from ${ot??"unknown"}`),k.current="",e)try{const Mt=await xS(e.uid,{direction:"inbound",from:ot??void 0,status:"active"});C.current=Mt}catch(Mt){console.error("Failed to create inbound call log",Mt)}return!0}catch(ot){const Mt=ot instanceof Error?ot.message:"Failed to answer call";return E(Mt),x(`Unable to accept call: ${Mt}`),!1}},[Ne,x,e]),fe=N.useCallback(async Z=>{const Te=I.current;if(!Te)return!1;try{return Te.reject(),I.current=null,s("idle"),w(null),x(`Rejected incoming call${Z?`: ${Z}`:""}`),!0}catch(Ae){const te=Ae instanceof Error?Ae.message:"Failed to reject call";return E(te),x(`Unable to reject call: ${te}`),!1}},[x]),ke=N.useCallback(async()=>{var Ae;const Z=j.current;if(!Z)return!1;const Te=!(((Ae=Z.isMuted)==null?void 0:Ae.call(Z))??d);try{return Z.mute(Te),h(Te),x(Te?"Call muted":"Call unmuted"),!0}catch(te){const ve=te instanceof Error?te.message:"Failed to toggle mute";return E(ve),x(`Mute toggle failed: ${ve}`),!1}},[d,x]),$e=N.useCallback(async()=>{var Ae;const Z=j.current;if(!Z)return!1;const Te=!(((Ae=Z.isOnHold)==null?void 0:Ae.call(Z))??p);try{if(typeof Z.hold=="function")Z.hold(Te);else throw new Error("Hold is not supported for this call");return y(Te),x(Te?"Call placed on hold":"Call resumed"),!0}catch(te){const ve=te instanceof Error?te.message:"Failed to toggle hold";return E(ve),x(`Hold toggle failed: ${ve}`),!1}},[p,x]),Ze=N.useCallback(async Z=>{const Te=j.current;if(!Te)return!1;const Ae=typeof Z=="string"?Z.replace(/[^0-9A-D#*]/gi,""):"";if(!Ae)return!1;try{return Te.sendDigits(Ae),x(`Sent DTMF ${Ae}`),!0}catch(te){const ve=te instanceof Error?te.message:"Failed to send tones";return E(ve),x(`DTMF failed: ${ve}`),!1}},[x]),Gt=N.useCallback(Z=>{k.current=typeof Z=="string"?Z:""},[]),Kt=N.useCallback(()=>{a([])},[]),En=N.useMemo(()=>({connectionStatus:n,callState:i,events:o,isClientReady:l,isMuted:d,isOnHold:p,lastError:T,incomingNumber:R,activeNumber:v,initializeClient:Ne,makeCall:De,acceptIncomingCall:Q,rejectIncomingCall:fe,hangUp:B,toggleMute:ke,toggleHold:$e,sendDigits:Ze,setCallNote:Gt,resetEvents:Kt}),[Q,v,i,n,o,B,R,Ne,l,d,p,T,De,fe,Kt,Gt,Ze,$e,ke]);return m.jsx(Jk.Provider,{value:En,children:t})}function sv(){const t=N.useContext(Jk);if(!t)throw new Error("useTwilioClient must be used within a TwilioClientProvider");return t}const OU=new Xb({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}});function LU({children:t}){return m.jsx(tI,{client:OU,children:m.jsx(DF,{children:m.jsx(DU,{children:t})})})}function MU(){const{user:t,loading:e}=Ui(),n=ji();return e?m.jsx("div",{className:"flex min-h-screen items-center justify-center bg-slate-950 text-slate-100",children:m.jsxs("div",{className:"space-y-2 text-center",children:[m.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-brand border-t-transparent"}),m.jsx("p",{className:"text-sm text-slate-400",children:"Loading workspace"})]})}):t?m.jsx(zb,{}):m.jsx(Bb,{to:"/auth",replace:!0,state:{from:n}})}var Vu=t=>t.type==="checkbox",co=t=>t instanceof Date,Fn=t=>t==null;const Yk=t=>typeof t=="object";var Lt=t=>!Fn(t)&&!Array.isArray(t)&&Yk(t)&&!co(t),VU=t=>Lt(t)&&t.target?Vu(t.target)?t.target.checked:t.target.value:t,jU=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,FU=(t,e)=>t.has(jU(e)),UU=t=>{const e=t.constructor&&t.constructor.prototype;return Lt(e)&&e.hasOwnProperty("isPrototypeOf")},ov=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Bt(t){let e;const n=Array.isArray(t),r=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(!(ov&&(t instanceof Blob||r))&&(n||Lt(t)))if(e=n?[]:Object.create(Object.getPrototypeOf(t)),!n&&!UU(t))e=t;else for(const i in t)t.hasOwnProperty(i)&&(e[i]=Bt(t[i]));else return t;return e}var Of=t=>/^\w*$/.test(t),kt=t=>t===void 0,av=t=>Array.isArray(t)?t.filter(Boolean):[],lv=t=>av(t.replace(/["|']|\]/g,"").split(/\.|\[/)),ue=(t,e,n)=>{if(!e||!Lt(t))return n;const r=(Of(e)?[e]:lv(e)).reduce((i,s)=>Fn(i)?i:i[s],t);return kt(r)||r===t?kt(t[e])?n:t[e]:r},qr=t=>typeof t=="boolean",mt=(t,e,n)=>{let r=-1;const i=Of(e)?[e]:lv(e),s=i.length,o=s-1;for(;++r<s;){const a=i[r];let l=n;if(r!==o){const u=t[a];l=Lt(u)||Array.isArray(u)?u:isNaN(+i[r+1])?{}:[]}if(a==="__proto__"||a==="constructor"||a==="prototype")return;t[a]=l,t=t[a]}};const IS={BLUR:"blur",FOCUS_OUT:"focusout"},Dr={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},ui={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},$U=Cn.createContext(null);$U.displayName="HookFormContext";var BU=(t,e,n,r=!0)=>{const i={defaultValues:e._defaultValues};for(const s in t)Object.defineProperty(i,s,{get:()=>{const o=s;return e._proxyFormState[o]!==Dr.all&&(e._proxyFormState[o]=!r||Dr.all),t[o]}});return i};const zU=typeof window<"u"?Cn.useLayoutEffect:Cn.useEffect;var tr=t=>typeof t=="string",WU=(t,e,n,r,i)=>tr(t)?(r&&e.watch.add(t),ue(n,t,i)):Array.isArray(t)?t.map(s=>(r&&e.watch.add(s),ue(n,s))):(r&&(e.watchAll=!0),n),Ug=t=>Fn(t)||!Yk(t);function is(t,e,n=new WeakSet){if(Ug(t)||Ug(e))return t===e;if(co(t)&&co(e))return t.getTime()===e.getTime();const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;if(n.has(t)||n.has(e))return!0;n.add(t),n.add(e);for(const s of r){const o=t[s];if(!i.includes(s))return!1;if(s!=="ref"){const a=e[s];if(co(o)&&co(a)||Lt(o)&&Lt(a)||Array.isArray(o)&&Array.isArray(a)?!is(o,a,n):o!==a)return!1}}return!0}var qU=(t,e,n,r,i)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[r]:i||!0}}:{},Ic=t=>Array.isArray(t)?t:[t],CS=()=>{let t=[];return{get observers(){return t},next:i=>{for(const s of t)s.next&&s.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(s=>s!==i)}}),unsubscribe:()=>{t=[]}}};function Zk(t,e){const n={};for(const r in t)if(t.hasOwnProperty(r)){const i=t[r],s=e[r];if(i&&Lt(i)&&s){const o=Zk(i,s);Lt(o)&&(n[r]=o)}else t[r]&&(n[r]=s)}return n}var Vn=t=>Lt(t)&&!Object.keys(t).length,cv=t=>t.type==="file",Or=t=>typeof t=="function",Fh=t=>{if(!ov)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},Xk=t=>t.type==="select-multiple",uv=t=>t.type==="radio",HU=t=>uv(t)||Vu(t),$p=t=>Fh(t)&&t.isConnected;function GU(t,e){const n=e.slice(0,-1).length;let r=0;for(;r<n;)t=kt(t)?r++:t[e[r++]];return t}function KU(t){for(const e in t)if(t.hasOwnProperty(e)&&!kt(t[e]))return!1;return!0}function Pt(t,e){const n=Array.isArray(e)?e:Of(e)?[e]:lv(e),r=n.length===1?t:GU(t,n),i=n.length-1,s=n[i];return r&&delete r[s],i!==0&&(Lt(r)&&Vn(r)||Array.isArray(r)&&KU(r))&&Pt(t,n.slice(0,-1)),t}var QU=t=>{for(const e in t)if(Or(t[e]))return!0;return!1};function eA(t){return Array.isArray(t)||Lt(t)&&!QU(t)}function $g(t,e={}){for(const n in t)eA(t[n])?(e[n]=Array.isArray(t[n])?[]:{},$g(t[n],e[n])):kt(t[n])||(e[n]=!0);return e}function aa(t,e,n){n||(n=$g(e));for(const r in t)eA(t[r])?kt(e)||Ug(n[r])?n[r]=$g(t[r],Array.isArray(t[r])?[]:{}):aa(t[r],Fn(e)?{}:e[r],n[r]):n[r]=!is(t[r],e[r]);return n}const kS={value:!1,isValid:!1},AS={value:!0,isValid:!0};var tA=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!kt(t[0].attributes.value)?kt(t[0].value)||t[0].value===""?AS:{value:t[0].value,isValid:!0}:AS:kS}return kS},nA=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:r})=>kt(t)?t:e?t===""?NaN:t&&+t:n&&tr(t)?new Date(t):r?r(t):t;const PS={isValid:!1,value:null};var rA=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,PS):PS;function RS(t){const e=t.ref;return cv(e)?e.files:uv(e)?rA(t.refs).value:Xk(e)?[...e.selectedOptions].map(({value:n})=>n):Vu(e)?tA(t.refs).value:nA(kt(e.value)?t.ref.value:e.value,t)}var JU=(t,e,n,r)=>{const i={};for(const s of t){const o=ue(e,s);o&&mt(i,s,o._f)}return{criteriaMode:n,names:[...t],fields:i,shouldUseNativeValidation:r}},Uh=t=>t instanceof RegExp,Jl=t=>kt(t)?t:Uh(t)?t.source:Lt(t)?Uh(t.value)?t.value.source:t.value:t,NS=t=>({isOnSubmit:!t||t===Dr.onSubmit,isOnBlur:t===Dr.onBlur,isOnChange:t===Dr.onChange,isOnAll:t===Dr.all,isOnTouch:t===Dr.onTouched});const DS="AsyncFunction";var YU=t=>!!t&&!!t.validate&&!!(Or(t.validate)&&t.validate.constructor.name===DS||Lt(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===DS)),ZU=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),OS=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const Cc=(t,e,n,r)=>{for(const i of n||Object.keys(t)){const s=ue(t,i);if(s){const{_f:o,...a}=s;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],i)&&!r)return!0;if(o.ref&&e(o.ref,o.name)&&!r)return!0;if(Cc(a,e))break}else if(Lt(a)&&Cc(a,e))break}}};function LS(t,e,n){const r=ue(t,n);if(r||Of(n))return{error:r,name:n};const i=n.split(".");for(;i.length;){const s=i.join("."),o=ue(e,s),a=ue(t,s);if(o&&!Array.isArray(o)&&n!==s)return{name:n};if(a&&a.type)return{name:s,error:a};if(a&&a.root&&a.root.type)return{name:`${s}.root`,error:a.root};i.pop()}return{name:n}}var XU=(t,e,n,r)=>{n(t);const{name:i,...s}=t;return Vn(s)||Object.keys(s).length>=Object.keys(e).length||Object.keys(s).find(o=>e[o]===(!r||Dr.all))},e3=(t,e,n)=>!t||!e||t===e||Ic(t).some(r=>r&&(n?r===e:r.startsWith(e)||e.startsWith(r))),t3=(t,e,n,r,i)=>i.isOnAll?!1:!n&&i.isOnTouch?!(e||t):(n?r.isOnBlur:i.isOnBlur)?!t:(n?r.isOnChange:i.isOnChange)?t:!0,n3=(t,e)=>!av(ue(t,e)).length&&Pt(t,e),r3=(t,e,n)=>{const r=Ic(ue(t,n));return mt(r,"root",e[n]),mt(t,n,r),t};function MS(t,e,n="validate"){if(tr(t)||Array.isArray(t)&&t.every(tr)||qr(t)&&!t)return{type:n,message:tr(t)?t:"",ref:e}}var Xo=t=>Lt(t)&&!Uh(t)?t:{value:t,message:""},VS=async(t,e,n,r,i,s)=>{const{ref:o,refs:a,required:l,maxLength:u,minLength:d,min:h,max:p,pattern:y,validate:T,name:E,valueAsNumber:R,mount:w}=t._f,v=ue(n,E);if(!w||e.has(E))return{};const b=a?a[0]:o,D=x=>{i&&b.reportValidity&&(b.setCustomValidity(qr(x)?"":x||""),b.reportValidity())},L={},j=uv(o),I=Vu(o),_=j||I,C=(R||cv(o))&&kt(o.value)&&kt(v)||Fh(o)&&o.value===""||v===""||Array.isArray(v)&&!v.length,A=qU.bind(null,E,r,L),k=(x,P,he,we=ui.maxLength,Ne=ui.minLength)=>{const De=x?P:he;L[E]={type:x?we:Ne,message:De,ref:o,...A(x?we:Ne,De)}};if(s?!Array.isArray(v)||!v.length:l&&(!_&&(C||Fn(v))||qr(v)&&!v||I&&!tA(a).isValid||j&&!rA(a).isValid)){const{value:x,message:P}=tr(l)?{value:!!l,message:l}:Xo(l);if(x&&(L[E]={type:ui.required,message:P,ref:b,...A(ui.required,P)},!r))return D(P),L}if(!C&&(!Fn(h)||!Fn(p))){let x,P;const he=Xo(p),we=Xo(h);if(!Fn(v)&&!isNaN(v)){const Ne=o.valueAsNumber||v&&+v;Fn(he.value)||(x=Ne>he.value),Fn(we.value)||(P=Ne<we.value)}else{const Ne=o.valueAsDate||new Date(v),De=fe=>new Date(new Date().toDateString()+" "+fe),B=o.type=="time",Q=o.type=="week";tr(he.value)&&v&&(x=B?De(v)>De(he.value):Q?v>he.value:Ne>new Date(he.value)),tr(we.value)&&v&&(P=B?De(v)<De(we.value):Q?v<we.value:Ne<new Date(we.value))}if((x||P)&&(k(!!x,he.message,we.message,ui.max,ui.min),!r))return D(L[E].message),L}if((u||d)&&!C&&(tr(v)||s&&Array.isArray(v))){const x=Xo(u),P=Xo(d),he=!Fn(x.value)&&v.length>+x.value,we=!Fn(P.value)&&v.length<+P.value;if((he||we)&&(k(he,x.message,P.message),!r))return D(L[E].message),L}if(y&&!C&&tr(v)){const{value:x,message:P}=Xo(y);if(Uh(x)&&!v.match(x)&&(L[E]={type:ui.pattern,message:P,ref:o,...A(ui.pattern,P)},!r))return D(P),L}if(T){if(Or(T)){const x=await T(v,n),P=MS(x,b);if(P&&(L[E]={...P,...A(ui.validate,P.message)},!r))return D(P.message),L}else if(Lt(T)){let x={};for(const P in T){if(!Vn(x)&&!r)break;const he=MS(await T[P](v,n),b,P);he&&(x={...he,...A(P,he.message)},D(he.message),r&&(L[E]=x))}if(!Vn(x)&&(L[E]={ref:b,...x},!r))return L}}return D(!0),L};const i3={mode:Dr.onSubmit,reValidateMode:Dr.onChange,shouldFocusError:!0};function s3(t={}){let e={...i3,...t},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:Or(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},r={},i=Lt(e.defaultValues)||Lt(e.values)?Bt(e.defaultValues||e.values)||{}:{},s=e.shouldUnregister?{}:Bt(i),o={action:!1,mount:!1,watch:!1},a={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},l,u=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let h={...d};const p={array:CS(),state:CS()},y=e.criteriaMode===Dr.all,T=O=>F=>{clearTimeout(u),u=setTimeout(O,F)},E=async O=>{if(!e.disabled&&(d.isValid||h.isValid||O)){const F=e.resolver?Vn((await I()).errors):await C(r,!0);F!==n.isValid&&p.state.next({isValid:F})}},R=(O,F)=>{!e.disabled&&(d.isValidating||d.validatingFields||h.isValidating||h.validatingFields)&&((O||Array.from(a.mount)).forEach($=>{$&&(F?mt(n.validatingFields,$,F):Pt(n.validatingFields,$))}),p.state.next({validatingFields:n.validatingFields,isValidating:!Vn(n.validatingFields)}))},w=(O,F=[],$,Y,K=!0,H=!0)=>{if(Y&&$&&!e.disabled){if(o.action=!0,H&&Array.isArray(ue(r,O))){const X=$(ue(r,O),Y.argA,Y.argB);K&&mt(r,O,X)}if(H&&Array.isArray(ue(n.errors,O))){const X=$(ue(n.errors,O),Y.argA,Y.argB);K&&mt(n.errors,O,X),n3(n.errors,O)}if((d.touchedFields||h.touchedFields)&&H&&Array.isArray(ue(n.touchedFields,O))){const X=$(ue(n.touchedFields,O),Y.argA,Y.argB);K&&mt(n.touchedFields,O,X)}(d.dirtyFields||h.dirtyFields)&&(n.dirtyFields=aa(i,s)),p.state.next({name:O,isDirty:k(O,F),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else mt(s,O,F)},v=(O,F)=>{mt(n.errors,O,F),p.state.next({errors:n.errors})},b=O=>{n.errors=O,p.state.next({errors:n.errors,isValid:!1})},D=(O,F,$,Y)=>{const K=ue(r,O);if(K){const H=ue(s,O,kt($)?ue(i,O):$);kt(H)||Y&&Y.defaultChecked||F?mt(s,O,F?H:RS(K._f)):he(O,H),o.mount&&E()}},L=(O,F,$,Y,K)=>{let H=!1,X=!1;const Se={name:O};if(!e.disabled){if(!$||Y){(d.isDirty||h.isDirty)&&(X=n.isDirty,n.isDirty=Se.isDirty=k(),H=X!==Se.isDirty);const Ke=is(ue(i,O),F);X=!!ue(n.dirtyFields,O),Ke?Pt(n.dirtyFields,O):mt(n.dirtyFields,O,!0),Se.dirtyFields=n.dirtyFields,H=H||(d.dirtyFields||h.dirtyFields)&&X!==!Ke}if($){const Ke=ue(n.touchedFields,O);Ke||(mt(n.touchedFields,O,$),Se.touchedFields=n.touchedFields,H=H||(d.touchedFields||h.touchedFields)&&Ke!==$)}H&&K&&p.state.next(Se)}return H?Se:{}},j=(O,F,$,Y)=>{const K=ue(n.errors,O),H=(d.isValid||h.isValid)&&qr(F)&&n.isValid!==F;if(e.delayError&&$?(l=T(()=>v(O,$)),l(e.delayError)):(clearTimeout(u),l=null,$?mt(n.errors,O,$):Pt(n.errors,O)),($?!is(K,$):K)||!Vn(Y)||H){const X={...Y,...H&&qr(F)?{isValid:F}:{},errors:n.errors,name:O};n={...n,...X},p.state.next(X)}},I=async O=>{R(O,!0);const F=await e.resolver(s,e.context,JU(O||a.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return R(O),F},_=async O=>{const{errors:F}=await I(O);if(O)for(const $ of O){const Y=ue(F,$);Y?mt(n.errors,$,Y):Pt(n.errors,$)}else n.errors=F;return F},C=async(O,F,$={valid:!0})=>{for(const Y in O){const K=O[Y];if(K){const{_f:H,...X}=K;if(H){const Se=a.array.has(H.name),Ke=K._f&&YU(K._f);Ke&&d.validatingFields&&R([H.name],!0);const Sn=await VS(K,a.disabled,s,y,e.shouldUseNativeValidation&&!F,Se);if(Ke&&d.validatingFields&&R([H.name]),Sn[H.name]&&($.valid=!1,F))break;!F&&(ue(Sn,H.name)?Se?r3(n.errors,Sn,H.name):mt(n.errors,H.name,Sn[H.name]):Pt(n.errors,H.name))}!Vn(X)&&await C(X,F,$)}}return $.valid},A=()=>{for(const O of a.unMount){const F=ue(r,O);F&&(F._f.refs?F._f.refs.every($=>!$p($)):!$p(F._f.ref))&&Z(O)}a.unMount=new Set},k=(O,F)=>!e.disabled&&(O&&F&&mt(s,O,F),!is(fe(),i)),x=(O,F,$)=>WU(O,a,{...o.mount?s:kt(F)?i:tr(O)?{[O]:F}:F},$,F),P=O=>av(ue(o.mount?s:i,O,e.shouldUnregister?ue(i,O,[]):[])),he=(O,F,$={})=>{const Y=ue(r,O);let K=F;if(Y){const H=Y._f;H&&(!H.disabled&&mt(s,O,nA(F,H)),K=Fh(H.ref)&&Fn(F)?"":F,Xk(H.ref)?[...H.ref.options].forEach(X=>X.selected=K.includes(X.value)):H.refs?Vu(H.ref)?H.refs.forEach(X=>{(!X.defaultChecked||!X.disabled)&&(Array.isArray(K)?X.checked=!!K.find(Se=>Se===X.value):X.checked=K===X.value||!!K)}):H.refs.forEach(X=>X.checked=X.value===K):cv(H.ref)?H.ref.value="":(H.ref.value=K,H.ref.type||p.state.next({name:O,values:Bt(s)})))}($.shouldDirty||$.shouldTouch)&&L(O,K,$.shouldTouch,$.shouldDirty,!0),$.shouldValidate&&Q(O)},we=(O,F,$)=>{for(const Y in F){if(!F.hasOwnProperty(Y))return;const K=F[Y],H=O+"."+Y,X=ue(r,H);(a.array.has(O)||Lt(K)||X&&!X._f)&&!co(K)?we(H,K,$):he(H,K,$)}},Ne=(O,F,$={})=>{const Y=ue(r,O),K=a.array.has(O),H=Bt(F);mt(s,O,H),K?(p.array.next({name:O,values:Bt(s)}),(d.isDirty||d.dirtyFields||h.isDirty||h.dirtyFields)&&$.shouldDirty&&p.state.next({name:O,dirtyFields:aa(i,s),isDirty:k(O,H)})):Y&&!Y._f&&!Fn(H)?we(O,H,$):he(O,H,$),OS(O,a)&&p.state.next({...n,name:O}),p.state.next({name:o.mount?O:void 0,values:Bt(s)})},De=async O=>{o.mount=!0;const F=O.target;let $=F.name,Y=!0;const K=ue(r,$),H=Ke=>{Y=Number.isNaN(Ke)||co(Ke)&&isNaN(Ke.getTime())||is(Ke,ue(s,$,Ke))},X=NS(e.mode),Se=NS(e.reValidateMode);if(K){let Ke,Sn;const Gs=F.type?RS(K._f):VU(O),Br=O.type===IS.BLUR||O.type===IS.FOCUS_OUT,Ks=!ZU(K._f)&&!e.resolver&&!ue(n.errors,$)&&!K._f.deps||t3(Br,ue(n.touchedFields,$),n.isSubmitted,Se,X),Wo=OS($,a,Br);mt(s,$,Gs),Br?(!F||!F.readOnly)&&(K._f.onBlur&&K._f.onBlur(O),l&&l(0)):K._f.onChange&&K._f.onChange(O);const qo=L($,Gs,Br),kl=!Vn(qo)||Wo;if(!Br&&p.state.next({name:$,type:O.type,values:Bt(s)}),Ks)return(d.isValid||h.isValid)&&(e.mode==="onBlur"?Br&&E():Br||E()),kl&&p.state.next({name:$,...Wo?{}:qo});if(!Br&&Wo&&p.state.next({...n}),e.resolver){const{errors:ju}=await I([$]);if(H(Gs),Y){const Mf=LS(n.errors,r,$),Ho=LS(ju,r,Mf.name||$);Ke=Ho.error,$=Ho.name,Sn=Vn(ju)}}else R([$],!0),Ke=(await VS(K,a.disabled,s,y,e.shouldUseNativeValidation))[$],R([$]),H(Gs),Y&&(Ke?Sn=!1:(d.isValid||h.isValid)&&(Sn=await C(r,!0)));Y&&(K._f.deps&&(!Array.isArray(K._f.deps)||K._f.deps.length>0)&&Q(K._f.deps),j($,Sn,Ke,qo))}},B=(O,F)=>{if(ue(n.errors,F)&&O.focus)return O.focus(),1},Q=async(O,F={})=>{let $,Y;const K=Ic(O);if(e.resolver){const H=await _(kt(O)?O:K);$=Vn(H),Y=O?!K.some(X=>ue(H,X)):$}else O?(Y=(await Promise.all(K.map(async H=>{const X=ue(r,H);return await C(X&&X._f?{[H]:X}:X)}))).every(Boolean),!(!Y&&!n.isValid)&&E()):Y=$=await C(r);return p.state.next({...!tr(O)||(d.isValid||h.isValid)&&$!==n.isValid?{}:{name:O},...e.resolver||!O?{isValid:$}:{},errors:n.errors}),F.shouldFocus&&!Y&&Cc(r,B,O?K:a.mount),Y},fe=(O,F)=>{let $={...o.mount?s:i};return F&&($=Zk(F.dirtyFields?n.dirtyFields:n.touchedFields,$)),kt(O)?$:tr(O)?ue($,O):O.map(Y=>ue($,Y))},ke=(O,F)=>({invalid:!!ue((F||n).errors,O),isDirty:!!ue((F||n).dirtyFields,O),error:ue((F||n).errors,O),isValidating:!!ue(n.validatingFields,O),isTouched:!!ue((F||n).touchedFields,O)}),$e=O=>{O&&Ic(O).forEach(F=>Pt(n.errors,F)),p.state.next({errors:O?n.errors:{}})},Ze=(O,F,$)=>{const Y=(ue(r,O,{_f:{}})._f||{}).ref,K=ue(n.errors,O)||{},{ref:H,message:X,type:Se,...Ke}=K;mt(n.errors,O,{...Ke,...F,ref:Y}),p.state.next({name:O,errors:n.errors,isValid:!1}),$&&$.shouldFocus&&Y&&Y.focus&&Y.focus()},Gt=(O,F)=>Or(O)?p.state.subscribe({next:$=>"values"in $&&O(x(void 0,F),$)}):x(O,F,!0),Kt=O=>p.state.subscribe({next:F=>{e3(O.name,F.name,O.exact)&&XU(F,O.formState||d,Qt,O.reRenderRoot)&&O.callback({values:{...s},...n,...F,defaultValues:i})}}).unsubscribe,En=O=>(o.mount=!0,h={...h,...O.formState},Kt({...O,formState:h})),Z=(O,F={})=>{for(const $ of O?Ic(O):a.mount)a.mount.delete($),a.array.delete($),F.keepValue||(Pt(r,$),Pt(s,$)),!F.keepError&&Pt(n.errors,$),!F.keepDirty&&Pt(n.dirtyFields,$),!F.keepTouched&&Pt(n.touchedFields,$),!F.keepIsValidating&&Pt(n.validatingFields,$),!e.shouldUnregister&&!F.keepDefaultValue&&Pt(i,$);p.state.next({values:Bt(s)}),p.state.next({...n,...F.keepDirty?{isDirty:k()}:{}}),!F.keepIsValid&&E()},Te=({disabled:O,name:F})=>{(qr(O)&&o.mount||O||a.disabled.has(F))&&(O?a.disabled.add(F):a.disabled.delete(F))},Ae=(O,F={})=>{let $=ue(r,O);const Y=qr(F.disabled)||qr(e.disabled);return mt(r,O,{...$||{},_f:{...$&&$._f?$._f:{ref:{name:O}},name:O,mount:!0,...F}}),a.mount.add(O),$?Te({disabled:qr(F.disabled)?F.disabled:e.disabled,name:O}):D(O,!0,F.value),{...Y?{disabled:F.disabled||e.disabled}:{},...e.progressive?{required:!!F.required,min:Jl(F.min),max:Jl(F.max),minLength:Jl(F.minLength),maxLength:Jl(F.maxLength),pattern:Jl(F.pattern)}:{},name:O,onChange:De,onBlur:De,ref:K=>{if(K){Ae(O,F),$=ue(r,O);const H=kt(K.value)&&K.querySelectorAll&&K.querySelectorAll("input,select,textarea")[0]||K,X=HU(H),Se=$._f.refs||[];if(X?Se.find(Ke=>Ke===H):H===$._f.ref)return;mt(r,O,{_f:{...$._f,...X?{refs:[...Se.filter($p),H,...Array.isArray(ue(i,O))?[{}]:[]],ref:{type:H.type,name:O}}:{ref:H}}}),D(O,!1,void 0,H)}else $=ue(r,O,{}),$._f&&($._f.mount=!1),(e.shouldUnregister||F.shouldUnregister)&&!(FU(a.array,O)&&o.action)&&a.unMount.add(O)}}},te=()=>e.shouldFocusError&&Cc(r,B,a.mount),ve=O=>{qr(O)&&(p.state.next({disabled:O}),Cc(r,(F,$)=>{const Y=ue(r,$);Y&&(F.disabled=Y._f.disabled||O,Array.isArray(Y._f.refs)&&Y._f.refs.forEach(K=>{K.disabled=Y._f.disabled||O}))},0,!1))},Ve=(O,F)=>async $=>{let Y;$&&($.preventDefault&&$.preventDefault(),$.persist&&$.persist());let K=Bt(s);if(p.state.next({isSubmitting:!0}),e.resolver){const{errors:H,values:X}=await I();n.errors=H,K=Bt(X)}else await C(r);if(a.disabled.size)for(const H of a.disabled)Pt(K,H);if(Pt(n.errors,"root"),Vn(n.errors)){p.state.next({errors:{}});try{await O(K,$)}catch(H){Y=H}}else F&&await F({...n.errors},$),te(),setTimeout(te);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Vn(n.errors)&&!Y,submitCount:n.submitCount+1,errors:n.errors}),Y)throw Y},ot=(O,F={})=>{ue(r,O)&&(kt(F.defaultValue)?Ne(O,Bt(ue(i,O))):(Ne(O,F.defaultValue),mt(i,O,Bt(F.defaultValue))),F.keepTouched||Pt(n.touchedFields,O),F.keepDirty||(Pt(n.dirtyFields,O),n.isDirty=F.defaultValue?k(O,Bt(ue(i,O))):k()),F.keepError||(Pt(n.errors,O),d.isValid&&E()),p.state.next({...n}))},Mt=(O,F={})=>{const $=O?Bt(O):i,Y=Bt($),K=Vn(O),H=K?i:Y;if(F.keepDefaultValues||(i=$),!F.keepValues){if(F.keepDirtyValues){const X=new Set([...a.mount,...Object.keys(aa(i,s))]);for(const Se of Array.from(X))ue(n.dirtyFields,Se)?mt(H,Se,ue(s,Se)):Ne(Se,ue(H,Se))}else{if(ov&&kt(O))for(const X of a.mount){const Se=ue(r,X);if(Se&&Se._f){const Ke=Array.isArray(Se._f.refs)?Se._f.refs[0]:Se._f.ref;if(Fh(Ke)){const Sn=Ke.closest("form");if(Sn){Sn.reset();break}}}}if(F.keepFieldsRef)for(const X of a.mount)Ne(X,ue(H,X));else r={}}s=e.shouldUnregister?F.keepDefaultValues?Bt(i):{}:Bt(H),p.array.next({values:{...H}}),p.state.next({values:{...H}})}a={mount:F.keepDirtyValues?a.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!F.keepIsValid||!!F.keepDirtyValues,o.watch=!!e.shouldUnregister,p.state.next({submitCount:F.keepSubmitCount?n.submitCount:0,isDirty:K?!1:F.keepDirty?n.isDirty:!!(F.keepDefaultValues&&!is(O,i)),isSubmitted:F.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:K?{}:F.keepDirtyValues?F.keepDefaultValues&&s?aa(i,s):n.dirtyFields:F.keepDefaultValues&&O?aa(i,O):F.keepDirty?n.dirtyFields:{},touchedFields:F.keepTouched?n.touchedFields:{},errors:F.keepErrors?n.errors:{},isSubmitSuccessful:F.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:i})},Jn=(O,F)=>Mt(Or(O)?O(s):O,F),ge=(O,F={})=>{const $=ue(r,O),Y=$&&$._f;if(Y){const K=Y.refs?Y.refs[0]:Y.ref;K.focus&&(K.focus(),F.shouldSelect&&Or(K.select)&&K.select())}},Qt=O=>{n={...n,...O}},Cl={control:{register:Ae,unregister:Z,getFieldState:ke,handleSubmit:Ve,setError:Ze,_subscribe:Kt,_runSchema:I,_focusError:te,_getWatch:x,_getDirty:k,_setValid:E,_setFieldArray:w,_setDisabledField:Te,_setErrors:b,_getFieldArray:P,_reset:Mt,_resetDefaultValues:()=>Or(e.defaultValues)&&e.defaultValues().then(O=>{Jn(O,e.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:A,_disableForm:ve,_subjects:p,_proxyFormState:d,get _fields(){return r},get _formValues(){return s},get _state(){return o},set _state(O){o=O},get _defaultValues(){return i},get _names(){return a},set _names(O){a=O},get _formState(){return n},get _options(){return e},set _options(O){e={...e,...O}}},subscribe:En,trigger:Q,register:Ae,handleSubmit:Ve,watch:Gt,setValue:Ne,getValues:fe,reset:Jn,resetField:ot,clearErrors:$e,unregister:Z,setError:Ze,setFocus:ge,getFieldState:ke};return{...Cl,formControl:Cl}}function Da(t={}){const e=Cn.useRef(void 0),n=Cn.useRef(void 0),[r,i]=Cn.useState({isDirty:!1,isValidating:!1,isLoading:Or(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:Or(t.defaultValues)?void 0:t.defaultValues});if(!e.current)if(t.formControl)e.current={...t.formControl,formState:r},t.defaultValues&&!Or(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:o,...a}=s3(t);e.current={...a,formState:r}}const s=e.current.control;return s._options=t,zU(()=>{const o=s._subscribe({formState:s._proxyFormState,callback:()=>i({...s._formState}),reRenderRoot:!0});return i(a=>({...a,isReady:!0})),s._formState.isReady=!0,o},[s]),Cn.useEffect(()=>s._disableForm(t.disabled),[s,t.disabled]),Cn.useEffect(()=>{t.mode&&(s._options.mode=t.mode),t.reValidateMode&&(s._options.reValidateMode=t.reValidateMode)},[s,t.mode,t.reValidateMode]),Cn.useEffect(()=>{t.errors&&(s._setErrors(t.errors),s._focusError())},[s,t.errors]),Cn.useEffect(()=>{t.shouldUnregister&&s._subjects.state.next({values:s._getWatch()})},[s,t.shouldUnregister]),Cn.useEffect(()=>{if(s._proxyFormState.isDirty){const o=s._getDirty();o!==r.isDirty&&s._subjects.state.next({isDirty:o})}},[s,r.isDirty]),Cn.useEffect(()=>{t.values&&!is(t.values,n.current)?(s._reset(t.values,{keepFieldsRef:!0,...s._options.resetOptions}),n.current=t.values,i(o=>({...o}))):s._resetDefaultValues()},[s,t.values]),Cn.useEffect(()=>{s._state.mount||(s._setValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),e.current.formState=BU(r,s),e.current}var Ge;(function(t){t.assertEqual=i=>{};function e(i){}t.assertIs=e;function n(i){throw new Error}t.assertNever=n,t.arrayToEnum=i=>{const s={};for(const o of i)s[o]=o;return s},t.getValidEnumValues=i=>{const s=t.objectKeys(i).filter(a=>typeof i[i[a]]!="number"),o={};for(const a of s)o[a]=i[a];return t.objectValues(o)},t.objectValues=i=>t.objectKeys(i).map(function(s){return i[s]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const o in i)Object.prototype.hasOwnProperty.call(i,o)&&s.push(o);return s},t.find=(i,s)=>{for(const o of i)if(s(o))return o},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&Number.isFinite(i)&&Math.floor(i)===i;function r(i,s=" | "){return i.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}t.joinValues=r,t.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(Ge||(Ge={}));var jS;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(jS||(jS={}));const ce=Ge.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Zi=t=>{switch(typeof t){case"undefined":return ce.undefined;case"string":return ce.string;case"number":return Number.isNaN(t)?ce.nan:ce.number;case"boolean":return ce.boolean;case"function":return ce.function;case"bigint":return ce.bigint;case"symbol":return ce.symbol;case"object":return Array.isArray(t)?ce.array:t===null?ce.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ce.promise:typeof Map<"u"&&t instanceof Map?ce.map:typeof Set<"u"&&t instanceof Set?ce.set:typeof Date<"u"&&t instanceof Date?ce.date:ce.object;default:return ce.unknown}},G=Ge.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Oi extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(s){return s.message},r={_errors:[]},i=s=>{for(const o of s.issues)if(o.code==="invalid_union")o.unionErrors.map(i);else if(o.code==="invalid_return_type")i(o.returnTypeError);else if(o.code==="invalid_arguments")i(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let a=r,l=0;for(;l<o.path.length;){const u=o.path[l];l===o.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(n(o))):a[u]=a[u]||{_errors:[]},a=a[u],l++}}};return i(this),r}static assert(e){if(!(e instanceof Oi))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ge.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const i of this.issues)if(i.path.length>0){const s=i.path[0];n[s]=n[s]||[],n[s].push(e(i))}else r.push(e(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Oi.create=t=>new Oi(t);const Bg=(t,e)=>{let n;switch(t.code){case G.invalid_type:t.received===ce.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case G.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Ge.jsonStringifyReplacer)}`;break;case G.unrecognized_keys:n=`Unrecognized key(s) in object: ${Ge.joinValues(t.keys,", ")}`;break;case G.invalid_union:n="Invalid input";break;case G.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Ge.joinValues(t.options)}`;break;case G.invalid_enum_value:n=`Invalid enum value. Expected ${Ge.joinValues(t.options)}, received '${t.received}'`;break;case G.invalid_arguments:n="Invalid function arguments";break;case G.invalid_return_type:n="Invalid function return type";break;case G.invalid_date:n="Invalid date";break;case G.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Ge.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case G.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case G.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case G.custom:n="Invalid input";break;case G.invalid_intersection_types:n="Intersection results could not be merged";break;case G.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case G.not_finite:n="Number must be finite";break;default:n=e.defaultError,Ge.assertNever(t)}return{message:n}};let o3=Bg;function a3(){return o3}const l3=t=>{const{data:e,path:n,errorMaps:r,issueData:i}=t,s=[...n,...i.path||[]],o={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let a="";const l=r.filter(u=>!!u).slice().reverse();for(const u of l)a=u(o,{data:e,defaultError:a}).message;return{...i,path:s,message:a}};function ee(t,e){const n=a3(),r=l3({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===Bg?void 0:Bg].filter(i=>!!i)});t.common.issues.push(r)}class lr{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const i of n){if(i.status==="aborted")return be;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const i of n){const s=await i.key,o=await i.value;r.push({key:s,value:o})}return lr.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const i of n){const{key:s,value:o}=i;if(s.status==="aborted"||o.status==="aborted")return be;s.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof o.value<"u"||i.alwaysSet)&&(r[s.value]=o.value)}return{status:e.value,value:r}}}const be=Object.freeze({status:"aborted"}),uc=t=>({status:"dirty",value:t}),xr=t=>({status:"valid",value:t}),FS=t=>t.status==="aborted",US=t=>t.status==="dirty",dl=t=>t.status==="valid",$h=t=>typeof Promise<"u"&&t instanceof Promise;var de;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(de||(de={}));class Fs{constructor(e,n,r,i){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=i}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const $S=(t,e)=>{if(dl(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Oi(t.common.issues);return this._error=n,this._error}}};function Oe(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:i}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(o,a)=>{const{message:l}=t;return o.code==="invalid_enum_value"?{message:l??a.defaultError}:typeof a.data>"u"?{message:l??r??a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:l??n??a.defaultError}},description:i}}class We{get description(){return this._def.description}_getType(e){return Zi(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Zi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new lr,ctx:{common:e.parent.common,data:e.data,parsedType:Zi(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if($h(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Zi(e)},i=this._parseSync({data:e,path:r.path,parent:r});return $S(r,i)}"~validate"(e){var r,i;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Zi(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:n});return dl(s)?{value:s.value}:{issues:n.common.issues}}catch(s){(i=(r=s==null?void 0:s.message)==null?void 0:r.toLowerCase())!=null&&i.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(s=>dl(s)?{value:s.value}:{issues:n.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Zi(e)},i=this._parse({data:e,path:r.path,parent:r}),s=await($h(i)?i:Promise.resolve(i));return $S(r,s)}refine(e,n){const r=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,s)=>{const o=e(i),a=()=>s.addIssue({code:G.custom,...r(i)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof n=="function"?n(r,i):n),!1))}_refinement(e){return new fl({schema:this,typeName:Ie.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Ns.create(this,this._def)}nullable(){return pl.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ii.create(this)}promise(){return qh.create(this,this._def)}or(e){return zh.create([this,e],this._def)}and(e){return Wh.create(this,e,this._def)}transform(e){return new fl({...Oe(this._def),schema:this,typeName:Ie.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new qg({...Oe(this._def),innerType:this,defaultValue:n,typeName:Ie.ZodDefault})}brand(){return new R3({typeName:Ie.ZodBranded,type:this,...Oe(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Hg({...Oe(this._def),innerType:this,catchValue:n,typeName:Ie.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return dv.create(this,e)}readonly(){return Gg.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const c3=/^c[^\s-]{8,}$/i,u3=/^[0-9a-z]+$/,d3=/^[0-9A-HJKMNP-TV-Z]{26}$/i,h3=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,f3=/^[a-z0-9_-]{21}$/i,p3=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,m3=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,g3=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,y3="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Bp;const _3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,v3=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,w3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,E3=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,S3=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,T3=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,iA="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",x3=new RegExp(`^${iA}$`);function sA(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function b3(t){return new RegExp(`^${sA(t)}$`)}function I3(t){let e=`${iA}T${sA(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function C3(t,e){return!!((e==="v4"||!e)&&_3.test(t)||(e==="v6"||!e)&&w3.test(t))}function k3(t,e){if(!p3.test(t))return!1;try{const[n]=t.split(".");if(!n)return!1;const r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||"typ"in i&&(i==null?void 0:i.typ)!=="JWT"||!i.alg||e&&i.alg!==e)}catch{return!1}}function A3(t,e){return!!((e==="v4"||!e)&&v3.test(t)||(e==="v6"||!e)&&E3.test(t))}class ys extends We{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ce.string){const s=this._getOrReturnCtx(e);return ee(s,{code:G.invalid_type,expected:ce.string,received:s.parsedType}),be}const r=new lr;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),ee(i,{code:G.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),ee(i,{code:G.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){const o=e.data.length>s.value,a=e.data.length<s.value;(o||a)&&(i=this._getOrReturnCtx(e,i),o?ee(i,{code:G.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&ee(i,{code:G.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")g3.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"email",code:G.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")Bp||(Bp=new RegExp(y3,"u")),Bp.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"emoji",code:G.invalid_string,message:s.message}),r.dirty());else if(s.kind==="uuid")h3.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"uuid",code:G.invalid_string,message:s.message}),r.dirty());else if(s.kind==="nanoid")f3.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"nanoid",code:G.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")c3.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"cuid",code:G.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")u3.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"cuid2",code:G.invalid_string,message:s.message}),r.dirty());else if(s.kind==="ulid")d3.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"ulid",code:G.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),ee(i,{validation:"url",code:G.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"regex",code:G.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),ee(i,{code:G.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),ee(i,{code:G.invalid_string,validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),ee(i,{code:G.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?I3(s).test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{code:G.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="date"?x3.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{code:G.invalid_string,validation:"date",message:s.message}),r.dirty()):s.kind==="time"?b3(s).test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{code:G.invalid_string,validation:"time",message:s.message}),r.dirty()):s.kind==="duration"?m3.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"duration",code:G.invalid_string,message:s.message}),r.dirty()):s.kind==="ip"?C3(e.data,s.version)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"ip",code:G.invalid_string,message:s.message}),r.dirty()):s.kind==="jwt"?k3(e.data,s.alg)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"jwt",code:G.invalid_string,message:s.message}),r.dirty()):s.kind==="cidr"?A3(e.data,s.version)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"cidr",code:G.invalid_string,message:s.message}),r.dirty()):s.kind==="base64"?S3.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"base64",code:G.invalid_string,message:s.message}),r.dirty()):s.kind==="base64url"?T3.test(e.data)||(i=this._getOrReturnCtx(e,i),ee(i,{validation:"base64url",code:G.invalid_string,message:s.message}),r.dirty()):Ge.assertNever(s);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(i=>e.test(i),{validation:n,code:G.invalid_string,...de.errToObj(r)})}_addCheck(e){return new ys({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...de.errToObj(e)})}url(e){return this._addCheck({kind:"url",...de.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...de.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...de.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...de.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...de.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...de.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...de.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...de.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...de.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...de.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...de.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...de.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...de.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...de.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...de.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...de.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...de.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...de.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...de.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...de.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...de.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...de.errToObj(n)})}nonempty(e){return this.min(1,de.errToObj(e))}trim(){return new ys({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ys({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ys({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}ys.create=t=>new ys({checks:[],typeName:Ie.ZodString,coerce:(t==null?void 0:t.coerce)??!1,...Oe(t)});function P3(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=n>r?n:r,s=Number.parseInt(t.toFixed(i).replace(".","")),o=Number.parseInt(e.toFixed(i).replace(".",""));return s%o/10**i}class lu extends We{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ce.number){const s=this._getOrReturnCtx(e);return ee(s,{code:G.invalid_type,expected:ce.number,received:s.parsedType}),be}let r;const i=new lr;for(const s of this._def.checks)s.kind==="int"?Ge.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),ee(r,{code:G.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),ee(r,{code:G.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),ee(r,{code:G.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?P3(e.data,s.value)!==0&&(r=this._getOrReturnCtx(e,r),ee(r,{code:G.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),ee(r,{code:G.not_finite,message:s.message}),i.dirty()):Ge.assertNever(s);return{status:i.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,de.toString(n))}gt(e,n){return this.setLimit("min",e,!1,de.toString(n))}lte(e,n){return this.setLimit("max",e,!0,de.toString(n))}lt(e,n){return this.setLimit("max",e,!1,de.toString(n))}setLimit(e,n,r,i){return new lu({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:de.toString(i)}]})}_addCheck(e){return new lu({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:de.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:de.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:de.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:de.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:de.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:de.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:de.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:de.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:de.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ge.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}lu.create=t=>new lu({checks:[],typeName:Ie.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Oe(t)});class cu extends We{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ce.bigint)return this._getInvalidInput(e);let r;const i=new lr;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),ee(r,{code:G.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),ee(r,{code:G.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),ee(r,{code:G.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):Ge.assertNever(s);return{status:i.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return ee(n,{code:G.invalid_type,expected:ce.bigint,received:n.parsedType}),be}gte(e,n){return this.setLimit("min",e,!0,de.toString(n))}gt(e,n){return this.setLimit("min",e,!1,de.toString(n))}lte(e,n){return this.setLimit("max",e,!0,de.toString(n))}lt(e,n){return this.setLimit("max",e,!1,de.toString(n))}setLimit(e,n,r,i){return new cu({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:de.toString(i)}]})}_addCheck(e){return new cu({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:de.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:de.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:de.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:de.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:de.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}cu.create=t=>new cu({checks:[],typeName:Ie.ZodBigInt,coerce:(t==null?void 0:t.coerce)??!1,...Oe(t)});class zg extends We{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ce.boolean){const r=this._getOrReturnCtx(e);return ee(r,{code:G.invalid_type,expected:ce.boolean,received:r.parsedType}),be}return xr(e.data)}}zg.create=t=>new zg({typeName:Ie.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Oe(t)});class Bh extends We{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ce.date){const s=this._getOrReturnCtx(e);return ee(s,{code:G.invalid_type,expected:ce.date,received:s.parsedType}),be}if(Number.isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return ee(s,{code:G.invalid_date}),be}const r=new lr;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),ee(i,{code:G.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),ee(i,{code:G.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):Ge.assertNever(s);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Bh({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:de.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:de.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Bh.create=t=>new Bh({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Ie.ZodDate,...Oe(t)});class BS extends We{_parse(e){if(this._getType(e)!==ce.symbol){const r=this._getOrReturnCtx(e);return ee(r,{code:G.invalid_type,expected:ce.symbol,received:r.parsedType}),be}return xr(e.data)}}BS.create=t=>new BS({typeName:Ie.ZodSymbol,...Oe(t)});class zS extends We{_parse(e){if(this._getType(e)!==ce.undefined){const r=this._getOrReturnCtx(e);return ee(r,{code:G.invalid_type,expected:ce.undefined,received:r.parsedType}),be}return xr(e.data)}}zS.create=t=>new zS({typeName:Ie.ZodUndefined,...Oe(t)});class WS extends We{_parse(e){if(this._getType(e)!==ce.null){const r=this._getOrReturnCtx(e);return ee(r,{code:G.invalid_type,expected:ce.null,received:r.parsedType}),be}return xr(e.data)}}WS.create=t=>new WS({typeName:Ie.ZodNull,...Oe(t)});class qS extends We{constructor(){super(...arguments),this._any=!0}_parse(e){return xr(e.data)}}qS.create=t=>new qS({typeName:Ie.ZodAny,...Oe(t)});class HS extends We{constructor(){super(...arguments),this._unknown=!0}_parse(e){return xr(e.data)}}HS.create=t=>new HS({typeName:Ie.ZodUnknown,...Oe(t)});class Us extends We{_parse(e){const n=this._getOrReturnCtx(e);return ee(n,{code:G.invalid_type,expected:ce.never,received:n.parsedType}),be}}Us.create=t=>new Us({typeName:Ie.ZodNever,...Oe(t)});class GS extends We{_parse(e){if(this._getType(e)!==ce.undefined){const r=this._getOrReturnCtx(e);return ee(r,{code:G.invalid_type,expected:ce.void,received:r.parsedType}),be}return xr(e.data)}}GS.create=t=>new GS({typeName:Ie.ZodVoid,...Oe(t)});class ii extends We{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),i=this._def;if(n.parsedType!==ce.array)return ee(n,{code:G.invalid_type,expected:ce.array,received:n.parsedType}),be;if(i.exactLength!==null){const o=n.data.length>i.exactLength.value,a=n.data.length<i.exactLength.value;(o||a)&&(ee(n,{code:o?G.too_big:G.too_small,minimum:a?i.exactLength.value:void 0,maximum:o?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(ee(n,{code:G.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(ee(n,{code:G.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>i.type._parseAsync(new Fs(n,o,n.path,a)))).then(o=>lr.mergeArray(r,o));const s=[...n.data].map((o,a)=>i.type._parseSync(new Fs(n,o,n.path,a)));return lr.mergeArray(r,s)}get element(){return this._def.type}min(e,n){return new ii({...this._def,minLength:{value:e,message:de.toString(n)}})}max(e,n){return new ii({...this._def,maxLength:{value:e,message:de.toString(n)}})}length(e,n){return new ii({...this._def,exactLength:{value:e,message:de.toString(n)}})}nonempty(e){return this.min(1,e)}}ii.create=(t,e)=>new ii({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Ie.ZodArray,...Oe(e)});function la(t){if(t instanceof Nt){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Ns.create(la(r))}return new Nt({...t._def,shape:()=>e})}else return t instanceof ii?new ii({...t._def,type:la(t.element)}):t instanceof Ns?Ns.create(la(t.unwrap())):t instanceof pl?pl.create(la(t.unwrap())):t instanceof jo?jo.create(t.items.map(e=>la(e))):t}class Nt extends We{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Ge.objectKeys(e);return this._cached={shape:e,keys:n},this._cached}_parse(e){if(this._getType(e)!==ce.object){const u=this._getOrReturnCtx(e);return ee(u,{code:G.invalid_type,expected:ce.object,received:u.parsedType}),be}const{status:r,ctx:i}=this._processInputParams(e),{shape:s,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Us&&this._def.unknownKeys==="strip"))for(const u in i.data)o.includes(u)||a.push(u);const l=[];for(const u of o){const d=s[u],h=i.data[u];l.push({key:{status:"valid",value:u},value:d._parse(new Fs(i,h,i.path,u)),alwaysSet:u in i.data})}if(this._def.catchall instanceof Us){const u=this._def.unknownKeys;if(u==="passthrough")for(const d of a)l.push({key:{status:"valid",value:d},value:{status:"valid",value:i.data[d]}});else if(u==="strict")a.length>0&&(ee(i,{code:G.unrecognized_keys,keys:a}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const d of a){const h=i.data[d];l.push({key:{status:"valid",value:d},value:u._parse(new Fs(i,h,i.path,d)),alwaysSet:d in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const u=[];for(const d of l){const h=await d.key,p=await d.value;u.push({key:h,value:p,alwaysSet:d.alwaysSet})}return u}).then(u=>lr.mergeObjectSync(r,u)):lr.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return de.errToObj,new Nt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,o;const i=((o=(s=this._def).errorMap)==null?void 0:o.call(s,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:de.errToObj(e).message??i}:{message:i}}}:{}})}strip(){return new Nt({...this._def,unknownKeys:"strip"})}passthrough(){return new Nt({...this._def,unknownKeys:"passthrough"})}extend(e){return new Nt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Nt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Ie.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Nt({...this._def,catchall:e})}pick(e){const n={};for(const r of Ge.objectKeys(e))e[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Nt({...this._def,shape:()=>n})}omit(e){const n={};for(const r of Ge.objectKeys(this.shape))e[r]||(n[r]=this.shape[r]);return new Nt({...this._def,shape:()=>n})}deepPartial(){return la(this)}partial(e){const n={};for(const r of Ge.objectKeys(this.shape)){const i=this.shape[r];e&&!e[r]?n[r]=i:n[r]=i.optional()}return new Nt({...this._def,shape:()=>n})}required(e){const n={};for(const r of Ge.objectKeys(this.shape))if(e&&!e[r])n[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof Ns;)s=s._def.innerType;n[r]=s}return new Nt({...this._def,shape:()=>n})}keyof(){return oA(Ge.objectKeys(this.shape))}}Nt.create=(t,e)=>new Nt({shape:()=>t,unknownKeys:"strip",catchall:Us.create(),typeName:Ie.ZodObject,...Oe(e)});Nt.strictCreate=(t,e)=>new Nt({shape:()=>t,unknownKeys:"strict",catchall:Us.create(),typeName:Ie.ZodObject,...Oe(e)});Nt.lazycreate=(t,e)=>new Nt({shape:t,unknownKeys:"strip",catchall:Us.create(),typeName:Ie.ZodObject,...Oe(e)});class zh extends We{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function i(s){for(const a of s)if(a.result.status==="valid")return a.result;for(const a of s)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=s.map(a=>new Oi(a.ctx.common.issues));return ee(n,{code:G.invalid_union,unionErrors:o}),be}if(n.common.async)return Promise.all(r.map(async s=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await s._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(i);{let s;const o=[];for(const l of r){const u={...n,common:{...n.common,issues:[]},parent:null},d=l._parseSync({data:n.data,path:n.path,parent:u});if(d.status==="valid")return d;d.status==="dirty"&&!s&&(s={result:d,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(s)return n.common.issues.push(...s.ctx.common.issues),s.result;const a=o.map(l=>new Oi(l));return ee(n,{code:G.invalid_union,unionErrors:a}),be}}get options(){return this._def.options}}zh.create=(t,e)=>new zh({options:t,typeName:Ie.ZodUnion,...Oe(e)});function Wg(t,e){const n=Zi(t),r=Zi(e);if(t===e)return{valid:!0,data:t};if(n===ce.object&&r===ce.object){const i=Ge.objectKeys(e),s=Ge.objectKeys(t).filter(a=>i.indexOf(a)!==-1),o={...t,...e};for(const a of s){const l=Wg(t[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(n===ce.array&&r===ce.array){if(t.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<t.length;s++){const o=t[s],a=e[s],l=Wg(o,a);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return n===ce.date&&r===ce.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Wh extends We{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=(s,o)=>{if(FS(s)||FS(o))return be;const a=Wg(s.value,o.value);return a.valid?((US(s)||US(o))&&n.dirty(),{status:n.value,value:a.data}):(ee(r,{code:G.invalid_intersection_types}),be)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,o])=>i(s,o)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Wh.create=(t,e,n)=>new Wh({left:t,right:e,typeName:Ie.ZodIntersection,...Oe(n)});class jo extends We{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ce.array)return ee(r,{code:G.invalid_type,expected:ce.array,received:r.parsedType}),be;if(r.data.length<this._def.items.length)return ee(r,{code:G.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),be;!this._def.rest&&r.data.length>this._def.items.length&&(ee(r,{code:G.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const s=[...r.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new Fs(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(s).then(o=>lr.mergeArray(n,o)):lr.mergeArray(n,s)}get items(){return this._def.items}rest(e){return new jo({...this._def,rest:e})}}jo.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new jo({items:t,typeName:Ie.ZodTuple,rest:null,...Oe(e)})};class KS extends We{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ce.map)return ee(r,{code:G.invalid_type,expected:ce.map,received:r.parsedType}),be;const i=this._def.keyType,s=this._def.valueType,o=[...r.data.entries()].map(([a,l],u)=>({key:i._parse(new Fs(r,a,r.path,[u,"key"])),value:s._parse(new Fs(r,l,r.path,[u,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const l of o){const u=await l.key,d=await l.value;if(u.status==="aborted"||d.status==="aborted")return be;(u.status==="dirty"||d.status==="dirty")&&n.dirty(),a.set(u.value,d.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const l of o){const u=l.key,d=l.value;if(u.status==="aborted"||d.status==="aborted")return be;(u.status==="dirty"||d.status==="dirty")&&n.dirty(),a.set(u.value,d.value)}return{status:n.value,value:a}}}}KS.create=(t,e,n)=>new KS({valueType:e,keyType:t,typeName:Ie.ZodMap,...Oe(n)});class uu extends We{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ce.set)return ee(r,{code:G.invalid_type,expected:ce.set,received:r.parsedType}),be;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(ee(r,{code:G.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(ee(r,{code:G.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const s=this._def.valueType;function o(l){const u=new Set;for(const d of l){if(d.status==="aborted")return be;d.status==="dirty"&&n.dirty(),u.add(d.value)}return{status:n.value,value:u}}const a=[...r.data.values()].map((l,u)=>s._parse(new Fs(r,l,r.path,u)));return r.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,n){return new uu({...this._def,minSize:{value:e,message:de.toString(n)}})}max(e,n){return new uu({...this._def,maxSize:{value:e,message:de.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}uu.create=(t,e)=>new uu({valueType:t,minSize:null,maxSize:null,typeName:Ie.ZodSet,...Oe(e)});class QS extends We{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}QS.create=(t,e)=>new QS({getter:t,typeName:Ie.ZodLazy,...Oe(e)});class JS extends We{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return ee(n,{received:n.data,code:G.invalid_literal,expected:this._def.value}),be}return{status:"valid",value:e.data}}get value(){return this._def.value}}JS.create=(t,e)=>new JS({value:t,typeName:Ie.ZodLiteral,...Oe(e)});function oA(t,e){return new hl({values:t,typeName:Ie.ZodEnum,...Oe(e)})}class hl extends We{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return ee(n,{expected:Ge.joinValues(r),received:n.parsedType,code:G.invalid_type}),be}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return ee(n,{received:n.data,code:G.invalid_enum_value,options:r}),be}return xr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return hl.create(e,{...this._def,...n})}exclude(e,n=this._def){return hl.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}hl.create=oA;class YS extends We{_parse(e){const n=Ge.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ce.string&&r.parsedType!==ce.number){const i=Ge.objectValues(n);return ee(r,{expected:Ge.joinValues(i),received:r.parsedType,code:G.invalid_type}),be}if(this._cache||(this._cache=new Set(Ge.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const i=Ge.objectValues(n);return ee(r,{received:r.data,code:G.invalid_enum_value,options:i}),be}return xr(e.data)}get enum(){return this._def.values}}YS.create=(t,e)=>new YS({values:t,typeName:Ie.ZodNativeEnum,...Oe(e)});class qh extends We{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ce.promise&&n.common.async===!1)return ee(n,{code:G.invalid_type,expected:ce.promise,received:n.parsedType}),be;const r=n.parsedType===ce.promise?n.data:Promise.resolve(n.data);return xr(r.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}qh.create=(t,e)=>new qh({type:t,typeName:Ie.ZodPromise,...Oe(e)});class fl extends We{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ie.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:o=>{ee(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const o=i.transform(r.data,s);if(r.common.async)return Promise.resolve(o).then(async a=>{if(n.value==="aborted")return be;const l=await this._def.schema._parseAsync({data:a,path:r.path,parent:r});return l.status==="aborted"?be:l.status==="dirty"||n.value==="dirty"?uc(l.value):l});{if(n.value==="aborted")return be;const a=this._def.schema._parseSync({data:o,path:r.path,parent:r});return a.status==="aborted"?be:a.status==="dirty"||n.value==="dirty"?uc(a.value):a}}if(i.type==="refinement"){const o=a=>{const l=i.refinement(a,s);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?be:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?be:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(i.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!dl(o))return be;const a=i.transform(o.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>dl(o)?Promise.resolve(i.transform(o.value,s)).then(a=>({status:n.value,value:a})):be);Ge.assertNever(i)}}fl.create=(t,e,n)=>new fl({schema:t,typeName:Ie.ZodEffects,effect:e,...Oe(n)});fl.createWithPreprocess=(t,e,n)=>new fl({schema:e,effect:{type:"preprocess",transform:t},typeName:Ie.ZodEffects,...Oe(n)});class Ns extends We{_parse(e){return this._getType(e)===ce.undefined?xr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ns.create=(t,e)=>new Ns({innerType:t,typeName:Ie.ZodOptional,...Oe(e)});class pl extends We{_parse(e){return this._getType(e)===ce.null?xr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}pl.create=(t,e)=>new pl({innerType:t,typeName:Ie.ZodNullable,...Oe(e)});class qg extends We{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===ce.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}qg.create=(t,e)=>new qg({innerType:t,typeName:Ie.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Oe(e)});class Hg extends We{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return $h(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Oi(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Oi(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Hg.create=(t,e)=>new Hg({innerType:t,typeName:Ie.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Oe(e)});class ZS extends We{_parse(e){if(this._getType(e)!==ce.nan){const r=this._getOrReturnCtx(e);return ee(r,{code:G.invalid_type,expected:ce.nan,received:r.parsedType}),be}return{status:"valid",value:e.data}}}ZS.create=t=>new ZS({typeName:Ie.ZodNaN,...Oe(t)});class R3 extends We{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class dv extends We{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?be:s.status==="dirty"?(n.dirty(),uc(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?be:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,n){return new dv({in:e,out:n,typeName:Ie.ZodPipeline})}}class Gg extends We{_parse(e){const n=this._def.innerType._parse(e),r=i=>(dl(i)&&(i.value=Object.freeze(i.value)),i);return $h(n)?n.then(i=>r(i)):r(n)}unwrap(){return this._def.innerType}}Gg.create=(t,e)=>new Gg({innerType:t,typeName:Ie.ZodReadonly,...Oe(e)});var Ie;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Ie||(Ie={}));const nn=ys.create,zp=zg.create;Us.create;ii.create;const qs=Nt.create;zh.create;Wh.create;jo.create;hl.create;qh.create;Ns.create;pl.create;function XS(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function aA(...t){return e=>{let n=!1;const r=t.map(i=>{const s=XS(i,e);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let i=0;i<r.length;i++){const s=r[i];typeof s=="function"?s():XS(t[i],null)}}}}function lA(...t){return N.useCallback(aA(...t),t)}function cA(t){const e=D3(t),n=N.forwardRef((r,i)=>{const{children:s,...o}=r,a=N.Children.toArray(s),l=a.find(L3);if(l){const u=l.props.children,d=a.map(h=>h===l?N.Children.count(u)>1?N.Children.only(null):N.isValidElement(u)?u.props.children:null:h);return m.jsx(e,{...o,ref:i,children:N.isValidElement(u)?N.cloneElement(u,void 0,d):null})}return m.jsx(e,{...o,ref:i,children:s})});return n.displayName=`${t}.Slot`,n}var N3=cA("Slot");function D3(t){const e=N.forwardRef((n,r)=>{const{children:i,...s}=n;if(N.isValidElement(i)){const o=V3(i),a=M3(s,i.props);return i.type!==N.Fragment&&(a.ref=r?aA(r,o):o),N.cloneElement(i,a)}return N.Children.count(i)>1?N.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var O3=Symbol("radix.slottable");function L3(t){return N.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===O3}function M3(t,e){const n={...e};for(const r in e){const i=t[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?n[r]=(...a)=>{const l=s(...a);return i(...a),l}:i&&(n[r]=i):r==="style"?n[r]={...i,...s}:r==="className"&&(n[r]=[i,s].filter(Boolean).join(" "))}return{...t,...n}}function V3(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function uA(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=uA(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function dA(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=uA(t))&&(r&&(r+=" "),r+=e);return r}const eT=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,tT=dA,j3=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return tT(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:i,defaultVariants:s}=e,o=Object.keys(i).map(u=>{const d=n==null?void 0:n[u],h=s==null?void 0:s[u];if(d===null)return null;const p=eT(d)||eT(h);return i[u][p]}),a=n&&Object.entries(n).reduce((u,d)=>{let[h,p]=d;return p===void 0||(u[h]=p),u},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:h,className:p,...y}=d;return Object.entries(y).every(T=>{let[E,R]=T;return Array.isArray(R)?R.includes({...s,...a}[E]):{...s,...a}[E]===R})?[...u,h,p]:u},[]);return tT(t,o,l,n==null?void 0:n.class,n==null?void 0:n.className)},hv="-",F3=t=>{const e=$3(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:o=>{const a=o.split(hv);return a[0]===""&&a.length!==1&&a.shift(),hA(a,e)||U3(o)},getConflictingClassGroupIds:(o,a)=>{const l=n[o]||[];return a&&r[o]?[...l,...r[o]]:l}}},hA=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),i=r?hA(t.slice(1),r):void 0;if(i)return i;if(e.validators.length===0)return;const s=t.join(hv);return(o=e.validators.find(({validator:a})=>a(s)))==null?void 0:o.classGroupId},nT=/^\[(.+)\]$/,U3=t=>{if(nT.test(t)){const e=nT.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},$3=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return z3(Object.entries(t.classGroups),n).forEach(([s,o])=>{Kg(o,r,s,e)}),r},Kg=(t,e,n,r)=>{t.forEach(i=>{if(typeof i=="string"){const s=i===""?e:rT(e,i);s.classGroupId=n;return}if(typeof i=="function"){if(B3(i)){Kg(i(r),e,n,r);return}e.validators.push({validator:i,classGroupId:n});return}Object.entries(i).forEach(([s,o])=>{Kg(o,rT(e,s),n,r)})})},rT=(t,e)=>{let n=t;return e.split(hv).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},B3=t=>t.isThemeGetter,z3=(t,e)=>e?t.map(([n,r])=>{const i=r.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([o,a])=>[e+o,a])):s);return[n,i]}):t,W3=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const i=(s,o)=>{n.set(s,o),e++,e>t&&(e=0,r=n,n=new Map)};return{get(s){let o=n.get(s);if(o!==void 0)return o;if((o=r.get(s))!==void 0)return i(s,o),o},set(s,o){n.has(s)?n.set(s,o):i(s,o)}}},fA="!",q3=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,i=e[0],s=e.length,o=a=>{const l=[];let u=0,d=0,h;for(let R=0;R<a.length;R++){let w=a[R];if(u===0){if(w===i&&(r||a.slice(R,R+s)===e)){l.push(a.slice(d,R)),d=R+s;continue}if(w==="/"){h=R;continue}}w==="["?u++:w==="]"&&u--}const p=l.length===0?a:a.substring(d),y=p.startsWith(fA),T=y?p.substring(1):p,E=h&&h>d?h-d:void 0;return{modifiers:l,hasImportantModifier:y,baseClassName:T,maybePostfixModifierPosition:E}};return n?a=>n({className:a,parseClassName:o}):o},H3=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},G3=t=>({cache:W3(t.cacheSize),parseClassName:q3(t),...F3(t)}),K3=/\s+/,Q3=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:i}=e,s=[],o=t.trim().split(K3);let a="";for(let l=o.length-1;l>=0;l-=1){const u=o[l],{modifiers:d,hasImportantModifier:h,baseClassName:p,maybePostfixModifierPosition:y}=n(u);let T=!!y,E=r(T?p.substring(0,y):p);if(!E){if(!T){a=u+(a.length>0?" "+a:a);continue}if(E=r(p),!E){a=u+(a.length>0?" "+a:a);continue}T=!1}const R=H3(d).join(":"),w=h?R+fA:R,v=w+E;if(s.includes(v))continue;s.push(v);const b=i(E,T);for(let D=0;D<b.length;++D){const L=b[D];s.push(w+L)}a=u+(a.length>0?" "+a:a)}return a};function J3(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=pA(e))&&(r&&(r+=" "),r+=n);return r}const pA=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=pA(t[r]))&&(n&&(n+=" "),n+=e);return n};function Y3(t,...e){let n,r,i,s=o;function o(l){const u=e.reduce((d,h)=>h(d),t());return n=G3(u),r=n.cache.get,i=n.cache.set,s=a,a(l)}function a(l){const u=r(l);if(u)return u;const d=Q3(l,n);return i(l,d),d}return function(){return s(J3.apply(null,arguments))}}const dt=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},mA=/^\[(?:([a-z-]+):)?(.+)\]$/i,Z3=/^\d+\/\d+$/,X3=new Set(["px","full","screen"]),e9=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,t9=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,n9=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,r9=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,i9=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,di=t=>Oa(t)||X3.has(t)||Z3.test(t),Gi=t=>Il(t,"length",h9),Oa=t=>!!t&&!Number.isNaN(Number(t)),Wp=t=>Il(t,"number",Oa),Yl=t=>!!t&&Number.isInteger(Number(t)),s9=t=>t.endsWith("%")&&Oa(t.slice(0,-1)),Pe=t=>mA.test(t),Ki=t=>e9.test(t),o9=new Set(["length","size","percentage"]),a9=t=>Il(t,o9,gA),l9=t=>Il(t,"position",gA),c9=new Set(["image","url"]),u9=t=>Il(t,c9,p9),d9=t=>Il(t,"",f9),Zl=()=>!0,Il=(t,e,n)=>{const r=mA.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},h9=t=>t9.test(t)&&!n9.test(t),gA=()=>!1,f9=t=>r9.test(t),p9=t=>i9.test(t),m9=()=>{const t=dt("colors"),e=dt("spacing"),n=dt("blur"),r=dt("brightness"),i=dt("borderColor"),s=dt("borderRadius"),o=dt("borderSpacing"),a=dt("borderWidth"),l=dt("contrast"),u=dt("grayscale"),d=dt("hueRotate"),h=dt("invert"),p=dt("gap"),y=dt("gradientColorStops"),T=dt("gradientColorStopPositions"),E=dt("inset"),R=dt("margin"),w=dt("opacity"),v=dt("padding"),b=dt("saturate"),D=dt("scale"),L=dt("sepia"),j=dt("skew"),I=dt("space"),_=dt("translate"),C=()=>["auto","contain","none"],A=()=>["auto","hidden","clip","visible","scroll"],k=()=>["auto",Pe,e],x=()=>[Pe,e],P=()=>["",di,Gi],he=()=>["auto",Oa,Pe],we=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Ne=()=>["solid","dashed","dotted","double","none"],De=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],B=()=>["start","end","center","between","around","evenly","stretch"],Q=()=>["","0",Pe],fe=()=>["auto","avoid","all","avoid-page","page","left","right","column"],ke=()=>[Oa,Pe];return{cacheSize:500,separator:":",theme:{colors:[Zl],spacing:[di,Gi],blur:["none","",Ki,Pe],brightness:ke(),borderColor:[t],borderRadius:["none","","full",Ki,Pe],borderSpacing:x(),borderWidth:P(),contrast:ke(),grayscale:Q(),hueRotate:ke(),invert:Q(),gap:x(),gradientColorStops:[t],gradientColorStopPositions:[s9,Gi],inset:k(),margin:k(),opacity:ke(),padding:x(),saturate:ke(),scale:ke(),sepia:Q(),skew:ke(),space:x(),translate:x()},classGroups:{aspect:[{aspect:["auto","square","video",Pe]}],container:["container"],columns:[{columns:[Ki]}],"break-after":[{"break-after":fe()}],"break-before":[{"break-before":fe()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...we(),Pe]}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:C()}],"overscroll-x":[{"overscroll-x":C()}],"overscroll-y":[{"overscroll-y":C()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[E]}],"inset-x":[{"inset-x":[E]}],"inset-y":[{"inset-y":[E]}],start:[{start:[E]}],end:[{end:[E]}],top:[{top:[E]}],right:[{right:[E]}],bottom:[{bottom:[E]}],left:[{left:[E]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Yl,Pe]}],basis:[{basis:k()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Pe]}],grow:[{grow:Q()}],shrink:[{shrink:Q()}],order:[{order:["first","last","none",Yl,Pe]}],"grid-cols":[{"grid-cols":[Zl]}],"col-start-end":[{col:["auto",{span:["full",Yl,Pe]},Pe]}],"col-start":[{"col-start":he()}],"col-end":[{"col-end":he()}],"grid-rows":[{"grid-rows":[Zl]}],"row-start-end":[{row:["auto",{span:[Yl,Pe]},Pe]}],"row-start":[{"row-start":he()}],"row-end":[{"row-end":he()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Pe]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Pe]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...B()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...B(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...B(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[R]}],mx:[{mx:[R]}],my:[{my:[R]}],ms:[{ms:[R]}],me:[{me:[R]}],mt:[{mt:[R]}],mr:[{mr:[R]}],mb:[{mb:[R]}],ml:[{ml:[R]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Pe,e]}],"min-w":[{"min-w":[Pe,e,"min","max","fit"]}],"max-w":[{"max-w":[Pe,e,"none","full","min","max","fit","prose",{screen:[Ki]},Ki]}],h:[{h:[Pe,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Pe,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Pe,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Pe,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Ki,Gi]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Wp]}],"font-family":[{font:[Zl]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Pe]}],"line-clamp":[{"line-clamp":["none",Oa,Wp]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",di,Pe]}],"list-image":[{"list-image":["none",Pe]}],"list-style-type":[{list:["none","disc","decimal",Pe]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Ne(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",di,Gi]}],"underline-offset":[{"underline-offset":["auto",di,Pe]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:x()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Pe]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Pe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...we(),l9]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",a9]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},u9]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[T]}],"gradient-via-pos":[{via:[T]}],"gradient-to-pos":[{to:[T]}],"gradient-from":[{from:[y]}],"gradient-via":[{via:[y]}],"gradient-to":[{to:[y]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...Ne(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:Ne()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...Ne()]}],"outline-offset":[{"outline-offset":[di,Pe]}],"outline-w":[{outline:[di,Gi]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:P()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[di,Gi]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Ki,d9]}],"shadow-color":[{shadow:[Zl]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...De(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":De()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Ki,Pe]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[b]}],sepia:[{sepia:[L]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[L]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Pe]}],duration:[{duration:ke()}],ease:[{ease:["linear","in","out","in-out",Pe]}],delay:[{delay:ke()}],animate:[{animate:["none","spin","ping","pulse","bounce",Pe]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[D]}],"scale-x":[{"scale-x":[D]}],"scale-y":[{"scale-y":[D]}],rotate:[{rotate:[Yl,Pe]}],"translate-x":[{"translate-x":[_]}],"translate-y":[{"translate-y":[_]}],"skew-x":[{"skew-x":[j]}],"skew-y":[{"skew-y":[j]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Pe]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Pe]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":x()}],"scroll-mx":[{"scroll-mx":x()}],"scroll-my":[{"scroll-my":x()}],"scroll-ms":[{"scroll-ms":x()}],"scroll-me":[{"scroll-me":x()}],"scroll-mt":[{"scroll-mt":x()}],"scroll-mr":[{"scroll-mr":x()}],"scroll-mb":[{"scroll-mb":x()}],"scroll-ml":[{"scroll-ml":x()}],"scroll-p":[{"scroll-p":x()}],"scroll-px":[{"scroll-px":x()}],"scroll-py":[{"scroll-py":x()}],"scroll-ps":[{"scroll-ps":x()}],"scroll-pe":[{"scroll-pe":x()}],"scroll-pt":[{"scroll-pt":x()}],"scroll-pr":[{"scroll-pr":x()}],"scroll-pb":[{"scroll-pb":x()}],"scroll-pl":[{"scroll-pl":x()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Pe]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[di,Gi,Wp]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},g9=Y3(m9);function Sr(...t){return g9(dA(...t))}const y9=j3("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 ring-offset-slate-950",{variants:{variant:{default:"bg-brand text-slate-950 hover:bg-brand-dark",outline:"border border-slate-700 bg-transparent hover:bg-slate-800",ghost:"bg-transparent hover:bg-slate-800"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),lt=({className:t,variant:e,size:n,asChild:r=!1,...i})=>{const s=r?N3:"button";return m.jsx(s,{className:Sr(y9({variant:e,size:n}),t),...i})},yn=N.forwardRef(({className:t,type:e="text",...n},r)=>m.jsx("input",{type:e,className:Sr("flex h-10 w-full rounded-md border border-slate-700 bg-slate-900 px-3 py-2 text-sm shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ring-offset-slate-950",t),ref:r,...n}));yn.displayName="Input";var _9=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],fv=_9.reduce((t,e)=>{const n=cA(`Primitive.${e}`),r=N.forwardRef((i,s)=>{const{asChild:o,...a}=i,l=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),m.jsx(l,{...a,ref:s})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{}),v9="Label",yA=N.forwardRef((t,e)=>m.jsx(fv.label,{...t,ref:e,onMouseDown:n=>{var i;n.target.closest("button, input, select, textarea")||((i=t.onMouseDown)==null||i.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));yA.displayName=v9;var _A=yA;const er=N.forwardRef(({className:t,...e},n)=>m.jsx(_A,{ref:n,className:Sr("text-sm font-medium leading-none",t),...e}));er.displayName=_A.displayName;function La(t){if(!t||typeof t.safeParse!="function")throw new Error("createZodResolver expects a Zod schema");return async e=>{const n=t.safeParse(e);if(n.success)return{values:n.data,errors:{}};const r={};for(const i of n.error.issues){const s=i.path.join(".")||i.code;r[s]={type:i.code,message:i.message}}return{values:{},errors:r}}}const w9=qs({email:nn().email("Enter a valid email"),password:nn().min(6,"Password must be at least 6 characters")}),E9=qs({name:nn().min(2,"Enter your name"),email:nn().email("Enter a valid email"),password:nn().min(6,"Password must be at least 6 characters"),confirmPassword:nn().min(6,"Confirm your password")}).refine(t=>t.password===t.confirmPassword,{message:"Passwords must match",path:["confirmPassword"]}),S9=qs({email:nn().email("Enter a valid email")}),T9={"sign-in":w9,"sign-up":E9,forgot:S9},iT={"sign-in":{email:"",password:""},"sign-up":{name:"",email:"",password:"",confirmPassword:""},forgot:{email:""}};function x9(){var we,Ne,De;const t=ji(),e=Eu(),{user:n,loading:r,signIn:i,signUp:s,signInWithGoogle:o,registerWithGoogle:a,sendPasswordReset:l,sendVerificationEmail:u,verifying:d}=Ui(),[h,p]=N.useState("sign-in"),[y,T]=N.useState(null),[E,R]=N.useState(((we=t.state)==null?void 0:we.message)??null),[w,v]=N.useState(null),b=N.useMemo(()=>T9[h],[h]),D=N.useMemo(()=>iT[h],[h]),{register:L,handleSubmit:j,reset:I,formState:{errors:_,isSubmitting:C}}=Da({resolver:La(b),defaultValues:D});N.useEffect(()=>{var B;I(iT[h]),T(null),R(((B=t.state)==null?void 0:B.message)??null),v(null)},[h,I,t.state]);const A=((De=(Ne=t.state)==null?void 0:Ne.from)==null?void 0:De.pathname)??"/dashboard";N.useEffect(()=>{!r&&n&&e(A,{replace:!0})},[r,e,A,n]);const k=B=>{p(B)},x=async B=>{T(null),R(null),v(null);try{if(h==="sign-in"){await i(B.email,B.password),e(A,{replace:!0});return}if(h==="sign-up"){await s({email:B.email,password:B.password,displayName:B.name}),v("Account created successfully. A verification email is on the way."),e(A,{replace:!0});return}h==="forgot"&&(await l(B.email),v("Password reset instructions have been emailed to you."),p("sign-in"))}catch(Q){T(Q instanceof Error?Q.message:"Authentication failed")}},P=async()=>{T(null),R(null),v(null);try{if(h==="sign-up"){await a(),v("Google account linked. You are now signed in."),e(A,{replace:!0});return}await o()&&e(A,{replace:!0})}catch(B){T(B instanceof Error?B.message:"Google sign-in failed")}},he=async()=>{T(null),v(null);try{await u(),R("Verification email resent. Please check your inbox.")}catch(B){const Q=B instanceof Error&&B.message.includes("No authenticated user")?"Sign in with your email and password before resending the verification link.":B instanceof Error?B.message:"Unable to send verification email";T(Q)}};return m.jsx("div",{className:"flex min-h-screen items-center justify-center bg-slate-950 px-4 text-slate-100",children:m.jsxs("div",{className:"w-full max-w-lg rounded-3xl border border-slate-800 bg-slate-900/80 p-8 shadow-xl",children:[m.jsxs("div",{className:"mb-6 text-center",children:[m.jsx("h1",{className:"text-2xl font-semibold text-brand",children:"Twilio Voice Dialer"}),m.jsx("p",{className:"text-sm text-slate-400",children:"Access the Twilio-powered browser dialer and workspace controls."})]}),m.jsxs("div",{className:"mb-6 flex justify-center gap-4 text-sm",children:[m.jsx("button",{type:"button",onClick:()=>k("sign-in"),className:`rounded-full px-4 py-1 font-medium transition ${h==="sign-in"?"bg-brand text-slate-950":"text-slate-400 hover:text-slate-100"}`,children:"Sign in"}),m.jsx("button",{type:"button",onClick:()=>k("sign-up"),className:`rounded-full px-4 py-1 font-medium transition ${h==="sign-up"?"bg-brand text-slate-950":"text-slate-400 hover:text-slate-100"}`,children:"Register"}),m.jsx("button",{type:"button",onClick:()=>k("forgot"),className:`rounded-full px-4 py-1 font-medium transition ${h==="forgot"?"bg-brand text-slate-950":"text-slate-400 hover:text-slate-100"}`,children:"Forgot password"})]}),m.jsxs("form",{className:"space-y-5",onSubmit:j(x),children:[h==="sign-up"?m.jsxs("div",{className:"space-y-2",children:[m.jsx(er,{htmlFor:"name",children:"Full name"}),m.jsx(yn,{id:"name",placeholder:"Your name",autoComplete:"name",...L("name")}),_.name?m.jsx("p",{className:"text-xs text-red-400",children:_.name.message}):null]}):null,m.jsxs("div",{className:"space-y-2",children:[m.jsx(er,{htmlFor:"email",children:"Email"}),m.jsx(yn,{id:"email",type:"email",placeholder:"you@example.com",autoComplete:"email",...L("email")}),_.email?m.jsx("p",{className:"text-xs text-red-400",children:_.email.message}):null]}),h!=="forgot"?m.jsxs("div",{className:"space-y-2",children:[m.jsx(er,{htmlFor:"password",children:"Password"}),m.jsx(yn,{id:"password",type:"password",placeholder:"",autoComplete:h==="sign-up"?"new-password":"current-password",...L("password")}),_.password?m.jsx("p",{className:"text-xs text-red-400",children:_.password.message}):null]}):null,h==="sign-up"?m.jsxs("div",{className:"space-y-2",children:[m.jsx(er,{htmlFor:"confirmPassword",children:"Confirm password"}),m.jsx(yn,{id:"confirmPassword",type:"password",placeholder:"",autoComplete:"new-password",...L("confirmPassword")}),_.confirmPassword?m.jsx("p",{className:"text-xs text-red-400",children:_.confirmPassword.message}):null]}):null,y?m.jsx("p",{className:"text-sm text-red-400",children:y}):null,E?m.jsx("p",{className:"text-sm text-amber-300",children:E}):null,w?m.jsx("p",{className:"text-sm text-emerald-400",children:w}):null,m.jsx(lt,{type:"submit",className:"w-full",disabled:C||d,children:C?"Please wait":h==="sign-in"?"Sign in":h==="sign-up"?"Create account":"Send reset link"})]}),h!=="forgot"?m.jsxs("div",{className:"mt-6 space-y-4",children:[m.jsx(lt,{type:"button",variant:"outline",className:"w-full",onClick:()=>void P(),children:h==="sign-up"?"Register with Google":"Sign in with Google"}),h==="sign-in"?m.jsx(lt,{type:"button",variant:"ghost",className:"w-full text-sm text-slate-400 hover:text-slate-100",disabled:d||C,onClick:()=>void he(),children:"Resend verification email"}):null]}):null]})})}/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b9=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),vA=(...t)=>t.filter((e,n,r)=>!!e&&r.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var I9={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C9=N.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...a},l)=>N.createElement("svg",{ref:l,...I9,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:vA("lucide",i),...a},[...o.map(([u,d])=>N.createElement(u,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=(t,e)=>{const n=N.forwardRef(({className:r,...i},s)=>N.createElement(C9,{ref:s,iconNode:e,className:vA(`lucide-${b9(t)}`,r),...i}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pv=it("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k9=it("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A9=it("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P9=it("CodeXml",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R9=it("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N9=it("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D9=it("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O9=it("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L9=it("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M9=it("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qp=it("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V9=it("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j9=it("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F9=it("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wA=it("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EA=it("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SA=it("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mv=it("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TA=it("PhoneIncoming",[["polyline",{points:"16 2 16 8 22 8",key:"1ygljm"}],["line",{x1:"22",x2:"16",y1:"2",y2:"8",key:"1xzwqn"}],["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qg=it("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xA=it("PhoneOutgoing",[["polyline",{points:"22 8 22 2 16 2",key:"1g204g"}],["line",{x1:"16",x2:"22",y1:"8",y2:"2",key:"1ggias"}],["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bA=it("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IA=it("ServerCog",[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["path",{d:"M4.5 10H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-.5",key:"tn8das"}],["path",{d:"M4.5 14H4a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-4a2 2 0 0 0-2-2h-.5",key:"1g2pve"}],["path",{d:"M6 6h.01",key:"1utrut"}],["path",{d:"M6 18h.01",key:"uhywen"}],["path",{d:"m15.7 13.4-.9-.3",key:"1jwmzr"}],["path",{d:"m9.2 10.9-.9-.3",key:"qapnim"}],["path",{d:"m10.6 15.7.3-.9",key:"quwk0k"}],["path",{d:"m13.6 15.7-.4-1",key:"cb9xp7"}],["path",{d:"m10.8 9.3-.4-1",key:"1uaiz5"}],["path",{d:"m8.3 13.6 1-.4",key:"s6srou"}],["path",{d:"m14.7 10.8 1-.4",key:"4d31cq"}],["path",{d:"m13.4 8.3-.3.9",key:"1bm987"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U9=it("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $9=it("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B9=it("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z9=it("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.424.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CA=it("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Nn=({className:t,...e})=>m.jsx("div",{className:Sr("rounded-xl border border-slate-800 bg-slate-900/60 p-6 shadow-lg",t),...e}),Hn=({className:t,...e})=>m.jsx("div",{className:Sr("mb-4 space-y-1",t),...e}),Gn=({className:t,...e})=>m.jsx("h2",{className:Sr("text-xl font-semibold tracking-tight",t),...e}),Kn=({className:t,...e})=>m.jsx("p",{className:Sr("text-sm text-slate-400",t),...e}),W9=[{title:"Active Call State",description:"Monitor the current Twilio call status and connection health.",icon:m.jsx(pv,{className:"h-5 w-5 text-brand"})},{title:"Inbound Calls",description:"Track the number of inbound calls handled by your team.",icon:m.jsx(TA,{className:"h-5 w-5 text-brand"})},{title:"Outbound Calls",description:"Review outbound call volume and completion success rates.",icon:m.jsx(xA,{className:"h-5 w-5 text-brand"})},{title:"Infrastructure Health",description:"Quickly verify SIP connectivity, WebRTC registration, and network reachability.",icon:m.jsx(IA,{className:"h-5 w-5 text-brand"})}];function q9(){return m.jsxs("div",{className:"space-y-6",children:[m.jsx("header",{className:"flex items-center justify-between",children:m.jsxs("div",{children:[m.jsx("h2",{className:"text-3xl font-semibold tracking-tight",children:"Dashboard"}),m.jsx("p",{className:"text-sm text-slate-400",children:"Real-time operational overview of your Twilio Web Dialer workspace."})]})}),m.jsx("section",{className:"grid gap-4 md:grid-cols-2 xl:grid-cols-4",children:W9.map(t=>m.jsx(Nn,{className:"space-y-3",children:m.jsxs(Hn,{className:"flex items-center gap-3",children:[t.icon,m.jsxs("div",{children:[m.jsx(Gn,{className:"text-base",children:t.title}),m.jsx(Kn,{children:t.description})]})]})},t.title))}),m.jsxs("section",{className:"grid gap-4 lg:grid-cols-2",children:[m.jsxs(Nn,{children:[m.jsxs(Hn,{children:[m.jsx(Gn,{children:"Recent Activity"}),m.jsx(Kn,{children:"Important events across SIP registration, call flows, and automation."})]}),m.jsxs("ul",{className:"space-y-3 text-sm text-slate-300",children:[m.jsx("li",{children:" TwiML application updated with latest routing logic."}),m.jsx("li",{children:" WebRTC client registered via secure WSS transport."}),m.jsx("li",{children:" Automated outbound campaign scheduled by marketing team."})]})]}),m.jsxs(Nn,{children:[m.jsxs(Hn,{children:[m.jsx(Gn,{children:"Next Steps"}),m.jsx(Kn,{children:"Suggested tasks to finish configuring your workspace."})]}),m.jsxs("ul",{className:"space-y-3 text-sm text-slate-300",children:[m.jsx("li",{children:" Upload organization logo for caller ID experiences."}),m.jsx("li",{children:" Enable status callbacks and Voice Insights for production monitoring."}),m.jsx("li",{children:" Invite additional operators and assign permission sets."})]})]})]})]})}const H9=N.forwardRef(function({className:e,...n},r){return m.jsx("textarea",{ref:r,className:Sr("min-h-[140px] w-full rounded-md border border-slate-700 bg-slate-950 px-3 py-2 text-sm text-slate-100 shadow-sm placeholder:text-slate-500 focus:border-brand focus:outline-none focus:ring-2 focus:ring-brand/40 disabled:cursor-not-allowed disabled:opacity-60",e),...n})}),kA=["active","connecting","ringing","held"];function G9(){const{user:t}=Ui(),{initializeClient:e,makeCall:n,hangUp:r,acceptIncomingCall:i,rejectIncomingCall:s,callState:o,connectionStatus:a,lastError:l,toggleMute:u,toggleHold:d,isMuted:h,isOnHold:p,isClientReady:y,sendDigits:T,incomingNumber:E,activeNumber:R,setCallNote:w}=sv(),[v,b]=N.useState(""),[D,L]=N.useState(""),[j,I]=N.useState(null),[_,C]=N.useState(!1),[A,k]=N.useState(!1),[x,P]=N.useState(""),he=N.useRef(null),we=N.useRef(null),Ne=N.useRef();N.useEffect(()=>{e().catch(ge=>I(ge instanceof Error?ge.message:"Unable to initialise Twilio client"))},[e]),N.useEffect(()=>{w(D)},[D,w]);const De=N.useCallback(()=>{const ge=he.current;ge&&(Ne.current&&(ge.removeEventListener("beforeunload",Ne.current),Ne.current=void 0),ge.closed||ge.close()),he.current=null,we.current=null,k(!1)},[]),B=N.useCallback(()=>{if(typeof window>"u"||typeof document>"u")return;if(he.current&&!he.current.closed){he.current.focus(),k(!0);return}const ge=window.open("","twilio-call","width=420,height=620,left=120,top=120,resizable=no,scrollbars=no,toolbar=no,menubar=no,status=no");if(!ge){k(!1);return}ge.document.title="Twilio Call",ge.document.body.className="bg-slate-950 text-slate-100",ge.document.body.style.margin="0",ge.document.body.style.padding="0";const Qt=ge.document.createElement("div");Qt.id="twilio-call-root",ge.document.body.appendChild(Qt),J9(document,ge.document);const Hs=()=>{C(!1),k(!1)};ge.addEventListener("beforeunload",Hs),Ne.current=Hs,he.current=ge,we.current=Qt,k(!0),ge.focus()},[]),Q=N.useMemo(()=>kA.includes(o),[o]);N.useEffect(()=>{Q&&_&&B(),Q||(C(!1),De())},[_,De,Q,B]),N.useEffect(()=>{if(!A||!he.current)return;const ge=he.current,Qt=o?o.charAt(0).toUpperCase()+o.slice(1):"Twilio Call";ge.document.title=R?`${Qt}  ${ea(R)}`:Qt},[R,o,A]),N.useEffect(()=>()=>{De()},[De]),N.useEffect(()=>{(o==="idle"||o==="completed"||o==="failed")&&(L(""),P(""))},[o]);const fe=N.useCallback(async()=>{if(!t){I("You must be signed in to place calls.");return}if(!y){I("Waiting for Twilio device registration to finish.");return}const ge=v.trim();if(!ge){I("Enter a destination number.");return}I(null),P(""),C(!0),B();try{await n(ge)||(I("Unable to start call."),C(!1),De())}catch(Qt){I(Qt instanceof Error?Qt.message:"Unable to start call"),C(!1),De()}},[De,v,y,n,B,t]),ke=N.useCallback(async()=>{await r(),C(!1),De()},[De,r]),$e=N.useCallback(async()=>{if(!await i()){I("Unable to accept incoming call.");return}C(!0),B(),I(null)},[i,B]),Ze=N.useCallback(async()=>{await s("Agent rejected call")||I("Unable to reject incoming call.")},[s]),Gt=N.useCallback(async ge=>{ge&&(Q?await T(ge)&&P(Hs=>`${Hs}${ge}`):b(Qt=>`${Qt}${ge}`))},[Q,T]),Kt=()=>{Q||b(ge=>ge.slice(0,-1))},En=()=>{Q||b("")},Z=v.trim().length>0&&!Q&&o!=="incoming"&&y,Te=o==="active"||o==="held",Ae=o==="incoming",te=N.useMemo(()=>a.state==="registered"?"text-emerald-400":a.state==="error"?"text-red-400":a.state==="disconnected"?"text-amber-400":a.state==="initialising"?"text-amber-300":"text-slate-200",[a.state]),ve=N.useMemo(()=>o==="active"?"text-emerald-400":o==="connecting"||o==="ringing"?"text-amber-300":o==="incoming"?"text-amber-200":o==="held"?"text-amber-300":o==="failed"?"text-red-400":o==="completed"?"text-slate-300":"text-slate-200",[o]),Ve=o?o.charAt(0).toUpperCase()+o.slice(1):"Idle",ot=N.useMemo(()=>[{label:"Registration",tone:te,value:a.message},{label:"Call State",tone:ve,value:Ve},{label:"Active Leg",value:R?ea(R):"None"},{label:"Incoming Caller",value:E?ea(E):"None"},{label:"Last Error",tone:l?"text-red-400":void 0,value:l||"None"}],[R,ve,a.message,Ve,E,l,te]),Mt=j??l,Jn=o==="active"?"Add live call notes...":"Notes will attach to your next call";return m.jsxs("div",{className:"mx-auto flex w-full max-w-5xl flex-col gap-6",children:[m.jsx("section",{children:m.jsx("div",{className:"grid gap-3 rounded-xl border border-slate-800 bg-slate-950/60 p-4 text-xs text-slate-300 sm:grid-cols-2 lg:grid-cols-5",children:ot.map(ge=>m.jsx(K9,{label:ge.label,tone:ge.tone,value:ge.value},ge.label))})}),Ae?m.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-amber-500/40 bg-amber-500/10 p-4 text-sm text-amber-100",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(k9,{className:"h-5 w-5"}),m.jsxs("div",{children:[m.jsx("p",{className:"font-semibold",children:"Incoming call"}),m.jsx("p",{className:"text-xs text-amber-200/90",children:E?ea(E):"Unknown caller"})]})]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsxs(lt,{variant:"secondary",className:"gap-2",onClick:$e,children:[m.jsx(TA,{className:"h-4 w-4"}),"Accept"]}),m.jsxs(lt,{variant:"destructive",className:"gap-2",onClick:Ze,children:[m.jsx(Qg,{className:"h-4 w-4"}),"Decline"]})]})]}):null,Mt?m.jsxs("div",{className:"flex items-center gap-3 rounded-xl border border-red-500/40 bg-red-500/10 p-4 text-sm text-red-200",children:[m.jsx(A9,{className:"h-4 w-4 shrink-0"}),m.jsx("p",{children:Mt})]}):null,m.jsxs("div",{className:"grid gap-6 lg:grid-cols-[1.1fr_0.9fr]",children:[m.jsx(Nn,{children:m.jsxs("div",{className:"space-y-5 p-5",children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx("label",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Destination"}),m.jsx(yn,{value:v,onChange:ge=>b(ge.target.value),placeholder:"+12025550123",disabled:Q||o==="incoming"})]}),m.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3 lg:grid-cols-4",children:[m.jsx(xd,{label:"Start Call",icon:m.jsx(xA,{className:"h-5 w-5"}),disabled:!Z,onClick:fe,tone:"start"}),m.jsx(xd,{label:"End Call",icon:m.jsx(Qg,{className:"h-5 w-5"}),disabled:!Q,onClick:ke,tone:"end",active:Q}),m.jsx(xd,{label:h?"Unmute":"Mute",icon:h?m.jsx(wA,{className:"h-5 w-5"}):m.jsx(EA,{className:"h-5 w-5"}),disabled:!Te,onClick:()=>u(),active:h}),m.jsx(xd,{label:p?"Resume":"Hold",icon:p?m.jsx(bA,{className:"h-5 w-5"}):m.jsx(SA,{className:"h-5 w-5"}),disabled:!Te,onClick:()=>d(),active:p})]}),m.jsxs("div",{children:[m.jsx("h3",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Dial Pad"}),m.jsx("div",{className:"mt-3",children:m.jsx(AA,{onDigitPress:Gt,disabledKeys:!Q})}),m.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs text-slate-500",children:[m.jsxs("span",{children:["DTMF sent: ",x||"None"]}),m.jsxs("div",{className:"flex gap-2",children:[m.jsx(lt,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs",onClick:Kt,disabled:Q,children:"Backspace"}),m.jsx(lt,{variant:"ghost",size:"sm",className:"h-7 px-2 text-xs",onClick:En,disabled:Q,children:"Clear"})]})]})]})]})}),m.jsxs(Nn,{className:"flex flex-col",children:[m.jsxs(Hn,{children:[m.jsxs(Gn,{className:"flex items-center gap-2",children:[m.jsx(B9,{className:"h-4 w-4"}),"Call Notes"]}),m.jsx(Kn,{children:"Notes attach to the active call record and are visible in the admin console."})]}),m.jsxs("div",{className:"flex flex-1 flex-col gap-4 px-6 pb-6",children:[m.jsx(H9,{value:D,onChange:ge=>L(ge.target.value),placeholder:Jn,className:"min-h-[200px] flex-1 resize-none"}),m.jsxs("div",{className:"rounded-lg border border-slate-800 bg-slate-900/60 p-4 text-xs text-slate-400",children:[m.jsx("p",{className:"font-semibold uppercase tracking-wide text-slate-500",children:"Call context"}),m.jsxs("dl",{className:"mt-3 space-y-2 text-slate-300",children:[m.jsx(Hp,{label:"Active leg",value:R?ea(R):"None"}),m.jsx(Hp,{label:"Incoming caller",value:E?ea(E):"None"}),m.jsx(Hp,{label:"Registration",value:a.message})]})]})]})]})]}),A&&we.current?Rb.createPortal(m.jsx(Q9,{destination:R||v,callState:Ve,dtmfSequence:x,onDigitPress:Gt,onHangUp:ke,onToggleMute:()=>u(),onToggleHold:()=>d(),canControlCall:Te,isMuted:h,isOnHold:p,onClose:()=>{C(!1),De()}}),we.current):null]})}function K9({label:t,value:e,tone:n}){return m.jsxs("div",{children:[m.jsx("p",{className:"text-[0.6rem] uppercase tracking-[0.3em] text-slate-500",children:t}),m.jsx("p",{className:Sr("mt-2 text-sm font-medium text-slate-200",n),children:e})]})}function Hp({label:t,value:e}){return m.jsxs("div",{className:"flex items-center justify-between",children:[m.jsx("span",{className:"text-slate-500",children:t}),m.jsx("span",{className:"text-slate-200",children:e})]})}function xd({label:t,icon:e,disabled:n,onClick:r,tone:i,active:s}){const o=i==="start"?"border-emerald-500/40 bg-emerald-500/10 text-emerald-200 hover:border-emerald-500/70 hover:bg-emerald-500/20":i==="end"?"border-red-500/40 bg-red-500/10 text-red-200 hover:border-red-500/70 hover:bg-red-500/20":s?"border-brand/40 bg-brand/10 text-brand":"border-slate-800 bg-slate-900/70 text-slate-200 hover:border-brand/40 hover:bg-slate-900";return m.jsxs("button",{type:"button",onClick:r,disabled:n,className:Sr("flex h-12 flex-col items-center justify-center rounded-xl border text-[0.7rem] font-semibold uppercase tracking-wide transition sm:h-14",o,n?"cursor-not-allowed opacity-40 hover:border-transparent hover:bg-transparent hover:text-slate-400":""),children:[m.jsx("span",{className:"mb-1 text-lg",children:e}),t]})}function AA({onDigitPress:t,disabledKeys:e}){const n=[{value:"1",letters:""},{value:"2",letters:"ABC"},{value:"3",letters:"DEF"},{value:"4",letters:"GHI"},{value:"5",letters:"JKL"},{value:"6",letters:"MNO"},{value:"7",letters:"PQRS"},{value:"8",letters:"TUV"},{value:"9",letters:"WXYZ"},{value:"*",letters:""},{value:"0",letters:"+"},{value:"#",letters:""}];return m.jsx("div",{className:"grid grid-cols-3 gap-2 sm:gap-3",children:n.map(r=>m.jsxs("button",{type:"button",className:"flex h-11 flex-col items-center justify-center rounded-xl border border-slate-800 bg-slate-900/70 text-slate-100 transition hover:border-brand/40 hover:bg-slate-900 disabled:cursor-not-allowed disabled:opacity-50 sm:h-12",onClick:()=>{t(r.value)},disabled:e,children:[m.jsx("span",{className:"text-lg font-semibold sm:text-xl",children:r.value}),r.letters?m.jsx("span",{className:"text-[0.6rem] tracking-[0.2em] text-slate-500",children:r.letters}):null]},r.value))})}function Q9({destination:t,callState:e,dtmfSequence:n,onDigitPress:r,onHangUp:i,onToggleMute:s,onToggleHold:o,canControlCall:a,isMuted:l,isOnHold:u,onClose:d}){const h=kA.includes(e.toLowerCase());return m.jsxs("div",{className:"flex min-h-screen flex-col bg-slate-950 p-6 text-slate-100",children:[m.jsxs("div",{className:"flex items-start justify-between",children:[m.jsxs("div",{children:[m.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Active Call"}),m.jsx("p",{className:"mt-2 text-2xl font-semibold",children:t||"Unknown number"}),m.jsx("p",{className:"mt-1 text-sm capitalize text-slate-400",children:e}),n?m.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:["DTMF sent: ",n]}):null]}),m.jsx("button",{type:"button",onClick:d,className:"rounded-full p-2 text-slate-500 transition hover:bg-slate-800/80 hover:text-slate-200",children:m.jsx(CA,{className:"h-4 w-4"})})]}),h?null:m.jsx("p",{className:"mt-4 rounded-md border border-amber-400/40 bg-amber-500/10 p-3 text-sm text-amber-200",children:"Waiting for the call to connect."}),m.jsxs("div",{className:"mt-6 flex-1 space-y-6",children:[m.jsx(AA,{onDigitPress:r,disabledKeys:!h}),m.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[m.jsxs(lt,{variant:"outline",className:"flex-1 gap-2",disabled:!a,onClick:s,children:[l?m.jsx(wA,{className:"h-4 w-4"}):m.jsx(EA,{className:"h-4 w-4"}),l?"Unmute":"Mute"]}),m.jsxs(lt,{variant:"outline",className:"flex-1 gap-2",disabled:!a,onClick:o,children:[u?m.jsx(bA,{className:"h-4 w-4"}):m.jsx(SA,{className:"h-4 w-4"}),u?"Resume":"Hold"]})]}),m.jsxs(lt,{className:"w-full gap-2",variant:"destructive",onClick:i,children:[m.jsx(Qg,{className:"h-4 w-4"}),"End Call"]})]})]})}function J9(t,e){const n=e.head||e.getElementsByTagName("head")[0];n&&Array.from(t.querySelectorAll('link[rel="stylesheet"], style')).forEach(r=>{n.appendChild(r.cloneNode(!0))})}function ea(t){return t?t.startsWith("+")?t:t.startsWith("client:")?t.replace(/^client:/i,"client/"):t:""}async function Y9(t){if(!_n)throw new Error("Firebase is not configured");const e=fk(_n,"users",t,"callLogs");return(await xF(vF(e,wF("startedAt","desc")))).docs.map(r=>({id:r.id,...r.data()}))}function Z9(){const{user:t}=Ui();return S2({enabled:!!(t&&_n),queryKey:["callLogs",t==null?void 0:t.uid],queryFn:()=>Y9(t.uid),staleTime:1e3*30})}const X9=[{id:"1",direction:"outbound",counterparty:"+1 202 555 0113",status:"completed",startedAt:"2024-05-12 09:24 UTC",duration:"04:12"},{id:"2",direction:"inbound",counterparty:"Acme HQ",status:"voicemail",startedAt:"2024-05-12 08:02 UTC",duration:"01:06"},{id:"3",direction:"outbound",counterparty:"+44 20 7946 0012",status:"failed",startedAt:"2024-05-11 20:13 UTC",duration:"00:00"}];function e$(t){const e=typeof t=="string"?t.toLowerCase():"";return["cancelled","canceled"].includes(e)?"cancelled":["failed","error","busy"].includes(e)?"failed":["completed","complete","ended"].includes(e)?"completed":e||"completed"}function t$(){const{data:t,error:e,isLoading:n,isFetching:r}=Z9(),i=N.useMemo(()=>!t||t.length===0?X9:t.map(s=>{var p,y;const o=(p=s.startedAt)!=null&&p.toDate?s.startedAt.toDate():s.startedAt,a=(y=s.endedAt)!=null&&y.toDate?s.endedAt.toDate():s.endedAt,l=o?new Date(o):null,u=typeof s.durationSeconds=="number"?s.durationSeconds:0,d=typeof s.note=="string"?s.note.trim():"",h=e$(s.status);return{id:s.id,direction:s.direction||"outbound",counterparty:s.counterparty||"Unknown",status:h,startedAt:l?l.toUTCString():"N/A",duration:u>0?new Date(u*1e3).toISOString().substring(14,19):a?"00:00":"",note:d.length>0?d:null}}),[t]);return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("header",{children:[m.jsx("h2",{className:"text-3xl font-semibold tracking-tight",children:"Call Logs"}),m.jsx("p",{className:"text-sm text-slate-400",children:"Track interactions handled through your Twilio-powered dialer."})]}),m.jsxs(Nn,{children:[m.jsxs(Hn,{children:[m.jsx(Gn,{children:"Recent Calls"}),m.jsx(Kn,{children:"Real-time logs sync from Firestore. When none exist yet, sample entries remain for reference."})]}),e?m.jsx("div",{className:"px-6 py-3 text-xs text-red-400",children:"Failed to load remote logs. Showing local mock data instead."}):null,m.jsx("div",{className:"px-6 pb-4 text-xs text-slate-500",children:n?"Loading call history":r?"Refreshing call history":null}),m.jsx("div",{className:"divide-y divide-slate-800",children:i.map(s=>m.jsxs("div",{className:"space-y-2 px-6 py-4 text-sm",children:[m.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:"rounded-full bg-slate-900/60 p-2",children:m.jsx(mv,{className:"h-4 w-4 text-brand"})}),m.jsxs("div",{children:[m.jsx("p",{className:"font-medium text-slate-200",children:s.counterparty}),m.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-400",children:s.direction})]})]}),m.jsxs("div",{className:"flex items-center gap-6 text-xs text-slate-400 sm:text-sm",children:[m.jsx("span",{children:s.startedAt}),m.jsx("span",{children:s.duration}),m.jsx("span",{className:"capitalize text-brand-light",children:s.status})]})]}),s.note?m.jsxs("div",{className:"rounded-md border border-brand/30 bg-brand/5 px-3 py-2 text-xs text-brand-light",children:[m.jsx("p",{className:"font-semibold uppercase tracking-wide",children:"Call Notes"}),m.jsx("p",{className:"mt-1 whitespace-pre-wrap text-slate-100",children:s.note})]}):null]},s.id))})]})]})}function n$(){const{events:t,initializeClient:e,resetEvents:n}=sv();return N.useEffect(()=>{e().catch(console.error)},[e]),m.jsxs("div",{className:"space-y-6",children:[m.jsxs("header",{children:[m.jsx("h2",{className:"text-3xl font-semibold tracking-tight",children:"Event Logs"}),m.jsx("p",{className:"text-sm text-slate-400",children:"Inspect Twilio WebRTC socket activity and signaling events."})]}),m.jsxs(Nn,{children:[m.jsxs(Hn,{className:"flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx(Gn,{children:"Real-time WebRTC Events"}),m.jsx(Kn,{children:"Live feed of Twilio socket messages. Useful for troubleshooting."})]}),m.jsx("button",{className:"text-sm font-medium text-brand hover:text-brand-light",onClick:n,children:"Clear"})]}),m.jsx("div",{className:"max-h-[480px] overflow-y-auto px-6 py-4",children:m.jsxs("ul",{className:"space-y-3 text-xs font-mono text-slate-300",children:[t.length===0?m.jsx("li",{children:"No events captured yet."}):null,t.map((r,i)=>m.jsxs("li",{className:"flex items-start gap-3",children:[m.jsx("span",{className:"mt-0.5 text-brand",children:m.jsx(pv,{className:"h-3 w-3"})}),m.jsx("span",{children:r})]},`${r}-${i}`))]})})]})]})}function r$(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function i$(t,e=[]){let n=[];function r(s,o){const a=N.createContext(o),l=n.length;n=[...n,o];const u=h=>{var w;const{scope:p,children:y,...T}=h,E=((w=p==null?void 0:p[t])==null?void 0:w[l])||a,R=N.useMemo(()=>T,Object.values(T));return m.jsx(E.Provider,{value:R,children:y})};u.displayName=s+"Provider";function d(h,p){var E;const y=((E=p==null?void 0:p[t])==null?void 0:E[l])||a,T=N.useContext(y);if(T)return T;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${s}\``)}return[u,d]}const i=()=>{const s=n.map(o=>N.createContext(o));return function(a){const l=(a==null?void 0:a[t])||s;return N.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return i.scopeName=t,[r,s$(i,...e)]}function s$(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const o=r.reduce((a,{useScope:l,scopeName:u})=>{const h=l(s)[`__scope${u}`];return{...a,...h}},{});return N.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var PA=globalThis!=null&&globalThis.document?N.useLayoutEffect:()=>{},o$=kT[" useInsertionEffect ".trim().toString()]||PA;function a$({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[i,s,o]=l$({defaultProp:e,onChange:n}),a=t!==void 0,l=a?t:i;{const d=N.useRef(t!==void 0);N.useEffect(()=>{const h=d.current;h!==a&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${a?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=a},[a,r])}const u=N.useCallback(d=>{var h;if(a){const p=c$(d)?d(t):d;p!==t&&((h=o.current)==null||h.call(o,p))}else s(d)},[a,t,s,o]);return[l,u]}function l$({defaultProp:t,onChange:e}){const[n,r]=N.useState(t),i=N.useRef(n),s=N.useRef(e);return o$(()=>{s.current=e},[e]),N.useEffect(()=>{var o;i.current!==n&&((o=s.current)==null||o.call(s,n),i.current=n)},[n,i]),[n,r,s]}function c$(t){return typeof t=="function"}function u$(t){const e=N.useRef({value:t,previous:t});return N.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}function d$(t){const[e,n]=N.useState(void 0);return PA(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let o,a;if("borderBoxSize"in s){const l=s.borderBoxSize,u=Array.isArray(l)?l[0]:l;o=u.inlineSize,a=u.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var Lf="Switch",[h$]=i$(Lf),[f$,p$]=h$(Lf),RA=N.forwardRef((t,e)=>{const{__scopeSwitch:n,name:r,checked:i,defaultChecked:s,required:o,disabled:a,value:l="on",onCheckedChange:u,form:d,...h}=t,[p,y]=N.useState(null),T=lA(e,b=>y(b)),E=N.useRef(!1),R=p?d||!!p.closest("form"):!0,[w,v]=a$({prop:i,defaultProp:s??!1,onChange:u,caller:Lf});return m.jsxs(f$,{scope:n,checked:w,disabled:a,children:[m.jsx(fv.button,{type:"button",role:"switch","aria-checked":w,"aria-required":o,"data-state":LA(w),"data-disabled":a?"":void 0,disabled:a,value:l,...h,ref:T,onClick:r$(t.onClick,b=>{v(D=>!D),R&&(E.current=b.isPropagationStopped(),E.current||b.stopPropagation())})}),R&&m.jsx(OA,{control:p,bubbles:!E.current,name:r,value:l,checked:w,required:o,disabled:a,form:d,style:{transform:"translateX(-100%)"}})]})});RA.displayName=Lf;var NA="SwitchThumb",DA=N.forwardRef((t,e)=>{const{__scopeSwitch:n,...r}=t,i=p$(NA,n);return m.jsx(fv.span,{"data-state":LA(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:e})});DA.displayName=NA;var m$="SwitchBubbleInput",OA=N.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:r=!0,...i},s)=>{const o=N.useRef(null),a=lA(o,s),l=u$(n),u=d$(e);return N.useEffect(()=>{const d=o.current;if(!d)return;const h=window.HTMLInputElement.prototype,y=Object.getOwnPropertyDescriptor(h,"checked").set;if(l!==n&&y){const T=new Event("click",{bubbles:r});y.call(d,n),d.dispatchEvent(T)}},[l,n,r]),m.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...i,tabIndex:-1,ref:a,style:{...i.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});OA.displayName=m$;function LA(t){return t?"checked":"unchecked"}var MA=RA,g$=DA;const VA=N.forwardRef(({className:t,...e},n)=>m.jsx(MA,{className:Sr("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent bg-slate-700 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-brand ring-offset-slate-950",t),...e,ref:n,children:m.jsx(g$,{className:Sr("pointer-events-none block h-5 w-5 rounded-full bg-slate-100 shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));VA.displayName=MA.displayName;const y$={allowOutbound:!0,allowInbound:!0,recordCalls:!0,callerId:"",identityAlias:""};async function _$(t){if(!_n)throw new Error("Firebase is not configured");const e=To(_n,"voiceProfiles",t),n=await bk(e);if(!n.exists())return{profile:y$,ref:e};const r=n.data()??{};return{profile:{allowOutbound:!!(r.allowOutbound??r.allow_outbound??!0),allowInbound:!!(r.allowInbound??r.allow_inbound??!0),recordCalls:!!(r.recordCalls??r.record_calls??!0),callerId:typeof r.callerId=="string"?r.callerId:typeof r.caller_id=="string"?r.caller_id:"",identityAlias:typeof r.identityAlias=="string"?r.identityAlias:typeof r.identity_alias=="string"?r.identity_alias:"",updatedAt:r.updatedAt},ref:e}}async function v$(t,e){if(!_n)throw new Error("Firebase is not configured");const n=To(_n,"voiceProfiles",t);await Ag(n,{allowOutbound:!!e.allowOutbound,allowInbound:!!e.allowInbound,recordCalls:!!e.recordCalls,callerId:e.callerId.trim(),identityAlias:e.identityAlias.trim(),updatedAt:su()},{merge:!0})}const w$=qs({callerId:nn().trim().optional().transform(t=>t??""),identityAlias:nn().trim().optional().transform(t=>t??""),allowOutbound:zp(),allowInbound:zp(),recordCalls:zp()});function E$(){var D,L;const{user:t}=Ui(),{connectionStatus:e}=sv(),[n,r]=N.useState(null),[i,s]=N.useState(null),[o,a]=N.useState(null),[l,u]=N.useState(!0),d=Da({resolver:La(w$),defaultValues:{callerId:"",identityAlias:"",allowOutbound:!0,allowInbound:!0,recordCalls:!0}});N.useEffect(()=>{if(!o)return;const j=setTimeout(()=>a(null),4e3);return()=>clearTimeout(j)},[o]),N.useEffect(()=>{if(!t){u(!1),r(null);return}let j=!1;return(async()=>{u(!0);try{const{profile:_}=await _$(t.uid);if(j)return;r(_),d.reset({callerId:_.callerId??"",identityAlias:_.identityAlias??"",allowOutbound:_.allowOutbound,allowInbound:_.allowInbound,recordCalls:_.recordCalls}),s(null)}catch(_){if(j)return;s(_ instanceof Error?_.message:"Unable to load voice workspace configuration.")}finally{u(!1)}})(),()=>{j=!0}},[d,t]);const h=async j=>{if(t){s(null);try{await v$(t.uid,{allowOutbound:j.allowOutbound,allowInbound:j.allowInbound,recordCalls:j.recordCalls,callerId:j.callerId??"",identityAlias:j.identityAlias??""}),a("Voice workspace updated."),r({allowOutbound:j.allowOutbound,allowInbound:j.allowInbound,recordCalls:j.recordCalls,callerId:j.callerId??"",identityAlias:j.identityAlias??""})}catch(I){s(I instanceof Error?I.message:"Unable to save voice workspace settings.")}}},p=N.useMemo(()=>e.state==="registered"?"text-emerald-400":e.state==="error"?"text-red-400":e.state==="disconnected"?"text-amber-400":e.state==="initialising"?"text-amber-300":"text-slate-300",[e.state]),y=N.useMemo(()=>{const j=n==null?void 0:n.updatedAt;return j!=null&&j.toDate?j.toDate().toLocaleString():null},[n]),{register:T,handleSubmit:E,formState:{errors:R,isSubmitting:w},setValue:v,watch:b}=d;return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("header",{children:[m.jsx("h2",{className:"text-3xl font-semibold tracking-tight",children:"Voice Workspace"}),m.jsx("p",{className:"text-sm text-slate-400",children:"Control Twilio Programmable Voice access for this operator. Update caller ID, allowed call directions, and recording policy."})]}),m.jsxs("div",{className:"grid gap-6 lg:grid-cols-[2fr,3fr]",children:[m.jsxs(Nn,{className:"self-start",children:[m.jsxs(Hn,{children:[m.jsx(Gn,{children:"Current Status"}),m.jsx(Kn,{children:"Live connection state for the browser dialer."})]}),m.jsxs("div",{className:"space-y-4 px-6 pb-6 text-sm text-slate-300",children:[l?m.jsx("p",{children:"Loading voice workspace"}):null,i?m.jsx("p",{className:"text-red-400",children:i}):null,!l&&!i&&n?m.jsxs("div",{className:"space-y-3",children:[m.jsx(ta,{label:"Caller ID",value:n.callerId||"Not set"}),m.jsx(ta,{label:"Identity Alias",value:n.identityAlias||"Auto generated"}),m.jsx(ta,{label:"Outbound Calls",value:n.allowOutbound?"Allowed":"Blocked"}),m.jsx(ta,{label:"Inbound Calls",value:n.allowInbound?"Allowed":"Blocked"}),m.jsx(ta,{label:"Recording",value:n.recordCalls?"Enabled":"Disabled"}),y?m.jsx(ta,{label:"Last updated",value:y}):null]}):null,m.jsxs("div",{className:`rounded-lg bg-slate-900/60 px-4 py-3 ${p}`,children:[m.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-slate-400",children:"Twilio Registration"}),m.jsx("p",{className:"text-sm text-slate-200",children:e.message})]}),o?m.jsx("p",{className:"text-xs text-emerald-400",children:o}):null]})]}),m.jsxs(Nn,{children:[m.jsxs(Hn,{children:[m.jsx(Gn,{children:"Voice Access Controls"}),m.jsx(Kn,{children:"Changes apply immediately after saving."})]}),m.jsxs("form",{className:"space-y-5 px-6 pb-6",onSubmit:E(h),children:[m.jsxs(sT,{label:"Caller ID",error:(D=R.callerId)==null?void 0:D.message,children:[m.jsx(yn,{placeholder:"+12025550123",...T("callerId")}),m.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Number presented to customers on outbound calls."})]}),m.jsxs(sT,{label:"Identity Alias",error:(L=R.identityAlias)==null?void 0:L.message,children:[m.jsx(yn,{placeholder:"support-team",...T("identityAlias")}),m.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Override the default Twilio client identity (defaults to the agent email)."})]}),m.jsxs("div",{className:"space-y-4",children:[m.jsx(Gp,{label:"Allow outbound calls",description:"Permit this agent to initiate outbound PSTN calls.",checked:b("allowOutbound"),onCheckedChange:j=>v("allowOutbound",!!j)}),m.jsx(Gp,{label:"Allow inbound calls",description:"Enable ringing when Twilio routes inbound calls to this agent.",checked:b("allowInbound"),onCheckedChange:j=>v("allowInbound",!!j)}),m.jsx(Gp,{label:"Record calls automatically",description:"Start dual-channel recordings when the call connects.",checked:b("recordCalls"),onCheckedChange:j=>v("recordCalls",!!j)})]}),m.jsx(lt,{type:"submit",disabled:w,children:w?"Saving":"Save voice settings"})]})]})]})]})}function sT({label:t,error:e,children:n}){return m.jsxs("div",{className:"space-y-2",children:[m.jsx("p",{className:"text-sm font-medium text-slate-200",children:t}),n,e?m.jsx("p",{className:"text-xs text-red-400",children:e}):null]})}function Gp({label:t,description:e,checked:n,onCheckedChange:r}){return m.jsxs("div",{className:"flex items-start justify-between rounded-lg border border-slate-800 bg-slate-900/60 p-4",children:[m.jsxs("div",{className:"pr-4",children:[m.jsx("p",{className:"text-sm font-semibold text-slate-200",children:t}),m.jsx("p",{className:"text-xs text-slate-500",children:e})]}),m.jsx(VA,{checked:n,onCheckedChange:r})]})}function ta({label:t,value:e}){return m.jsxs("div",{children:[m.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:t}),m.jsx("p",{className:"text-sm text-slate-200",children:e||"-"})]})}const S$=qs({displayName:nn().min(2,"Name is required")}),T$=qs({newEmail:nn().email("Enter a valid email"),currentPassword:nn().min(6,"Enter your current password")}),x$=qs({currentPassword:nn().min(6,"Enter your current password"),newPassword:nn().min(6,"New password must be at least 6 characters"),confirmPassword:nn().min(6,"Confirm your new password")}).refine(t=>t.newPassword===t.confirmPassword,{message:"Passwords must match",path:["confirmPassword"]});function b$(){var A;const{user:t,updateDisplayName:e,updateEmailAddress:n,updateUserPassword:r,sendVerificationEmail:i,verifying:s,refreshUser:o,determineProvider:a}=Ui(),[l,u]=N.useState(null),[d,h]=N.useState(null),[p,y]=N.useState(null),[T,E]=N.useState(null),R=a(),w=R==="password"||((A=t==null?void 0:t.providerData)==null?void 0:A.some(k=>k.providerId==="password")),v=R==="google"&&!w,b=Da({resolver:La(S$),defaultValues:{displayName:(t==null?void 0:t.displayName)??""}}),D=Da({resolver:La(T$),defaultValues:{newEmail:(t==null?void 0:t.email)??"",currentPassword:""}}),L=Da({resolver:La(x$),defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""}});N.useEffect(()=>{b.reset({displayName:(t==null?void 0:t.displayName)??""}),D.reset({newEmail:(t==null?void 0:t.email)??"",currentPassword:""})},[D,b,t==null?void 0:t.displayName,t==null?void 0:t.email]);const j=b.handleSubmit(async k=>{u(null),E(null);try{await e(k.displayName.trim()),await o(),u("Display name updated successfully.")}catch(x){E(x instanceof Error?x.message:"Unable to update profile")}}),I=D.handleSubmit(async k=>{if(h(null),E(null),!w){E("Email updates are managed through your Google account settings.");return}try{await n({currentPassword:k.currentPassword,newEmail:k.newEmail.trim()}),await o(),h("Email address updated. Please verify the new address if prompted by email.")}catch(x){E(x instanceof Error?x.message:"Unable to update email")}}),_=L.handleSubmit(async k=>{if(y(null),E(null),!w){E("Password changes are unavailable for Google-linked accounts.");return}try{await r({currentPassword:k.currentPassword,newPassword:k.newPassword}),y("Password updated successfully."),L.reset({currentPassword:"",newPassword:"",confirmPassword:""})}catch(x){E(x instanceof Error?x.message:"Unable to update password")}}),C=async()=>{E(null),h(null);try{await i(),h("Verification email sent. Please check your inbox.")}catch(k){E(k instanceof Error?k.message:"Unable to send verification email")}};return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("header",{children:[m.jsx("h2",{className:"text-3xl font-semibold tracking-tight",children:"User Settings"}),m.jsx("p",{className:"text-sm text-slate-400",children:"Manage how you appear to customers and keep your credentials secure."})]}),m.jsxs(Nn,{children:[m.jsxs(Hn,{children:[m.jsx(Gn,{children:"Profile"}),m.jsx(Kn,{children:"Update the display name shown to other Twilio operators."})]}),m.jsxs("form",{className:"space-y-5 px-6 pb-6",onSubmit:j,children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(er,{htmlFor:"displayName",children:"Display name"}),m.jsx(yn,{id:"displayName",...b.register("displayName")}),b.formState.errors.displayName?m.jsx("p",{className:"text-xs text-red-400",children:b.formState.errors.displayName.message}):null]}),l?m.jsx("p",{className:"text-sm text-emerald-400",children:l}):null,m.jsx(lt,{type:"submit",disabled:b.formState.isSubmitting,children:b.formState.isSubmitting?"Saving":"Save profile"})]})]}),m.jsxs(Nn,{children:[m.jsxs(Hn,{children:[m.jsx(Gn,{children:"Email & Verification"}),m.jsxs(Kn,{children:["Current email: ",m.jsx("span",{className:"font-medium",children:t==null?void 0:t.email})," "," ",m.jsx("span",{className:t!=null&&t.emailVerified?"text-emerald-400":"text-amber-300",children:t!=null&&t.emailVerified?"Verified":"Unverified"})]})]}),m.jsxs("form",{className:"space-y-5 px-6 pb-6",onSubmit:I,children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(er,{htmlFor:"newEmail",children:"New email"}),m.jsx(yn,{id:"newEmail",type:"email",autoComplete:"email",disabled:!w,...D.register("newEmail")}),D.formState.errors.newEmail?m.jsx("p",{className:"text-xs text-red-400",children:D.formState.errors.newEmail.message}):null]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(er,{htmlFor:"currentPasswordEmail",children:"Current password"}),m.jsx(yn,{id:"currentPasswordEmail",type:"password",autoComplete:"current-password",disabled:!w,...D.register("currentPassword")}),D.formState.errors.currentPassword?m.jsx("p",{className:"text-xs text-red-400",children:D.formState.errors.currentPassword.message}):null]}),d?m.jsx("p",{className:"text-sm text-emerald-400",children:d}):null,v?m.jsx("p",{className:"text-xs text-slate-400",children:"This profile is linked to Google sign-in. Update your primary email from your Google account."}):null,m.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[m.jsx(lt,{type:"submit",className:"flex-1",disabled:!w||D.formState.isSubmitting,children:D.formState.isSubmitting?"Updating":"Update email"}),m.jsx(lt,{type:"button",variant:"outline",className:"flex-1",disabled:s||D.formState.isSubmitting,onClick:()=>void C(),children:s?"Sending":"Resend verification email"})]})]})]}),m.jsxs(Nn,{children:[m.jsxs(Hn,{children:[m.jsx(Gn,{children:"Password"}),m.jsx(Kn,{children:"Change your password regularly to protect Twilio accounts."})]}),m.jsxs("form",{className:"space-y-5 px-6 pb-6",onSubmit:_,children:[m.jsxs("div",{className:"space-y-2",children:[m.jsx(er,{htmlFor:"currentPassword",children:"Current password"}),m.jsx(yn,{id:"currentPassword",type:"password",autoComplete:"current-password",disabled:!w,...L.register("currentPassword")}),L.formState.errors.currentPassword?m.jsx("p",{className:"text-xs text-red-400",children:L.formState.errors.currentPassword.message}):null]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(er,{htmlFor:"newPassword",children:"New password"}),m.jsx(yn,{id:"newPassword",type:"password",autoComplete:"new-password",disabled:!w,...L.register("newPassword")}),L.formState.errors.newPassword?m.jsx("p",{className:"text-xs text-red-400",children:L.formState.errors.newPassword.message}):null]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(er,{htmlFor:"confirmPassword",children:"Confirm new password"}),m.jsx(yn,{id:"confirmPassword",type:"password",autoComplete:"new-password",disabled:!w,...L.register("confirmPassword")}),L.formState.errors.confirmPassword?m.jsx("p",{className:"text-xs text-red-400",children:L.formState.errors.confirmPassword.message}):null]}),p?m.jsx("p",{className:"text-sm text-emerald-400",children:p}):null,v?m.jsx("p",{className:"text-xs text-slate-400",children:"Password resets are managed through Google. Use Google security settings to update it."}):null,m.jsx(lt,{type:"submit",disabled:!w||L.formState.isSubmitting,children:L.formState.isSubmitting?"Updating":"Update password"})]})]}),T?m.jsx("p",{className:"text-sm text-red-400",children:T}):null]})}const I$=[{title:"Webhooks & Status Callbacks",description:"Subscribe to Twilio Voice status callbacks and recording webhooks to automate post-call workflows.",icon:m.jsx(U9,{className:"h-5 w-5 text-brand"})},{title:"Programmable Voice API",description:"Trigger outbound calls or update live sessions using Twilio's REST API, Functions, or Studio flows.",icon:m.jsx(P9,{className:"h-5 w-5 text-brand"})},{title:"TwiML Applications",description:"Design IVRs, warm transfers, and conference bridges with TwiML bins or server-hosted TwiML.",icon:m.jsx(R9,{className:"h-5 w-5 text-brand"})},{title:"Secure Media",description:"Enforce SRTP, TLS, and JWT access tokens for hardened voice connectivity.",icon:m.jsx(M9,{className:"h-5 w-5 text-brand"})},{title:"Developer Tooling",description:"Leverage the Twilio CLI, Postman collections, and Terraform modules to automate deployments.",icon:m.jsx(N9,{className:"h-5 w-5 text-brand"})}];function C$(){return m.jsxs("div",{className:"space-y-6",children:[m.jsxs("header",{children:[m.jsx("h2",{className:"text-3xl font-semibold tracking-tight",children:"Advanced Configuration"}),m.jsx("p",{className:"text-sm text-slate-400",children:"Extend the Twilio web dialer with Programmable Voice, serverless automation, and production observability."})]}),m.jsx("section",{className:"grid gap-4 lg:grid-cols-2",children:I$.map(t=>m.jsxs(Nn,{className:"flex items-start gap-4",children:[m.jsx("div",{className:"rounded-xl bg-slate-900/70 p-3",children:t.icon}),m.jsx("div",{children:m.jsxs(Hn,{className:"p-0",children:[m.jsx(Gn,{className:"text-lg",children:t.title}),m.jsx(Kn,{children:t.description})]})})]},t.title))}),m.jsxs(Nn,{children:[m.jsxs(Hn,{children:[m.jsx(Gn,{children:"Developer Checklist"}),m.jsx(Kn,{children:"Steps to launch advanced functionality in a production-ready workspace."})]}),m.jsxs("ol",{className:"list-decimal space-y-3 px-6 pb-6 text-sm text-slate-300",children:[m.jsx("li",{children:"Create TwiML applications and SIP domains for each environment."}),m.jsx("li",{children:"Issue short-lived access tokens via Twilio Functions or your backend."}),m.jsx("li",{children:"Implement status callbacks to orchestrate IVRs, warm transfers, and recording policies."}),m.jsx("li",{children:"Instrument Voice Insights, Event Streams, and your monitoring stack for quality dashboards."})]})]})]})}function k$(){return m.jsx("div",{className:"flex min-h-screen flex-col items-center justify-center bg-slate-950 text-center text-slate-100",children:m.jsxs("div",{className:"space-y-4",children:[m.jsx("h1",{className:"text-4xl font-semibold",children:"404"}),m.jsx("p",{className:"text-sm text-slate-400",children:"The page you are looking for does not exist."}),m.jsx(lt,{asChild:!0,children:m.jsx(Gy,{to:"/dashboard",children:"Return to dashboard"})})]})})}function A$(){const t=[{icon:m.jsx(V9,{className:"h-5 w-5 text-brand-light"}),label:"Email",value:"support@twilio.com",helper:"Reach our support desk for account or billing questions."},{icon:m.jsx(mv,{className:"h-5 w-5 text-brand-light"}),label:"WhatsApp",value:"+1 (877) 889-4545",helper:"Tap to start a secure conversation with our operators."},{icon:m.jsx(F9,{className:"h-5 w-5 text-brand-light"}),label:"Live chat",value:"Coming soon",helper:"We are building an in-dashboard live chat experience for rapid responses."}];return m.jsxs("div",{className:"mx-auto w-full max-w-4xl space-y-6",children:[m.jsxs("div",{children:[m.jsx("h1",{className:"text-2xl font-semibold text-brand",children:"Need a hand?"}),m.jsx("p",{className:"text-sm text-slate-400",children:"The Twilio success team is ready to help with onboarding, troubleshooting, or optimisation guidance."})]}),m.jsxs(Nn,{children:[m.jsxs(Hn,{children:[m.jsx(Gn,{children:"Contact Twilio"}),m.jsx(Kn,{children:"Use the channel that suits you best  we will route your request to the right specialist."})]}),m.jsx("div",{className:"space-y-5",children:t.map(e=>m.jsxs("div",{className:"flex items-start gap-4 rounded-lg border border-slate-800/60 bg-slate-950/40 p-4",children:[m.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-brand/10",children:e.icon}),m.jsxs("div",{children:[m.jsx("p",{className:"text-sm font-semibold text-slate-100",children:e.label}),m.jsx("p",{className:"text-lg font-medium text-brand-light",children:e.value}),m.jsx("p",{className:"text-xs text-slate-400",children:e.helper})]})]},e.label))})]})]})}const P$=[{to:"/dashboard",label:"Dashboard",icon:D9},{to:"/dialer",label:"Dialer",icon:mv},{to:"/call-logs",label:"Call Logs",icon:L9},{to:"/event-logs",label:"Event Logs",icon:pv},{to:"/voice-workspace",label:"Voice Workspace",icon:IA},{to:"/advanced-config",label:"Advanced Config",icon:z9},{to:"/settings",label:"Settings",icon:$9},{to:"/contact",label:"Contact Us",icon:O9}];function R$(){const{user:t,signOutUser:e}=Ui(),[n,r]=N.useState(!1),i=N.useMemo(()=>t!=null&&t.email?`${t.email} ${t.emailVerified?"(Verified)":"(Unverified)"}`:"guest",[t==null?void 0:t.email,t==null?void 0:t.emailVerified]),s=a=>P$.map(l=>{const u=l.icon;return m.jsxs(MN,{to:l.to,onClick:()=>a==null?void 0:a(),className:({isActive:d})=>`flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium transition hover:bg-slate-800 ${d?"bg-slate-800 text-brand-light":"text-slate-300"}`,children:[m.jsx(u,{className:"h-4 w-4"}),l.label]},l.to)}),o=()=>r(!1);return m.jsxs("div",{className:"flex min-h-screen bg-slate-950 text-slate-100",children:[m.jsxs("aside",{className:"hidden w-64 flex-col border-r border-slate-800 bg-slate-900/60 p-6 lg:flex",children:[m.jsxs("div",{className:"mb-8",children:[m.jsx("h1",{className:"text-2xl font-semibold text-brand",children:"Twilio Voice Console"}),m.jsxs("p",{className:"text-sm text-slate-400",children:["Connected as ",i]})]}),m.jsx("nav",{className:"flex-1 space-y-2",children:s()}),m.jsxs(lt,{variant:"outline",onClick:()=>e(),className:"mt-auto justify-start gap-2",children:[m.jsx(qp,{className:"h-4 w-4"}),"Sign out"]})]}),n?m.jsxs("div",{className:"fixed inset-0 z-50 flex lg:hidden",children:[m.jsxs("div",{className:"flex w-64 flex-col border-r border-slate-800 bg-slate-900/95 p-6",children:[m.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[m.jsxs("div",{children:[m.jsx("h1",{className:"text-xl font-semibold text-brand",children:"Twilio Voice Console"}),m.jsxs("p",{className:"text-xs text-slate-400",children:["Connected as ",i]})]}),m.jsx(lt,{variant:"ghost",size:"icon",onClick:o,"aria-label":"Close navigation",children:m.jsx(CA,{className:"h-5 w-5"})})]}),m.jsx("nav",{className:"flex-1 space-y-2 overflow-y-auto",children:s(o)}),m.jsxs(lt,{variant:"outline",onClick:()=>{o(),e()},className:"mt-6 justify-start gap-2",children:[m.jsx(qp,{className:"h-4 w-4"}),"Sign out"]})]}),m.jsx("button",{type:"button",className:"flex-1 bg-black/40",onClick:o,"aria-label":"Close navigation"})]}):null,m.jsxs("div",{className:"flex flex-1 flex-col",children:[m.jsxs("header",{className:"flex items-center justify-between border-b border-slate-800 bg-slate-900/40 p-4",children:[m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx(lt,{variant:"ghost",size:"icon",className:"lg:hidden",onClick:()=>r(!0),"aria-label":"Open navigation",children:m.jsx(j9,{className:"h-5 w-5"})}),m.jsxs("div",{className:"flex flex-col",children:[m.jsx("span",{className:"text-xs uppercase tracking-wide text-slate-400",children:"Twilio Voice Console"}),m.jsx("span",{className:"text-lg font-semibold",children:"Web Dialer"})]})]}),m.jsxs("div",{className:"flex items-center gap-3",children:[m.jsx("div",{className:"hidden text-sm text-slate-400 sm:block",children:i}),m.jsxs(lt,{size:"sm",variant:"outline",onClick:()=>e(),children:[m.jsx(qp,{className:"mr-2 h-4 w-4"})," Logout"]})]})]}),m.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:m.jsx("div",{className:"mx-auto max-w-6xl space-y-6",children:m.jsx(zb,{})})})]})]})}const N$=qs({password:nn().min(6,"Password must be at least 6 characters long"),confirmPassword:nn().min(6,"Confirm your new password")}).refine(t=>t.password===t.confirmPassword,{message:"Passwords must match",path:["confirmPassword"]});function D$(){const[t]=FN(),e=Eu(),n=t.get("mode"),r=t.get("oobCode"),i=t.get("continueUrl"),[s,o]=N.useState("loading"),[a,l]=N.useState(""),[u,d]=N.useState(""),[h,p]=N.useState(""),{handleSubmit:y,register:T,formState:{errors:E,isSubmitting:R},reset:w}=Da({resolver:La(N$),defaultValues:{password:"",confirmPassword:""}});N.useEffect(()=>{if(!ne){p("Firebase is not configured for this environment."),o("error");return}if(!n||!r){p("Invalid or missing action parameters."),o("error");return}o("loading"),d(""),p("");let L=!1;return(async()=>{var I;try{switch(n){case"verifyEmail":{await Rp(ne,r),L||(o("verifyEmailComplete"),d("Your email has been verified successfully. You can now sign in."));break}case"resetPassword":{const _=await tL(ne,r);L||(l(_??""),o("resetReady"));break}case"recoverEmail":{const _=await UI(ne,r);if(await Rp(ne,r),!L){const C=((I=_==null?void 0:_.data)==null?void 0:I.email)??"";l(C),o("recoverEmailComplete"),d("Your email address has been restored.")}break}case"verifyAndChangeEmail":{await Rp(ne,r),L||(o("verifyEmailComplete"),d("Your email change has been confirmed. Please sign in with the updated address."));break}default:L||(o("unsupported"),d("This action link is not supported."))}}catch(_){if(console.error("Failed to resolve auth action",_),!L){const C=_ instanceof Error&&_.message?_.message:"The link is invalid or has already been used.";p(C),o("error")}}})(),()=>{L=!0}},[n,r,ne]);const v=async L=>{if(!(!ne||!r)){p("");try{await eL(ne,r,L.password),o("resetComplete"),d("Password updated. You can now sign in with your new credentials."),w()}catch(j){const I=j instanceof Error&&j.message?j.message:"Unable to update your password. Try requesting a new reset email.";p(I)}}},b=N.useMemo(()=>{switch(n){case"verifyEmail":case"verifyAndChangeEmail":return"Confirm your email";case"resetPassword":return"Reset your password";case"recoverEmail":return"Restore your email";default:return"Account action"}},[n]),D=()=>s==="loading"?m.jsxs("div",{className:"space-y-2 text-center",children:[m.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-brand border-t-transparent"}),m.jsx("p",{className:"text-sm text-slate-400",children:"Validating your request"})]}):s==="resetReady"?m.jsxs("form",{className:"space-y-5",onSubmit:y(v),children:[m.jsxs("div",{className:"space-y-1 text-left",children:[m.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Account"}),m.jsx("p",{className:"text-sm text-slate-300",children:a})]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(er,{htmlFor:"password",children:"New password"}),m.jsx(yn,{id:"password",type:"password",autoComplete:"new-password",...T("password")}),E.password?m.jsx("p",{className:"text-xs text-red-400",children:E.password.message}):null]}),m.jsxs("div",{className:"space-y-2",children:[m.jsx(er,{htmlFor:"confirmPassword",children:"Confirm password"}),m.jsx(yn,{id:"confirmPassword",type:"password",autoComplete:"new-password",...T("confirmPassword")}),E.confirmPassword?m.jsx("p",{className:"text-xs text-red-400",children:E.confirmPassword.message}):null]}),h?m.jsx("p",{className:"text-sm text-red-400",children:h}):null,m.jsx(lt,{className:"w-full",type:"submit",disabled:R,children:R?"Updating":"Save new password"})]}):s==="resetComplete"||s==="verifyEmailComplete"||s==="recoverEmailComplete"?m.jsxs("div",{className:"space-y-4 text-center",children:[m.jsx("p",{className:"text-sm text-slate-300",children:u}),m.jsxs("div",{className:"flex flex-col gap-2",children:[m.jsx(lt,{onClick:()=>e("/auth",{replace:!0}),children:"Return to sign in"}),i?m.jsx(lt,{variant:"outline",asChild:!0,children:m.jsx("a",{href:i,children:"Continue to original page"})}):null]})]}):s==="unsupported"?m.jsxs("div",{className:"space-y-4 text-center",children:[m.jsx("p",{className:"text-sm text-slate-300",children:u}),m.jsx(lt,{onClick:()=>e("/auth",{replace:!0}),children:"Go to sign in"})]}):m.jsxs("div",{className:"space-y-4 text-center",children:[m.jsx("p",{className:"text-sm text-red-400",children:h||"Something went wrong with this request."}),m.jsx(lt,{onClick:()=>e("/auth",{replace:!0}),children:"Return to sign in"})]});return m.jsx("div",{className:"flex min-h-screen items-center justify-center bg-slate-950 px-4 text-slate-100",children:m.jsxs("div",{className:"w-full max-w-lg rounded-3xl border border-slate-800 bg-slate-900/80 p-8 shadow-xl",children:[m.jsxs("div",{className:"mb-6 text-center",children:[m.jsx("h1",{className:"text-2xl font-semibold text-brand",children:"Twilio Voice Dialer"}),m.jsx("p",{className:"text-sm text-slate-400",children:b})]}),s==="loading"?m.jsxs("div",{className:"space-y-2 text-center",children:[m.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-brand border-t-transparent"}),m.jsx("p",{className:"text-sm text-slate-400",children:"Validating your request"})]}):D(),m.jsxs("div",{className:"mt-6 text-center text-xs text-slate-500",children:["Need help? Contact ",m.jsx(Gy,{to:"/contact",className:"text-brand hover:underline",children:"Twilio support"}),"."]})]})})}function O$(){const{user:t,loading:e}=Ui();return e?m.jsx("div",{className:"flex min-h-screen items-center justify-center bg-slate-950 text-slate-100",children:m.jsxs("div",{className:"space-y-2 text-center",children:[m.jsx("div",{className:"h-10 w-10 animate-spin rounded-full border-4 border-brand border-t-transparent"}),m.jsx("p",{className:"text-sm text-slate-400",children:"Preparing your workspace"})]})}):m.jsx(Bb,{to:t?"/dashboard":"/auth",replace:!0})}function L$(){return m.jsxs(xN,{children:[m.jsx(xn,{path:"/",element:m.jsx(O$,{})}),m.jsx(xn,{path:"/auth",element:m.jsx(x9,{})}),m.jsx(xn,{path:"/auth/action",element:m.jsx(D$,{})}),m.jsx(xn,{element:m.jsx(MU,{}),children:m.jsxs(xn,{element:m.jsx(R$,{}),children:[m.jsx(xn,{path:"/dashboard",element:m.jsx(q9,{})}),m.jsx(xn,{path:"/dialer",element:m.jsx(G9,{})}),m.jsx(xn,{path:"/call-logs",element:m.jsx(t$,{})}),m.jsx(xn,{path:"/event-logs",element:m.jsx(n$,{})}),m.jsx(xn,{path:"/voice-workspace",element:m.jsx(E$,{})}),m.jsx(xn,{path:"/settings",element:m.jsx(b$,{})}),m.jsx(xn,{path:"/advanced-config",element:m.jsx(C$,{})}),m.jsx(xn,{path:"/contact",element:m.jsx(A$,{})})]})}),m.jsx(xn,{path:"*",element:m.jsx(k$,{})})]})}function M$(){return m.jsx(LU,{children:m.jsx(L$,{})})}const V$=new Xb,jA=document.getElementById("root");if(!jA)throw new Error("Root element not found");Kp.createRoot(jA).render(m.jsx(Cn.StrictMode,{children:m.jsx(tI,{client:V$,children:m.jsx(DN,{children:m.jsx(M$,{})})})}));
